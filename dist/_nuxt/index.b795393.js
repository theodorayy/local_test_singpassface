/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{183:function(e,t,n){var content=n(188);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(48).default)("3a6f4316",content,!0,{sourceMap:!1})},184:function(e,t,n){e.exports=n.p+"img/SingPassLogo.def2598.svg"},185:function(e,t,n){e.exports=n.p+"img/tick.25ffec9.png"},186:function(e,t,n){window,e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=177)}([function(e,t,n){var r=n(1),i=n(7),o=n(16),a=n(12),s=n(19),c=function e(t,n,c){var u,l,h,f,d=t&e.F,p=t&e.G,m=t&e.P,v=t&e.B,g=p?r:t&e.S?r[n]||(r[n]={}):(r[n]||{}).prototype,y=p?i:i[n]||(i[n]={}),b=y.prototype||(y.prototype={});for(u in p&&(c=n),c)h=((l=!d&&g&&void 0!==g[u])?g:c)[u],f=v&&l?s(h,r):m&&"function"==typeof h?s(Function.call,h):h,g&&a(g,u,h,t&e.U),y[u]!=h&&o(y,u,f),m&&b[u]!=h&&(b[u]=h)};r.core=i,c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){var r=n(4);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=function(e){return"object"===n(e)?null!==e:"function"==typeof e}},function(e,t,n){var r=n(57)("wks"),i=n(32),o=n(1).Symbol,a="function"==typeof o;(e.exports=function(e){return r[e]||(r[e]=a&&o[e]||(a?o:i)("Symbol."+e))}).store=r},function(e,t,n){var r=n(21),i=Math.min;e.exports=function(e){return e>0?i(r(e),9007199254740991):0}},function(e,t){var n=e.exports={version:"2.6.11"};"number"==typeof __e&&(__e=n)},function(e,t,n){e.exports=!n(2)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(3),i=n(105),o=n(28),a=Object.defineProperty;t.f=n(8)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(26);e.exports=function(e){return Object(r(e))}},function(e,t){e.exports="varying vec2 vUv;\n\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n"},function(e,t,n){var r=n(1),i=n(16),o=n(15),a=n(32)("src"),s=n(182),c=(""+s).split("toString");n(7).inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var u="function"==typeof n;u&&(o(n,"name")||i(n,"name",t)),e[t]!==n&&(u&&(o(n,a)||i(n,a,e[t]?""+e[t]:c.join(String(t)))),e===r?e[t]=n:s?e[t]?e[t]=n:i(e,t,n):(delete e[t],i(e,t,n)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[a]||s.call(this)}))},function(e,t,n){var r=n(0),i=n(2),o=n(26),a=/"/g,s=function(e,t,n,r){var i=String(o(e)),s="<"+t;return""!==n&&(s+=" "+n+'="'+String(r).replace(a,"&quot;")+'"'),s+">"+i+"</"+t+">"};e.exports=function(e,t){var n={};n[e]=t(s),r(r.P+r.F*i((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3})),"String",n)}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=n(151),o=n(396),a=Object.prototype.toString;function s(e){return"[object Array]"===a.call(e)}function c(e){return null!==e&&"object"===r(e)}function u(e){return"[object Function]"===a.call(e)}function l(e,t){if(null!=e)if("object"!==r(e)&&(e=[e]),s(e))for(var n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}e.exports={isArray:s,isArrayBuffer:function(e){return"[object ArrayBuffer]"===a.call(e)},isBuffer:o,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:c,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===a.call(e)},isFile:function(e){return"[object File]"===a.call(e)},isBlob:function(e){return"[object Blob]"===a.call(e)},isFunction:u,isStream:function(e){return c(e)&&u(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:l,merge:function e(){var t={};function n(n,i){"object"===r(t[i])&&"object"===r(n)?t[i]=e(t[i],n):t[i]=n}for(var i=0,o=arguments.length;i<o;i++)l(arguments[i],n);return t},deepMerge:function e(){var t={};function n(n,i){"object"===r(t[i])&&"object"===r(n)?t[i]=e(t[i],n):"object"===r(n)?t[i]=e({},n):t[i]=n}for(var i=0,o=arguments.length;i<o;i++)l(arguments[i],n);return t},extend:function(e,t,n){return l(t,(function(t,r){e[r]=n&&"function"==typeof t?i(t,n):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t,n){var r=n(9),i=n(31);e.exports=n(8)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(50),i=n(26);e.exports=function(e){return r(i(e))}},function(e,t,n){"use strict";var r=n(2);e.exports=function(e,t){return!!e&&r((function(){t?e.call(null,(function(){}),1):e.call(null)}))}},function(e,t,n){var r=n(20);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},function(e,t,n){var r=n(51),i=n(31),o=n(17),a=n(28),s=n(15),c=n(105),u=Object.getOwnPropertyDescriptor;t.f=n(8)?u:function(e,t){if(e=o(e),t=a(t,!0),c)try{return u(e,t)}catch(e){}if(s(e,t))return i(!r.f.call(e,t),e[t])}},function(e,t,n){var r=n(0),i=n(7),o=n(2);e.exports=function(e,t){var n=(i.Object||{})[e]||Object[e],a={};a[e]=t(n),r(r.S+r.F*o((function(){n(1)})),"Object",a)}},function(e,t,n){var r=n(19),i=n(50),o=n(10),a=n(6),s=n(121);e.exports=function(e,t){var n=1==e,c=2==e,u=3==e,l=4==e,h=6==e,f=5==e||h,d=t||s;return function(t,s,p){for(var m,v,g=o(t),y=i(g),b=r(s,p,3),_=a(y.length),w=0,x=n?d(t,_):c?d(t,0):void 0;_>w;w++)if((f||w in y)&&(v=b(m=y[w],w,g),e))if(n)x[w]=v;else if(v)switch(e){case 3:return!0;case 5:return m;case 6:return w;case 2:x.push(m)}else if(l)return!1;return h?-1:u||l?l:x}}},function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}if(n(8)){var i=n(33),o=n(1),a=n(2),s=n(0),c=n(68),u=n(97),l=n(19),h=n(45),f=n(31),d=n(16),p=n(46),m=n(21),v=n(6),g=n(132),y=n(35),b=n(28),_=n(15),w=n(52),x=n(4),S=n(10),E=n(89),M=n(36),C=n(38),T=n(37).f,A=n(91),P=n(32),L=n(5),R=n(24),k=n(58),N=n(53),O=n(93),D=n(43),F=n(61),I=n(44),U=n(92),B=n(123),j=n(9),z=n(22),V=j.f,G=z.f,W=o.RangeError,H=o.TypeError,q=o.Uint8Array,X=Array.prototype,Y=u.ArrayBuffer,Z=u.DataView,J=R(0),K=R(2),$=R(3),Q=R(4),ee=R(5),te=R(6),ne=k(!0),re=k(!1),ie=O.values,oe=O.keys,ae=O.entries,se=X.lastIndexOf,ce=X.reduce,ue=X.reduceRight,le=X.join,he=X.sort,fe=X.slice,de=X.toString,pe=X.toLocaleString,me=L("iterator"),ve=L("toStringTag"),ge=P("typed_constructor"),ye=P("def_constructor"),be=c.CONSTR,_e=c.TYPED,we=c.VIEW,xe=R(1,(function(e,t){return Te(N(e,e[ye]),t)})),Se=a((function(){return 1===new q(new Uint16Array([1]).buffer)[0]})),Ee=!!q&&!!q.prototype.set&&a((function(){new q(1).set({})})),Me=function(e,t){var n=m(e);if(n<0||n%t)throw W("Wrong offset!");return n},Ce=function(e){if(x(e)&&_e in e)return e;throw H(e+" is not a typed array!")},Te=function(e,t){if(!x(e)||!(ge in e))throw H("It is not a typed array constructor!");return new e(t)},Ae=function(e,t){return Pe(N(e,e[ye]),t)},Pe=function(e,t){for(var n=0,r=t.length,i=Te(e,r);r>n;)i[n]=t[n++];return i},Le=function(e,t,n){V(e,t,{get:function(){return this._d[n]}})},Re=function(e){var t,n,r,i,o,a,s=S(e),c=arguments.length,u=c>1?arguments[1]:void 0,h=void 0!==u,f=A(s);if(null!=f&&!E(f)){for(a=f.call(s),r=[],t=0;!(o=a.next()).done;t++)r.push(o.value);s=r}for(h&&c>2&&(u=l(u,arguments[2],2)),t=0,n=v(s.length),i=Te(this,n);n>t;t++)i[t]=h?u(s[t],t):s[t];return i},ke=function(){for(var e=0,t=arguments.length,n=Te(this,t);t>e;)n[e]=arguments[e++];return n},Ne=!!q&&a((function(){pe.call(new q(1))})),Oe=function(){return pe.apply(Ne?fe.call(Ce(this)):Ce(this),arguments)},De={copyWithin:function(e,t){return B.call(Ce(this),e,t,arguments.length>2?arguments[2]:void 0)},every:function(e){return Q(Ce(this),e,arguments.length>1?arguments[1]:void 0)},fill:function(e){return U.apply(Ce(this),arguments)},filter:function(e){return Ae(this,K(Ce(this),e,arguments.length>1?arguments[1]:void 0))},find:function(e){return ee(Ce(this),e,arguments.length>1?arguments[1]:void 0)},findIndex:function(e){return te(Ce(this),e,arguments.length>1?arguments[1]:void 0)},forEach:function(e){J(Ce(this),e,arguments.length>1?arguments[1]:void 0)},indexOf:function(e){return re(Ce(this),e,arguments.length>1?arguments[1]:void 0)},includes:function(e){return ne(Ce(this),e,arguments.length>1?arguments[1]:void 0)},join:function(e){return le.apply(Ce(this),arguments)},lastIndexOf:function(e){return se.apply(Ce(this),arguments)},map:function(e){return xe(Ce(this),e,arguments.length>1?arguments[1]:void 0)},reduce:function(e){return ce.apply(Ce(this),arguments)},reduceRight:function(e){return ue.apply(Ce(this),arguments)},reverse:function(){for(var e,t=Ce(this).length,n=Math.floor(t/2),r=0;r<n;)e=this[r],this[r++]=this[--t],this[t]=e;return this},some:function(e){return $(Ce(this),e,arguments.length>1?arguments[1]:void 0)},sort:function(e){return he.call(Ce(this),e)},subarray:function(e,t){var n=Ce(this),r=n.length,i=y(e,r);return new(N(n,n[ye]))(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,v((void 0===t?r:y(t,r))-i))}},Fe=function(e,t){return Ae(this,fe.call(Ce(this),e,t))},Ie=function(e){Ce(this);var t=Me(arguments[1],1),n=this.length,r=S(e),i=v(r.length),o=0;if(i+t>n)throw W("Wrong length!");for(;o<i;)this[t+o]=r[o++]},Ue={entries:function(){return ae.call(Ce(this))},keys:function(){return oe.call(Ce(this))},values:function(){return ie.call(Ce(this))}},Be=function(e,t){return x(e)&&e[_e]&&"symbol"!=r(t)&&t in e&&String(+t)==String(t)},je=function(e,t){return Be(e,t=b(t,!0))?f(2,e[t]):G(e,t)},ze=function(e,t,n){return!(Be(e,t=b(t,!0))&&x(n)&&_(n,"value"))||_(n,"get")||_(n,"set")||n.configurable||_(n,"writable")&&!n.writable||_(n,"enumerable")&&!n.enumerable?V(e,t,n):(e[t]=n.value,e)};be||(z.f=je,j.f=ze),s(s.S+s.F*!be,"Object",{getOwnPropertyDescriptor:je,defineProperty:ze}),a((function(){de.call({})}))&&(de=pe=function(){return le.call(this)});var Ve=p({},De);p(Ve,Ue),d(Ve,me,Ue.values),p(Ve,{slice:Fe,set:Ie,constructor:function(){},toString:de,toLocaleString:Oe}),Le(Ve,"buffer","b"),Le(Ve,"byteOffset","o"),Le(Ve,"byteLength","l"),Le(Ve,"length","e"),V(Ve,ve,{get:function(){return this[_e]}}),e.exports=function(e,t,n,r){var u=e+((r=!!r)?"Clamped":"")+"Array",l="get"+e,f="set"+e,p=o[u],m=p||{},y=p&&C(p),b=!p||!c.ABV,_={},S=p&&p.prototype,E=function(e,n){V(e,n,{get:function(){return function(e,n){var r=e._d;return r.v[l](n*t+r.o,Se)}(this,n)},set:function(e){return function(e,n,i){var o=e._d;r&&(i=(i=Math.round(i))<0?0:i>255?255:255&i),o.v[f](n*t+o.o,i,Se)}(this,n,e)},enumerable:!0})};b?(p=n((function(e,n,r,i){h(e,p,u,"_d");var o,a,s,c,l=0,f=0;if(x(n)){if(!(n instanceof Y||"ArrayBuffer"==(c=w(n))||"SharedArrayBuffer"==c))return _e in n?Pe(p,n):Re.call(p,n);o=n,f=Me(r,t);var m=n.byteLength;if(void 0===i){if(m%t)throw W("Wrong length!");if((a=m-f)<0)throw W("Wrong length!")}else if((a=v(i)*t)+f>m)throw W("Wrong length!");s=a/t}else s=g(n),o=new Y(a=s*t);for(d(e,"_d",{b:o,o:f,l:a,e:s,v:new Z(o)});l<s;)E(e,l++)})),S=p.prototype=M(Ve),d(S,"constructor",p)):a((function(){p(1)}))&&a((function(){new p(-1)}))&&F((function(e){new p,new p(null),new p(1.5),new p(e)}),!0)||(p=n((function(e,n,r,i){var o;return h(e,p,u),x(n)?n instanceof Y||"ArrayBuffer"==(o=w(n))||"SharedArrayBuffer"==o?void 0!==i?new m(n,Me(r,t),i):void 0!==r?new m(n,Me(r,t)):new m(n):_e in n?Pe(p,n):Re.call(p,n):new m(g(n))})),J(y!==Function.prototype?T(m).concat(T(y)):T(m),(function(e){e in p||d(p,e,m[e])})),p.prototype=S,i||(S.constructor=p));var A=S[me],P=!!A&&("values"==A.name||null==A.name),L=Ue.values;d(p,ge,!0),d(S,_e,u),d(S,we,!0),d(S,ye,p),(r?new p(1)[ve]==u:ve in S)||V(S,ve,{get:function(){return u}}),_[u]=p,s(s.G+s.W+s.F*(p!=m),_),s(s.S,u,{BYTES_PER_ELEMENT:t}),s(s.S+s.F*a((function(){m.of.call(p,1)})),u,{from:Re,of:ke}),"BYTES_PER_ELEMENT"in S||d(S,"BYTES_PER_ELEMENT",t),s(s.P,u,De),I(u),s(s.P+s.F*Ee,u,{set:Ie}),s(s.P+s.F*!P,u,Ue),i||S.toString==de||(S.toString=de),s(s.P+s.F*a((function(){new p(1).slice()})),u,{slice:Fe}),s(s.P+s.F*(a((function(){return[1,2].toLocaleString()!=new p([1,2]).toLocaleString()}))||!a((function(){S.toLocaleString.call([1,2])}))),u,{toLocaleString:Oe}),D[u]=P?A:L,i||P||d(S,me,L)}}else e.exports=function(){}},function(e,t,n){var r=n(4);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=n(32)("meta"),o=n(4),a=n(15),s=n(9).f,c=0,u=Object.isExtensible||function(){return!0},l=!n(2)((function(){return u(Object.preventExtensions({}))})),h=function(e){s(e,i,{value:{i:"O"+ ++c,w:{}}})},f=e.exports={KEY:i,NEED:!1,fastKey:function(e,t){if(!o(e))return"symbol"==r(e)?e:("string"==typeof e?"S":"P")+e;if(!a(e,i)){if(!u(e))return"F";if(!t)return"E";h(e)}return e[i].i},getWeak:function(e,t){if(!a(e,i)){if(!u(e))return!0;if(!t)return!1;h(e)}return e[i].w},onFreeze:function(e){return l&&f.NEED&&u(e)&&!a(e,i)&&h(e),e}}},function(e,t,n){(function(r){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}t.log=function(){var e;return"object"===("undefined"==typeof console?"undefined":i(console))&&console.log&&(e=console).log.apply(e,arguments)},t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),this.useColors){var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&"%c"===e&&(i=++r)})),t.splice(i,0,n)}},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){var e;try{e=t.storage.getItem("debug")}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=Object({NODE_ENV:"production"}).DEBUG),e},t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports=n(370)(t),e.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this,n(55))},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},function(e,t){e.exports=!1},function(e,t,n){var r=n(107),i=n(76);e.exports=Object.keys||function(e){return r(e,i)}},function(e,t,n){var r=n(21),i=Math.max,o=Math.min;e.exports=function(e,t){return(e=r(e))<0?i(e+t,0):o(e,t)}},function(e,t,n){var r=n(3),i=n(108),o=n(76),a=n(75)("IE_PROTO"),s=function(){},c=function(){var e,t=n(73)("iframe"),r=o.length;for(t.style.display="none",n(77).appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),c=e.F;r--;)delete c.prototype[o[r]];return c()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=r(e),n=new s,s.prototype=null,n[a]=e):n=c(),void 0===t?n:i(n,t)}},function(e,t,n){var r=n(107),i=n(76).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return r(e,i)}},function(e,t,n){var r=n(15),i=n(10),o=n(75)("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=i(e),r(e,o)?e[o]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},function(e,t,n){var r=n(5)("unscopables"),i=Array.prototype;null==i[r]&&n(16)(i,r,{}),e.exports=function(e){i[r][e]=!0}},function(e,t,n){var r=n(4);e.exports=function(e,t){if(!r(e)||e._t!==t)throw TypeError("Incompatible receiver, "+t+" required!");return e}},function(e,t,n){var r=n(9).f,i=n(15),o=n(5)("toStringTag");e.exports=function(e,t,n){e&&!i(e=n?e:e.prototype,o)&&r(e,o,{configurable:!0,value:t})}},function(e,t,n){var r=n(0),i=n(26),o=n(2),a=n(79),s="["+a+"]",c=RegExp("^"+s+s+"*"),u=RegExp(s+s+"*$"),l=function(e,t,n){var i={},s=o((function(){return!!a[e]()||"​"!="​"[e]()})),c=i[e]=s?t(h):a[e];n&&(i[n]=c),r(r.P+r.F*s,"String",i)},h=l.trim=function(e,t){return e=String(i(e)),1&t&&(e=e.replace(c,"")),2&t&&(e=e.replace(u,"")),e};e.exports=l},function(e,t){e.exports={}},function(e,t,n){"use strict";var r=n(1),i=n(9),o=n(8),a=n(5)("species");e.exports=function(e){var t=r[e];o&&t&&!t[a]&&i.f(t,a,{configurable:!0,get:function(){return this}})}},function(e,t){e.exports=function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!");return e}},function(e,t,n){var r=n(12);e.exports=function(e,t,n){for(var i in t)r(e,i,t[i],n);return e}},function(e,t,n){function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}e.exports=r,r.prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var r=0,i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t);return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){var r,i=n(383),o=n(145),a=n(385),s=n(386),c=n(387);"undefined"!=typeof ArrayBuffer&&(r=n(388));var u="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),l="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),h=u||l;t.protocol=3;var f=t.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},d=i(f),p={type:"error",data:"parser error"},m=n(389);function v(e,t,n){for(var r=new Array(e.length),i=s(e.length,n),o=function(e,n,i){t(n,(function(t,n){r[e]=n,i(t,r)}))},a=0;a<e.length;a++)o(a,e[a],i)}t.encodePacket=function(e,n,r,i){"function"==typeof n&&(i=n,n=!1),"function"==typeof r&&(i=r,r=null);var o=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!=typeof ArrayBuffer&&o instanceof ArrayBuffer)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var i=e.data,o=new Uint8Array(i),a=new Uint8Array(1+i.byteLength);a[0]=f[e.type];for(var s=0;s<o.length;s++)a[s+1]=o[s];return r(a.buffer)}(e,n,i);if(void 0!==m&&o instanceof m)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);if(h)return function(e,n,r){if(!n)return t.encodeBase64Packet(e,r);var i=new FileReader;return i.onload=function(){t.encodePacket({type:e.type,data:i.result},n,!0,r)},i.readAsArrayBuffer(e.data)}(e,n,r);var i=new Uint8Array(1);return i[0]=f[e.type],r(new m([i.buffer,e.data]))}(e,n,i);if(o&&o.base64)return function(e,n){return n("b"+t.packets[e.type]+e.data.data)}(e,i);var a=f[e.type];return void 0!==e.data&&(a+=r?c.encode(String(e.data),{strict:!1}):String(e.data)),i(""+a)},t.encodeBase64Packet=function(e,n){var r,i="b"+t.packets[e.type];if(void 0!==m&&e.data instanceof m){var o=new FileReader;return o.onload=function(){var e=o.result.split(",")[1];n(i+e)},o.readAsDataURL(e.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(t){for(var a=new Uint8Array(e.data),s=new Array(a.length),c=0;c<a.length;c++)s[c]=a[c];r=String.fromCharCode.apply(null,s)}return i+=btoa(r),n(i)},t.decodePacket=function(e,n,r){if(void 0===e)return p;if("string"==typeof e){if("b"===e.charAt(0))return t.decodeBase64Packet(e.substr(1),n);if(r&&!1===(e=function(e){try{e=c.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return p;var i=e.charAt(0);return Number(i)==i&&d[i]?e.length>1?{type:d[i],data:e.substring(1)}:{type:d[i]}:p}i=new Uint8Array(e)[0];var o=a(e,1);return m&&"blob"===n&&(o=new m([o])),{type:d[i],data:o}},t.decodeBase64Packet=function(e,t){var n=d[e.charAt(0)];if(!r)return{type:n,data:{base64:!0,data:e.substr(1)}};var i=r.decode(e.substr(1));return"blob"===t&&m&&(i=new m([i])),{type:n,data:i}},t.encodePayload=function(e,n,r){"function"==typeof n&&(r=n,n=null);var i=o(e);return n&&i?m&&!h?t.encodePayloadAsBlob(e,r):t.encodePayloadAsArrayBuffer(e,r):e.length?void v(e,(function(e,r){t.encodePacket(e,!!i&&n,!1,(function(e){r(null,function(e){return e.length+":"+e}(e))}))}),(function(e,t){return r(t.join(""))})):r("0:")},t.decodePayload=function(e,n,r){if("string"!=typeof e)return t.decodePayloadAsBinary(e,n,r);var i;if("function"==typeof n&&(r=n,n=null),""===e)return r(p,0,1);for(var o,a,s="",c=0,u=e.length;c<u;c++){var l=e.charAt(c);if(":"===l){if(""===s||s!=(o=Number(s)))return r(p,0,1);if(s!=(a=e.substr(c+1,o)).length)return r(p,0,1);if(a.length){if(i=t.decodePacket(a,n,!1),p.type===i.type&&p.data===i.data)return r(p,0,1);if(!1===r(i,c+o,u))return}c+=o,s=""}else s+=l}return""!==s?r(p,0,1):void 0},t.encodePayloadAsArrayBuffer=function(e,n){if(!e.length)return n(new ArrayBuffer(0));v(e,(function(e,n){t.encodePacket(e,!0,!0,(function(e){return n(null,e)}))}),(function(e,t){var r=t.reduce((function(e,t){var n;return e+(n="string"==typeof t?t.length:t.byteLength).toString().length+n+2}),0),i=new Uint8Array(r),o=0;return t.forEach((function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),a=0;a<e.length;a++)r[a]=e.charCodeAt(a);n=r.buffer}i[o++]=t?0:1;var s=n.byteLength.toString();for(a=0;a<s.length;a++)i[o++]=parseInt(s[a]);for(i[o++]=255,r=new Uint8Array(n),a=0;a<r.length;a++)i[o++]=r[a]})),n(i.buffer)}))},t.encodePayloadAsBlob=function(e,n){v(e,(function(e,n){t.encodePacket(e,!0,!0,(function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var r=new Uint8Array(e.length),i=0;i<e.length;i++)r[i]=e.charCodeAt(i);e=r.buffer,t[0]=0}var o=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),a=new Uint8Array(o.length+1);for(i=0;i<o.length;i++)a[i]=parseInt(o[i]);if(a[o.length]=255,m){var s=new m([t.buffer,a.buffer,e]);n(null,s)}}))}),(function(e,t){return n(new m(t))}))},t.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var i=e,o=[];i.byteLength>0;){for(var s=new Uint8Array(i),c=0===s[0],u="",l=1;255!==s[l];l++){if(u.length>310)return r(p,0,1);u+=s[l]}i=a(i,2+u.length),u=parseInt(u);var h=a(i,0,u);if(c)try{h=String.fromCharCode.apply(null,new Uint8Array(h))}catch(e){var f=new Uint8Array(h);for(h="",l=0;l<f.length;l++)h+=String.fromCharCode(f[l])}o.push(h),i=a(i,u)}var d=o.length;o.forEach((function(e,i){r(t.decodePacket(e,n,!0),i,d)}))}},function(e,t,n){!function(){"use strict";var t="undefined"!=typeof window&&void 0!==window.document?window.document:{},n=e.exports,r=function(){for(var e,n=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],r=0,i=n.length,o={};r<i;r++)if((e=n[r])&&e[1]in t){for(r=0;r<e.length;r++)o[n[0][r]]=e[r];return o}return!1}(),i={change:r.fullscreenchange,error:r.fullscreenerror},o={request:function(e){return new Promise(function(n,i){var o=function(){this.off("change",o),n()}.bind(this);this.on("change",o);var a=(e=e||t.documentElement)[r.requestFullscreen]();a instanceof Promise&&a.then(o).catch(i)}.bind(this))},exit:function(){return new Promise(function(e,n){if(this.isFullscreen){var i=function(){this.off("change",i),e()}.bind(this);this.on("change",i);var o=t[r.exitFullscreen]();o instanceof Promise&&o.then(i).catch(n)}else e()}.bind(this))},toggle:function(e){return this.isFullscreen?this.exit():this.request(e)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(e,n){var r=i[e];r&&t.addEventListener(r,n,!1)},off:function(e,n){var r=i[e];r&&t.removeEventListener(r,n,!1)},raw:r};r?(Object.defineProperties(o,{isFullscreen:{get:function(){return Boolean(t[r.fullscreenElement])}},element:{enumerable:!0,get:function(){return t[r.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(t[r.fullscreenEnabled])}}}),n?e.exports=o:window.screenfull=o):n?e.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}}()},function(e,t,n){var r=n(25);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},function(e,t){t.f={}.propertyIsEnumerable},function(e,t,n){var r=n(25),i=n(5)("toStringTag"),o="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),i))?n:o?r(t):"Object"==(a=r(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t,n){var r=n(3),i=n(20),o=n(5)("species");e.exports=function(e,t){var n,a=r(e).constructor;return void 0===a||null==(n=r(a)[o])?t:i(n)}},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"===("undefined"==typeof window?"undefined":n(window))&&(r=window)}e.exports=r},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var c,u=[],l=!1,h=-1;function f(){l&&c&&(l=!1,c.length?u=c.concat(u):h=-1,u.length&&d())}function d(){if(!l){var e=s(f);l=!0;for(var t=u.length;t;){for(c=u,u=[];++h<t;)c&&c[h].run();h=-1,t=u.length}c=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new p(e,t)),1!==u.length||l||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){"use strict";(function(e){var n=function(){this._tweens={},this._tweensAddedDuringUpdate={}};n.prototype={getAll:function(){return Object.keys(this._tweens).map(function(e){return this._tweens[e]}.bind(this))},removeAll:function(){this._tweens={}},add:function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},remove:function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},update:function(e,t){var n=Object.keys(this._tweens);if(0===n.length)return!1;for(e=void 0!==e?e:r.now();n.length>0;){this._tweensAddedDuringUpdate={};for(var i=0;i<n.length;i++){var o=this._tweens[n[i]];o&&!1===o.update(e)&&(o._isPlaying=!1,t||delete this._tweens[n[i]])}n=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var r=new n;r.Group=n,r._nextId=0,r.nextId=function(){return r._nextId++},"undefined"==typeof self&&void 0!==e&&e.hrtime?r.now=function(){var t=e.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof self&&void 0!==self.performance&&void 0!==self.performance.now?r.now=self.performance.now.bind(self.performance):void 0!==Date.now?r.now=Date.now:r.now=function(){return(new Date).getTime()},r.Tween=function(e,t){this._isPaused=!1,this._pauseStart=null,this._object=e,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._repeatDelayTime=void 0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=r.Easing.Linear.None,this._interpolationFunction=r.Interpolation.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onRepeatCallback=null,this._onCompleteCallback=null,this._onStopCallback=null,this._group=t||r,this._id=r.nextId()},r.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},isPaused:function(){return this._isPaused},to:function(e,t){return this._valuesEnd=Object.create(e),void 0!==t&&(this._duration=t),this},duration:function(e){return this._duration=e,this},start:function(e){for(var t in this._group.add(this),this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._startTime=void 0!==e?"string"==typeof e?r.now()+parseFloat(e):e:r.now(),this._startTime+=this._delayTime,this._valuesEnd){if(this._valuesEnd[t]instanceof Array){if(0===this._valuesEnd[t].length)continue;this._valuesEnd[t]=[this._object[t]].concat(this._valuesEnd[t])}void 0!==this._object[t]&&(void 0===this._valuesStart[t]&&(this._valuesStart[t]=this._object[t]),this._valuesStart[t]instanceof Array==0&&(this._valuesStart[t]*=1),this._valuesStartRepeat[t]=this._valuesStart[t]||0)}return this},stop:function(){return this._isPlaying?(this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,null!==this._onStopCallback&&this._onStopCallback(this._object),this.stopChainedTweens(),this):this},end:function(){return this.update(1/0),this},pause:function(e){return this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=void 0===e?r.now():e,this._group.remove(this)),this},resume:function(e){return this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=(void 0===e?r.now():e)-this._pauseStart,this._pauseStart=0,this._group.add(this),this):this},stopChainedTweens:function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop()},group:function(e){return this._group=e,this},delay:function(e){return this._delayTime=e,this},repeat:function(e){return this._repeat=e,this},repeatDelay:function(e){return this._repeatDelayTime=e,this},yoyo:function(e){return this._yoyo=e,this},easing:function(e){return this._easingFunction=e,this},interpolation:function(e){return this._interpolationFunction=e,this},chain:function(){return this._chainedTweens=arguments,this},onStart:function(e){return this._onStartCallback=e,this},onUpdate:function(e){return this._onUpdateCallback=e,this},onRepeat:function(e){return this._onRepeatCallback=e,this},onComplete:function(e){return this._onCompleteCallback=e,this},onStop:function(e){return this._onStopCallback=e,this},update:function(e){var t,n,r;if(e<this._startTime)return!0;for(t in!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),n=(e-this._startTime)/this._duration,n=0===this._duration||n>1?1:n,r=this._easingFunction(n),this._valuesEnd)if(void 0!==this._valuesStart[t]){var i=this._valuesStart[t]||0,o=this._valuesEnd[t];o instanceof Array?this._object[t]=this._interpolationFunction(o,r):("string"==typeof o&&(o="+"===o.charAt(0)||"-"===o.charAt(0)?i+parseFloat(o):parseFloat(o)),"number"==typeof o&&(this._object[t]=i+(o-i)*r))}if(null!==this._onUpdateCallback&&this._onUpdateCallback(this._object,n),1===n){if(this._repeat>0){for(t in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat){if("string"==typeof this._valuesEnd[t]&&(this._valuesStartRepeat[t]=this._valuesStartRepeat[t]+parseFloat(this._valuesEnd[t])),this._yoyo){var a=this._valuesStartRepeat[t];this._valuesStartRepeat[t]=this._valuesEnd[t],this._valuesEnd[t]=a}this._valuesStart[t]=this._valuesStartRepeat[t]}return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=e+this._repeatDelayTime:this._startTime=e+this._delayTime,null!==this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var s=0,c=this._chainedTweens.length;s<c;s++)this._chainedTweens[s].start(this._startTime+this._duration);return!1}return!0}},r.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){return 0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)},Out:function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?-.5*Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)+1}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-r.Easing.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*r.Easing.Bounce.In(2*e):.5*r.Easing.Bounce.Out(2*e-1)+.5}}},r.Interpolation={Linear:function(e,t){var n=e.length-1,i=n*t,o=Math.floor(i),a=r.Interpolation.Utils.Linear;return t<0?a(e[0],e[1],i):t>1?a(e[n],e[n-1],n-i):a(e[o],e[o+1>n?n:o+1],i-o)},Bezier:function(e,t){for(var n=0,i=e.length-1,o=Math.pow,a=r.Interpolation.Utils.Bernstein,s=0;s<=i;s++)n+=o(1-t,i-s)*o(t,s)*e[s]*a(i,s);return n},CatmullRom:function(e,t){var n=e.length-1,i=n*t,o=Math.floor(i),a=r.Interpolation.Utils.CatmullRom;return e[0]===e[n]?(t<0&&(o=Math.floor(i=n*(1+t))),a(e[(o-1+n)%n],e[o],e[(o+1)%n],e[(o+2)%n],i-o)):t<0?e[0]-(a(e[0],e[0],e[1],e[1],-i)-e[0]):t>1?e[n]-(a(e[n],e[n],e[n-1],e[n-1],i-n)-e[n]):a(e[o?o-1:0],e[o],e[n<o+1?n:o+1],e[n<o+2?n:o+2],i-o)},Utils:{Linear:function(e,t,n){return(t-e)*n+e},Bernstein:function(e,t){var n=r.Interpolation.Utils.Factorial;return n(e)/n(t)/n(e-t)},Factorial:function(){var e=[1];return function(t){var n=1;if(e[t])return e[t];for(var r=t;r>1;r--)n*=r;return e[t]=n,n}}(),CatmullRom:function(e,t,n,r,i){var o=.5*(n-e),a=.5*(r-t),s=i*i;return(2*t-2*n+o+a)*(i*s)+(-3*t+3*n-2*o-a)*s+o*i+t}}},r.version="18.5.0",t.a=r}).call(this,n(55))},function(e,t,n){var r=n(7),i=n(1),o=i["__core-js_shared__"]||(i["__core-js_shared__"]={});(e.exports=function(e,t){return o[e]||(o[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n(33)?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},function(e,t,n){var r=n(17),i=n(6),o=n(35);e.exports=function(e){return function(t,n,a){var s,c=r(t),u=i(c.length),l=o(a,u);if(e&&n!=n){for(;u>l;)if((s=c[l++])!=s)return!0}else for(;u>l;l++)if((e||l in c)&&c[l]===n)return e||l||0;return!e&&-1}}},function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){var r=n(25);e.exports=Array.isArray||function(e){return"Array"==r(e)}},function(e,t,n){var r=n(5)("iterator"),i=!1;try{var o=[7][r]();o.return=function(){i=!0},Array.from(o,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!i)return!1;var n=!1;try{var o=[7],a=o[r]();a.next=function(){return{done:n=!0}},o[r]=function(){return a},e(o)}catch(e){}return n}},function(e,t,n){"use strict";var r=n(3);e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=n(52),o=RegExp.prototype.exec;e.exports=function(e,t){var n=e.exec;if("function"==typeof n){var a=n.call(e,t);if("object"!==r(a))throw new TypeError("RegExp exec method returned something other than an Object or null");return a}if("RegExp"!==i(e))throw new TypeError("RegExp#exec called on incompatible receiver");return o.call(e,t)}},function(e,t,n){"use strict";n(125);var r=n(12),i=n(16),o=n(2),a=n(26),s=n(5),c=n(94),u=s("species"),l=!o((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),h=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();e.exports=function(e,t,n){var f=s(e),d=!o((function(){var t={};return t[f]=function(){return 7},7!=""[e](t)})),p=d?!o((function(){var t=!1,n=/a/;return n.exec=function(){return t=!0,null},"split"===e&&(n.constructor={},n.constructor[u]=function(){return n}),n[f](""),!t})):void 0;if(!d||!p||"replace"===e&&!l||"split"===e&&!h){var m=/./[f],v=n(a,f,""[e],(function(e,t,n,r,i){return t.exec===c?d&&!i?{done:!0,value:m.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}})),g=v[0],y=v[1];r(String.prototype,e,g),i(RegExp.prototype,f,2==t?function(e,t){return y.call(e,this,t)}:function(e){return y.call(e,this)})}}},function(e,t,n){var r=n(19),i=n(120),o=n(89),a=n(3),s=n(6),c=n(91),u={},l={};(t=e.exports=function(e,t,n,h,f){var d,p,m,v,g=f?function(){return e}:c(e),y=r(n,h,t?2:1),b=0;if("function"!=typeof g)throw TypeError(e+" is not iterable!");if(o(g)){for(d=s(e.length);d>b;b++)if((v=t?y(a(p=e[b])[0],p[1]):y(e[b]))===u||v===l)return v}else for(m=g.call(e);!(p=m.next()).done;)if((v=i(m,y,p.value,t))===u||v===l)return v}).BREAK=u,t.RETURN=l},function(e,t,n){var r=n(1).navigator;e.exports=r&&r.userAgent||""},function(e,t,n){"use strict";var r=n(1),i=n(0),o=n(12),a=n(46),s=n(29),c=n(65),u=n(45),l=n(4),h=n(2),f=n(61),d=n(41),p=n(80);e.exports=function(e,t,n,m,v,g){var y=r[e],b=y,_=v?"set":"add",w=b&&b.prototype,x={},S=function(e){var t=w[e];o(w,e,"delete"==e||"has"==e?function(e){return!(g&&!l(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return g&&!l(e)?void 0:t.call(this,0===e?0:e)}:"add"==e?function(e){return t.call(this,0===e?0:e),this}:function(e,n){return t.call(this,0===e?0:e,n),this})};if("function"==typeof b&&(g||w.forEach&&!h((function(){(new b).entries().next()})))){var E=new b,M=E[_](g?{}:-0,1)!=E,C=h((function(){E.has(1)})),T=f((function(e){new b(e)})),A=!g&&h((function(){for(var e=new b,t=5;t--;)e[_](t,t);return!e.has(-0)}));T||((b=t((function(t,n){u(t,b,e);var r=p(new y,t,b);return null!=n&&c(n,v,r[_],r),r}))).prototype=w,w.constructor=b),(C||A)&&(S("delete"),S("has"),v&&S("get")),(A||M)&&S(_),g&&w.clear&&delete w.clear}else b=m.getConstructor(t,e,v,_),a(b.prototype,n),s.NEED=!0;return d(b,e),x[e]=b,i(i.G+i.W+i.F*(b!=y),x),g||m.setStrong(b,e,v),b}},function(e,t,n){for(var r,i=n(1),o=n(16),a=n(32),s=a("typed_array"),c=a("view"),u=!(!i.ArrayBuffer||!i.DataView),l=u,h=0,f="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");h<9;)(r=i[f[h++]])?(o(r.prototype,s,!0),o(r.prototype,c,!0)):l=!1;e.exports={ABV:u,CONSTR:l,TYPED:s,VIEW:c}},function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),r=0,i=n.length;r<i;r++){var o=n[r].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}},function(e,t){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t,n){e.exports=n(395)},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i,o="object"===("undefined"==typeof Reflect?"undefined":r(Reflect))?Reflect:null,a=o&&"function"==typeof o.apply?o.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};i=o&&"function"==typeof o.ownKeys?o.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function c(){c.init.call(this)}e.exports=c,c.EventEmitter=c,c.prototype._events=void 0,c.prototype._eventsCount=0,c.prototype._maxListeners=void 0;var u=10;function l(e){return void 0===e._maxListeners?c.defaultMaxListeners:e._maxListeners}function h(e,t,n,i){var o,a,s;if("function"!=typeof n)throw new TypeError('The "listener" argument must be of type Function. Received type '+r(n));if(void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),s=a[t]),void 0===s)s=a[t]=n,++e._eventsCount;else if("function"==typeof s?s=a[t]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),(o=l(e))>0&&s.length>o&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=s.length,function(e){console&&console.warn&&console.warn(e)}(c)}return e}function f(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=function(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);this.fired||(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,a(this.listener,this.target,e))}.bind(r);return i.listener=n,r.wrapFn=i,i}function d(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):m(i,i.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}Object.defineProperty(c,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");u=e}}),c.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},c.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},c.prototype.getMaxListeners=function(){return l(this)},c.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,i=this._events;if(void 0!==i)r=r&&void 0===i.error;else if(!r)return!1;if(r){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var c=i[e];if(void 0===c)return!1;if("function"==typeof c)a(c,this,t);else{var u=c.length,l=m(c,u);for(n=0;n<u;++n)a(l[n],this,t)}return!0},c.prototype.addListener=function(e,t){return h(this,e,t,!1)},c.prototype.on=c.prototype.addListener,c.prototype.prependListener=function(e,t){return h(this,e,t,!0)},c.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+r(t));return this.on(e,f(this,e,t)),this},c.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+r(t));return this.prependListener(e,f(this,e,t)),this},c.prototype.removeListener=function(e,t){var n,i,o,a,s;if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+r(t));if(void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(o=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){s=n[a].listener,o=a;break}if(o<0)return this;0===o?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,o),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,s||t)}return this},c.prototype.off=c.prototype.removeListener,c.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},c.prototype.listeners=function(e){return d(this,e,!0)},c.prototype.rawListeners=function(e){return d(this,e,!1)},c.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},c.prototype.listenerCount=p,c.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},function(e,t,n){var r=n(4),i=n(1).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,n){t.f=n(5)},function(e,t,n){var r=n(57)("keys"),i=n(32);e.exports=function(e){return r[e]||(r[e]=i(e))}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,n){var r=n(1).document;e.exports=r&&r.documentElement},function(e,t,n){var r=n(4),i=n(3),o=function(e,t){if(i(e),!r(t)&&null!==t)throw TypeError(t+": can't set as prototype!")};e.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(e,t,r){try{(r=n(19)(Function.call,n(22).f(Object.prototype,"__proto__").set,2))(e,[]),t=!(e instanceof Array)}catch(e){t=!0}return function(e,n){return o(e,n),t?e.__proto__=n:r(e,n),e}}({},!1):void 0),check:o}},function(e,t){e.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(e,t,n){var r=n(4),i=n(78).set;e.exports=function(e,t,n){var o,a=t.constructor;return a!==n&&"function"==typeof a&&(o=a.prototype)!==n.prototype&&r(o)&&i&&i(e,o),e}},function(e,t,n){"use strict";var r=n(21),i=n(26);e.exports=function(e){var t=String(i(this)),n="",o=r(e);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(t+=t))1&o&&(n+=t);return n}},function(e,t){e.exports=Math.sign||function(e){return 0==(e=+e)||e!=e?e:e<0?-1:1}},function(e,t){var n=Math.expm1;e.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:Math.exp(e)-1}:n},function(e,t,n){var r=n(21),i=n(26);e.exports=function(e){return function(t,n){var o,a,s=String(i(t)),c=r(n),u=s.length;return c<0||c>=u?e?"":void 0:(o=s.charCodeAt(c))<55296||o>56319||c+1===u||(a=s.charCodeAt(c+1))<56320||a>57343?e?s.charAt(c):o:e?s.slice(c,c+2):a-56320+(o-55296<<10)+65536}}},function(e,t,n){"use strict";var r=n(33),i=n(0),o=n(12),a=n(16),s=n(43),c=n(119),u=n(41),l=n(38),h=n(5)("iterator"),f=!([].keys&&"next"in[].keys()),d=function(){return this};e.exports=function(e,t,n,p,m,v,g){c(n,t,p);var y,b,_,w=function(e){if(!f&&e in M)return M[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},x=t+" Iterator",S="values"==m,E=!1,M=e.prototype,C=M[h]||M["@@iterator"]||m&&M[m],T=C||w(m),A=m?S?w("entries"):T:void 0,P="Array"==t&&M.entries||C;if(P&&(_=l(P.call(new e)))!==Object.prototype&&_.next&&(u(_,x,!0),r||"function"==typeof _[h]||a(_,h,d)),S&&C&&"values"!==C.name&&(E=!0,T=function(){return C.call(this)}),r&&!g||!f&&!E&&M[h]||a(M,h,T),s[t]=T,s[x]=d,m)if(y={values:S?T:w("values"),keys:v?T:w("keys"),entries:A},g)for(b in y)b in M||o(M,b,y[b]);else i(i.P+i.F*(f||E),t,y);return y}},function(e,t,n){var r=n(87),i=n(26);e.exports=function(e,t,n){if(r(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(i(e))}},function(e,t,n){var r=n(4),i=n(25),o=n(5)("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[o])?!!t:"RegExp"==i(e))}},function(e,t,n){var r=n(5)("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,!"/./"[e](t)}catch(e){}}return!0}},function(e,t,n){var r=n(43),i=n(5)("iterator"),o=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||o[i]===e)}},function(e,t,n){"use strict";var r=n(9),i=n(31);e.exports=function(e,t,n){t in e?r.f(e,t,i(0,n)):e[t]=n}},function(e,t,n){var r=n(52),i=n(5)("iterator"),o=n(43);e.exports=n(7).getIteratorMethod=function(e){if(null!=e)return e[i]||e["@@iterator"]||o[r(e)]}},function(e,t,n){"use strict";var r=n(10),i=n(35),o=n(6);e.exports=function(e){for(var t=r(this),n=o(t.length),a=arguments.length,s=i(a>1?arguments[1]:void 0,n),c=a>2?arguments[2]:void 0,u=void 0===c?n:i(c,n);u>s;)t[s++]=e;return t}},function(e,t,n){"use strict";var r=n(39),i=n(124),o=n(43),a=n(17);e.exports=n(85)(Array,"Array",(function(e,t){this._t=a(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,i(1)):i(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(e,t,n){"use strict";var r=n(62),i=RegExp.prototype.exec,o=String.prototype.replace,a=i,s=function(){var e=/a/,t=/b*/g;return i.call(e,"a"),i.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),c=void 0!==/()??/.exec("")[1];(s||c)&&(a=function(e){var t,n,a,u,l=this;return c&&(n=new RegExp("^"+l.source+"$(?!\\s)",r.call(l))),s&&(t=l.lastIndex),a=i.call(l,e),s&&a&&(l.lastIndex=l.global?a.index+a[0].length:t),c&&a&&a.length>1&&o.call(a[0],n,(function(){for(u=1;u<arguments.length-2;u++)void 0===arguments[u]&&(a[u]=void 0)})),a}),e.exports=a},function(e,t,n){"use strict";var r=n(84)(!0);e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},function(e,t,n){var r,i,o,a=n(19),s=n(113),c=n(77),u=n(73),l=n(1),h=l.process,f=l.setImmediate,d=l.clearImmediate,p=l.MessageChannel,m=l.Dispatch,v=0,g={},y=function(){var e=+this;if(g.hasOwnProperty(e)){var t=g[e];delete g[e],t()}},b=function(e){y.call(e.data)};f&&d||(f=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return g[++v]=function(){s("function"==typeof e?e:Function(e),t)},r(v),v},d=function(e){delete g[e]},"process"==n(25)(h)?r=function(e){h.nextTick(a(y,e,1))}:m&&m.now?r=function(e){m.now(a(y,e,1))}:p?(o=(i=new p).port2,i.port1.onmessage=b,r=a(o.postMessage,o,1)):l.addEventListener&&"function"==typeof postMessage&&!l.importScripts?(r=function(e){l.postMessage(e+"","*")},l.addEventListener("message",b,!1)):r="onreadystatechange"in u("script")?function(e){c.appendChild(u("script")).onreadystatechange=function(){c.removeChild(this),y.call(e)}}:function(e){setTimeout(a(y,e,1),0)}),e.exports={set:f,clear:d}},function(e,t,n){"use strict";var r=n(1),i=n(8),o=n(33),a=n(68),s=n(16),c=n(46),u=n(2),l=n(45),h=n(21),f=n(6),d=n(132),p=n(37).f,m=n(9).f,v=n(92),g=n(41),y="prototype",b="Wrong index!",_=r.ArrayBuffer,w=r.DataView,x=r.Math,S=r.RangeError,E=r.Infinity,M=_,C=x.abs,T=x.pow,A=x.floor,P=x.log,L=x.LN2,R=i?"_b":"buffer",k=i?"_l":"byteLength",N=i?"_o":"byteOffset";function O(e,t,n){var r,i,o,a=new Array(n),s=8*n-t-1,c=(1<<s)-1,u=c>>1,l=23===t?T(2,-24)-T(2,-77):0,h=0,f=e<0||0===e&&1/e<0?1:0;for((e=C(e))!=e||e===E?(i=e!=e?1:0,r=c):(r=A(P(e)/L),e*(o=T(2,-r))<1&&(r--,o*=2),(e+=r+u>=1?l/o:l*T(2,1-u))*o>=2&&(r++,o/=2),r+u>=c?(i=0,r=c):r+u>=1?(i=(e*o-1)*T(2,t),r+=u):(i=e*T(2,u-1)*T(2,t),r=0));t>=8;a[h++]=255&i,i/=256,t-=8);for(r=r<<t|i,s+=t;s>0;a[h++]=255&r,r/=256,s-=8);return a[--h]|=128*f,a}function D(e,t,n){var r,i=8*n-t-1,o=(1<<i)-1,a=o>>1,s=i-7,c=n-1,u=e[c--],l=127&u;for(u>>=7;s>0;l=256*l+e[c],c--,s-=8);for(r=l&(1<<-s)-1,l>>=-s,s+=t;s>0;r=256*r+e[c],c--,s-=8);if(0===l)l=1-a;else{if(l===o)return r?NaN:u?-E:E;r+=T(2,t),l-=a}return(u?-1:1)*r*T(2,l-t)}function F(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]}function I(e){return[255&e]}function U(e){return[255&e,e>>8&255]}function B(e){return[255&e,e>>8&255,e>>16&255,e>>24&255]}function j(e){return O(e,52,8)}function z(e){return O(e,23,4)}function V(e,t,n){m(e[y],t,{get:function(){return this[n]}})}function G(e,t,n,r){var i=d(+n);if(i+t>e[k])throw S(b);var o=e[R]._b,a=i+e[N],s=o.slice(a,a+t);return r?s:s.reverse()}function W(e,t,n,r,i,o){var a=d(+n);if(a+t>e[k])throw S(b);for(var s=e[R]._b,c=a+e[N],u=r(+i),l=0;l<t;l++)s[c+l]=u[o?l:t-l-1]}if(a.ABV){if(!u((function(){_(1)}))||!u((function(){new _(-1)}))||u((function(){return new _,new _(1.5),new _(NaN),"ArrayBuffer"!=_.name}))){for(var H,q=(_=function(e){return l(this,_),new M(d(e))})[y]=M[y],X=p(M),Y=0;X.length>Y;)(H=X[Y++])in _||s(_,H,M[H]);o||(q.constructor=_)}var Z=new w(new _(2)),J=w[y].setInt8;Z.setInt8(0,2147483648),Z.setInt8(1,2147483649),!Z.getInt8(0)&&Z.getInt8(1)||c(w[y],{setInt8:function(e,t){J.call(this,e,t<<24>>24)},setUint8:function(e,t){J.call(this,e,t<<24>>24)}},!0)}else _=function(e){l(this,_,"ArrayBuffer");var t=d(e);this._b=v.call(new Array(t),0),this[k]=t},w=function(e,t,n){l(this,w,"DataView"),l(e,_,"DataView");var r=e[k],i=h(t);if(i<0||i>r)throw S("Wrong offset!");if(i+(n=void 0===n?r-i:f(n))>r)throw S("Wrong length!");this[R]=e,this[N]=i,this[k]=n},i&&(V(_,"byteLength","_l"),V(w,"buffer","_b"),V(w,"byteLength","_l"),V(w,"byteOffset","_o")),c(w[y],{getInt8:function(e){return G(this,1,e)[0]<<24>>24},getUint8:function(e){return G(this,1,e)[0]},getInt16:function(e){var t=G(this,2,e,arguments[1]);return(t[1]<<8|t[0])<<16>>16},getUint16:function(e){var t=G(this,2,e,arguments[1]);return t[1]<<8|t[0]},getInt32:function(e){return F(G(this,4,e,arguments[1]))},getUint32:function(e){return F(G(this,4,e,arguments[1]))>>>0},getFloat32:function(e){return D(G(this,4,e,arguments[1]),23,4)},getFloat64:function(e){return D(G(this,8,e,arguments[1]),52,8)},setInt8:function(e,t){W(this,1,e,I,t)},setUint8:function(e,t){W(this,1,e,I,t)},setInt16:function(e,t){W(this,2,e,U,t,arguments[2])},setUint16:function(e,t){W(this,2,e,U,t,arguments[2])},setInt32:function(e,t){W(this,4,e,B,t,arguments[2])},setUint32:function(e,t){W(this,4,e,B,t,arguments[2])},setFloat32:function(e,t){W(this,4,e,z,t,arguments[2])},setFloat64:function(e,t){W(this,8,e,j,t,arguments[2])}});g(_,"ArrayBuffer"),g(w,"DataView"),s(w[y],a.VIEW,!0),t.ArrayBuffer=_,t.DataView=w},function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=function(e){return"object"===n(e)?null!==e:"function"==typeof e}},function(e,t,n){e.exports=!n(138)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(372)("socket.io-parser"),i=n(47),o=n(375),a=n(140),s=n(141);function c(){}t.protocol=4,t.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],t.CONNECT=0,t.DISCONNECT=1,t.EVENT=2,t.ACK=3,t.ERROR=4,t.BINARY_EVENT=5,t.BINARY_ACK=6,t.Encoder=c,t.Decoder=h;var u=t.ERROR+'"encode error"';function l(e){var n=""+e.type;if(t.BINARY_EVENT!==e.type&&t.BINARY_ACK!==e.type||(n+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(n+=e.nsp+","),null!=e.id&&(n+=e.id),null!=e.data){var i=function(e){try{return JSON.stringify(e)}catch(e){return!1}}(e.data);if(!1===i)return u;n+=i}return r("encoded %j as %s",e,n),n}function h(){this.reconstructor=null}function f(e){this.reconPack=e,this.buffers=[]}function d(e){return{type:t.ERROR,data:"parser error: "+e}}c.prototype.encode=function(e,n){r("encoding packet %j",e),t.BINARY_EVENT===e.type||t.BINARY_ACK===e.type?function(e,t){o.removeBlobs(e,(function(e){var n=o.deconstructPacket(e),r=l(n.packet),i=n.buffers;i.unshift(r),t(i)}))}(e,n):n([l(e)])},i(h.prototype),h.prototype.add=function(e){var n;if("string"==typeof e)n=function(e){var n=0,i={type:Number(e.charAt(0))};if(null==t.types[i.type])return d("unknown packet type "+i.type);if(t.BINARY_EVENT===i.type||t.BINARY_ACK===i.type){for(var o="";"-"!==e.charAt(++n)&&(o+=e.charAt(n),n!=e.length););if(o!=Number(o)||"-"!==e.charAt(n))throw new Error("Illegal attachments");i.attachments=Number(o)}if("/"===e.charAt(n+1))for(i.nsp="";++n&&","!==(s=e.charAt(n))&&(i.nsp+=s,n!==e.length););else i.nsp="/";var c=e.charAt(n+1);if(""!==c&&Number(c)==c){for(i.id="";++n;){var s;if(null==(s=e.charAt(n))||Number(s)!=s){--n;break}if(i.id+=e.charAt(n),n===e.length)break}i.id=Number(i.id)}if(e.charAt(++n)){var u=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(n));if(!1===u||i.type!==t.ERROR&&!a(u))return d("invalid payload");i.data=u}return r("decoded %s as %j",e,i),i}(e),t.BINARY_EVENT===n.type||t.BINARY_ACK===n.type?(this.reconstructor=new f(n),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",n)):this.emit("decoded",n);else{if(!s(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(n=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",n))}},h.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},f.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){var t=o.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},f.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(e,t,n){"use strict";(function(e){var r=n(376),i=n(377),o=n(378);function a(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return h(this,e)}return u(this,e,t,n)}function u(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r),c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=f(e,t),e}(e,t,n,r):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n),i=(e=s(e,r)).write(t,n);return i!==r&&(e=e.slice(0,i)),e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|d(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||function(e){return e!=e}(t.length)?s(e,0):f(e,t);if("Buffer"===t.type&&o(t.data))return f(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t){if(l(t),e=s(e,t<0?0:0|d(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function f(e,t){var n=t.length<0?0:0|d(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function d(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function p(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return j(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return z(e).length;default:if(r)return j(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:g(e,t,n,r,i);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):g(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function g(e,t,n,r,i){var o,a=1,s=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,c/=2,n/=2}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var l=-1;for(o=n;o<s;o++)if(u(e,o)===u(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===c)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(n+c>s&&(n=s-c),o=n;o>=0;o--){for(var h=!0,f=0;f<c;f++)if(u(e,o+f)!==u(t,f)){h=!1;break}if(h)return o}return-1}function y(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function b(e,t,n,r){return V(j(t,e.length-n),e,n,r)}function _(e,t,n,r){return V(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function w(e,t,n,r){return _(e,t,n,r)}function x(e,t,n,r){return V(z(t),e,n,r)}function S(e,t,n,r){return V(function(e,t){for(var n,r,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)r=(n=e.charCodeAt(a))>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function E(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function M(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,a,s,c,u=e[i],l=null,h=u>239?4:u>223?3:u>191?2:1;if(i+h<=n)switch(h){case 1:u<128&&(l=u);break;case 2:128==(192&(o=e[i+1]))&&(c=(31&u)<<6|63&o)>127&&(l=c);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(c=(15&u)<<12|(63&o)<<6|63&a)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(c=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&c<1114112&&(l=c)}null===l?(l=65533,h=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=h}return function(e){var t=e.length;if(t<=C)return String.fromCharCode.apply(String,e);for(var n="",r=0;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=C));return n}(r)}t.Buffer=c,t.SlowBuffer=function(e){return+e!=e&&(e=0),c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=a(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return u(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,r){return l(t),t<=0?s(e,t):void 0!==n?"string"==typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return h(null,e)},c.allocUnsafeSlow=function(e){return h(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=c.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var a=e[n];if(!c.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},c.byteLength=p,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?M(this,0,e):function(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return P(this,t,n);case"utf8":case"utf-8":return M(this,t,n);case"ascii":return T(this,t,n);case"latin1":case"binary":return A(this,t,n);case"base64":return E(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,r,i){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(o,a),u=this.slice(r,i),l=e.slice(t,n),h=0;h<s;++h)if(u[h]!==l[h]){o=u[h],a=l[h];break}return o<a?-1:a<o?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return y(this,e,t,n);case"utf8":case"utf-8":return b(this,e,t,n);case"ascii":return _(this,e,t,n);case"latin1":case"binary":return w(this,e,t,n);case"base64":return x(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var C=4096;function T(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function A(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function P(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=B(e[o]);return i}function L(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function R(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function k(e,t,n,r,i,o){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function N(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function O(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function D(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function F(e,t,n,r,o){return o||D(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function I(e,t,n,r,o){return o||D(e,0,n,8),i.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var i=t-e;n=new c(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},c.prototype.readUInt8=function(e,t){return t||R(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||R(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||R(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||R(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||R(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},c.prototype.readInt8=function(e,t){return t||R(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||R(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||R(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||R(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||R(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||R(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||R(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,r){e=+e,t|=0,n|=0,r||k(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,r){e=+e,t|=0,n|=0,r||k(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):N(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):N(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):O(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):O(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);k(this,e,t,n,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);k(this,e,t,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):N(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):N(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):O(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||k(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):O(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return F(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return F(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return I(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return I(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!c.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},c.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var a=c.isBuffer(e)?e:j(new c(e,r).toString()),s=a.length;for(o=0;o<n-t;++o)this[o+t]=a[o%s]}return this};var U=/[^+\/0-9A-Za-z-_]/g;function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function j(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function z(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(U,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function V(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(54))},function(e,t,n){var r=n(381);e.exports=function(e){var t=e.xdomain,n=e.xscheme,i=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||r))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&i)return new XDomainRequest}catch(e){}if(!t)try{return new(self[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}},function(e,t,n){var r=n(48),i=n(47);function o(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}e.exports=o,i(o.prototype),o.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},o.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},o.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},o.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},o.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},o.prototype.onData=function(e){var t=r.decodePacket(e,this.socket.binaryType);this.onPacket(t)},o.prototype.onPacket=function(e){this.emit("packet",e)},o.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,t,n){e.exports=!n(8)&&!n(2)((function(){return 7!=Object.defineProperty(n(73)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(1),i=n(7),o=n(33),a=n(74),s=n(9).f;e.exports=function(e){var t=i.Symbol||(i.Symbol=o?{}:r.Symbol||{});"_"==e.charAt(0)||e in t||s(t,e,{value:a.f(e)})}},function(e,t,n){var r=n(15),i=n(17),o=n(58)(!1),a=n(75)("IE_PROTO");e.exports=function(e,t){var n,s=i(e),c=0,u=[];for(n in s)n!=a&&r(s,n)&&u.push(n);for(;t.length>c;)r(s,n=t[c++])&&(~o(u,n)||u.push(n));return u}},function(e,t,n){var r=n(9),i=n(3),o=n(34);e.exports=n(8)?Object.defineProperties:function(e,t){i(e);for(var n,a=o(t),s=a.length,c=0;s>c;)r.f(e,n=a[c++],t[n]);return e}},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=n(17),o=n(37).f,a={}.toString,s="object"==("undefined"==typeof window?"undefined":r(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];e.exports.f=function(e){return s&&"[object Window]"==a.call(e)?function(e){try{return o(e)}catch(e){return s.slice()}}(e):o(i(e))}},function(e,t,n){"use strict";var r=n(8),i=n(34),o=n(59),a=n(51),s=n(10),c=n(50),u=Object.assign;e.exports=!u||n(2)((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=u({},e)[n]||Object.keys(u({},t)).join("")!=r}))?function(e,t){for(var n=s(e),u=arguments.length,l=1,h=o.f,f=a.f;u>l;)for(var d,p=c(arguments[l++]),m=h?i(p).concat(h(p)):i(p),v=m.length,g=0;v>g;)d=m[g++],r&&!f.call(p,d)||(n[d]=p[d]);return n}:u},function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},function(e,t,n){"use strict";var r=n(20),i=n(4),o=n(113),a=[].slice,s={};e.exports=Function.bind||function(e){var t=r(this),n=a.call(arguments,1),c=function r(){var i=n.concat(a.call(arguments));return this instanceof r?function(e,t,n){if(!(t in s)){for(var r=[],i=0;i<t;i++)r[i]="a["+i+"]";s[t]=Function("F,a","return new F("+r.join(",")+")")}return s[t](e,n)}(t,i.length,i):o(t,i,e)};return i(t.prototype)&&(c.prototype=t.prototype),c}},function(e,t){e.exports=function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},function(e,t,n){var r=n(1).parseInt,i=n(42).trim,o=n(79),a=/^[-+]?0[xX]/;e.exports=8!==r(o+"08")||22!==r(o+"0x16")?function(e,t){var n=i(String(e),3);return r(n,t>>>0||(a.test(n)?16:10))}:r},function(e,t,n){var r=n(1).parseFloat,i=n(42).trim;e.exports=1/r(n(79)+"-0")!=-1/0?function(e){var t=i(String(e),3),n=r(t);return 0===n&&"-"==t.charAt(0)?-0:n}:r},function(e,t,n){var r=n(25);e.exports=function(e,t){if("number"!=typeof e&&"Number"!=r(e))throw TypeError(t);return+e}},function(e,t,n){var r=n(4),i=Math.floor;e.exports=function(e){return!r(e)&&isFinite(e)&&i(e)===e}},function(e,t){e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:Math.log(1+e)}},function(e,t,n){"use strict";var r=n(36),i=n(31),o=n(41),a={};n(16)(a,n(5)("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(a,{next:i(1,n)}),o(e,t+" Iterator")}},function(e,t,n){var r=n(3);e.exports=function(e,t,n,i){try{return i?t(r(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&r(o.call(e)),t}}},function(e,t,n){var r=n(272);e.exports=function(e,t){return new(r(e))(t)}},function(e,t,n){var r=n(20),i=n(10),o=n(50),a=n(6);e.exports=function(e,t,n,s,c){r(t);var u=i(e),l=o(u),h=a(u.length),f=c?h-1:0,d=c?-1:1;if(n<2)for(;;){if(f in l){s=l[f],f+=d;break}if(f+=d,c?f<0:h<=f)throw TypeError("Reduce of empty array with no initial value")}for(;c?f>=0:h>f;f+=d)f in l&&(s=t(s,l[f],f,u));return s}},function(e,t,n){"use strict";var r=n(10),i=n(35),o=n(6);e.exports=[].copyWithin||function(e,t){var n=r(this),a=o(n.length),s=i(e,a),c=i(t,a),u=arguments.length>2?arguments[2]:void 0,l=Math.min((void 0===u?a:i(u,a))-c,a-s),h=1;for(c<s&&s<c+l&&(h=-1,c+=l-1,s+=l-1);l-- >0;)c in n?n[s]=n[c]:delete n[s],s+=h,c+=h;return n}},function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},function(e,t,n){"use strict";var r=n(94);n(0)({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},function(e,t,n){n(8)&&"g"!=/./g.flags&&n(9).f(RegExp.prototype,"flags",{configurable:!0,get:n(62)})},function(e,t,n){"use strict";var r,i,o,a,s=n(33),c=n(1),u=n(19),l=n(52),h=n(0),f=n(4),d=n(20),p=n(45),m=n(65),v=n(53),g=n(96).set,y=n(292)(),b=n(128),_=n(293),w=n(66),x=n(129),S=c.TypeError,E=c.process,M=E&&E.versions,C=M&&M.v8||"",T=c.Promise,A="process"==l(E),P=function(){},L=i=b.f,R=!!function(){try{var e=T.resolve(1),t=(e.constructor={})[n(5)("species")]=function(e){e(P,P)};return(A||"function"==typeof PromiseRejectionEvent)&&e.then(P)instanceof t&&0!==C.indexOf("6.6")&&-1===w.indexOf("Chrome/66")}catch(e){}}(),k=function(e){var t;return!(!f(e)||"function"!=typeof(t=e.then))&&t},N=function(e,t){if(!e._n){e._n=!0;var n=e._c;y((function(){for(var r=e._v,i=1==e._s,o=0,a=function(t){var n,o,a,s=i?t.ok:t.fail,c=t.resolve,u=t.reject,l=t.domain;try{s?(i||(2==e._h&&F(e),e._h=1),!0===s?n=r:(l&&l.enter(),n=s(r),l&&(l.exit(),a=!0)),n===t.promise?u(S("Promise-chain cycle")):(o=k(n))?o.call(n,c,u):c(n)):u(r)}catch(e){l&&!a&&l.exit(),u(e)}};n.length>o;)a(n[o++]);e._c=[],e._n=!1,t&&!e._h&&O(e)}))}},O=function(e){g.call(c,(function(){var t,n,r,i=e._v,o=D(e);if(o&&(t=_((function(){A?E.emit("unhandledRejection",i,e):(n=c.onunhandledrejection)?n({promise:e,reason:i}):(r=c.console)&&r.error&&r.error("Unhandled promise rejection",i)})),e._h=A||D(e)?2:1),e._a=void 0,o&&t.e)throw t.v}))},D=function(e){return 1!==e._h&&0===(e._a||e._c).length},F=function(e){g.call(c,(function(){var t;A?E.emit("rejectionHandled",e):(t=c.onrejectionhandled)&&t({promise:e,reason:e._v})}))},I=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),N(t,!0))},U=function e(t){var n,r=this;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw S("Promise can't be resolved itself");(n=k(t))?y((function(){var i={_w:r,_d:!1};try{n.call(t,u(e,i,1),u(I,i,1))}catch(e){I.call(i,e)}})):(r._v=t,r._s=1,N(r,!1))}catch(e){I.call({_w:r,_d:!1},e)}}};R||(T=function(e){p(this,T,"Promise","_h"),d(e),r.call(this);try{e(u(U,this,1),u(I,this,1))}catch(e){I.call(this,e)}},(r=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=n(46)(T.prototype,{then:function(e,t){var n=L(v(this,T));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=A?E.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&N(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),o=function(){var e=new r;this.promise=e,this.resolve=u(U,e,1),this.reject=u(I,e,1)},b.f=L=function(e){return e===T||e===a?new o(e):i(e)}),h(h.G+h.W+h.F*!R,{Promise:T}),n(41)(T,"Promise"),n(44)("Promise"),a=n(7).Promise,h(h.S+h.F*!R,"Promise",{reject:function(e){var t=L(this);return(0,t.reject)(e),t.promise}}),h(h.S+h.F*(s||!R),"Promise",{resolve:function(e){return x(s&&this===a?T:this,e)}}),h(h.S+h.F*!(R&&n(61)((function(e){T.all(e).catch(P)}))),"Promise",{all:function(e){var t=this,n=L(t),r=n.resolve,i=n.reject,o=_((function(){var n=[],o=0,a=1;m(e,!1,(function(e){var s=o++,c=!1;n.push(void 0),a++,t.resolve(e).then((function(e){c||(c=!0,n[s]=e,--a||r(n))}),i)})),--a||r(n)}));return o.e&&i(o.v),n.promise},race:function(e){var t=this,n=L(t),r=n.reject,i=_((function(){m(e,!1,(function(e){t.resolve(e).then(n.resolve,r)}))}));return i.e&&r(i.v),n.promise}})},function(e,t,n){"use strict";var r=n(20);e.exports.f=function(e){return new function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=r(t),this.reject=r(n)}(e)}},function(e,t,n){var r=n(3),i=n(4),o=n(128);e.exports=function(e,t){if(r(e),i(t)&&t.constructor===e)return t;var n=o.f(e);return(0,n.resolve)(t),n.promise}},function(e,t,n){"use strict";var r=n(9).f,i=n(36),o=n(46),a=n(19),s=n(45),c=n(65),u=n(85),l=n(124),h=n(44),f=n(8),d=n(29).fastKey,p=n(40),m=f?"_s":"size",v=function(e,t){var n,r=d(t);if("F"!==r)return e._i[r];for(n=e._f;n;n=n.n)if(n.k==t)return n};e.exports={getConstructor:function(e,t,n,u){var l=e((function(e,r){s(e,l,t,"_i"),e._t=t,e._i=i(null),e._f=void 0,e._l=void 0,e[m]=0,null!=r&&c(r,n,e[u],e)}));return o(l.prototype,{clear:function(){for(var e=p(this,t),n=e._i,r=e._f;r;r=r.n)r.r=!0,r.p&&(r.p=r.p.n=void 0),delete n[r.i];e._f=e._l=void 0,e[m]=0},delete:function(e){var n=p(this,t),r=v(n,e);if(r){var i=r.n,o=r.p;delete n._i[r.i],r.r=!0,o&&(o.n=i),i&&(i.p=o),n._f==r&&(n._f=i),n._l==r&&(n._l=o),n[m]--}return!!r},forEach:function(e){p(this,t);for(var n,r=a(e,arguments.length>1?arguments[1]:void 0,3);n=n?n.n:this._f;)for(r(n.v,n.k,this);n&&n.r;)n=n.p},has:function(e){return!!v(p(this,t),e)}}),f&&r(l.prototype,"size",{get:function(){return p(this,t)[m]}}),l},def:function(e,t,n){var r,i,o=v(e,t);return o?o.v=n:(e._l=o={i:i=d(t,!0),k:t,v:n,p:r=e._l,n:void 0,r:!1},e._f||(e._f=o),r&&(r.n=o),e[m]++,"F"!==i&&(e._i[i]=o)),e},getEntry:v,setStrong:function(e,t,n){u(e,t,(function(e,n){this._t=p(e,t),this._k=n,this._l=void 0}),(function(){for(var e=this._k,t=this._l;t&&t.r;)t=t.p;return this._t&&(this._l=t=t?t.n:this._t._f)?l(0,"keys"==e?t.k:"values"==e?t.v:[t.k,t.v]):(this._t=void 0,l(1))}),n?"entries":"values",!n,!0),h(t)}}},function(e,t,n){"use strict";var r=n(46),i=n(29).getWeak,o=n(3),a=n(4),s=n(45),c=n(65),u=n(24),l=n(15),h=n(40),f=u(5),d=u(6),p=0,m=function(e){return e._l||(e._l=new v)},v=function(){this.a=[]},g=function(e,t){return f(e.a,(function(e){return e[0]===t}))};v.prototype={get:function(e){var t=g(this,e);if(t)return t[1]},has:function(e){return!!g(this,e)},set:function(e,t){var n=g(this,e);n?n[1]=t:this.a.push([e,t])},delete:function(e){var t=d(this.a,(function(t){return t[0]===e}));return~t&&this.a.splice(t,1),!!~t}},e.exports={getConstructor:function(e,t,n,o){var u=e((function(e,r){s(e,u,t,"_i"),e._t=t,e._i=p++,e._l=void 0,null!=r&&c(r,n,e[o],e)}));return r(u.prototype,{delete:function(e){if(!a(e))return!1;var n=i(e);return!0===n?m(h(this,t)).delete(e):n&&l(n,this._i)&&delete n[this._i]},has:function(e){if(!a(e))return!1;var n=i(e);return!0===n?m(h(this,t)).has(e):n&&l(n,this._i)}}),u},def:function(e,t,n){var r=i(o(t),!0);return!0===r?m(e).set(t,n):r[e._i]=n,e},ufstore:m}},function(e,t,n){var r=n(21),i=n(6);e.exports=function(e){if(void 0===e)return 0;var t=r(e),n=i(t);if(t!==n)throw RangeError("Wrong length!");return n}},function(e,t,n){var r=n(37),i=n(59),o=n(3),a=n(1).Reflect;e.exports=a&&a.ownKeys||function(e){var t=r.f(o(e)),n=i.f;return n?t.concat(n(e)):t}},function(e,t,n){var r=n(6),i=n(81),o=n(26);e.exports=function(e,t,n,a){var s=String(o(e)),c=s.length,u=void 0===n?" ":String(n),l=r(t);if(l<=c||""==u)return s;var h=l-c,f=i.call(u,Math.ceil(h/u.length));return f.length>h&&(f=f.slice(0,h)),a?f+s:s+f}},function(e,t,n){var r=n(8),i=n(34),o=n(17),a=n(51).f;e.exports=function(e){return function(t){for(var n,s=o(t),c=i(s),u=c.length,l=0,h=[];u>l;)n=c[l++],r&&!a.call(s,n)||h.push(e?[n,s[n]]:s[n]);return h}}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t){var n=e.exports={version:"2.6.11"};"number"==typeof __e&&(__e=n)},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,i=e.indexOf("["),o=e.indexOf("]");-1!=i&&-1!=o&&(e=e.substring(0,i)+e.substring(i,o).replace(/:/g,";")+e.substring(o,e.length));for(var a=n.exec(e||""),s={},c=14;c--;)s[r[c]]=a[c]||"";return-1!=i&&-1!=o&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){(function(t){e.exports=function(e){return n&&t.isBuffer(e)||r&&(e instanceof ArrayBuffer||i(e))};var n="function"==typeof t&&"function"==typeof t.isBuffer,r="function"==typeof ArrayBuffer,i=function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}}).call(this,n(102).Buffer)},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=n(379),o=n(148),a=n(47),s=n(101),c=n(149),u=n(150),l=n(30)("socket.io-client:manager"),h=n(147),f=n(394),d=Object.prototype.hasOwnProperty;function p(e,t){if(!(this instanceof p))return new p(e,t);e&&"object"===r(e)&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new f({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||s;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}e.exports=p,p.prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)d.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},p.prototype.updateSocketIds=function(){for(var e in this.nsps)d.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},p.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},a(p.prototype),p.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},p.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},p.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},p.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},p.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},p.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},p.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},p.prototype.open=p.prototype.connect=function(e,t){if(l("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;l("opening %s",this.uri),this.engine=i(this.uri,this.opts);var n=this.engine,r=this;this.readyState="opening",this.skipReconnect=!1;var o=c(n,"open",(function(){r.onopen(),e&&e()})),a=c(n,"error",(function(t){if(l("connect_error"),r.cleanup(),r.readyState="closed",r.emitAll("connect_error",t),e){var n=new Error("Connection error");n.data=t,e(n)}else r.maybeReconnectOnOpen()}));if(!1!==this._timeout){var s=this._timeout;l("connect attempt will timeout after %d",s);var u=setTimeout((function(){l("connect attempt timed out after %d",s),o.destroy(),n.close(),n.emit("error","timeout"),r.emitAll("connect_timeout",s)}),s);this.subs.push({destroy:function(){clearTimeout(u)}})}return this.subs.push(o),this.subs.push(a),this},p.prototype.onopen=function(){l("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(c(e,"data",u(this,"ondata"))),this.subs.push(c(e,"ping",u(this,"onping"))),this.subs.push(c(e,"pong",u(this,"onpong"))),this.subs.push(c(e,"error",u(this,"onerror"))),this.subs.push(c(e,"close",u(this,"onclose"))),this.subs.push(c(this.decoder,"decoded",u(this,"ondecoded")))},p.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},p.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},p.prototype.ondata=function(e){this.decoder.add(e)},p.prototype.ondecoded=function(e){this.emit("packet",e)},p.prototype.onerror=function(e){l("error",e),this.emitAll("error",e)},p.prototype.socket=function(e,t){var n=this.nsps[e];if(!n){n=new o(this,e,t),this.nsps[e]=n;var r=this;n.on("connecting",i),n.on("connect",(function(){n.id=r.generateId(e)})),this.autoConnect&&i()}function i(){~h(r.connecting,n)||r.connecting.push(n)}return n},p.prototype.destroy=function(e){var t=h(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},p.prototype.packet=function(e){l("writing packet %j",e);var t=this;e.query&&0===e.type&&(e.nsp+="?"+e.query),t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,(function(n){for(var r=0;r<n.length;r++)t.engine.write(n[r],e.options);t.encoding=!1,t.processPacketQueue()})))},p.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},p.prototype.cleanup=function(){l("cleanup");for(var e=this.subs.length,t=0;t<e;t++)this.subs.shift().destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},p.prototype.close=p.prototype.disconnect=function(){l("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},p.prototype.onclose=function(e){l("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},p.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)l("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();l("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout((function(){e.skipReconnect||(l("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open((function(t){t?(l("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(l("reconnect success"),e.onreconnect())})))}),t);this.subs.push({destroy:function(){clearTimeout(n)}})}},p.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,n){var r=n(103),i=n(382),o=n(390),a=n(391);t.polling=function(e){var t=!1,n=!1,a=!1!==e.jsonp;if("undefined"!=typeof location){var s="https:"===location.protocol,c=location.port;c||(c=s?443:80),t=e.hostname!==location.hostname||c!==e.port,n=e.secure!==s}if(e.xdomain=t,e.xscheme=n,"open"in new r(e)&&!e.forceJSONP)return new i(e);if(!a)throw new Error("JSONP disabled");return new o(e)},t.websocket=a},function(e,t,n){var r=n(104),i=n(69),o=n(48),a=n(70),s=n(146),c=n(30)("engine.io-client:polling");e.exports=l;var u=null!=new(n(103))({xdomain:!1}).responseType;function l(e){var t=e&&e.forceBase64;u&&!t||(this.supportsBinary=!1),r.call(this,e)}a(l,r),l.prototype.name="polling",l.prototype.doOpen=function(){this.poll()},l.prototype.pause=function(e){var t=this;function n(){c("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(c("we are currently polling - waiting to pause"),r++,this.once("pollComplete",(function(){c("pre-pause polling complete"),--r||n()}))),this.writable||(c("we are currently writing - waiting to pause"),r++,this.once("drain",(function(){c("pre-pause writing complete"),--r||n()})))}else n()},l.prototype.poll=function(){c("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},l.prototype.onData=function(e){var t=this;c("polling got data %s",e),o.decodePayload(e,this.socket.binaryType,(function(e,n,r){if("opening"===t.readyState&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():c('ignoring poll - transport state "%s"',this.readyState))},l.prototype.doClose=function(){var e=this;function t(){c("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(c("transport open - closing"),t()):(c("transport not open - deferring close"),this.once("open",t))},l.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};o.encodePayload(e,this.supportsBinary,(function(e){t.doWrite(e,n)}))},l.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=s()),this.supportsBinary||e.sid||(e.b64=1),e=i.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},function(e,t,n){(function(t){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=n(384),o=Object.prototype.toString,a="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===o.call(Blob),s="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===o.call(File);e.exports=function e(n){if(!n||"object"!==r(n))return!1;if(i(n)){for(var o=0,c=n.length;o<c;o++)if(e(n[o]))return!0;return!1}if("function"==typeof t&&t.isBuffer&&t.isBuffer(n)||"function"==typeof ArrayBuffer&&n instanceof ArrayBuffer||a&&n instanceof Blob||s&&n instanceof File)return!0;if(n.toJSON&&"function"==typeof n.toJSON&&1===arguments.length)return e(n.toJSON(),!0);for(var u in n)if(Object.prototype.hasOwnProperty.call(n,u)&&e(n[u]))return!0;return!1}}).call(this,n(102).Buffer)},function(e,t,n){"use strict";var r,i="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),a={},s=0,o=0;function u(e){var t="";do{t=i[e%64]+t,e=Math.floor(e/64)}while(e>0);return t}function c(){var e=u(+new Date);return e!==r?(s=0,r=e):e+"."+u(s++)}for(;o<64;o++)a[i[o]]=o;c.encode=u,c.decode=function(e){var t=0;for(o=0;o<e.length;o++)t=64*t+a[e.charAt(o)];return t},e.exports=c},function(e,t){var n=[].indexOf;e.exports=function(e,t){if(n)return e.indexOf(t);for(var r=0;r<e.length;++r)if(e[r]===t)return r;return-1}},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=n(101),o=n(47),a=n(393),s=n(149),c=n(150),u=n(30)("socket.io-client:socket"),l=n(69),h=n(145);e.exports=p;var f={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},d=o.prototype.emit;function p(e,t,n){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}o(p.prototype),p.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[s(e,"open",c(this,"onopen")),s(e,"packet",c(this,"onpacket")),s(e,"close",c(this,"onclose"))]}},p.prototype.open=p.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},p.prototype.send=function(){var e=a(arguments);return e.unshift("message"),this.emit.apply(this,e),this},p.prototype.emit=function(e){if(f.hasOwnProperty(e))return d.apply(this,arguments),this;var t=a(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:h(t))?i.BINARY_EVENT:i.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(u("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},p.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},p.prototype.onopen=function(){if(u("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"===r(this.query)?l.encode(this.query):this.query;u("sending connect packet with query %s",e),this.packet({type:i.CONNECT,query:e})}else this.packet({type:i.CONNECT})},p.prototype.onclose=function(e){u("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},p.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===i.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case i.CONNECT:this.onconnect();break;case i.EVENT:case i.BINARY_EVENT:this.onevent(e);break;case i.ACK:case i.BINARY_ACK:this.onack(e);break;case i.DISCONNECT:this.ondisconnect();break;case i.ERROR:this.emit("error",e.data)}},p.prototype.onevent=function(e){var t=e.data||[];u("emitting event %j",t),null!=e.id&&(u("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?d.apply(this,t):this.receiveBuffer.push(t)},p.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var r=a(arguments);u("sending ack %j",r),t.packet({type:h(r)?i.BINARY_ACK:i.ACK,id:e,data:r})}}},p.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(u("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):u("bad ack %s",e.id)},p.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},p.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)d.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},p.prototype.ondisconnect=function(){u("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},p.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},p.prototype.close=p.prototype.disconnect=function(){return this.connected&&(u("performing disconnect (%s)",this.nsp),this.packet({type:i.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},p.prototype.compress=function(e){return this.flags.compress=e,this},p.prototype.binary=function(e){return this.flags.binary=e,this}},function(e,t){e.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},function(e,t){var n=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var r=n.call(arguments,2);return function(){return t.apply(e,r.concat(n.call(arguments)))}}},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},function(e,t,n){"use strict";var r=n(14);function i(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var o;if(n)o=n(t);else if(r.isURLSearchParams(t))o=t.toString();else{var a=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),a.push(i(t)+"="+i(e))})))})),o=a.join("&")}if(o){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";(function(t){var r=n(14),i=n(401),o={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var s={adapter:function(){var e;return(void 0!==t&&"[object process]"===Object.prototype.toString.call(t)||"undefined"!=typeof XMLHttpRequest)&&(e=n(155)),e}(),transformRequest:[function(e,t){return i(t,"Accept"),i(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(a(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(e){s.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){s.headers[e]=r.merge(o)})),e.exports=s}).call(this,n(55))},function(e,t,n){"use strict";var r=n(14),i=n(402),o=n(152),a=n(404),s=n(405),c=n(156);e.exports=function(e){return new Promise((function(t,u){var l=e.data,h=e.headers;r.isFormData(l)&&delete h["Content-Type"];var f=new XMLHttpRequest;if(e.auth){var d=e.auth.username||"",p=e.auth.password||"";h.Authorization="Basic "+btoa(d+":"+p)}if(f.open(e.method.toUpperCase(),o(e.url,e.params,e.paramsSerializer),!0),f.timeout=e.timeout,f.onreadystatechange=function(){if(f&&4===f.readyState&&(0!==f.status||f.responseURL&&0===f.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in f?a(f.getAllResponseHeaders()):null,r={data:e.responseType&&"text"!==e.responseType?f.response:f.responseText,status:f.status,statusText:f.statusText,headers:n,config:e,request:f};i(t,u,r),f=null}},f.onabort=function(){f&&(u(c("Request aborted",e,"ECONNABORTED",f)),f=null)},f.onerror=function(){u(c("Network Error",e,null,f)),f=null},f.ontimeout=function(){u(c("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",f)),f=null},r.isStandardBrowserEnv()){var m=n(406),v=(e.withCredentials||s(e.url))&&e.xsrfCookieName?m.read(e.xsrfCookieName):void 0;v&&(h[e.xsrfHeaderName]=v)}if("setRequestHeader"in f&&r.forEach(h,(function(e,t){void 0===l&&"content-type"===t.toLowerCase()?delete h[t]:f.setRequestHeader(t,e)})),e.withCredentials&&(f.withCredentials=!0),e.responseType)try{f.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&f.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&f.upload&&f.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){f&&(f.abort(),u(e),f=null)})),void 0===l&&(l=null),f.send(l)}))}},function(e,t,n){"use strict";var r=n(403);e.exports=function(e,t,n,i,o){var a=new Error(e);return r(a,t,n,i,o)}},function(e,t,n){"use strict";var r=n(14);e.exports=function(e,t){t=t||{};var n={};return r.forEach(["url","method","params","data"],(function(e){void 0!==t[e]&&(n[e]=t[e])})),r.forEach(["headers","auth","proxy"],(function(i){r.isObject(t[i])?n[i]=r.deepMerge(e[i],t[i]):void 0!==t[i]?n[i]=t[i]:r.isObject(e[i])?n[i]=r.deepMerge(e[i]):void 0!==e[i]&&(n[i]=e[i])})),r.forEach(["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","maxContentLength","validateStatus","maxRedirects","httpAgent","httpsAgent","cancelToken","socketPath"],(function(r){void 0!==t[r]?n[r]=t[r]:void 0!==e[r]&&(n[r]=e[r])})),n}},function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},function(e,t,n){var r,i,o,s;function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}s=function(e){"use strict";function t(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}var n=function(e){return function(t){var n=function(e){if(!e)return null;var t=document.createElement("template");return t.innerHTML=e,t.content.cloneNode(!0)}(t.template);return n&&e.appendChild(n),t}},r=function(e){return function(t){var n=function(e){if(!e)return null;var t=document.createElement("style");return t.textContent=e,t}(t.styles);return n&&e.appendChild(n),t}},i=function(e){return function(i){var o=i.prototype.connectedCallback;return i.prototype.connectedCallback=function(){var a=this;if(!0===e.shadowDOM){var s=a.shadowRoot;s||(s=a.attachShadow({mode:e.mode?e.mode:"open"})),a=s}!function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(e){return function(r){var i=n.map((function(t){return t(e)}));return t.apply(void 0,i)(r)}}}(n,r)(a)(e);var c=i.observedAttributes;c&&c.indexOf(name)>-1&&(this["_"+name]=this.getAttribute(name)),o&&o.call(this)},i}},o=function(e){var t=e.prototype.attributeChangedCallback;return e.prototype.attributeChangedCallback=function(n,r,i){var o=e.observedAttributes;o&&o.indexOf(n)>-1&&(this["_"+n]=i),t&&t.call(this,n,r,i)},e},a=function(e){var t=e.observedAttributes;return t&&t.forEach((function(t){Object.defineProperty(e.prototype,t,{get:function(){return this["_"+t]},set:function(e){this.setAttribute(t,e)},configurable:!0,enumerable:!0})})),e};e.WebComponent=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(r){return r=function(){for(var e=arguments.length,n=Array(e),r=0;r<e;r++)n[r]=arguments[r];return function(e){return t.apply(void 0,n)(e)}}(i(n),o,a)(r),customElements.define(e,r,{extends:n.extends})}},Object.defineProperty(e,"__esModule",{value:!0})},"object"===a(t)&&void 0!==e?s(t):(i=[t],void 0===(o="function"==typeof(r=s)?r.apply(t,i):r)||(e.exports=o))},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=n(369),o=n(101),a=n(142),s=n(30)("socket.io-client");e.exports=t=u;var c=t.managers={};function u(e,t){"object"===r(e)&&(t=e,e=void 0),t=t||{};var n,o=i(e),u=o.source,l=o.id,h=o.path,f=c[l]&&h in c[l].nsps;return t.forceNew||t["force new connection"]||!1===t.multiplex||f?(s("ignoring socket cache for %s",u),n=a(u,t)):(c[l]||(s("new io instance for %s",u),c[l]=a(u,t)),n=c[l]),o.query&&!t.query&&(t.query=o.query),n.socket(o.path,t)}t.protocol=o.protocol,t.connect=u,t.Manager=n(142),t.Socket=n(148)},function(e,t){e.exports="uniform highp float opacity;uniform sampler2D tDiffuse;varying highp vec2 vUv;void main(){lowp vec4 a;a=texture2D(tDiffuse,vUv);gl_FragColor=(opacity*a);}"},function(e,t){e.exports="uniform sampler2D tDiffuse;varying highp vec2 vUv;void main(){lowp vec4 a;a=texture2D(tDiffuse,vUv);lowp vec4 b;b.xyz=vec3(dot(a.xyz,vec3(0.2125,0.7154,0.0721)));b.w=a.w;gl_FragColor=b;}"},function(e,t){e.exports="uniform sampler2D tDiffuse;uniform highp vec2 uWindow;uniform highp float threshold;varying highp vec2 vUv;void main(){lowp vec2 a;lowp vec2 b;highp vec2 c;c=(threshold/uWindow);highp vec2 d;d.x=-(c.x);d.y=c.y;lowp vec4 e;e=texture2D(tDiffuse,(vUv+d));highp vec2 f;f.x=c.x;f.y=-(c.y);lowp vec4 g;g=texture2D(tDiffuse,(vUv+f));lowp vec4 h;h=texture2D(tDiffuse,(vUv-c));lowp vec4 i;i=texture2D(tDiffuse,(vUv+c));highp vec2 j;j.y=0.0;j.x=-(c.x);highp vec2 k;k.y=0.0;k.x=c.x;highp vec2 l;l.x=0.0;l.y=c.y;highp vec2 m;m.x=0.0;m.y=-(c.y);b.x=(((((-(e.x)-(2.0*texture2D(tDiffuse,(vUv+j)).x))-h.x)+i.x)+(2.0*texture2D(tDiffuse,(vUv+k)).x))+g.x);b.y=(((((-(h.x)-(2.0*texture2D(tDiffuse,(vUv+m)).x))-g.x)+e.x)+(2.0*texture2D(tDiffuse,(vUv+l)).x))+i.x);lowp float n;n=sqrt(dot(b,b));lowp vec2 o;o=normalize(b);a=(sign(o)*floor((abs(o)+0.617316)));a=((a+1.0)*0.5);mediump vec4 p;p.w=1.0;p.x=n;p.y=a.x;p.z=a.y;gl_FragColor=p;}"},function(e,t){e.exports="uniform sampler2D tDiffuse;uniform highp float texelWidth;uniform highp float texelHeight;uniform mediump float upperThreshold;uniform mediump float lowerThreshold;varying highp vec2 vUv;void main(){lowp float a;lowp vec4 b;b=texture2D(tDiffuse,vUv);highp vec2 c;c.x=texelWidth;c.y=texelHeight;highp vec2 d;d=(((b.yz*2.0)-1.0)*c);highp vec2 e;e=(vUv+d);highp vec2 f;f=(vUv-d);a=(float((b.x>=texture2D(tDiffuse,e).x))*float((b.x>=texture2D(tDiffuse,f).x)));mediump float g;mediump float h;h=clamp(((b.x-lowerThreshold)/(upperThreshold-lowerThreshold)),0.0,1.0);g=(h*(h*(3.0-(2.0*h))));a=(a*g);lowp vec4 i;i.w=1.0;i.x=a;i.y=a;i.z=a;gl_FragColor=i;}"},function(e,t){e.exports="uniform sampler2D tDiffuse;uniform highp vec2 uWindow;uniform highp float threshold;varying highp vec2 vUv;void main(){highp vec2 a;a=(threshold/uWindow);highp vec2 b;b.x=-(a.x);b.y=a.y;highp vec2 c;c.x=a.x;c.y=-(a.y);highp vec2 d;d.y=0.0;d.x=-(a.x);highp vec2 e;e.y=0.0;e.x=a.x;highp vec2 f;f.x=0.0;f.y=a.y;highp vec2 g;g.x=0.0;g.y=-(a.y);lowp vec4 h;h=texture2D(tDiffuse,vUv);lowp float i;i=float(((((texture2D(tDiffuse,(vUv+b)).x+texture2D(tDiffuse,(vUv+c)).x)+(texture2D(tDiffuse,(vUv-a)).x+texture2D(tDiffuse,(vUv+a)).x))+((texture2D(tDiffuse,(vUv+d)).x+texture2D(tDiffuse,(vUv+e)).x)+((texture2D(tDiffuse,(vUv+f)).x+texture2D(tDiffuse,(vUv+g)).x)+h.x)))>=1.5));lowp float j;j=float((h.x>=0.01));lowp vec3 k;k.x=(i*j);k.y=(i*j);k.z=(i*j);lowp vec4 l;l.w=1.0;l.xyz=k;gl_FragColor=l;}"},function(e,t){e.exports="uniform sampler2D tDiffuse;\nuniform sampler2D tShade;\nuniform vec4 blend;\nuniform vec4 fade;\n\nvarying vec2 vUv;\n\nvoid main(void) {\n\n    float step1 = 0.8;\n    float step2 = 0.6;\n    float step3 = 0.3;\n    float step4 = 0.15;\n    float alpha = 1.0;\n\n    vec3 shade = vec3(1.0);\n    vec4 color = vec4(1.0);\n\n    vec4 texelLines = texture2D(tDiffuse, vUv);\n    vec4 texelShade = texture2D(tShade, vUv);\n\n    float brightness = (0.2126 * texelShade.r) + (0.7152 * texelShade.g) + (0.0722 * texelShade.b);\n    float brightest = max(max(texelShade.r, texelShade.g), texelShade.b);\n    float dimmest = min(min(texelShade.r, texelShade.g), texelShade.b);\n    float delta = brightest - dimmest;\n\n    if (delta > 0.1) {\n        texelShade = texelShade * (1.0 / brightest);\n    } else {\n        texelShade.rgb = vec3(1.0);\n    }\n\n    if (brightness < step1) {\n        shade = vec3(texelShade.rgb * step1);\n    }\n\n    if (brightness < step2) {\n        shade = vec3(texelShade.rgb * step2);\n    }\n\n    if (brightness < step3) {\n        shade = vec3(texelShade.rgb * step3);\n    }\n\n    if (brightness < step4) {\n        shade = vec3(texelShade.rgb * step4);\n    }\n\n    if (texelLines.rgb == vec3(0.0)) {\n        color = 1.0 - vec4(mix(shade, blend.rgb, blend.a), 0.0);\n    }\n\n    if (fade.x > 0.0) {\n        alpha *= smoothstep(0.0, fade.x * abs(sin(0.5)), vec4(vUv, 1.0 - vUv)).x;\n    }\n\n    if (fade.y > 0.0) {\n        alpha *= smoothstep(0.0, fade.y * abs(sin(0.5)), vec4(vUv, 1.0 - vUv)).y;\n    }\n\n    if (fade.z > 0.0) {\n        alpha *= smoothstep(0.0, fade.z * abs(sin(0.5)), vec4(vUv, 1.0 - vUv)).z;\n    }\n\n    if (fade.w > 0.0) {\n        alpha *= smoothstep(0.0, fade.w * abs(sin(0.5)), vec4(vUv, 1.0 - vUv)).w;\n    }\n\n    if (fade != vec4(0.0)) {\n        color = vec4(mix(vec3(0.0), color.rgb, alpha), 1.0);\n    }\n\n    gl_FragColor = color;\n\n}\n"},function(e,t){e.exports="uniform sampler2D tDiffuse;\nuniform sampler2D tFlash;\nuniform float edgeR;\nuniform float edgeG;\nuniform float edgeB;\n\nvarying vec2 vUv;\n\nvoid main() {\n\n    vec4 texelFlash = texture2D(tFlash, vUv);\n    vec4 texelEdge = texture2D(tDiffuse, vUv);\n\n    vec4 edgeColor = vec4(edgeR, edgeG, edgeB, 1.0);\n    float brightness = (texelEdge.r + texelEdge.g + texelEdge.b) / 3.0;\n\n    gl_FragColor = mix(texelFlash, vec4(1.-texelEdge.rgb, 1.0), brightness); // RGB\n\n}\n"},function(e,t){e.exports="uniform sampler2D tDiffuse;\nuniform sampler2D tFlash;\nuniform float edgeR;\nuniform float edgeG;\nuniform float edgeB;\n\nvarying vec2 vUv;\n\nvoid main() {\n\n    vec4 texelFlash = texture2D(tFlash, vUv);\n    vec4 texelEdge = texture2D(tDiffuse, vUv);\n\n    vec4 edgeColor = vec4(edgeR, edgeG, edgeB, 1.0);\n    float brightness = (texelEdge.r + texelEdge.g + texelEdge.b) / 3.0;\n\n    gl_FragColor = mix(texelFlash, edgeColor, brightness); // Monochrome\n\n}\n"},function(e,t){e.exports="uniform highp float nextR;uniform highp float nextG;uniform highp float nextB;void main(){mediump vec4 a;a.w=1.0;a.x=nextR;a.y=nextG;a.z=nextB;gl_FragColor=a;}"},function(e,t){e.exports="uniform highp float time;uniform highp float timeDiff;uniform highp float delta;uniform float seedsX[10];uniform float seedsY[10];uniform highp float thisR;uniform highp float thisG;uniform highp float thisB;uniform highp float nextR;uniform highp float nextG;uniform highp float nextB;uniform highp float start;varying highp vec2 vUv;void main(){highp float a;highp float b;highp float c;highp vec2 d;d=(-1.0+(2.0*vUv));c=0.0;b=0.0;a=0.0;if((start>0.0)){highp float e;e=d.x;highp float f;f=d.y;highp float g;g=10.0;for(highp int h=0;h<10;h++){highp float i;i=(e-seedsX[h]);highp float j;j=(f-seedsY[h]);g=min(pow(((i*i)+(j*j)),0.5),g);}highp float k;k=(g+delta);highp float l;l=(time-start);c=(((1.0/((1.0+exp(((k*(-6.0*l))+10.0)))))*(nextR-thisR))+thisR);b=(((1.0/((1.0+exp(((k*(-8.0*l))+10.0)))))*(nextG-thisG))+thisG);a=(((1.0/((1.0+exp(((-10.0*(k*l))+10.0)))))*(nextB-thisB))+thisB);if(((time-start)>timeDiff)){c=nextR;b=nextG;a=nextB;}}mediump vec4 m;m.w=1.0;m.x=c;m.y=b;m.z=a;gl_FragColor=m;}"},function(e,t){e.exports="uniform sampler2D tDiffuse;\nuniform sampler2D tBlend;\n\nvarying vec2 vUv;\n\nvoid main() {\n\n    vec4 texelBlend = texture2D(tBlend, vUv);\n\n    vec4 texelDiffuse = texture2D(tDiffuse, vUv);\n\n    vec3 color = texelBlend.a * texelBlend.rgb + (1.0 - texelBlend.a) * texelDiffuse.rgb;\n\n    gl_FragColor = vec4(color, 1.0);\n\n}\n"},function(e,t){e.exports="varying highp vec2 vUv;uniform highp float nextR;uniform highp float nextG;uniform highp float nextB;void main(){if((vUv.x<=0.5)){mediump vec4 a;a.w=1.0;a.x=nextR;a.y=nextG;a.z=nextB;gl_FragColor=a;}else{mediump vec4 b;b.w=1.0;b.x=(1.0-nextR);b.y=(1.0-nextG);b.z=(1.0-nextB);gl_FragColor=b;}}"},function(e,t){e.exports="const float PI_2 = 1.57079632679489661923;\n\nuniform sampler2D tScan;\nuniform vec2 uWindow;\nuniform vec4 cross;\nuniform vec4 color;\n\nvarying vec2 vUv;\n\nvoid main() {\n\n    vec4 texelScan = texture2D(tScan, vUv);\n    vec4 target = vec4(vUv - 0.5 + cross.y, vUv - 0.5 + cross.x);\n\n    target.y = cos(cross.z) * target.x + sin(cross.z) * target.y;\n    target.w = cos(cross.z + PI_2) * target.z + sin(cross.z + PI_2) * target.w;\n\n    float line1 = smoothstep(0.0, cross.w / (uWindow.y * sin(cross.z) + cos(cross.z) * uWindow.x), abs(target.y));\n    float line2 = smoothstep(0.0, cross.w / (uWindow.x * sin(cross.z) + cos(cross.z) * uWindow.y), abs(target.w));\n\n    gl_FragColor = mix(color, texelScan, line1 * line2);\n\n}\n"},function(e,t,n){(function(e){var r;function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(o,a){"use strict";var s="model",c="name",u="type",l="vendor",h="version",f="mobile",d="tablet",p="smarttv",m={extend:function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"===i(e)?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},v={rgx:function(e,t){for(var n,r,o,a,s,c,u=0;u<t.length&&!s;){var l=t[u],h=t[u+1];for(n=r=0;n<l.length&&!s;)if(s=l[n++].exec(e))for(o=0;o<h.length;o++)c=s[++r],"object"===i(a=h[o])&&a.length>0?2==a.length?"function"==i(a[1])?this[a[0]]=a[1].call(this,c):this[a[0]]=a[1]:3==a.length?"function"!==i(a[1])||a[1].exec&&a[1].test?this[a[0]]=c?c.replace(a[1],a[2]):void 0:this[a[0]]=c?a[1].call(this,c,a[2]):void 0:4==a.length&&(this[a[0]]=c?a[3].call(this,c.replace(a[1],a[2])):void 0):this[a]=c||void 0;u+=2}},str:function(e,t){for(var n in t)if("object"===i(t[n])&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(m.has(t[n][r],e))return"?"===n?void 0:n}else if(m.has(t[n],e))return"?"===n?void 0:n;return e}},g={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},y={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[c,h],[/(opios)[\/\s]+([\w\.]+)/i],[[c,"Opera Mini"],h],[/\s(opr)\/([\w\.]+)/i],[[c,"Opera"],h],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(bidubrowser|baidubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[c,h],[/(konqueror)\/([\w\.]+)/i],[[c,"Konqueror"],h],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[c,"IE"],h],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[c,"Edge"],h],[/(yabrowser)\/([\w\.]+)/i],[[c,"Yandex"],h],[/(Avast)\/([\w\.]+)/i],[[c,"Avast Secure Browser"],h],[/(AVG)\/([\w\.]+)/i],[[c,"AVG Secure Browser"],h],[/(puffin)\/([\w\.]+)/i],[[c,"Puffin"],h],[/(focus)\/([\w\.]+)/i],[[c,"Firefox Focus"],h],[/(opt)\/([\w\.]+)/i],[[c,"Opera Touch"],h],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[c,"UCBrowser"],h],[/(comodo_dragon)\/([\w\.]+)/i],[[c,/_/g," "],h],[/(windowswechat qbcore)\/([\w\.]+)/i],[[c,"WeChat(Win) Desktop"],h],[/(micromessenger)\/([\w\.]+)/i],[[c,"WeChat"],h],[/(brave)\/([\w\.]+)/i],[[c,"Brave"],h],[/(qqbrowserlite)\/([\w\.]+)/i],[c,h],[/(QQ)\/([\d\.]+)/i],[c,h],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[c,h],[/(baiduboxapp)[\/\s]?([\w\.]+)/i],[c,h],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[c,h],[/(MetaSr)[\/\s]?([\w\.]+)/i],[c],[/(LBBROWSER)/i],[c],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[h,[c,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[h,[c,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[c,h],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[h,[c,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[c,/(.+)/,"$1 WebView"],h],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[c,/(.+(?:g|us))(.+)/,"$1 $2"],h],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[h,[c,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[c,"Sailfish Browser"],h],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[c,h],[/(dolfin)\/([\w\.]+)/i],[[c,"Dolphin"],h],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[c,"360 Browser"]],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[c,"Chrome"],h],[/(coast)\/([\w\.]+)/i],[[c,"Opera Coast"],h],[/fxios\/([\w\.-]+)/i],[h,[c,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[h,[c,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[h,c],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[c,"GSA"],h],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[c,[h,v.str,g.browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[c,h],[/(navigator|netscape)\/([\w\.-]+)/i],[[c,"Netscape"],h],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[c,h]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",m.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",m.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[["architecture",m.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[s,l,[u,d]],[/applecoremedia\/[\w\.]+ \((ipad)/],[s,[l,"Apple"],[u,d]],[/(apple\s{0,1}tv)/i],[[s,"Apple TV"],[l,"Apple"],[u,p]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[l,s,[u,d]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[s,[l,"Amazon"],[u,d]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[s,v.str,g.device.amazon.model],[l,"Amazon"],[u,f]],[/android.+aft([bms])\sbuild/i],[s,[l,"Amazon"],[u,p]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[s,l,[u,f]],[/\((ip[honed|\s\w*]+);/i],[s,[l,"Apple"],[u,f]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[l,s,[u,f]],[/\(bb10;\s(\w+)/i],[s,[l,"BlackBerry"],[u,f]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[s,[l,"Asus"],[u,d]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[l,"Sony"],[s,"Xperia Tablet"],[u,d]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[s,[l,"Sony"],[u,f]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[l,s,[u,"console"]],[/android.+;\s(shield)\sbuild/i],[s,[l,"Nvidia"],[u,"console"]],[/(playstation\s[34portablevi]+)/i],[s,[l,"Sony"],[u,"console"]],[/(sprint\s(\w+))/i],[[l,v.str,g.device.sprint.vendor],[s,v.str,g.device.sprint.model],[u,f]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[l,[s,/_/g," "],[u,f]],[/(nexus\s9)/i],[s,[l,"HTC"],[u,d]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p|vog-l29|ane-lx1|eml-l29)/i],[s,[l,"Huawei"],[u,f]],[/android.+(bah2?-a?[lw]\d{2})/i],[s,[l,"Huawei"],[u,d]],[/(microsoft);\s(lumia[\s\w]+)/i],[l,s,[u,f]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[s,[l,"Microsoft"],[u,"console"]],[/(kin\.[onetw]{3})/i],[[s,/\./g," "],[l,"Microsoft"],[u,f]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[s,[l,"Motorola"],[u,f]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[s,[l,"Motorola"],[u,d]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[l,m.trim],[s,m.trim],[u,p]],[/hbbtv.+maple;(\d+)/i],[[s,/^/,"SmartTV"],[l,"Samsung"],[u,p]],[/\(dtv[\);].+(aquos)/i],[s,[l,"Sharp"],[u,p]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[l,"Samsung"],s,[u,d]],[/smart-tv.+(samsung)/i],[l,[u,p],s],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[l,"Samsung"],s,[u,f]],[/sie-(\w*)/i],[s,[l,"Siemens"],[u,f]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[l,"Nokia"],s,[u,f]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[s,[l,"Acer"],[u,d]],[/android.+([vl]k\-?\d{3})\s+build/i],[s,[l,"LG"],[u,d]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[l,"LG"],s,[u,d]],[/(lg) netcast\.tv/i],[l,s,[u,p]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[s,[l,"LG"],[u,f]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[l,s,[u,d]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[s,[l,"Lenovo"],[u,d]],[/(lenovo)[_\s-]?([\w-]+)/i],[l,s,[u,f]],[/linux;.+((jolla));/i],[l,s,[u,f]],[/((pebble))app\/[\d\.]+\s/i],[l,s,[u,"wearable"]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[l,s,[u,f]],[/crkey/i],[[s,"Chromecast"],[l,"Google"],[u,p]],[/android.+;\s(glass)\s\d/i],[s,[l,"Google"],[u,"wearable"]],[/android.+;\s(pixel c)[\s)]/i],[s,[l,"Google"],[u,d]],[/android.+;\s(pixel( [23])?( xl)?)[\s)]/i],[s,[l,"Google"],[u,f]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[s,/_/g," "],[l,"Xiaomi"],[u,f]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[s,/_/g," "],[l,"Xiaomi"],[u,d]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[s,[l,"Meizu"],[u,f]],[/(mz)-([\w-]{2,})/i],[[l,"Meizu"],s,[u,f]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})[\s)]/i],[s,[l,"OnePlus"],[u,f]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[s,[l,"RCA"],[u,d]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[s,[l,"Dell"],[u,d]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[s,[l,"Verizon"],[u,d]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[l,"Barnes & Noble"],s,[u,d]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[s,[l,"NuVision"],[u,d]],[/android.+;\s(k88)\sbuild/i],[s,[l,"ZTE"],[u,d]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[s,[l,"Swiss"],[u,f]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[s,[l,"Swiss"],[u,d]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[s,[l,"Zeki"],[u,d]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[l,"Dragon Touch"],s,[u,d]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[s,[l,"Insignia"],[u,d]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[s,[l,"NextBook"],[u,d]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[l,"Voice"],s,[u,f]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[l,"LvTel"],s,[u,f]],[/android.+;\s(PH-1)\s/i],[s,[l,"Essential"],[u,f]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[s,[l,"Envizen"],[u,d]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[l,s,[u,d]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[s,[l,"MachSpeed"],[u,d]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[l,s,[u,d]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[s,[l,"Rotor"],[u,d]],[/android.+(KS(.+))\s+build/i],[s,[l,"Amazon"],[u,d]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[l,s,[u,d]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[u,m.lowerize],l,s],[/[\s\/\(](smart-?tv)[;\)]/i],[[u,p]],[/(android[\w\.\s\-]{0,9});.+build/i],[s,[l,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[h,[c,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[h,[c,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[c,h],[/rv\:([\w\.]{1,9}).+(gecko)/i],[h,c]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[c,h],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[c,[h,v.str,g.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[c,"Windows"],[h,v.str,g.os.windows.version]],[/\((bb)(10);/i],[[c,"BlackBerry"],h],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[c,h],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[c,"Symbian"],h],[/\((series40);/i],[c],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[c,"Firefox OS"],h],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[c,h],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[c,"Chromium OS"],h],[/(sunos)\s?([\w\.\d]*)/i],[[c,"Solaris"],h],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[c,h],[/(haiku)\s(\w+)/i],[c,h],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[h,/_/g,"."],[c,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[c,"Mac OS"],[h,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[c,h]]},b=function e(t,n){if("object"===i(t)&&(n=t,t=void 0),!(this instanceof e))return new e(t,n).getResult();var r=t||(o&&o.navigator&&o.navigator.userAgent?o.navigator.userAgent:""),a=n?m.extend(y,n):y;return this.getBrowser=function(){var e={name:void 0,version:void 0};return v.rgx.call(e,r,a.browser),e.major=m.major(e.version),e},this.getCPU=function(){var e={architecture:void 0};return v.rgx.call(e,r,a.cpu),e},this.getDevice=function(){var e={vendor:void 0,model:void 0,type:void 0};return v.rgx.call(e,r,a.device),e},this.getEngine=function(){var e={name:void 0,version:void 0};return v.rgx.call(e,r,a.engine),e},this.getOS=function(){var e={name:void 0,version:void 0};return v.rgx.call(e,r,a.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return r},this.setUA=function(e){return r=e,this},this};b.VERSION="0.7.21",b.BROWSER={NAME:c,MAJOR:"major",VERSION:h},b.CPU={ARCHITECTURE:"architecture"},b.DEVICE={MODEL:s,VENDOR:l,TYPE:u,CONSOLE:"console",MOBILE:f,SMARTTV:p,TABLET:d,WEARABLE:"wearable",EMBEDDED:"embedded"},b.ENGINE={NAME:c,VERSION:h},b.OS={NAME:c,VERSION:h},"undefined"!==i(t)?("undefined"!==i(e)&&e.exports&&(t=e.exports=b),t.UAParser=b):void 0===(r=function(){return b}.call(t,n,t,e))||(e.exports=r);var _=o&&(o.jQuery||o.Zepto);if(_&&!_.ua){var w=new b;_.ua=w.getResult(),_.ua.get=function(){return w.getUA()},_.ua.set=function(e){w.setUA(e);var t=w.getResult();for(var n in t)_.ua[n]=t[n]}}}("object"===("undefined"==typeof window?"undefined":i(window))?window:this)}).call(this,n(136)(e))},function(e,t){e.exports='<svg width="288" height="480" viewBox="0 0 288 480" version="1.1"><g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="svg-ui"><path d="M0,0 L288,0 L288,480 L0,480 L0,0 Z M276,240 C276,142.720646 216.792069,64 143.998668,64 C71.2075246,64 12,142.721191 12,240 C12,337.280578 71.2068175,416 143.998668,416 C216.792776,416 276,337.281123 276,240 Z" id="svg-mask" fill-opacity=".25" fill="#5C5C5C"/><g id="svg-face" transform="translate(12 64)"><path d="M261,176 C261,271.622922 203.138395,349 131.998699,349 C60.861208,349 3,271.622386 3,176 C3,80.3793525 60.8618991,3 131.998699,3 C203.137704,3 261,80.378817 261,176 Z M0,176 C0,273.12603 58.9917486,352 131.998698,352 C205.007843,352 264,273.126571 264,176 C264,78.8751724 205.00716,0 131.998698,0 C58.9924316,0 0,78.8757135 0,176 Z" id="svg-oval" fill="#5C5C5C" fill-rule="nonzero"/><path d="M0.432601829,0.432601829 C0.695286813,0.165117586 1.05621782,0 1.45454545,0 L30.5454545,0 C31.3487778,0 32,0.671572875 32,1.5 C32,2.32842712 31.3487778,3 30.5454545,3 L3,3 L3,30.5454545 C3,31.3487778 2.32842712,32 1.5,32 C0.671572875,32 -1.11022302e-16,31.3487778 -1.11022302e-16,30.5454545 L-1.11022302e-16,1.45454545 C-1.11022302e-16,1.05621782 0.165117586,0.695286813 0.432601829,0.432601829 Z M261,3 L233.454545,3 C232.651222,3 232,2.32842712 232,1.5 C232,0.671572875 232.651222,0 233.454545,0 L262.545455,0 C262.943782,0 263.304713,0.165117586 263.567398,0.432601829 C263.834882,0.695286813 264,1.05621782 264,1.45454545 L264,30.5454545 C264,31.3487778 263.328427,32 262.5,32 C261.671573,32 261,31.3487778 261,30.5454545 L261,3 Z M3,349 L30.5454545,349 C31.3487778,349 32,349.671573 32,350.5 C32,351.328427 31.3487778,352 30.5454545,352 L1.45454545,352 C1.05621782,352 0.695286813,351.834882 0.432601829,351.567398 C0.165117586,351.304713 -1.11022302e-16,350.943782 -1.11022302e-16,350.545455 L-1.11022302e-16,321.454545 C-1.11022302e-16,320.651222 0.671572875,320 1.5,320 C2.32842712,320 3,320.651222 3,321.454545 L3,349 Z M263.567398,351.567398 C263.304713,351.834882 262.943782,352 262.545455,352 L233.454545,352 C232.651222,352 232,351.328427 232,350.5 C232,349.671573 232.651222,349 233.454545,349 L261,349 L261,321.454545 C261,320.651222 261.671573,320 262.5,320 C263.328427,320 264,320.651222 264,321.454545 L264,350.545455 C264,350.943782 263.834882,351.304713 263.567398,351.567398 Z" id="svg-frame" fill="#5C5C5C"/><g id="svg-count" transform="translate(85 111)" fill="#00C657"><path d="M48.0971314,129.69 C30.8119871,129.69 16.4884985,124.164873 5.1262359,113.114452 C2.70873321,111.171521 1.5,108.500031 1.5,105.099902 C1.5,102.185505 2.55764156,99.6658042 4.67295642,97.5407233 C6.78827127,95.4156425 9.29639269,94.353118 12.1973959,94.353118 C14.977524,94.353118 17.4554271,95.3245689 19.6311795,97.2675 C27.7298135,105.403524 37.3392426,109.471475 48.4597549,109.471475 C54.7452619,109.471475 59.9730331,107.680362 64.1432252,104.098083 C68.3134174,100.515804 70.3984822,95.8710538 70.3984822,90.1636938 L70.3984822,89.7993961 C70.3984822,83.6063033 67.7694874,78.7794063 62.5114191,75.3185604 C57.2533507,71.8577144 50.1520431,70.1273174 41.2072831,70.1273174 L36.6744883,70.1273174 C34.0152353,70.1273174 31.7488605,69.1862243 29.8752959,67.3040098 C28.0017314,65.4217954 27.0649631,63.1449572 27.0649631,60.473427 C27.0649631,57.5590304 28.6363163,54.5232461 31.7790698,51.3659831 L61.5142042,19.4899298 L15.4610082,19.4899298 C12.8017553,19.4899298 10.5051622,18.5488367 8.57116001,16.6666222 C6.63715786,14.7844077 5.67017129,12.5075695 5.67017129,9.83603933 C5.67017129,7.16450911 6.60693953,4.85731309 8.48050411,2.91438202 C10.3540687,0.97145096 12.6808801,0 15.4610082,0 L80.3706309,0 C83.6342595,0 86.2934726,0.910735275 88.3483499,2.73223315 C90.4032272,4.55373102 91.4306504,6.92164273 91.4306504,9.83603933 C91.4306504,13.7219015 89.3153673,17.7898523 85.0847376,22.040014 L55.1682914,53.1874719 C65.9261783,54.523237 74.8405858,58.0751046 81.9117812,63.8431812 C88.9829765,69.6112578 92.5185212,77.9596645 92.5185212,88.8886517 L92.5185212,89.2529494 C92.5185212,101.031969 88.4088282,110.716121 80.1893191,118.305695 C71.96981,125.89527 61.272521,129.69 48.0971314,129.69 Z" id="svg-start-3"/><path d="M0,119.092756 C0,114.830724 1.93937455,111.116723 5.81818182,107.950642 L44.9090909,74.5243012 C53.8788327,66.9744159 60.0908918,60.733677 63.5454545,55.8018971 C67.0000173,50.8701172 68.7272727,45.6035424 68.7272727,40.0020146 C68.7272727,33.9133975 66.7878982,29.0730194 62.9090909,25.4807353 C59.0302836,21.8884512 54.1212418,20.0923361 48.1818182,20.0923361 C39.2120764,20.0923361 30.8485236,24.8413862 23.0909091,34.339629 C21.0302927,36.6533035 18.4242582,37.8101234 15.2727273,37.8101234 C12.4848345,37.8101234 10.0909191,36.8055166 8.09090909,34.796273 C6.09089909,32.7870293 5.09090909,30.3820616 5.09090909,27.5812977 C5.09090909,25.0240785 5.93938545,22.7104387 7.63636364,20.6403089 C13.2121491,13.6992854 19.2423918,8.52403843 25.7272727,5.11441283 C32.2121536,1.70478723 40.2423764,0 49.8181818,0 C62.3030927,0 72.4242036,3.50090234 80.1818182,10.5028121 C87.9394327,17.5047218 91.8181818,26.7288384 91.8181818,38.1754386 L91.8181818,38.5407538 C91.8181818,48.0389965 89.3939636,56.1367359 84.5454545,62.8342147 C79.6969455,69.5316936 71.0909709,77.9338592 58.7272727,88.0409637 L32.5454545,109.959876 L84.1818182,109.959876 C86.8484982,109.959876 89.1515055,110.93404 91.0909091,112.882397 C93.0303127,114.830755 94,117.144395 94,119.823386 C94,122.502378 93.0303127,124.816018 91.0909091,126.764375 C89.1515055,128.712733 86.8484982,129.686897 84.1818182,129.686897 L12,129.686897 C8.48483091,129.686897 5.60607182,128.743175 3.36363636,126.855704 C1.12120091,124.968233 0,122.380609 0,119.092756 Z" id="svg-start-2"/><path d="M49.75898,118.610042 L49.75898,22.7048319 L36.7410978,26.7008824 C35.5357324,27.0641615 34.2098502,27.2457983 32.7634116,27.2457983 C30.1116076,27.2457983 27.8214475,26.3073413 25.8928627,24.4303992 C23.9642779,22.553457 23,20.3435421 23,17.8005882 C23,12.7146805 25.4709622,9.50576296 30.4129607,8.1737395 L49.5781761,1.99802521 C54.1585649,0.666001743 57.7746072,0 60.4264112,0 L60.7880191,0 C63.9219693,0 66.5435999,1.05954823 68.6529895,3.17867647 C70.7623791,5.29780471 71.8170581,7.93153888 71.8170581,11.079958 L71.8170581,118.610042 C71.8170581,121.758461 70.7322455,124.392195 68.5625876,126.511324 C66.3929297,128.630452 63.8014328,129.69 60.7880191,129.69 C57.7746054,129.69 55.1831084,128.600179 53.0134506,126.420504 C50.8437927,124.240829 49.75898,121.637368 49.75898,118.610042 Z" id="svg-start-1"/></g></g><g id="svg-bottom" transform="translate(0 440)"><rect id="svg-progress" fill-opacity=".9" fill="#000" x="0" y="0" width="1" height="40"/><rect id="svg-panel" fill-opacity=".676" fill="#000" x="0" y="0" width="288" height="40"/><text id="svg-status" font-family="GothamRounded-Medium, Gotham Rounded" font-size="20" font-weight="400" fill="#FFF"><tspan x="95.07" y="27" id="svg-status-text" tabindex="1">Please wait…</tspan></text></g><g id="svg-top"><rect id="svg-bar" fill-opacity=".68" fill="#000" x="0" y="0" width="288" height="40"/><g id="svg-exit" transform="translate(248)" pointer-events="bounding-box" fill="#C29339"><g id="svg-cross" transform="translate(5 5)"><path d="M30,15 C30,6.71511628 23.2848837,0 15,0 C6.71511628,0 0,6.71511628 0,15 C0,23.2848837 6.71511628,30 15,30 C23.2848837,30 30,23.2848837 30,15 Z M27,15 C27,21.6166911 21.6166911,27 15,27 C8.38330893,27 3,21.6166911 3,15 C3,8.38330893 8.38330893,3 15,3 C21.6166911,3 27,8.38330893 27,15 Z" id="svg-o"/><path d="M21,18.6570397 C21,18.4043321 20.8953069,18.1516245 20.7148014,17.967509 L17.7472924,15 L20.7148014,12.0288809 C20.8953069,11.8483755 21,11.5956679 21,11.3465704 C21,11.0938628 20.8953069,10.8375451 20.7148014,10.6570397 L19.3429603,9.28519856 C19.1588448,9.10108303 18.9097473,9 18.6570397,9 C18.4043321,9 18.1516245,9.10108303 17.967509,9.28519856 L15,12.2527076 L12.032491,9.28519856 C11.8483755,9.10108303 11.599278,9 11.3429603,9 C11.0902527,9 10.8411552,9.10108303 10.6570397,9.28519856 L9.28519856,10.6570397 C9.10108303,10.8375451 9,11.0938628 9,11.3465704 C9,11.5956679 9.10108303,11.8483755 9.28519856,12.0288809 L12.2527076,15 L9.28519856,17.967509 C9.10108303,18.1516245 9,18.4043321 9,18.6570397 C9,18.9097473 9.10108303,19.1624549 9.28519856,19.3465704 L10.6570397,20.7184116 C10.8411552,20.898917 11.0902527,21 11.3429603,21 C11.599278,21 11.8483755,20.898917 12.032491,20.7184116 L15,17.7472924 L17.967509,20.7184116 C18.1516245,20.898917 18.4043321,21 18.6570397,21 C18.9097473,21 19.1588448,20.898917 19.3429603,20.7184116 L20.7148014,19.3465704 C20.8953069,19.1624549 21,18.9097473 21,18.6570397" id="svg-x"/></g></g><text id="svg-info" font-family="GothamRounded-Book, Gotham Rounded" font-size="12" font-weight="300" fill="#FFF"><tspan x="105.366" y="24" id="svg-info-text" tabindex="2">Connecting…</tspan></text><g id="svg-logo" transform="translate(4 4)"><g id="svg-iproov"><path d="M6.60539216,8 C9.61018052,8 11.208137,9.00358681 11.8897059,10.4080968 L11.8897059,29.3333333 C10.7497946,29.3333333 7.2165154,28.8428898 6.60539216,25.7889678 L6.60539216,8" id="svg-i" fill="#FFF"/><path d="M9.24754902,0 C10.7066949,0 11.8897059,1.19391792 11.8897059,2.66651668 C11.8897059,4.13911544 10.7066949,5.33333333 9.24754902,5.33333333 C7.78810587,5.33333333 6.60539216,4.13911544 6.60539216,2.66651668 C6.60539216,1.19391792 7.78810587,0 9.24754902,0" id="svg-dot" fill="#FFF"/><path d="M9.28561065,19.2052716 L24.5167113,8.01371988 C28.9820276,5.05421061 25.7501894,4.57160478 21.7977238,4.18190703 C17.8097918,3.7886607 13.0814591,3.50090375 13.5814414,3.468644 L25.9906078,2.66666667 C29.7318442,2.66666667 32.104328,5.87844717 28.8442422,9.04183805 L10.0683828,25.3333333 L0,16.0893026 L9.28561065,19.2052716" id="svg-tick" fill="#979797"/><path d="M15.8529412,31.4747937 C15.8529412,31.7708705 16.0692929,32 16.3491289,32 C16.6289648,32 16.8326829,31.7708705 16.8326829,31.4747937 L16.8326829,28.4445642 C17.3415043,29.225616 18.1304775,29.925891 19.3518383,29.925891 C20.9424183,29.925891 22.4947815,28.5790874 22.4947815,26.3031936 L22.4947815,26.2761632 C22.4947815,23.9867542 20.9297846,22.6666667 19.3518383,22.6666667 C18.1431111,22.6666667 17.3670875,23.3804569 16.8326829,24.2155694 L16.8326829,23.2726497 C16.8326829,22.9765729 16.6163312,22.7474435 16.3364952,22.7474435 C16.0692929,22.7474435 15.8529412,22.9765729 15.8529412,23.2726497 L15.8529412,31.4747937 L15.8529412,31.4747937 Z M19.1737034,28.9968008 C17.9523426,28.9968008 16.794466,27.9193579 16.794466,26.3031936 L16.794466,26.2761632 C16.794466,24.6870292 17.9523426,23.5960712 19.1737034,23.5960712 C20.4206474,23.5960712 21.4894566,24.6464837 21.4894566,26.2896784 L21.4894566,26.3163945 C21.4894566,27.9998204 20.4462306,28.9968008 19.1737034,28.9968008 L19.1737034,28.9968008 Z M23.7723622,29.319908 C23.7723622,29.616299 23.9887139,29.8451142 24.2685499,29.8451142 C24.5487017,29.8451142 24.7521039,29.6027839 24.7521039,29.319908 L24.7521039,26.9494079 C24.7521039,24.9428748 25.7956457,23.9326935 27.0678571,23.7711399 C27.3224257,23.7305944 27.5005605,23.5288096 27.5005605,23.2459337 C27.5005605,22.9495426 27.309792,22.7207274 27.0170065,22.7207274 C26.1901323,22.7207274 25.2356579,23.4210024 24.7521039,24.5792221 L24.7521039,23.2726497 C24.7521039,22.9765729 24.536068,22.7474435 24.2559162,22.7474435 C23.9887139,22.7474435 23.7723622,22.9900881 23.7723622,23.2726497 L23.7723622,29.319908 L23.7723622,29.319908 Z M31.1194776,29.9394062 C33.1042284,29.9394062 34.5675241,28.2694954 34.5675241,26.3031936 L34.5675241,26.2761632 C34.5675241,24.3098614 33.116862,22.6666667 31.1450608,22.6666667 C29.1599941,22.6666667 27.7093321,24.3368917 27.7093321,26.3031936 L27.7093321,26.3299096 C27.7093321,28.2962115 29.1473604,29.9394062 31.1194776,29.9394062 L31.1194776,29.9394062 Z M31.1450608,29.0100017 C29.7578829,29.0100017 28.714657,27.7980356 28.714657,26.3031936 L28.714657,26.2761632 C28.714657,24.8080373 29.6943987,23.582556 31.1194776,23.582556 C32.5063396,23.582556 33.562515,24.8080373 33.562515,26.3031936 L33.562515,26.3299096 C33.562515,27.7980356 32.5698238,29.0100017 31.1450608,29.0100017 L31.1450608,29.0100017 Z M38.8099131,29.9394062 C40.7949798,29.9394062 42.2579597,28.2694954 42.2579597,26.3031936 L42.2579597,26.2761632 C42.2579597,24.3098614 40.8076135,22.6666667 38.8354963,22.6666667 C36.8504297,22.6666667 35.4000835,24.3368917 35.4000835,26.3031936 L35.4000835,26.3299096 C35.4000835,28.2962115 36.837796,29.9394062 38.8099131,29.9394062 L38.8099131,29.9394062 Z M38.8354963,29.0100017 C37.4483185,29.0100017 36.4050926,27.7980356 36.4050926,26.3031936 L36.4050926,26.2761632 C36.4050926,24.8080373 37.3848343,23.582556 38.8099131,23.582556 C40.1967751,23.582556 41.2529506,24.8080373 41.2529506,26.3031936 L41.2529506,26.3299096 C41.2529506,27.7980356 40.2605752,29.0100017 38.8354963,29.0100017 L38.8354963,29.0100017 Z M46.3477971,29.4412303 L48.8290514,23.5152944 C48.8543188,23.4477185 48.879902,23.3537408 48.879902,23.2594488 C48.879902,22.9765729 48.6635502,22.7474435 48.3963479,22.7474435 C48.1417793,22.7474435 48.0018613,22.9225122 47.9383771,23.1246113 L45.7751756,28.5926026 L43.6505068,23.1516417 C43.5740731,22.9225122 43.4341551,22.7474435 43.1543191,22.7474435 C42.8741673,22.7474435 42.6578156,22.9900881 42.6578156,23.2594488 C42.6578156,23.3537408 42.6960325,23.4477185 42.7216157,23.5423247 L45.1899205,29.4412303 C45.3045711,29.7102767 45.482706,29.8853455 45.7499083,29.8853455 L45.8007588,29.8853455 C46.0679611,29.8853455 46.2331464,29.7102767 46.3477971,29.4412303 L46.3477971,29.4412303 Z" id="svg-proov" fill="#FFF"/></g></g></g></g></g></svg>'},function(e,t){e.exports='<svg width="1653" height="1221" viewBox="0 0 1653 1221" version="1.1" xmlns="http://www.w3.org/2000/svg"><g id="svg-ui" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="svg-layout" transform="translate(0 .5)"><path id="svg-mask" d="M1653,85 L1653,1220 L0,1220 L0,85 L1653,85 Z M826.5,224 C651.149592,224 509,415.845985 509,652.5 C509,889.154015 651.149592,1081 826.5,1081 C1001.85041,1081 1144,889.154015 1144,652.5 C1144,415.845985 1001.85041,224 826.5,224 Z" fill-opacity=".2" fill="#E02020" fill-rule="nonzero"/><g id="svg-top"><rect id="svg-bar" fill="#615A52" fill-rule="nonzero" x="0" y="0" width="1653" height="85"/><g id="svg-logo" transform="translate(20 13)" fill-rule="nonzero"><g id="svg-iproov"><path d="M12.1323529,14.75 C17.651352,14.75 20.5863741,16.6003632 21.8382353,19.1899285 L21.8382353,54.0833333 C19.7445207,54.0833333 13.2548242,53.1790781 12.1323529,47.5484094 L12.1323529,14.75" id="svg-i" fill="#FFF"/><path d="M16.9852941,0 C19.665358,0 21.8382353,2.20128616 21.8382353,4.91639012 C21.8382353,7.63149408 19.665358,9.83333333 16.9852941,9.83333333 C14.3046842,9.83333333 12.1323529,7.63149408 12.1323529,4.91639012 C12.1323529,2.20128616 14.3046842,0 16.9852941,0" id="svg-dot" fill="#FFF"/><path d="M17.0552032,35.4097196 L45.0306943,14.775296 C53.2322957,9.31870081 47.2962663,8.42889631 40.0366356,7.71039108 C32.7118625,6.98534316 24.0271697,6.45479128 24.9455046,6.39531237 L47.7378511,4.91666667 C54.6095098,4.91666667 58.967133,10.838387 52.9792203,16.6708889 L18.4929479,46.7083333 L0,29.6646516 L17.0552032,35.4097196" id="svg-tick" fill="#979797"/><path d="M29.1176471,58.031651 C29.1176471,58.5775425 29.5150278,59 30.0290122,59 C30.5429966,59 30.9171727,58.5775425 30.9171727,58.031651 L30.9171727,52.4446652 C31.8517425,53.8847295 33.300877,55.1758615 35.5441927,55.1758615 C38.4656663,55.1758615 41.3169456,52.6926924 41.3169456,48.4965132 L41.3169456,48.4466759 C41.3169456,44.2255781 38.4424616,41.7916667 35.5441927,41.7916667 C33.3240817,41.7916667 31.8987321,43.1077173 30.9171727,44.6474561 L30.9171727,42.9089479 C30.9171727,42.3630564 30.5197919,41.9405989 30.0058075,41.9405989 C29.5150278,41.9405989 29.1176471,42.3630564 29.1176471,42.9089479 L29.1176471,58.031651 L29.1176471,58.031651 Z M35.2170063,53.4628515 C32.9736905,53.4628515 30.8469784,51.4763162 30.8469784,48.4965132 L30.8469784,48.4466759 C30.8469784,45.5167102 32.9736905,43.5052562 35.2170063,43.5052562 C37.5073116,43.5052562 39.4704304,45.4419543 39.4704304,48.4715945 L39.4704304,48.5208523 C39.4704304,51.6246689 37.5543011,53.4628515 35.2170063,53.4628515 L35.2170063,53.4628515 Z M43.6635224,54.0585803 C43.6635224,54.6050514 44.0609031,55.0269293 44.5748875,55.0269293 C45.0894521,55.0269293 45.463048,54.5801327 45.463048,54.0585803 L45.463048,49.6879708 C45.463048,45.9884254 47.3797574,44.1259036 49.7164721,43.8280392 C50.1840471,43.7532834 50.5112336,43.3812426 50.5112336,42.8596902 C50.5112336,42.3132191 50.1608424,41.8913411 49.6230732,41.8913411 C48.1043246,41.8913411 46.3512084,43.1824732 45.463048,45.3179407 L45.463048,42.9089479 C45.463048,42.3630564 45.0662474,41.9405989 44.5516828,41.9405989 C44.0609031,41.9405989 43.6635224,42.387975 43.6635224,42.9089479 L43.6635224,54.0585803 L43.6635224,54.0585803 Z M57.1582241,55.2007802 C60.8036847,55.2007802 63.4913708,52.1218822 63.4913708,48.4965132 L63.4913708,48.4466759 C63.4913708,44.8213069 60.8268895,41.7916667 57.2052136,41.7916667 C53.5591729,41.7916667 50.8946915,44.8711441 50.8946915,48.4965132 L50.8946915,48.5457709 C50.8946915,52.1711399 53.5359682,55.2007802 57.1582241,55.2007802 L57.1582241,55.2007802 Z M57.2052136,53.4871906 C54.657336,53.4871906 52.7412067,51.2526281 52.7412067,48.4965132 L52.7412067,48.4466759 C52.7412067,45.7398187 54.5407323,43.4803376 57.1582241,43.4803376 C59.7055216,43.4803376 61.6454358,45.7398187 61.6454358,48.4965132 L61.6454358,48.5457709 C61.6454358,51.2526281 59.8221253,53.4871906 57.2052136,53.4871906 L57.2052136,53.4871906 Z M71.2835139,55.2007802 C74.9295547,55.2007802 77.6166606,52.1218822 77.6166606,48.4965132 L77.6166606,48.4466759 C77.6166606,44.8213069 74.9527594,41.7916667 71.3305035,41.7916667 C67.6844627,41.7916667 65.0205615,44.8711441 65.0205615,48.4965132 L65.0205615,48.5457709 C65.0205615,52.1711399 67.661258,55.2007802 71.2835139,55.2007802 L71.2835139,55.2007802 Z M71.3305035,53.4871906 C68.7826258,53.4871906 66.8664965,51.2526281 66.8664965,48.4965132 L66.8664965,48.4466759 C66.8664965,45.7398187 68.6660221,43.4803376 71.2835139,43.4803376 C73.8308115,43.4803376 75.7707256,45.7398187 75.7707256,48.4965132 L75.7707256,48.5457709 C75.7707256,51.2526281 73.9479953,53.4871906 71.3305035,53.4871906 L71.3305035,53.4871906 Z M85.1286069,54.2822683 L89.6860128,43.356324 C89.7324222,43.2317309 89.7794118,43.0584596 89.7794118,42.8846088 C89.7794118,42.3630564 89.382031,41.9405989 88.8912513,41.9405989 C88.4236763,41.9405989 88.1666841,42.2633819 88.0500804,42.6360021 L84.0768532,52.717611 L80.1744003,42.6858394 C80.0340118,42.2633819 79.7770196,41.9405989 79.2630351,41.9405989 C78.7484706,41.9405989 78.3510899,42.387975 78.3510899,42.8846088 C78.3510899,43.0584596 78.4212841,43.2317309 78.4682737,43.4061613 L83.0018948,54.2822683 C83.2124776,54.7783227 83.539664,55.1011057 84.0304437,55.1011057 L84.1238427,55.1011057 C84.6146224,55.1011057 84.9180241,54.7783227 85.1286069,54.2822683 L85.1286069,54.2822683 Z" id="svg-proov" fill="#FFF"/></g></g><g id="svg-exit" transform="translate(1587 18)" fill="#C29339" fill-rule="nonzero"><g id="svg-cross"><path d="M49,24.5 C49,10.9680233 38.0319767,0 24.5,0 C10.9680233,0 0,10.9680233 0,24.5 C0,38.0319767 10.9680233,49 24.5,49 C38.0319767,49 49,38.0319767 49,24.5 Z M44.1,24.5 C44.1,35.3072621 35.3072621,44.1 24.5,44.1 C13.6927379,44.1 4.9,35.3072621 4.9,24.5 C4.9,13.6927379 13.6927379,4.9 24.5,4.9 C35.3072621,4.9 44.1,13.6927379 44.1,24.5 L44.1,24.5 Z" id="svg-o"/><path d="M34.3,30.4731648 C34.3,30.0604091 34.1290013,29.6476533 33.8341756,29.3469314 L28.9872443,24.5 L33.8341756,19.6471721 C34.1290013,19.3523467 34.3,18.9395909 34.3,18.5327317 C34.3,18.1199759 34.1290013,17.7013237 33.8341756,17.4064982 L31.5935018,15.1658243 C31.2927798,14.8651023 30.8859206,14.7 30.4731648,14.7 C30.0604091,14.7 29.6476533,14.8651023 29.3469314,15.1658243 L24.5,20.0127557 L19.6530686,15.1658243 C19.3523467,14.8651023 18.9454874,14.7 18.5268352,14.7 C18.1140794,14.7 17.7072202,14.8651023 17.4064982,15.1658243 L15.1658243,17.4064982 C14.8651023,17.7013237 14.7,18.1199759 14.7,18.5327317 C14.7,18.9395909 14.8651023,19.3523467 15.1658243,19.6471721 L20.0127557,24.5 L15.1658243,29.3469314 C14.8651023,29.6476533 14.7,30.0604091 14.7,30.4731648 C14.7,30.8859206 14.8651023,31.2986763 15.1658243,31.5993983 L17.4064982,33.8400723 C17.7072202,34.1348978 18.1140794,34.3 18.5268352,34.3 C18.9454874,34.3 19.3523467,34.1348978 19.6530686,33.8400723 L24.5,28.9872443 L29.3469314,33.8400723 C29.6476533,34.1348978 30.0604091,34.3 30.4731648,34.3 C30.8859206,34.3 31.2927798,34.1348978 31.5935018,33.8400723 L33.8341756,31.5993983 C34.1290013,31.2986763 34.3,30.8859206 34.3,30.4731648" id="svg-x"/></g></g><text id="svg-info" text-anchor="middle" font-family="GothamRounded-Book, Gotham Rounded" font-size="30" font-weight="300" fill="#FFF"><tspan x="50%" y="50" id="svg-info-text" tabindex="2">Connecting…</tspan></text></g><g id="svg-feedback" text-anchor="middle" font-family="GothamRounded-Medium, Gotham Rounded" font-size="80" font-weight="400" letter-spacing="-1.929" fill="#FFF" stroke="#615A52" stroke-width="2"><text id="svg-top-text"><tspan x="50%" y="194">Put your face in the oval</tspan></text><text id="svg-bottom-text"><tspan x="50%" y="1179.5">Put your face in the oval</tspan></text></g><g id="svg-countdown" transform="translate(654 440.5)"><g id="svg-number-1"><circle fill="#1A7919" fill-rule="nonzero" cx="172.5" cy="194.5" r="172.5"/><text transform="translate(113)" fill="#FFF" font-family="GothamRounded-Book, Gotham Rounded" font-size="320" font-weight="300"><tspan x="-.001" y="307">1</tspan></text></g><g id="svg-number-2"><circle fill="#1A7919" fill-rule="nonzero" cx="172.5" cy="194.5" r="172.5"/><text transform="translate(78)" fill="#FFF" font-family="GothamRounded-Book, Gotham Rounded" font-size="320" font-weight="300"><tspan x=".279" y="307">2</tspan></text></g><g id="svg-number-3"><circle fill="#1A7919" fill-rule="nonzero" cx="172.5" cy="191.5" r="172.5"/><text transform="translate(77)" fill="#FFF" font-family="GothamRounded-Book, Gotham Rounded" font-size="320" font-weight="300"><tspan x=".479" y="307">3</tspan></text></g></g></g></g></svg>'},function(e,t,n){n(178),e.exports=n(413)},function(e,t,n){"use strict";n(179);var r=function(e){return e&&e.__esModule?e:{default:e}}(n(351));r.default._babelPolyfill&&"undefined"!=typeof console&&console.warn&&console.warn("@babel/polyfill is loaded more than once on this page. This is probably not desirable/intended and may have consequences if different versions of the polyfills are applied sequentially. If you do need to load the polyfill more than once, use @babel/polyfill/noConflict instead to bypass the warning."),r.default._babelPolyfill=!0},function(e,t,n){"use strict";n(180),n(323),n(325),n(328),n(330),n(332),n(334),n(336),n(338),n(340),n(342),n(344),n(346),n(350)},function(e,t,n){n(181),n(184),n(185),n(186),n(187),n(188),n(189),n(190),n(191),n(192),n(193),n(194),n(195),n(196),n(197),n(198),n(199),n(200),n(201),n(202),n(203),n(204),n(205),n(206),n(207),n(208),n(209),n(210),n(211),n(212),n(213),n(214),n(215),n(216),n(217),n(218),n(219),n(220),n(221),n(222),n(223),n(224),n(225),n(227),n(228),n(229),n(230),n(231),n(232),n(233),n(234),n(235),n(236),n(237),n(238),n(239),n(240),n(241),n(242),n(243),n(244),n(245),n(246),n(247),n(248),n(249),n(250),n(251),n(252),n(253),n(254),n(255),n(256),n(257),n(258),n(259),n(260),n(262),n(263),n(265),n(266),n(267),n(268),n(269),n(270),n(271),n(273),n(274),n(275),n(276),n(277),n(278),n(279),n(280),n(281),n(282),n(283),n(284),n(285),n(93),n(286),n(125),n(287),n(126),n(288),n(289),n(290),n(291),n(127),n(294),n(295),n(296),n(297),n(298),n(299),n(300),n(301),n(302),n(303),n(304),n(305),n(306),n(307),n(308),n(309),n(310),n(311),n(312),n(313),n(314),n(315),n(316),n(317),n(318),n(319),n(320),n(321),n(322),e.exports=n(7)},function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=n(1),o=n(15),a=n(8),s=n(0),c=n(12),u=n(29).KEY,l=n(2),h=n(57),f=n(41),d=n(32),p=n(5),m=n(74),v=n(106),g=n(183),y=n(60),b=n(3),_=n(4),w=n(10),x=n(17),S=n(28),E=n(31),M=n(36),C=n(109),T=n(22),A=n(59),P=n(9),L=n(34),R=T.f,k=P.f,N=C.f,O=i.Symbol,D=i.JSON,F=D&&D.stringify,I=p("_hidden"),U=p("toPrimitive"),B={}.propertyIsEnumerable,j=h("symbol-registry"),z=h("symbols"),V=h("op-symbols"),G=Object.prototype,W="function"==typeof O&&!!A.f,H=i.QObject,q=!H||!H.prototype||!H.prototype.findChild,X=a&&l((function(){return 7!=M(k({},"a",{get:function(){return k(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=R(G,t);r&&delete G[t],k(e,t,n),r&&e!==G&&k(G,t,r)}:k,Y=function(e){var t=z[e]=M(O.prototype);return t._k=e,t},Z=W&&"symbol"==r(O.iterator)?function(e){return"symbol"==r(e)}:function(e){return e instanceof O},J=function(e,t,n){return e===G&&J(V,t,n),b(e),t=S(t,!0),b(n),o(z,t)?(n.enumerable?(o(e,I)&&e[I][t]&&(e[I][t]=!1),n=M(n,{enumerable:E(0,!1)})):(o(e,I)||k(e,I,E(1,{})),e[I][t]=!0),X(e,t,n)):k(e,t,n)},K=function(e,t){b(e);for(var n,r=g(t=x(t)),i=0,o=r.length;o>i;)J(e,n=r[i++],t[n]);return e},$=function(e){var t=B.call(this,e=S(e,!0));return!(this===G&&o(z,e)&&!o(V,e))&&(!(t||!o(this,e)||!o(z,e)||o(this,I)&&this[I][e])||t)},Q=function(e,t){if(e=x(e),t=S(t,!0),e!==G||!o(z,t)||o(V,t)){var n=R(e,t);return!n||!o(z,t)||o(e,I)&&e[I][t]||(n.enumerable=!0),n}},ee=function(e){for(var t,n=N(x(e)),r=[],i=0;n.length>i;)o(z,t=n[i++])||t==I||t==u||r.push(t);return r},te=function(e){for(var t,n=e===G,r=N(n?V:x(e)),i=[],a=0;r.length>a;)!o(z,t=r[a++])||n&&!o(G,t)||i.push(z[t]);return i};W||(c((O=function(){if(this instanceof O)throw TypeError("Symbol is not a constructor!");var e=d(arguments.length>0?arguments[0]:void 0);return a&&q&&X(G,e,{configurable:!0,set:function t(n){this===G&&t.call(V,n),o(this,I)&&o(this[I],e)&&(this[I][e]=!1),X(this,e,E(1,n))}}),Y(e)}).prototype,"toString",(function(){return this._k})),T.f=Q,P.f=J,n(37).f=C.f=ee,n(51).f=$,A.f=te,a&&!n(33)&&c(G,"propertyIsEnumerable",$,!0),m.f=function(e){return Y(p(e))}),s(s.G+s.W+s.F*!W,{Symbol:O});for(var ne="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),re=0;ne.length>re;)p(ne[re++]);for(var ie=L(p.store),oe=0;ie.length>oe;)v(ie[oe++]);s(s.S+s.F*!W,"Symbol",{for:function(e){return o(j,e+="")?j[e]:j[e]=O(e)},keyFor:function(e){if(!Z(e))throw TypeError(e+" is not a symbol!");for(var t in j)if(j[t]===e)return t},useSetter:function(){q=!0},useSimple:function(){q=!1}}),s(s.S+s.F*!W,"Object",{create:function(e,t){return void 0===t?M(e):K(M(e),t)},defineProperty:J,defineProperties:K,getOwnPropertyDescriptor:Q,getOwnPropertyNames:ee,getOwnPropertySymbols:te});var ae=l((function(){A.f(1)}));s(s.S+s.F*ae,"Object",{getOwnPropertySymbols:function(e){return A.f(w(e))}}),D&&s(s.S+s.F*(!W||l((function(){var e=O();return"[null]"!=F([e])||"{}"!=F({a:e})||"{}"!=F(Object(e))}))),"JSON",{stringify:function(e){for(var t,n,r=[e],i=1;arguments.length>i;)r.push(arguments[i++]);if(n=t=r[1],(_(t)||void 0!==e)&&!Z(e))return y(t)||(t=function(e,t){if("function"==typeof n&&(t=n.call(this,e,t)),!Z(t))return t}),r[1]=t,F.apply(D,r)}}),O.prototype[U]||n(16)(O.prototype,U,O.prototype.valueOf),f(O,"Symbol"),f(Math,"Math",!0),f(i.JSON,"JSON",!0)},function(e,t,n){e.exports=n(57)("native-function-to-string",Function.toString)},function(e,t,n){var r=n(34),i=n(59),o=n(51);e.exports=function(e){var t=r(e),n=i.f;if(n)for(var a,s=n(e),c=o.f,u=0;s.length>u;)c.call(e,a=s[u++])&&t.push(a);return t}},function(e,t,n){var r=n(0);r(r.S,"Object",{create:n(36)})},function(e,t,n){var r=n(0);r(r.S+r.F*!n(8),"Object",{defineProperty:n(9).f})},function(e,t,n){var r=n(0);r(r.S+r.F*!n(8),"Object",{defineProperties:n(108)})},function(e,t,n){var r=n(17),i=n(22).f;n(23)("getOwnPropertyDescriptor",(function(){return function(e,t){return i(r(e),t)}}))},function(e,t,n){var r=n(10),i=n(38);n(23)("getPrototypeOf",(function(){return function(e){return i(r(e))}}))},function(e,t,n){var r=n(10),i=n(34);n(23)("keys",(function(){return function(e){return i(r(e))}}))},function(e,t,n){n(23)("getOwnPropertyNames",(function(){return n(109).f}))},function(e,t,n){var r=n(4),i=n(29).onFreeze;n(23)("freeze",(function(e){return function(t){return e&&r(t)?e(i(t)):t}}))},function(e,t,n){var r=n(4),i=n(29).onFreeze;n(23)("seal",(function(e){return function(t){return e&&r(t)?e(i(t)):t}}))},function(e,t,n){var r=n(4),i=n(29).onFreeze;n(23)("preventExtensions",(function(e){return function(t){return e&&r(t)?e(i(t)):t}}))},function(e,t,n){var r=n(4);n(23)("isFrozen",(function(e){return function(t){return!r(t)||!!e&&e(t)}}))},function(e,t,n){var r=n(4);n(23)("isSealed",(function(e){return function(t){return!r(t)||!!e&&e(t)}}))},function(e,t,n){var r=n(4);n(23)("isExtensible",(function(e){return function(t){return!!r(t)&&(!e||e(t))}}))},function(e,t,n){var r=n(0);r(r.S+r.F,"Object",{assign:n(110)})},function(e,t,n){var r=n(0);r(r.S,"Object",{is:n(111)})},function(e,t,n){var r=n(0);r(r.S,"Object",{setPrototypeOf:n(78).set})},function(e,t,n){"use strict";var r=n(52),i={};i[n(5)("toStringTag")]="z",i+""!="[object z]"&&n(12)(Object.prototype,"toString",(function(){return"[object "+r(this)+"]"}),!0)},function(e,t,n){var r=n(0);r(r.P,"Function",{bind:n(112)})},function(e,t,n){var r=n(9).f,i=Function.prototype,o=/^\s*function ([^ (]*)/;"name"in i||n(8)&&r(i,"name",{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(e){return""}}})},function(e,t,n){"use strict";var r=n(4),i=n(38),o=n(5)("hasInstance"),a=Function.prototype;o in a||n(9).f(a,o,{value:function(e){if("function"!=typeof this||!r(e))return!1;if(!r(this.prototype))return e instanceof this;for(;e=i(e);)if(this.prototype===e)return!0;return!1}})},function(e,t,n){var r=n(0),i=n(114);r(r.G+r.F*(parseInt!=i),{parseInt:i})},function(e,t,n){var r=n(0),i=n(115);r(r.G+r.F*(parseFloat!=i),{parseFloat:i})},function(e,t,n){"use strict";var r=n(1),i=n(15),o=n(25),a=n(80),s=n(28),c=n(2),u=n(37).f,l=n(22).f,h=n(9).f,f=n(42).trim,d=r.Number,p=d,m=d.prototype,v="Number"==o(n(36)(m)),g="trim"in String.prototype,y=function(e){var t=s(e,!1);if("string"==typeof t&&t.length>2){var n,r,i,o=(t=g?t.trim():f(t,3)).charCodeAt(0);if(43===o||45===o){if(88===(n=t.charCodeAt(2))||120===n)return NaN}else if(48===o){switch(t.charCodeAt(1)){case 66:case 98:r=2,i=49;break;case 79:case 111:r=8,i=55;break;default:return+t}for(var a,c=t.slice(2),u=0,l=c.length;u<l;u++)if((a=c.charCodeAt(u))<48||a>i)return NaN;return parseInt(c,r)}}return+t};if(!d(" 0o1")||!d("0b1")||d("+0x1")){d=function(e){var t=arguments.length<1?0:e,n=this;return n instanceof d&&(v?c((function(){m.valueOf.call(n)})):"Number"!=o(n))?a(new p(y(t)),n,d):y(t)};for(var b,_=n(8)?u(p):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),w=0;_.length>w;w++)i(p,b=_[w])&&!i(d,b)&&h(d,b,l(p,b));d.prototype=m,m.constructor=d,n(12)(r,"Number",d)}},function(e,t,n){"use strict";var r=n(0),i=n(21),o=n(116),a=n(81),s=1..toFixed,c=Math.floor,u=[0,0,0,0,0,0],l="Number.toFixed: incorrect invocation!",h=function(e,t){for(var n=-1,r=t;++n<6;)r+=e*u[n],u[n]=r%1e7,r=c(r/1e7)},f=function(e){for(var t=6,n=0;--t>=0;)n+=u[t],u[t]=c(n/e),n=n%e*1e7},d=function(){for(var e=6,t="";--e>=0;)if(""!==t||0===e||0!==u[e]){var n=String(u[e]);t=""===t?n:t+a.call("0",7-n.length)+n}return t},p=function e(t,n,r){return 0===n?r:n%2==1?e(t,n-1,r*t):e(t*t,n/2,r)};r(r.P+r.F*(!!s&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!n(2)((function(){s.call({})}))),"Number",{toFixed:function(e){var t,n,r,s,c=o(this,l),u=i(e),m="",v="0";if(u<0||u>20)throw RangeError(l);if(c!=c)return"NaN";if(c<=-1e21||c>=1e21)return String(c);if(c<0&&(m="-",c=-c),c>1e-21)if(n=(t=function(e){for(var t=0,n=e;n>=4096;)t+=12,n/=4096;for(;n>=2;)t+=1,n/=2;return t}(c*p(2,69,1))-69)<0?c*p(2,-t,1):c/p(2,t,1),n*=4503599627370496,(t=52-t)>0){for(h(0,n),r=u;r>=7;)h(1e7,0),r-=7;for(h(p(10,r,1),0),r=t-1;r>=23;)f(1<<23),r-=23;f(1<<r),h(1,1),f(2),v=d()}else h(0,n),h(1<<-t,0),v=d()+a.call("0",u);return u>0?m+((s=v.length)<=u?"0."+a.call("0",u-s)+v:v.slice(0,s-u)+"."+v.slice(s-u)):m+v}})},function(e,t,n){"use strict";var r=n(0),i=n(2),o=n(116),a=1..toPrecision;r(r.P+r.F*(i((function(){return"1"!==a.call(1,void 0)}))||!i((function(){a.call({})}))),"Number",{toPrecision:function(e){var t=o(this,"Number#toPrecision: incorrect invocation!");return void 0===e?a.call(t):a.call(t,e)}})},function(e,t,n){var r=n(0);r(r.S,"Number",{EPSILON:Math.pow(2,-52)})},function(e,t,n){var r=n(0),i=n(1).isFinite;r(r.S,"Number",{isFinite:function(e){return"number"==typeof e&&i(e)}})},function(e,t,n){var r=n(0);r(r.S,"Number",{isInteger:n(117)})},function(e,t,n){var r=n(0);r(r.S,"Number",{isNaN:function(e){return e!=e}})},function(e,t,n){var r=n(0),i=n(117),o=Math.abs;r(r.S,"Number",{isSafeInteger:function(e){return i(e)&&o(e)<=9007199254740991}})},function(e,t,n){var r=n(0);r(r.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(e,t,n){var r=n(0);r(r.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(e,t,n){var r=n(0),i=n(115);r(r.S+r.F*(Number.parseFloat!=i),"Number",{parseFloat:i})},function(e,t,n){var r=n(0),i=n(114);r(r.S+r.F*(Number.parseInt!=i),"Number",{parseInt:i})},function(e,t,n){var r=n(0),i=n(118),o=Math.sqrt,a=Math.acosh;r(r.S+r.F*!(a&&710==Math.floor(a(Number.MAX_VALUE))&&a(1/0)==1/0),"Math",{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?Math.log(e)+Math.LN2:i(e-1+o(e-1)*o(e+1))}})},function(e,t,n){var r=n(0),i=Math.asinh;r(r.S+r.F*!(i&&1/i(0)>0),"Math",{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):Math.log(t+Math.sqrt(t*t+1)):t}})},function(e,t,n){var r=n(0),i=Math.atanh;r(r.S+r.F*!(i&&1/i(-0)<0),"Math",{atanh:function(e){return 0==(e=+e)?e:Math.log((1+e)/(1-e))/2}})},function(e,t,n){var r=n(0),i=n(82);r(r.S,"Math",{cbrt:function(e){return i(e=+e)*Math.pow(Math.abs(e),1/3)}})},function(e,t,n){var r=n(0);r(r.S,"Math",{clz32:function(e){return(e>>>=0)?31-Math.floor(Math.log(e+.5)*Math.LOG2E):32}})},function(e,t,n){var r=n(0),i=Math.exp;r(r.S,"Math",{cosh:function(e){return(i(e=+e)+i(-e))/2}})},function(e,t,n){var r=n(0),i=n(83);r(r.S+r.F*(i!=Math.expm1),"Math",{expm1:i})},function(e,t,n){var r=n(0);r(r.S,"Math",{fround:n(226)})},function(e,t,n){var r=n(82),i=Math.pow,o=i(2,-52),a=i(2,-23),s=i(2,127)*(2-a),c=i(2,-126);e.exports=Math.fround||function(e){var t,n,i=Math.abs(e),u=r(e);return i<c?u*function(e){return e+1/o-1/o}(i/c/a)*c*a:(n=(t=(1+a/o)*i)-(t-i))>s||n!=n?u*(1/0):u*n}},function(e,t,n){var r=n(0),i=Math.abs;r(r.S,"Math",{hypot:function(e,t){for(var n,r,o=0,a=0,s=arguments.length,c=0;a<s;)c<(n=i(arguments[a++]))?(o=o*(r=c/n)*r+1,c=n):o+=n>0?(r=n/c)*r:n;return c===1/0?1/0:c*Math.sqrt(o)}})},function(e,t,n){var r=n(0),i=Math.imul;r(r.S+r.F*n(2)((function(){return-5!=i(4294967295,5)||2!=i.length})),"Math",{imul:function(e,t){var n=+e,r=+t,i=65535&n,o=65535&r;return 0|i*o+((65535&n>>>16)*o+i*(65535&r>>>16)<<16>>>0)}})},function(e,t,n){var r=n(0);r(r.S,"Math",{log10:function(e){return Math.log(e)*Math.LOG10E}})},function(e,t,n){var r=n(0);r(r.S,"Math",{log1p:n(118)})},function(e,t,n){var r=n(0);r(r.S,"Math",{log2:function(e){return Math.log(e)/Math.LN2}})},function(e,t,n){var r=n(0);r(r.S,"Math",{sign:n(82)})},function(e,t,n){var r=n(0),i=n(83),o=Math.exp;r(r.S+r.F*n(2)((function(){return-2e-17!=!Math.sinh(-2e-17)})),"Math",{sinh:function(e){return Math.abs(e=+e)<1?(i(e)-i(-e))/2:(o(e-1)-o(-e-1))*(Math.E/2)}})},function(e,t,n){var r=n(0),i=n(83),o=Math.exp;r(r.S,"Math",{tanh:function(e){var t=i(e=+e),n=i(-e);return t==1/0?1:n==1/0?-1:(t-n)/(o(e)+o(-e))}})},function(e,t,n){var r=n(0);r(r.S,"Math",{trunc:function(e){return(e>0?Math.floor:Math.ceil)(e)}})},function(e,t,n){var r=n(0),i=n(35),o=String.fromCharCode,a=String.fromCodePoint;r(r.S+r.F*(!!a&&1!=a.length),"String",{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,a=0;r>a;){if(t=+arguments[a++],i(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?o(t):o(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}})},function(e,t,n){var r=n(0),i=n(17),o=n(6);r(r.S,"String",{raw:function(e){for(var t=i(e.raw),n=o(t.length),r=arguments.length,a=[],s=0;n>s;)a.push(String(t[s++])),s<r&&a.push(String(arguments[s]));return a.join("")}})},function(e,t,n){"use strict";n(42)("trim",(function(e){return function(){return e(this,3)}}))},function(e,t,n){"use strict";var r=n(84)(!0);n(85)(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=r(t,n),this._i+=e.length,{value:e,done:!1})}))},function(e,t,n){"use strict";var r=n(0),i=n(84)(!1);r(r.P,"String",{codePointAt:function(e){return i(this,e)}})},function(e,t,n){"use strict";var r=n(0),i=n(6),o=n(86),a="".endsWith;r(r.P+r.F*n(88)("endsWith"),"String",{endsWith:function(e){var t=o(this,e,"endsWith"),n=arguments.length>1?arguments[1]:void 0,r=i(t.length),s=void 0===n?r:Math.min(i(n),r),c=String(e);return a?a.call(t,c,s):t.slice(s-c.length,s)===c}})},function(e,t,n){"use strict";var r=n(0),i=n(86);r(r.P+r.F*n(88)("includes"),"String",{includes:function(e){return!!~i(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},function(e,t,n){var r=n(0);r(r.P,"String",{repeat:n(81)})},function(e,t,n){"use strict";var r=n(0),i=n(6),o=n(86),a="".startsWith;r(r.P+r.F*n(88)("startsWith"),"String",{startsWith:function(e){var t=o(this,e,"startsWith"),n=i(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),r=String(e);return a?a.call(t,r,n):t.slice(n,n+r.length)===r}})},function(e,t,n){"use strict";n(13)("anchor",(function(e){return function(t){return e(this,"a","name",t)}}))},function(e,t,n){"use strict";n(13)("big",(function(e){return function(){return e(this,"big","","")}}))},function(e,t,n){"use strict";n(13)("blink",(function(e){return function(){return e(this,"blink","","")}}))},function(e,t,n){"use strict";n(13)("bold",(function(e){return function(){return e(this,"b","","")}}))},function(e,t,n){"use strict";n(13)("fixed",(function(e){return function(){return e(this,"tt","","")}}))},function(e,t,n){"use strict";n(13)("fontcolor",(function(e){return function(t){return e(this,"font","color",t)}}))},function(e,t,n){"use strict";n(13)("fontsize",(function(e){return function(t){return e(this,"font","size",t)}}))},function(e,t,n){"use strict";n(13)("italics",(function(e){return function(){return e(this,"i","","")}}))},function(e,t,n){"use strict";n(13)("link",(function(e){return function(t){return e(this,"a","href",t)}}))},function(e,t,n){"use strict";n(13)("small",(function(e){return function(){return e(this,"small","","")}}))},function(e,t,n){"use strict";n(13)("strike",(function(e){return function(){return e(this,"strike","","")}}))},function(e,t,n){"use strict";n(13)("sub",(function(e){return function(){return e(this,"sub","","")}}))},function(e,t,n){"use strict";n(13)("sup",(function(e){return function(){return e(this,"sup","","")}}))},function(e,t,n){var r=n(0);r(r.S,"Date",{now:function(){return(new Date).getTime()}})},function(e,t,n){"use strict";var r=n(0),i=n(10),o=n(28);r(r.P+r.F*n(2)((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})})),"Date",{toJSON:function(e){var t=i(this),n=o(t);return"number"!=typeof n||isFinite(n)?t.toISOString():null}})},function(e,t,n){var r=n(0),i=n(261);r(r.P+r.F*(Date.prototype.toISOString!==i),"Date",{toISOString:i})},function(e,t,n){"use strict";var r=n(2),i=Date.prototype.getTime,o=Date.prototype.toISOString,a=function(e){return e>9?e:"0"+e};e.exports=r((function(){return"0385-07-25T07:06:39.999Z"!=o.call(new Date(-50000000000001))}))||!r((function(){o.call(new Date(NaN))}))?function(){if(!isFinite(i.call(this)))throw RangeError("Invalid time value");var e=this,t=e.getUTCFullYear(),n=e.getUTCMilliseconds(),r=t<0?"-":t>9999?"+":"";return r+("00000"+Math.abs(t)).slice(r?-6:-4)+"-"+a(e.getUTCMonth()+1)+"-"+a(e.getUTCDate())+"T"+a(e.getUTCHours())+":"+a(e.getUTCMinutes())+":"+a(e.getUTCSeconds())+"."+(n>99?n:"0"+a(n))+"Z"}:o},function(e,t,n){var r=Date.prototype,i=r.toString,o=r.getTime;new Date(NaN)+""!="Invalid Date"&&n(12)(r,"toString",(function(){var e=o.call(this);return e==e?i.call(this):"Invalid Date"}))},function(e,t,n){var r=n(5)("toPrimitive"),i=Date.prototype;r in i||n(16)(i,r,n(264))},function(e,t,n){"use strict";var r=n(3),i=n(28);e.exports=function(e){if("string"!==e&&"number"!==e&&"default"!==e)throw TypeError("Incorrect hint");return i(r(this),"number"!=e)}},function(e,t,n){var r=n(0);r(r.S,"Array",{isArray:n(60)})},function(e,t,n){"use strict";var r=n(19),i=n(0),o=n(10),a=n(120),s=n(89),c=n(6),u=n(90),l=n(91);i(i.S+i.F*!n(61)((function(e){Array.from(e)})),"Array",{from:function(e){var t,n,i,h,f=o(e),d="function"==typeof this?this:Array,p=arguments.length,m=p>1?arguments[1]:void 0,v=void 0!==m,g=0,y=l(f);if(v&&(m=r(m,p>2?arguments[2]:void 0,2)),null==y||d==Array&&s(y))for(n=new d(t=c(f.length));t>g;g++)u(n,g,v?m(f[g],g):f[g]);else for(h=y.call(f),n=new d;!(i=h.next()).done;g++)u(n,g,v?a(h,m,[i.value,g],!0):i.value);return n.length=g,n}})},function(e,t,n){"use strict";var r=n(0),i=n(90);r(r.S+r.F*n(2)((function(){function e(){}return!(Array.of.call(e)instanceof e)})),"Array",{of:function(){for(var e=0,t=arguments.length,n=new("function"==typeof this?this:Array)(t);t>e;)i(n,e,arguments[e++]);return n.length=t,n}})},function(e,t,n){"use strict";var r=n(0),i=n(17),o=[].join;r(r.P+r.F*(n(50)!=Object||!n(18)(o)),"Array",{join:function(e){return o.call(i(this),void 0===e?",":e)}})},function(e,t,n){"use strict";var r=n(0),i=n(77),o=n(25),a=n(35),s=n(6),c=[].slice;r(r.P+r.F*n(2)((function(){i&&c.call(i)})),"Array",{slice:function(e,t){var n=s(this.length),r=o(this);if(t=void 0===t?n:t,"Array"==r)return c.call(this,e,t);for(var i=a(e,n),u=a(t,n),l=s(u-i),h=new Array(l),f=0;f<l;f++)h[f]="String"==r?this.charAt(i+f):this[i+f];return h}})},function(e,t,n){"use strict";var r=n(0),i=n(20),o=n(10),a=n(2),s=[].sort,c=[1,2,3];r(r.P+r.F*(a((function(){c.sort(void 0)}))||!a((function(){c.sort(null)}))||!n(18)(s)),"Array",{sort:function(e){return void 0===e?s.call(o(this)):s.call(o(this),i(e))}})},function(e,t,n){"use strict";var r=n(0),i=n(24)(0),o=n(18)([].forEach,!0);r(r.P+r.F*!o,"Array",{forEach:function(e){return i(this,e,arguments[1])}})},function(e,t,n){var r=n(4),i=n(60),o=n(5)("species");e.exports=function(e){var t;return i(e)&&("function"!=typeof(t=e.constructor)||t!==Array&&!i(t.prototype)||(t=void 0),r(t)&&null===(t=t[o])&&(t=void 0)),void 0===t?Array:t}},function(e,t,n){"use strict";var r=n(0),i=n(24)(1);r(r.P+r.F*!n(18)([].map,!0),"Array",{map:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(24)(2);r(r.P+r.F*!n(18)([].filter,!0),"Array",{filter:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(24)(3);r(r.P+r.F*!n(18)([].some,!0),"Array",{some:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(24)(4);r(r.P+r.F*!n(18)([].every,!0),"Array",{every:function(e){return i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(122);r(r.P+r.F*!n(18)([].reduce,!0),"Array",{reduce:function(e){return i(this,e,arguments.length,arguments[1],!1)}})},function(e,t,n){"use strict";var r=n(0),i=n(122);r(r.P+r.F*!n(18)([].reduceRight,!0),"Array",{reduceRight:function(e){return i(this,e,arguments.length,arguments[1],!0)}})},function(e,t,n){"use strict";var r=n(0),i=n(58)(!1),o=[].indexOf,a=!!o&&1/[1].indexOf(1,-0)<0;r(r.P+r.F*(a||!n(18)(o)),"Array",{indexOf:function(e){return a?o.apply(this,arguments)||0:i(this,e,arguments[1])}})},function(e,t,n){"use strict";var r=n(0),i=n(17),o=n(21),a=n(6),s=[].lastIndexOf,c=!!s&&1/[1].lastIndexOf(1,-0)<0;r(r.P+r.F*(c||!n(18)(s)),"Array",{lastIndexOf:function(e){if(c)return s.apply(this,arguments)||0;var t=i(this),n=a(t.length),r=n-1;for(arguments.length>1&&(r=Math.min(r,o(arguments[1]))),r<0&&(r=n+r);r>=0;r--)if(r in t&&t[r]===e)return r||0;return-1}})},function(e,t,n){var r=n(0);r(r.P,"Array",{copyWithin:n(123)}),n(39)("copyWithin")},function(e,t,n){var r=n(0);r(r.P,"Array",{fill:n(92)}),n(39)("fill")},function(e,t,n){"use strict";var r=n(0),i=n(24)(5),o=!0;"find"in[]&&Array(1).find((function(){o=!1})),r(r.P+r.F*o,"Array",{find:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(39)("find")},function(e,t,n){"use strict";var r=n(0),i=n(24)(6),o="findIndex",a=!0;o in[]&&Array(1)[o]((function(){a=!1})),r(r.P+r.F*a,"Array",{findIndex:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(39)(o)},function(e,t,n){n(44)("Array")},function(e,t,n){var r=n(1),i=n(80),o=n(9).f,a=n(37).f,s=n(87),c=n(62),u=r.RegExp,l=u,h=u.prototype,f=/a/g,d=/a/g,p=new u(f)!==f;if(n(8)&&(!p||n(2)((function(){return d[n(5)("match")]=!1,u(f)!=f||u(d)==d||"/a/i"!=u(f,"i")})))){u=function(e,t){var n=this instanceof u,r=s(e),o=void 0===t;return!n&&r&&e.constructor===u&&o?e:i(p?new l(r&&!o?e.source:e,t):l((r=e instanceof u)?e.source:e,r&&o?c.call(e):t),n?this:h,u)};for(var m=function(e){e in u||o(u,e,{configurable:!0,get:function(){return l[e]},set:function(t){l[e]=t}})},v=a(l),g=0;v.length>g;)m(v[g++]);h.constructor=u,u.prototype=h,n(12)(r,"RegExp",u)}n(44)("RegExp")},function(e,t,n){"use strict";n(126);var r=n(3),i=n(62),o=n(8),a=/./.toString,s=function(e){n(12)(RegExp.prototype,"toString",e,!0)};n(2)((function(){return"/a/b"!=a.call({source:"a",flags:"b"})}))?s((function(){var e=r(this);return"/".concat(e.source,"/","flags"in e?e.flags:!o&&e instanceof RegExp?i.call(e):void 0)})):"toString"!=a.name&&s((function(){return a.call(this)}))},function(e,t,n){"use strict";var r=n(3),i=n(6),o=n(95),a=n(63);n(64)("match",1,(function(e,t,n,s){return[function(n){var r=e(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=s(n,e,this);if(t.done)return t.value;var c=r(e),u=String(this);if(!c.global)return a(c,u);var l=c.unicode;c.lastIndex=0;for(var h,f=[],d=0;null!==(h=a(c,u));){var p=String(h[0]);f[d]=p,""===p&&(c.lastIndex=o(u,i(c.lastIndex),l)),d++}return 0===d?null:f}]}))},function(e,t,n){"use strict";var r=n(3),i=n(10),o=n(6),a=n(21),s=n(95),c=n(63),u=Math.max,l=Math.min,h=Math.floor,f=/\$([$&`']|\d\d?|<[^>]*>)/g,d=/\$([$&`']|\d\d?)/g,p=function(e){return void 0===e?e:String(e)};n(64)("replace",2,(function(e,t,n,m){return[function(r,i){var o=e(this),a=null==r?void 0:r[t];return void 0!==a?a.call(r,o,i):n.call(String(o),r,i)},function(e,t){var i=m(n,e,this,t);if(i.done)return i.value;var h=r(e),f=String(this),d="function"==typeof t;d||(t=String(t));var g=h.global;if(g){var y=h.unicode;h.lastIndex=0}for(var b=[];;){var _=c(h,f);if(null===_)break;if(b.push(_),!g)break;""===String(_[0])&&(h.lastIndex=s(f,o(h.lastIndex),y))}for(var w="",x=0,S=0;S<b.length;S++){_=b[S];for(var E=String(_[0]),M=u(l(a(_.index),f.length),0),C=[],T=1;T<_.length;T++)C.push(p(_[T]));var A=_.groups;if(d){var P=[E].concat(C,M,f);void 0!==A&&P.push(A);var L=String(t.apply(void 0,P))}else L=v(E,f,M,C,A,t);M>=x&&(w+=f.slice(x,M)+L,x=M+E.length)}return w+f.slice(x)}];function v(e,t,r,o,a,s){var c=r+e.length,u=o.length,l=d;return void 0!==a&&(a=i(a),l=f),n.call(s,l,(function(n,i){var s;switch(i.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,r);case"'":return t.slice(c);case"<":s=a[i.slice(1,-1)];break;default:var l=+i;if(0===l)return n;if(l>u){var f=h(l/10);return 0===f?n:f<=u?void 0===o[f-1]?i.charAt(1):o[f-1]+i.charAt(1):n}s=o[l-1]}return void 0===s?"":s}))}}))},function(e,t,n){"use strict";var r=n(3),i=n(111),o=n(63);n(64)("search",1,(function(e,t,n,a){return[function(n){var r=e(this),i=null==n?void 0:n[t];return void 0!==i?i.call(n,r):new RegExp(n)[t](String(r))},function(e){var t=a(n,e,this);if(t.done)return t.value;var s=r(e),c=String(this),u=s.lastIndex;i(u,0)||(s.lastIndex=0);var l=o(s,c);return i(s.lastIndex,u)||(s.lastIndex=u),null===l?-1:l.index}]}))},function(e,t,n){"use strict";var r=n(87),i=n(3),o=n(53),a=n(95),s=n(6),c=n(63),u=n(94),l=n(2),h=Math.min,f=[].push,d=!l((function(){RegExp(4294967295,"y")}));n(64)("split",2,(function(e,t,n,l){var p;return p="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,t){var i=String(this);if(void 0===e&&0===t)return[];if(!r(e))return n.call(i,e,t);for(var o,a,s,c=[],l=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),h=0,d=void 0===t?4294967295:t>>>0,p=new RegExp(e.source,l+"g");(o=u.call(p,i))&&!((a=p.lastIndex)>h&&(c.push(i.slice(h,o.index)),o.length>1&&o.index<i.length&&f.apply(c,o.slice(1)),s=o[0].length,h=a,c.length>=d));)p.lastIndex===o.index&&p.lastIndex++;return h===i.length?!s&&p.test("")||c.push(""):c.push(i.slice(h)),c.length>d?c.slice(0,d):c}:"0".split(void 0,0).length?function(e,t){return void 0===e&&0===t?[]:n.call(this,e,t)}:n,[function(n,r){var i=e(this),o=null==n?void 0:n[t];return void 0!==o?o.call(n,i,r):p.call(String(i),n,r)},function(e,t){var r=l(p,e,this,t,p!==n);if(r.done)return r.value;var u=i(e),f=String(this),m=o(u,RegExp),v=u.unicode,g=(u.ignoreCase?"i":"")+(u.multiline?"m":"")+(u.unicode?"u":"")+(d?"y":"g"),y=new m(d?u:"^(?:"+u.source+")",g),b=void 0===t?4294967295:t>>>0;if(0===b)return[];if(0===f.length)return null===c(y,f)?[f]:[];for(var _=0,w=0,x=[];w<f.length;){y.lastIndex=d?w:0;var S,E=c(y,d?f:f.slice(w));if(null===E||(S=h(s(y.lastIndex+(d?0:w)),f.length))===_)w=a(f,w,v);else{if(x.push(f.slice(_,w)),x.length===b)return x;for(var M=1;M<=E.length-1;M++)if(x.push(E[M]),x.length===b)return x;w=_=S}}return x.push(f.slice(_)),x}]}))},function(e,t,n){var r=n(1),i=n(96).set,o=r.MutationObserver||r.WebKitMutationObserver,a=r.process,s=r.Promise,c="process"==n(25)(a);e.exports=function(){var e,t,n,u=function(){var r,i;for(c&&(r=a.domain)&&r.exit();e;){i=e.fn,e=e.next;try{i()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(c)n=function(){a.nextTick(u)};else if(!o||r.navigator&&r.navigator.standalone)if(s&&s.resolve){var l=s.resolve(void 0);n=function(){l.then(u)}}else n=function(){i.call(r,u)};else{var h=!0,f=document.createTextNode("");new o(u).observe(f,{characterData:!0}),n=function(){f.data=h=!h}}return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}}},function(e,t){e.exports=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}}},function(e,t,n){"use strict";var r=n(130),i=n(40);e.exports=n(67)("Map",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(e){var t=r.getEntry(i(this,"Map"),e);return t&&t.v},set:function(e,t){return r.def(i(this,"Map"),0===e?0:e,t)}},r,!0)},function(e,t,n){"use strict";var r=n(130),i=n(40);e.exports=n(67)("Set",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return r.def(i(this,"Set"),e=0===e?0:e,e)}},r)},function(e,t,n){"use strict";var r,i=n(1),o=n(24)(0),a=n(12),s=n(29),c=n(110),u=n(131),l=n(4),h=n(40),f=n(40),d=!i.ActiveXObject&&"ActiveXObject"in i,p=s.getWeak,m=Object.isExtensible,v=u.ufstore,g=function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},y={get:function(e){if(l(e)){var t=p(e);return!0===t?v(h(this,"WeakMap")).get(e):t?t[this._i]:void 0}},set:function(e,t){return u.def(h(this,"WeakMap"),e,t)}},b=e.exports=n(67)("WeakMap",g,y,u,!0,!0);f&&d&&(c((r=u.getConstructor(g,"WeakMap")).prototype,y),s.NEED=!0,o(["delete","has","get","set"],(function(e){var t=b.prototype,n=t[e];a(t,e,(function(t,i){if(l(t)&&!m(t)){this._f||(this._f=new r);var o=this._f[e](t,i);return"set"==e?this:o}return n.call(this,t,i)}))})))},function(e,t,n){"use strict";var r=n(131),i=n(40);n(67)("WeakSet",(function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(e){return r.def(i(this,"WeakSet"),e,!0)}},r,!1,!0)},function(e,t,n){"use strict";var r=n(0),i=n(68),o=n(97),a=n(3),s=n(35),c=n(6),u=n(4),l=n(1).ArrayBuffer,h=n(53),f=o.ArrayBuffer,d=o.DataView,p=i.ABV&&l.isView,m=f.prototype.slice,v=i.VIEW;r(r.G+r.W+r.F*(l!==f),{ArrayBuffer:f}),r(r.S+r.F*!i.CONSTR,"ArrayBuffer",{isView:function(e){return p&&p(e)||u(e)&&v in e}}),r(r.P+r.U+r.F*n(2)((function(){return!new f(2).slice(1,void 0).byteLength})),"ArrayBuffer",{slice:function(e,t){if(void 0!==m&&void 0===t)return m.call(a(this),e);for(var n=a(this).byteLength,r=s(e,n),i=s(void 0===t?n:t,n),o=new(h(this,f))(c(i-r)),u=new d(this),l=new d(o),p=0;r<i;)l.setUint8(p++,u.getUint8(r++));return o}}),n(44)("ArrayBuffer")},function(e,t,n){var r=n(0);r(r.G+r.W+r.F*!n(68).ABV,{DataView:n(97).DataView})},function(e,t,n){n(27)("Int8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(27)("Uint8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(27)("Uint8",1,(function(e){return function(t,n,r){return e(this,t,n,r)}}),!0)},function(e,t,n){n(27)("Int16",2,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(27)("Uint16",2,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(27)("Int32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(27)("Uint32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(27)("Float32",4,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){n(27)("Float64",8,(function(e){return function(t,n,r){return e(this,t,n,r)}}))},function(e,t,n){var r=n(0),i=n(20),o=n(3),a=(n(1).Reflect||{}).apply,s=Function.apply;r(r.S+r.F*!n(2)((function(){a((function(){}))})),"Reflect",{apply:function(e,t,n){var r=i(e),c=o(n);return a?a(r,t,c):s.call(r,t,c)}})},function(e,t,n){var r=n(0),i=n(36),o=n(20),a=n(3),s=n(4),c=n(2),u=n(112),l=(n(1).Reflect||{}).construct,h=c((function(){function e(){}return!(l((function(){}),[],e)instanceof e)})),f=!c((function(){l((function(){}))}));r(r.S+r.F*(h||f),"Reflect",{construct:function(e,t){o(e),a(t);var n=arguments.length<3?e:o(arguments[2]);if(f&&!h)return l(e,t,n);if(e==n){switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3])}var r=[null];return r.push.apply(r,t),new(u.apply(e,r))}var c=n.prototype,d=i(s(c)?c:Object.prototype),p=Function.apply.call(e,d,t);return s(p)?p:d}})},function(e,t,n){var r=n(9),i=n(0),o=n(3),a=n(28);i(i.S+i.F*n(2)((function(){Reflect.defineProperty(r.f({},1,{value:1}),1,{value:2})})),"Reflect",{defineProperty:function(e,t,n){o(e),t=a(t,!0),o(n);try{return r.f(e,t,n),!0}catch(e){return!1}}})},function(e,t,n){var r=n(0),i=n(22).f,o=n(3);r(r.S,"Reflect",{deleteProperty:function(e,t){var n=i(o(e),t);return!(n&&!n.configurable)&&delete e[t]}})},function(e,t,n){"use strict";var r=n(0),i=n(3),o=function(e){this._t=i(e),this._i=0;var t,n=this._k=[];for(t in e)n.push(t)};n(119)(o,"Object",(function(){var e,t=this._k;do{if(this._i>=t.length)return{value:void 0,done:!0}}while(!((e=t[this._i++])in this._t));return{value:e,done:!1}})),r(r.S,"Reflect",{enumerate:function(e){return new o(e)}})},function(e,t,n){var r=n(22),i=n(38),o=n(15),a=n(0),s=n(4),c=n(3);a(a.S,"Reflect",{get:function e(t,n){var a,u,l=arguments.length<3?t:arguments[2];return c(t)===l?t[n]:(a=r.f(t,n))?o(a,"value")?a.value:void 0!==a.get?a.get.call(l):void 0:s(u=i(t))?e(u,n,l):void 0}})},function(e,t,n){var r=n(22),i=n(0),o=n(3);i(i.S,"Reflect",{getOwnPropertyDescriptor:function(e,t){return r.f(o(e),t)}})},function(e,t,n){var r=n(0),i=n(38),o=n(3);r(r.S,"Reflect",{getPrototypeOf:function(e){return i(o(e))}})},function(e,t,n){var r=n(0);r(r.S,"Reflect",{has:function(e,t){return t in e}})},function(e,t,n){var r=n(0),i=n(3),o=Object.isExtensible;r(r.S,"Reflect",{isExtensible:function(e){return i(e),!o||o(e)}})},function(e,t,n){var r=n(0);r(r.S,"Reflect",{ownKeys:n(133)})},function(e,t,n){var r=n(0),i=n(3),o=Object.preventExtensions;r(r.S,"Reflect",{preventExtensions:function(e){i(e);try{return o&&o(e),!0}catch(e){return!1}}})},function(e,t,n){var r=n(9),i=n(22),o=n(38),a=n(15),s=n(0),c=n(31),u=n(3),l=n(4);s(s.S,"Reflect",{set:function e(t,n,s){var h,f,d=arguments.length<4?t:arguments[3],p=i.f(u(t),n);if(!p){if(l(f=o(t)))return e(f,n,s,d);p=c(0)}if(a(p,"value")){if(!1===p.writable||!l(d))return!1;if(h=i.f(d,n)){if(h.get||h.set||!1===h.writable)return!1;h.value=s,r.f(d,n,h)}else r.f(d,n,c(0,s));return!0}return void 0!==p.set&&(p.set.call(d,s),!0)}})},function(e,t,n){var r=n(0),i=n(78);i&&r(r.S,"Reflect",{setPrototypeOf:function(e,t){i.check(e,t);try{return i.set(e,t),!0}catch(e){return!1}}})},function(e,t,n){n(324),e.exports=n(7).Array.includes},function(e,t,n){"use strict";var r=n(0),i=n(58)(!0);r(r.P,"Array",{includes:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0)}}),n(39)("includes")},function(e,t,n){n(326),e.exports=n(7).Array.flatMap},function(e,t,n){"use strict";var r=n(0),i=n(327),o=n(10),a=n(6),s=n(20),c=n(121);r(r.P,"Array",{flatMap:function(e){var t,n,r=o(this);return s(e),t=a(r.length),n=c(r,0),i(n,r,r,t,0,1,e,arguments[1]),n}}),n(39)("flatMap")},function(e,t,n){"use strict";var r=n(60),i=n(4),o=n(6),a=n(19),s=n(5)("isConcatSpreadable");e.exports=function e(t,n,c,u,l,h,f,d){for(var p,m,v=l,g=0,y=!!f&&a(f,d,3);g<u;){if(g in c){if(p=y?y(c[g],g,n):c[g],m=!1,i(p)&&(m=void 0!==(m=p[s])?!!m:r(p)),m&&h>0)v=e(t,n,p,o(p.length),v,h-1)-1;else{if(v>=9007199254740991)throw TypeError();t[v]=p}v++}g++}return v}},function(e,t,n){n(329),e.exports=n(7).String.padStart},function(e,t,n){"use strict";var r=n(0),i=n(134),o=n(66),a=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);r(r.P+r.F*a,"String",{padStart:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!0)}})},function(e,t,n){n(331),e.exports=n(7).String.padEnd},function(e,t,n){"use strict";var r=n(0),i=n(134),o=n(66),a=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);r(r.P+r.F*a,"String",{padEnd:function(e){return i(this,e,arguments.length>1?arguments[1]:void 0,!1)}})},function(e,t,n){n(333),e.exports=n(7).String.trimLeft},function(e,t,n){"use strict";n(42)("trimLeft",(function(e){return function(){return e(this,1)}}),"trimStart")},function(e,t,n){n(335),e.exports=n(7).String.trimRight},function(e,t,n){"use strict";n(42)("trimRight",(function(e){return function(){return e(this,2)}}),"trimEnd")},function(e,t,n){n(337),e.exports=n(74).f("asyncIterator")},function(e,t,n){n(106)("asyncIterator")},function(e,t,n){n(339),e.exports=n(7).Object.getOwnPropertyDescriptors},function(e,t,n){var r=n(0),i=n(133),o=n(17),a=n(22),s=n(90);r(r.S,"Object",{getOwnPropertyDescriptors:function(e){for(var t,n,r=o(e),c=a.f,u=i(r),l={},h=0;u.length>h;)void 0!==(n=c(r,t=u[h++]))&&s(l,t,n);return l}})},function(e,t,n){n(341),e.exports=n(7).Object.values},function(e,t,n){var r=n(0),i=n(135)(!1);r(r.S,"Object",{values:function(e){return i(e)}})},function(e,t,n){n(343),e.exports=n(7).Object.entries},function(e,t,n){var r=n(0),i=n(135)(!0);r(r.S,"Object",{entries:function(e){return i(e)}})},function(e,t,n){"use strict";n(127),n(345),e.exports=n(7).Promise.finally},function(e,t,n){"use strict";var r=n(0),i=n(7),o=n(1),a=n(53),s=n(129);r(r.P+r.R,"Promise",{finally:function(e){var t=a(this,i.Promise||o.Promise),n="function"==typeof e;return this.then(n?function(n){return s(t,e()).then((function(){return n}))}:e,n?function(n){return s(t,e()).then((function(){throw n}))}:e)}})},function(e,t,n){n(347),n(348),n(349),e.exports=n(7)},function(e,t,n){var r=n(1),i=n(0),o=n(66),a=[].slice,s=/MSIE .\./.test(o),c=function(e){return function(t,n){var r=arguments.length>2,i=!!r&&a.call(arguments,2);return e(r?function(){("function"==typeof t?t:Function(t)).apply(this,i)}:t,n)}};i(i.G+i.B+i.F*s,{setTimeout:c(r.setTimeout),setInterval:c(r.setInterval)})},function(e,t,n){var r=n(0),i=n(96);r(r.G+r.B,{setImmediate:i.set,clearImmediate:i.clear})},function(e,t,n){for(var r=n(93),i=n(34),o=n(12),a=n(1),s=n(16),c=n(43),u=n(5),l=u("iterator"),h=u("toStringTag"),f=c.Array,d={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},p=i(d),m=0;m<p.length;m++){var v,g=p[m],y=d[g],b=a[g],_=b&&b.prototype;if(_&&(_[l]||s(_,l,f),_[h]||s(_,h,g),c[g]=f,y))for(v in r)_[v]||o(_,v,r[v],!0)}},function(e,t,n){(function(e){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var n=function(e){"use strict";var n,r=Object.prototype,i=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,o=Object.create(i.prototype),a=new A(r||[]);return o._invoke=function(e,t,n){var r=h;return function(i,o){if(r===d)throw new Error("Generator is already running");if(r===p){if("throw"===i)throw o;return L()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=M(a,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===h)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var c=l(e,t,n);if("normal"===c.type){if(r=n.done?p:f,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=p,n.method="throw",n.arg=c.arg)}}}(e,n,a),o}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var h="suspendedStart",f="suspendedYield",d="executing",p="completed",m={};function v(){}function g(){}function y(){}var b={};b[a]=function(){return this};var _=Object.getPrototypeOf,w=_&&_(_(P([])));w&&w!==r&&i.call(w,a)&&(b=w);var x=y.prototype=v.prototype=Object.create(b);function S(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function E(e){var n;this._invoke=function(r,o){function a(){return new Promise((function(n,a){!function n(r,o,a,s){var c=l(e[r],e,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"===t(h)&&i.call(h,"__await")?Promise.resolve(h.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):Promise.resolve(h).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}(r,o,n,a)}))}return n=n?n.then(a,a):a()}}function M(e,t){var r=e.iterator[t.method];if(r===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,M(e,t),"throw"===t.method))return m;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var i=l(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,m;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,m):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,m)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function P(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(i.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return o.next=o}}return{next:L}}function L(){return{value:n,done:!0}}return g.prototype=x.constructor=y,y.constructor=g,y[c]=g.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,c in e||(e[c]="GeneratorFunction")),e.prototype=Object.create(x),e},e.awrap=function(e){return{__await:e}},S(E.prototype),E.prototype[s]=function(){return this},e.AsyncIterator=E,e.async=function(t,n,r,i){var o=new E(u(t,n,r,i));return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},S(x),x[c]="Generator",x[a]=function(){return this},x.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=P,A.prototype={constructor:A,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,i){return s.type="throw",s.arg=e,t.next=r,i&&(t.method="next",t.arg=n),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var c=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:P(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),m}},e}("object"===t(e)?e.exports:{});try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}}).call(this,n(136)(e))},function(e,t,n){n(352),e.exports=n(137).global},function(e,t,n){var r=n(353);r(r.G,{global:n(98)})},function(e,t,n){var r=n(98),i=n(137),o=n(354),a=n(356),s=n(363),c=function e(t,n,c){var u,l,h,f=t&e.F,d=t&e.G,p=t&e.S,m=t&e.P,v=t&e.B,g=t&e.W,y=d?i:i[n]||(i[n]={}),b=y.prototype,_=d?r:p?r[n]:(r[n]||{}).prototype;for(u in d&&(c=n),c)(l=!f&&_&&void 0!==_[u])&&s(y,u)||(h=l?_[u]:c[u],y[u]=d&&"function"!=typeof _[u]?c[u]:v&&l?o(h,r):g&&_[u]==h?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(h):m&&"function"==typeof h?o(Function.call,h):h,m&&((y.virtual||(y.virtual={}))[u]=h,t&e.R&&b&&!b[u]&&a(b,u,h)))};c.F=1,c.G=2,c.S=4,c.P=8,c.B=16,c.W=32,c.U=64,c.R=128,e.exports=c},function(e,t,n){var r=n(355);e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}}},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,n){var r=n(357),i=n(362);e.exports=n(100)?function(e,t,n){return r.f(e,t,i(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){var r=n(358),i=n(359),o=n(361),a=Object.defineProperty;t.f=n(100)?Object.defineProperty:function(e,t,n){if(r(e),t=o(t,!0),r(n),i)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},function(e,t,n){var r=n(99);e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},function(e,t,n){e.exports=!n(100)&&!n(138)((function(){return 7!=Object.defineProperty(n(360)("div"),"a",{get:function(){return 7}}).a}))},function(e,t,n){var r=n(99),i=n(98).document,o=r(i)&&r(i.createElement);e.exports=function(e){return o?i.createElement(e):{}}},function(e,t,n){var r=n(99);e.exports=function(e,t){if(!r(e))return e;var n,i;if(t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;if("function"==typeof(n=e.valueOf)&&!r(i=n.call(e)))return i;if(!t&&"function"==typeof(n=e.toString)&&!r(i=n.call(e)))return i;throw TypeError("Can't convert object to primitive value")}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},function(e,t){e.exports='<div class=iproov-state-screen id=iproov-ready> <slot name=ready> <h3 class=iproov-lang-heading>Ready to iProov</h3> </slot> </div> <div class=iproov-state-screen id=iproov-aborted> <slot name=aborted> <h3 class=iproov-lang-heading>Try iProov again?</h3> </slot> </div> <div class=iproov-state-screen id=iproov-button> <slot name=button> <button role=button type=button aria-label="Click to start" tabindex=1>Scan Face</button> </slot> </div> <div class=iproov-state-screen id=iproov-progress> <slot name=progress> <progress max=100 value=0></progress> <div class=iproov-lang-term>Streaming...</div> </slot> </div> <div class=iproov-state-screen id=iproov-passed> <slot name=passed> <h3 class=iproov-lang-heading>Passed</h3> <div class=iproov-lang-term>You have iProoved successfully</div> </slot> </div> <div class=iproov-state-screen id=iproov-failed> <slot name=failed> <h3 class=iproov-lang-heading>Failed</h3> <div class=iproov-lang-term>The iProov was unsuccessful</div> </slot> </div> <div class=iproov-state-screen id=iproov-error> <slot name=error> <h3 class=iproov-lang-heading>Error</h3> <div class=iproov-lang-term>There was an error attempting to perform an iProov</div> </slot> </div> <div class=iproov-state-screen id=iproov-unsupported> <slot name=unsupported> <h3 class=iproov-lang-heading>Unsupported</h3> <div class=iproov-lang-term>Your device isn\'t currently supported to perform an iProov</div> </slot> </div> <div class=iproov-state-screen id=iproov-permission_denied> <slot name=permission_denied> <h3 class=iproov-lang-heading>Permission Required</h3> <div class=iproov-lang-term> Permission to access the camera has been denied. Please enable permission to perform an iProov. If you have already allowed permission, you will need to reload the page. </div> </slot> </div> <div class=iproov-state-screen id=iproov-grant_permission> <slot name=grant_permission> <h3 class=iproov-lang-heading>Grant Camera Access</h3> <div class=iproov-lang-term>Camera access must be granted to perform an iProov</div> </slot> </div> <div class=iproov-state-screen id=iproov-grant_button> <slot name=grant_button> <button role=button type=button aria-label="Click to grant camera permission" tabindex=1> Grant Permission </button> </slot> </div> <div class=iproov-state-screen id=iproov-no_camera> <slot name=no_camera> <h3 class=iproov-lang-heading>No Camera Detected</h3> <div class=iproov-lang-term>A camera must be present to perform an iProov</div> </slot> </div> <div id=iproov-wrapper> <div id=accessibility aria-live=assertive aria-hidden=false class=sr-only></div> </div> <div id=iproov-rotate> <img loading=lazy width=370 height=370 /> </div> '},function(e,t){e.exports=".sr-only{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}#iproov-app{background:#fafafa;position:fixed;left:0;top:0;bottom:0;width:100%;z-index:2147483635;visibility:hidden}#iproov-app svg{backface-visibility:hidden;position:absolute;z-index:2147483640;height:100%;width:100%;top:0;left:0;opacity:0}#iproov-app svg *{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#iproov-app svg :focus{outline:none}#iproov-app #svg-exit{cursor:pointer}#svg-start-1,#svg-start-2,#svg-start-3{visibility:hidden}#svg-progress{transition:width 2s}#iproov-webgl{z-index:2147483638;position:fixed;top:0;left:0;bottom:0;right:0;margin:0}#iproov-webgl.low-fps{width:100%!important;height:100%!important}.iproov-canvas{z-index:2147483639;position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);margin:0 auto}#iproov-video{opacity:.5;z-index:2147483642;position:fixed;height:100%;width:100%;top:0;left:0;right:0;bottom:0;transform:scaleX(-1)}#iproov-app .dg.main{z-index:2147483643;position:absolute;top:0;left:0}@media (max-width:400px){#iproov-app .dg.ac{display:none}}.iproov-state-screen a,.iproov-state-screen button{color:#fff;background-color:#007bff;display:inline-block;font-weight:400;text-align:center;white-space:nowrap;vertical-align:middle;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;border:1px solid #007bff;padding:.375rem .75rem;font-size:1rem;line-height:1.5;border-radius:.25rem;transition:color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;text-decoration:none;cursor:pointer}.iproov-state-screen div{margin-bottom:20px}#iproov-button button:hover{background-color:#0069d9;border-color:#0062cc;cursor:pointer}#iproov-button button:hover{text-decoration:none}#iproov-progress .progress-bar{-webkit-appearance:none;border:none;-webkit-transition:width 5s ease;-moz-transition:width 5s ease;-o-transition:width 5s ease;transition:width 5s ease}.iproov-state-screen{display:none}.iproov-is-visible{display:inherit}#iproov-face-detection{display:none}#iproov-rotate{display:none;position:fixed;top:0;left:0;bottom:0;width:100%;background:#efefef;z-index:2147483637}.fade-in{-webkit-animation:fadeIn 1s;-webkit-animation-fill-mode:forwards;animation:fadeIn 1s;animation-fill-mode:forwards}@keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-moz-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-webkit-keyframes fadeIn{0%{opacity:0}to{opacity:1}}@-webkit-keyframes shake{0%,to{-webkit-transform:translateZ(0);transform:translateZ(0)}10%,30%,50%,70%,90%{-webkit-transform:translate3d(-2px,0,0);transform:translate3d(-2px,0,0)}20%,40%,60%,80%{-webkit-transform:translate3d(2px,0,0);transform:translate3d(2px,0,0)}}@keyframes shake{0%,to{-webkit-transform:translateZ(0);transform:translateZ(0)}10%,30%,50%,70%,90%{-webkit-transform:translate3d(-2px,0,0);transform:translate3d(-2px,0,0)}20%,40%,60%,80%{-webkit-transform:translate3d(2px,0,0);transform:translate3d(2px,0,0)}}.shake{-webkit-animation-name:shake;animation-name:shake}.animated{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:both;animation-fill-mode:both}@media (prefers-reduced-motion:reduce),(print){.animated{-webkit-animation-duration:1ms!important;animation-duration:1ms!important;-webkit-transition-duration:1ms!important;transition-duration:1ms!important;-webkit-animation-iteration-count:1!important;animation-iteration-count:1!important}}.animated.fast{-webkit-animation-duration:.8s;animation-duration:.8s}#iproov-rotate img{width:auto;height:100%}"},function(e,t,n){(function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}(function(){"use strict";var r;function i(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}function o(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:i(e)}}function a(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}var s="undefined"!=typeof window&&window===this?this:void 0!==e&&null!=e?e:this,c="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)};function u(){u=function(){},s.Symbol||(s.Symbol=f)}function l(e,t){this.a=e,c(this,"description",{configurable:!0,writable:!0,value:t})}l.prototype.toString=function(){return this.a};var h,f=function(){var e=0;return function t(n){if(this instanceof t)throw new TypeError("Symbol is not a constructor");return new l("jscomp_symbol_"+(n||"")+"_"+e++,n)}}();function d(){u();var e=s.Symbol.iterator;e||(e=s.Symbol.iterator=s.Symbol("Symbol.iterator")),"function"!=typeof Array.prototype[e]&&c(Array.prototype,e,{configurable:!0,writable:!0,value:function(){return function(e){return d(),(e={next:e})[s.Symbol.iterator]=function(){return this},e}(i(this))}}),d=function(){}}if("function"==typeof Object.setPrototypeOf)h=Object.setPrototypeOf;else{var p;e:{var m={};try{m.__proto__={Pa:!0},p=m.Pa;break e}catch(e){}p=!1}h=p?function(e,t){if(e.__proto__=t,e.__proto__!==t)throw new TypeError(e+" is not extensible");return e}:null}var v=h;function g(){this.l=!1,this.b=null,this.Ea=void 0,this.a=1,this.Y=0,this.c=null}function y(e){if(e.l)throw new TypeError("Generator is already running");e.l=!0}function b(e,t){e.c={Sa:t,Wa:!0},e.a=e.Y}function _(e,t){return e.a=3,{value:t}}function w(e,t,n,r){try{var i=t.call(e.a.b,n);if(!(i instanceof Object))throw new TypeError("Iterator result "+i+" is not an object");if(!i.done)return e.a.l=!1,i;var o=i.value}catch(t){return e.a.b=null,b(e.a,t),x(e)}return e.a.b=null,r.call(e.a,o),x(e)}function x(e){for(;e.a.a;)try{var t=e.b(e.a);if(t)return e.a.l=!1,{value:t.value,done:!1}}catch(t){e.a.Ea=void 0,b(e.a,t)}if(e.a.l=!1,e.a.c){if(t=e.a.c,e.a.c=null,t.Wa)throw t.Sa;return{value:t.return,done:!0}}return{value:void 0,done:!0}}function S(e){this.next=function(t){return y(e.a),e.a.b?t=w(e,e.a.b.next,t,e.a.J):(e.a.J(t),t=x(e)),t},this.throw=function(t){return y(e.a),e.a.b?t=w(e,e.a.b.throw,t,e.a.J):(b(e.a,t),t=x(e)),t},this.return=function(t){return function(e,t){y(e.a);var n=e.a.b;return n?w(e,"return"in n?n.return:function(e){return{value:e,done:!0}},t,e.a.return):(e.a.return(t),x(e))}(e,t)},d(),this[Symbol.iterator]=function(){return this}}function E(e,t){return t=new S(new function(e){this.a=new g,this.b=e}(t)),v&&v(t,e.prototype),t}g.prototype.J=function(e){this.Ea=e},g.prototype.return=function(e){this.c={return:e},this.a=this.Y},Array.from||(Array.from=function(e){return[].slice.call(e)}),Object.assign||(Object.assign=function(e){for(var t,n=[].slice.call(arguments,1),r=0;r<n.length;r++)if(t=n[r])for(var i=e,o=t,a=Object.getOwnPropertyNames(o),s=0;s<a.length;s++)i[t=a[s]]=o[t];return e}),function(){if(!function(){var e=document.createEvent("Event");return e.initEvent("foo",!0,!0),e.preventDefault(),e.defaultPrevented}()){var e=Event.prototype.preventDefault;Event.prototype.preventDefault=function(){this.cancelable&&(e.call(this),Object.defineProperty(this,"defaultPrevented",{get:function(){return!0},configurable:!0}))}}var t=/Trident/.test(navigator.userAgent);if(!window.Event||t&&"function"!=typeof window.Event){var n=window.Event;if(window.Event=function(e,t){t=t||{};var n=document.createEvent("Event");return n.initEvent(e,!!t.bubbles,!!t.cancelable),n},n){for(var r in n)window.Event[r]=n[r];window.Event.prototype=n.prototype}}if((!window.CustomEvent||t&&"function"!=typeof window.CustomEvent)&&(window.CustomEvent=function(e,t){t=t||{};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!!t.bubbles,!!t.cancelable,t.detail),n},window.CustomEvent.prototype=window.Event.prototype),!window.MouseEvent||t&&"function"!=typeof window.MouseEvent){if(t=window.MouseEvent,window.MouseEvent=function(e,t){t=t||{};var n=document.createEvent("MouseEvent");return n.initMouseEvent(e,!!t.bubbles,!!t.cancelable,t.view||window,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,t.ctrlKey,t.altKey,t.shiftKey,t.metaKey,t.button,t.relatedTarget),n},t)for(var i in t)window.MouseEvent[i]=t[i];window.MouseEvent.prototype=t.prototype}}(),function(){function e(){}function t(e,t){if(!e.childNodes.length)return[];switch(e.nodeType){case Node.DOCUMENT_NODE:return m.call(e,t);case Node.DOCUMENT_FRAGMENT_NODE:return v.call(e,t);default:return p.call(e,t)}}var n="undefined"==typeof HTMLTemplateElement,r=!(document.createDocumentFragment().cloneNode()instanceof DocumentFragment),i=!1;/Trident/.test(navigator.userAgent)&&function(){function e(e,t){if(e instanceof DocumentFragment)for(var r;r=e.firstChild;)n.call(this,r,t);else n.call(this,e,t);return e}i=!0;var t=Node.prototype.cloneNode;Node.prototype.cloneNode=function(e){return e=t.call(this,e),this instanceof DocumentFragment&&(e.__proto__=DocumentFragment.prototype),e},DocumentFragment.prototype.querySelectorAll=HTMLElement.prototype.querySelectorAll,DocumentFragment.prototype.querySelector=HTMLElement.prototype.querySelector,Object.defineProperties(DocumentFragment.prototype,{nodeType:{get:function(){return Node.DOCUMENT_FRAGMENT_NODE},configurable:!0},localName:{get:function(){},configurable:!0},nodeName:{get:function(){return"#document-fragment"},configurable:!0}});var n=Node.prototype.insertBefore;Node.prototype.insertBefore=e;var r=Node.prototype.appendChild;Node.prototype.appendChild=function(t){return t instanceof DocumentFragment?e.call(this,t,null):r.call(this,t),t};var o=Node.prototype.removeChild,a=Node.prototype.replaceChild;Node.prototype.replaceChild=function(t,n){return t instanceof DocumentFragment?(e.call(this,t,n),o.call(this,n)):a.call(this,t,n),n},Document.prototype.createDocumentFragment=function(){var e=this.createElement("df");return e.__proto__=DocumentFragment.prototype,e};var s=Document.prototype.importNode;Document.prototype.importNode=function(e,t){return t=s.call(this,e,t||!1),e instanceof DocumentFragment&&(t.__proto__=DocumentFragment.prototype),t}}();var o=Node.prototype.cloneNode,a=Document.prototype.createElement,s=Document.prototype.importNode,c=Node.prototype.removeChild,u=Node.prototype.appendChild,l=Node.prototype.replaceChild,h=DOMParser.prototype.parseFromString,f=Object.getOwnPropertyDescriptor(window.HTMLElement.prototype,"innerHTML")||{get:function(){return this.innerHTML},set:function(e){this.innerHTML=e}},d=Object.getOwnPropertyDescriptor(window.Node.prototype,"childNodes")||{get:function(){return this.childNodes}},p=Element.prototype.querySelectorAll,m=Document.prototype.querySelectorAll,v=DocumentFragment.prototype.querySelectorAll,g=function(){if(!n){var e=document.createElement("template"),t=document.createElement("template");return t.content.appendChild(document.createElement("div")),e.content.appendChild(t),0===(e=e.cloneNode(!0)).content.childNodes.length||0===e.content.firstChild.content.childNodes.length||r}}();if(n){var y=document.implementation.createHTMLDocument("template"),b=!0,_=document.createElement("style");_.textContent="template{display:none;}";var w=document.head;w.insertBefore(_,w.firstElementChild),e.prototype=Object.create(HTMLElement.prototype);var x=!document.createElement("div").hasOwnProperty("innerHTML");e.U=function(t){if(!t.content&&t.namespaceURI===document.documentElement.namespaceURI){t.content=y.createDocumentFragment();for(var n;n=t.firstChild;)u.call(t.content,n);if(x)t.__proto__=e.prototype;else if(t.cloneNode=function(t){return e.b(this,t)},b)try{E(t),M(t)}catch(e){b=!1}e.a(t.content)}};var S={option:["select"],thead:["table"],col:["colgroup","table"],tr:["tbody","table"],th:["tr","tbody","table"],td:["tr","tbody","table"]},E=function(t){Object.defineProperty(t,"innerHTML",{get:function(){return R(this)},set:function(t){var n=S[(/<([a-z][^/\0>\x20\t\r\n\f]+)/i.exec(t)||["",""])[1].toLowerCase()];if(n)for(var r=0;r<n.length;r++)t="<"+n[r]+">"+t+"</"+n[r]+">";for(y.body.innerHTML=t,e.a(y);this.content.firstChild;)c.call(this.content,this.content.firstChild);if(t=y.body,n)for(r=0;r<n.length;r++)t=t.lastChild;for(;t.firstChild;)u.call(this.content,t.firstChild)},configurable:!0})},M=function(e){Object.defineProperty(e,"outerHTML",{get:function(){return"<template>"+this.innerHTML+"</template>"},set:function(e){if(!this.parentNode)throw Error("Failed to set the 'outerHTML' property on 'Element': This element has no parent node.");for(y.body.innerHTML=e,e=this.ownerDocument.createDocumentFragment();y.body.firstChild;)u.call(e,y.body.firstChild);l.call(this.parentNode,e,this)},configurable:!0})};E(e.prototype),M(e.prototype),e.a=function(n){for(var r,i=0,o=(n=t(n,"template")).length;i<o&&(r=n[i]);i++)e.U(r)},document.addEventListener("DOMContentLoaded",(function(){e.a(document)})),Document.prototype.createElement=function(){var t=a.apply(this,arguments);return"template"===t.localName&&e.U(t),t},DOMParser.prototype.parseFromString=function(){var t=h.apply(this,arguments);return e.a(t),t},Object.defineProperty(HTMLElement.prototype,"innerHTML",{get:function(){return R(this)},set:function(t){f.set.call(this,t),e.a(this)},configurable:!0,enumerable:!0});var C=/[&\u00A0"]/g,T=/[&\u00A0<>]/g,A=function(e){switch(e){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case" ":return"&nbsp;"}},P=(_=function(e){for(var t={},n=0;n<e.length;n++)t[e[n]]=!0;return t})("area base br col command embed hr img input keygen link meta param source track wbr".split(" ")),L=_("style script xmp iframe noembed noframes plaintext noscript".split(" ")),R=function e(t,n){"template"===t.localName&&(t=t.content);for(var r,i="",o=n?n(t):d.get.call(t),a=0,s=o.length;a<s&&(r=o[a]);a++){e:{var c=r,u=t,l=n;switch(c.nodeType){case Node.ELEMENT_NODE:for(var h=c.localName,f="<"+h,p=c.attributes,m=0;u=p[m];m++)f+=" "+u.name+'="'+u.value.replace(C,A)+'"';f+=">",c=P[h]?f:f+e(c,l)+"</"+h+">";break e;case Node.TEXT_NODE:c=c.data,c=u&&L[u.localName]?c:c.replace(T,A);break e;case Node.COMMENT_NODE:c="\x3c!--"+c.data+"--\x3e";break e;default:throw window.console.error(c),Error("not implemented")}}i+=c}return i}}if(n||g){e.b=function(e,t){var n=o.call(e,!1);return this.U&&this.U(n),t&&(u.call(n.content,o.call(e.content,!0)),k(n.content,e.content)),n};var k=function(n,r){if(r.querySelectorAll&&0!==(r=t(r,"template")).length)for(var i,o,a=0,s=(n=t(n,"template")).length;a<s;a++)o=r[a],i=n[a],e&&e.U&&e.U(o),l.call(i.parentNode,N.call(o,!0),i)},N=Node.prototype.cloneNode=function(t){if(!i&&r&&this instanceof DocumentFragment){if(!t)return this.ownerDocument.createDocumentFragment();var n=O.call(this.ownerDocument,this,!0)}else n=this.nodeType===Node.ELEMENT_NODE&&"template"===this.localName&&this.namespaceURI==document.documentElement.namespaceURI?e.b(this,t):o.call(this,t);return t&&k(n,this),n},O=Document.prototype.importNode=function(n,r){if(r=r||!1,"template"===n.localName)return e.b(n,r);var i=s.call(this,n,r);if(r){k(i,n),n=t(i,'script:not([type]),script[type="application/javascript"],script[type="text/javascript"]');for(var o,c=0;c<n.length;c++){o=n[c],(r=a.call(document,"script")).textContent=o.textContent;for(var u,h=o.attributes,f=0;f<h.length;f++)u=h[f],r.setAttribute(u.name,u.value);l.call(o.parentNode,r,o)}}return i}}n&&(window.HTMLTemplateElement=e)}();var M=setTimeout;function C(){}function T(e){if(!(this instanceof T))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this.I=0,this.za=!1,this.C=void 0,this.W=[],k(e,this)}function A(e,t){for(;3===e.I;)e=e.C;0===e.I?e.W.push(t):(e.za=!0,N((function(){var n=1===e.I?t.Ya:t.Za;if(null===n)(1===e.I?P:L)(t.va,e.C);else{try{var r=n(e.C)}catch(e){return void L(t.va,e)}P(t.va,r)}})))}function P(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"===n(t)||"function"==typeof t)){var r=t.then;if(t instanceof T)return e.I=3,e.C=t,void R(e);if("function"==typeof r)return void k(function(e,t){return function(){e.apply(t,arguments)}}(r,t),e)}e.I=1,e.C=t,R(e)}catch(t){L(e,t)}}function L(e,t){e.I=2,e.C=t,R(e)}function R(e){2===e.I&&0===e.W.length&&N((function(){e.za||"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e.C)}));for(var t=0,n=e.W.length;t<n;t++)A(e,e.W[t]);e.W=null}function k(e,t){var n=!1;try{e((function(e){n||(n=!0,P(t,e))}),(function(e){n||(n=!0,L(t,e))}))}catch(e){n||(n=!0,L(t,e))}}T.prototype.catch=function(e){return this.then(null,e)},T.prototype.then=function(e,t){var n=new this.constructor(C);return A(this,new function(e,t,n){this.Ya="function"==typeof e?e:null,this.Za="function"==typeof t?t:null,this.va=n}(e,t,n)),n},T.prototype.finally=function(e){var t=this.constructor;return this.then((function(n){return t.resolve(e()).then((function(){return n}))}),(function(n){return t.resolve(e()).then((function(){return t.reject(n)}))}))};var N="function"==typeof t&&function(e){t(e)}||function(e){M(e,0)};if(!window.Promise){window.Promise=T,T.prototype.then=T.prototype.then,T.all=function(e){return new T((function(t,r){function i(e,s){try{if(s&&("object"===n(s)||"function"==typeof s)){var c=s.then;if("function"==typeof c)return void c.call(s,(function(t){i(e,t)}),r)}o[e]=s,0==--a&&t(o)}catch(e){r(e)}}if(!e||void 0===e.length)throw new TypeError("Promise.all accepts an array");var o=Array.prototype.slice.call(e);if(0===o.length)return t([]);for(var a=o.length,s=0;s<o.length;s++)i(s,o[s])}))},T.race=function(e){return new T((function(t,n){for(var r=0,i=e.length;r<i;r++)e[r].then(t,n)}))},T.resolve=function(e){return e&&"object"===n(e)&&e.constructor===T?e:new T((function(t){t(e)}))},T.reject=function(e){return new T((function(t,n){n(e)}))};var O=document.createTextNode(""),D=[];new MutationObserver((function(){for(var e=D.length,t=0;t<e;t++)D[t]();D.splice(0,e)})).observe(O,{characterData:!0}),N=function(e){D.push(e),O.textContent=0<O.textContent.length?"":"a"}}!function(t,r){if(!(r in t)){var i=(void 0===e?"undefined":n(e))===n(i)?window:e,o=0,a=""+Math.random(),s="__symbol@@"+a,c=t.getOwnPropertyNames,u=t.getOwnPropertyDescriptor,l=t.create,h=t.keys,f=t.freeze||t,d=t.defineProperty,p=t.defineProperties,m=u(t,"getOwnPropertyNames"),v=t.prototype,g=v.hasOwnProperty,y=v.propertyIsEnumerable,b=v.toString,_=function(e,t,n){g.call(e,s)||d(e,s,{enumerable:!1,configurable:!1,writable:!1,value:{}}),e[s]["@@"+t]=n},w=function(){},x=function(e){return e!=s&&!g.call(T,e)},S=function(e){return e!=s&&g.call(T,e)},E=function(e){var t=""+e;return S(t)?g.call(this,t)&&this[s]["@@"+t]:y.call(this,e)},M=function(e){return d(v,e,{enumerable:!1,configurable:!0,get:w,set:function(t){k(this,e,{enumerable:!1,configurable:!0,writable:!0,value:t}),_(this,e,!0)}}),f(T[e]=d(t(e),"constructor",A))},C=function(e){if(this&&this!==i)throw new TypeError("Symbol is not a constructor");return M("__symbol:".concat(e||"",a,++o))},T=l(null),A={value:C},P=function(e){return T[e]},L=function(e,t,n){var r=""+t;if(S(r)){if(t=k,n.enumerable){var i=l(n);i.enumerable=!1}else i=n;t(e,r,i),_(e,r,!!n.enumerable)}else d(e,t,n);return e},R=function(e){return c(e).filter(S).map(P)};m.value=L,d(t,"defineProperty",m),m.value=R,d(t,r,m),m.value=function(e){return c(e).filter(x)},d(t,"getOwnPropertyNames",m),m.value=function(e,t){var n=R(t);return n.length?h(t).concat(n).forEach((function(n){E.call(t,n)&&L(e,n,t[n])})):p(e,t),e},d(t,"defineProperties",m),m.value=E,d(v,"propertyIsEnumerable",m),m.value=C,d(i,"Symbol",m),m.value=function(e){return(e="__symbol:".concat("__symbol:",e,a))in v?T[e]:M(e)},d(C,"for",m),m.value=function(e){if(x(e))throw new TypeError(e+" is not a symbol");return g.call(T,e)?e.slice(20,-a.length):void 0},d(C,"keyFor",m),m.value=function(e,t){var n=u(e,t);return n&&S(t)&&(n.enumerable=E.call(e,t)),n},d(t,"getOwnPropertyDescriptor",m),m.value=function(e,t){return 1===arguments.length?l(e):function(e,t){var n=l(e);return c(t).forEach((function(e){E.call(t,e)&&L(n,e,t[e])})),n}(e,t)},d(t,"create",m),m.value=function(){var e=b.call(this);return"[object String]"===e&&S(this)?"[object Symbol]":e},d(v,"toString",m);try{var k=l(d({},"__symbol:",{get:function(){return d(this,"__symbol:",{value:!1})["__symbol:"]}}))["__symbol:"]||d}catch(e){k=function(e,t,n){var r=u(v,t);delete v[t],d(e,t,n),d(v,t,r)}}}}(Object,"getOwnPropertySymbols"),function(e){var t,n=e.defineProperty,r=e.prototype,i=r.toString;"iterator match replace search split hasInstance isConcatSpreadable unscopables species toPrimitive toStringTag".split(" ").forEach((function(o){if(!(o in Symbol))switch(n(Symbol,o,{value:Symbol(o)}),o){case"toStringTag":(t=e.getOwnPropertyDescriptor(r,"toString")).value=function(){var e=i.call(this),t=this[Symbol.toStringTag];return void 0===t?e:"[object "+t+"]"},n(r,"toString",t)}}))}(Object,Symbol),function(e,t,n){function r(){return this}t[e]||(t[e]=function(){var t=0,n=this,i={next:function(){var e=n.length<=t;return e?{done:e}:{done:e,value:n[t++]}}};return i[e]=r,i}),n[e]||(n[e]=function(){var t=String.fromCodePoint,n=this,i=0,o=n.length,a={next:function(){var e=o<=i,r=e?"":t(n.codePointAt(i));return i+=r.length,e?{done:e}:{done:e,value:r}}};return a[e]=r,a})}(Symbol.iterator,Array.prototype,String.prototype);var F=Object.prototype.toString;Object.prototype.toString=function(){return void 0===this?"[object Undefined]":null===this?"[object Null]":F.call(this)},Object.keys=function(e){return Object.getOwnPropertyNames(e).filter((function(t){return(t=Object.getOwnPropertyDescriptor(e,t))&&t.enumerable}))};var I=window.Symbol.iterator;String.prototype[I]&&String.prototype.codePointAt||(String.prototype[I]=function e(){var t,n=this;return E(e,(function(e){if(1==e.a&&(t=0),3!=e.a)return t<n.length?e=_(e,n[t]):(e.a=0,e=void 0),e;t++,e.a=2}))}),Set.prototype[I]||(Set.prototype[I]=function e(){var t,n,r=this;return E(e,(function(e){if(1==e.a&&(t=[],r.forEach((function(e){t.push(e)})),n=0),3!=e.a)return n<t.length?e=_(e,t[n]):(e.a=0,e=void 0),e;n++,e.a=2}))}),Map.prototype[I]||(Map.prototype[I]=function e(){var t,n,r=this;return E(e,(function(e){if(1==e.a&&(t=[],r.forEach((function(e,n){t.push([n,e])})),n=0),3!=e.a)return n<t.length?e=_(e,t[n]):(e.a=0,e=void 0),e;n++,e.a=2}))}),window.WebComponents=window.WebComponents||{flags:{}};var U=document.querySelector('script[src*="webcomponents-bundle"]'),B=/wc-(.+)/,j={};if(!j.noOpts){if(location.search.slice(1).split("&").forEach((function(e){var t;(e=e.split("="))[0]&&(t=e[0].match(B))&&(j[t[1]]=e[1]||!0)})),U)for(var z=0,V=void 0;V=U.attributes[z];z++)"src"!==V.name&&(j[V.name]=V.value||!0);if(j.log&&j.log.split){var G=j.log.split(",");j.log={},G.forEach((function(e){j.log[e]=!0}))}else j.log={}}window.WebComponents.flags=j;var W=j.shadydom;if(W){window.ShadyDOM=window.ShadyDOM||{},window.ShadyDOM.force=W;var H=j.noPatch;window.ShadyDOM.noPatch="true"===H||H}var q=j.register||j.ce;function X(){}function Y(e){return e.__shady||(e.__shady=new X),e.__shady}function Z(e){return e&&e.__shady}q&&window.customElements&&(window.customElements.forcePolyfill=q),X.prototype.toJSON=function(){return{}};var J=window.ShadyDOM||{};J.Ua=!(!Element.prototype.attachShadow||!Node.prototype.getRootNode);var K=Object.getOwnPropertyDescriptor(Node.prototype,"firstChild");function $(e){return(e=Z(e))&&void 0!==e.firstChild}function Q(e){return e instanceof ShadowRoot}function ee(e){return(e=(e=Z(e))&&e.root)&&Ln(e)}J.B=!!(K&&K.configurable&&K.get),J.sa=J.force||!J.Ua,J.D=J.noPatch||!1,J.la=J.preferPerformance,J.ua="on-demand"===J.D,J.Ia=navigator.userAgent.match("Trident");var te=Element.prototype,ne=te.matches||te.matchesSelector||te.mozMatchesSelector||te.msMatchesSelector||te.oMatchesSelector||te.webkitMatchesSelector,re=document.createTextNode(""),ie=0,oe=[];function ae(e){oe.push(e),re.textContent=ie++}new MutationObserver((function(){for(;oe.length;)try{oe.shift()()}catch(e){throw re.textContent=ie++,e}})).observe(re,{characterData:!0});var se=!!document.contains;function ce(e,t){for(;t;){if(t==e)return!0;t=t.__shady_parentNode}return!1}function ue(e){for(var t=e.length-1;0<=t;t--){var n=e[t],r=n.getAttribute("id")||n.getAttribute("name");r&&"length"!==r&&isNaN(r)&&(e[r]=n)}return e.item=function(t){return e[t]},e.namedItem=function(t){if("length"!==t&&isNaN(t)&&e[t])return e[t];for(var n=o(e),r=n.next();!r.done;r=n.next())if(((r=r.value).getAttribute("id")||r.getAttribute("name"))==t)return r;return null},e}function le(e){var t=[];for(e=e.__shady_native_firstChild;e;e=e.__shady_native_nextSibling)t.push(e);return t}function he(e){var t=[];for(e=e.__shady_firstChild;e;e=e.__shady_nextSibling)t.push(e);return t}function fe(e,t,n){if(n.configurable=!0,n.value)e[t]=n.value;else try{Object.defineProperty(e,t,n)}catch(e){}}function de(e,t,n,r){for(var i in n=void 0===n?"":n,t)r&&0<=r.indexOf(i)||fe(e,n+i,t[i])}function pe(e,t){for(var n in t)n in e&&fe(e,n,t[n])}function me(e){var t={};return Object.getOwnPropertyNames(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t}function ve(e,t){for(var n,r=Object.getOwnPropertyNames(t),i=0;i<r.length;i++)e[n=r[i]]=t[n]}var ge,ye=[];function be(e){ge||(ge=!0,ae(_e)),ye.push(e)}function _e(){ge=!1;for(var e=!!ye.length;ye.length;)ye.shift()();return e}function we(){this.a=!1,this.addedNodes=[],this.removedNodes=[],this.ia=new Set}_e.list=ye,we.prototype.flush=function(){if(this.a){this.a=!1;var e=this.takeRecords();e.length&&this.ia.forEach((function(t){t(e)}))}},we.prototype.takeRecords=function(){if(this.addedNodes.length||this.removedNodes.length){var e=[{addedNodes:this.addedNodes,removedNodes:this.removedNodes}];return this.addedNodes=[],this.removedNodes=[],e}return[]};var xe=/[&\u00A0"]/g,Se=/[&\u00A0<>]/g;function Ee(e){switch(e){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case" ":return"&nbsp;"}}function Me(e){for(var t={},n=0;n<e.length;n++)t[e[n]]=!0;return t}var Ce=Me("area base br col command embed hr img input keygen link meta param source track wbr".split(" ")),Te=Me("style script xmp iframe noembed noframes plaintext noscript".split(" "));function Ae(e,t){"template"===e.localName&&(e=e.content);for(var n="",r=t?t(e):e.childNodes,i=0,o=r.length,a=void 0;i<o&&(a=r[i]);i++){e:{var s=a,c=e,u=t;switch(s.nodeType){case Node.ELEMENT_NODE:for(var l,h="<"+(c=s.localName),f=s.attributes,d=0;l=f[d];d++)h+=" "+l.name+'="'+l.value.replace(xe,Ee)+'"';h+=">",s=Ce[c]?h:h+Ae(s,u)+"</"+c+">";break e;case Node.TEXT_NODE:s=s.data,s=c&&Te[c.localName]?s:s.replace(Se,Ee);break e;case Node.COMMENT_NODE:s="\x3c!--"+s.data+"--\x3e";break e;default:throw window.console.error(s),Error("not implemented")}}n+=s}return n}var Pe=J.B,Le={querySelector:function(e){return this.__shady_native_querySelector(e)},querySelectorAll:function(e){return this.__shady_native_querySelectorAll(e)}},Re={};function ke(e){Re[e]=function(t){return t["__shady_native_"+e]}}function Ne(e,t){for(var n in de(e,t,"__shady_native_"),t)ke(n)}function Oe(e,t){t=void 0===t?[]:t;for(var n=0;n<t.length;n++){var r=t[n],i=Object.getOwnPropertyDescriptor(e,r);i&&(Object.defineProperty(e,"__shady_native_"+r,i),i.value?Le[r]||(Le[r]=i.value):ke(r))}}var De=document.createTreeWalker(document,NodeFilter.SHOW_ALL,null,!1),Fe=document.createTreeWalker(document,NodeFilter.SHOW_ELEMENT,null,!1),Ie=document.implementation.createHTMLDocument("inert");function Ue(e){for(var t;t=e.__shady_native_firstChild;)e.__shady_native_removeChild(t)}var Be=["firstElementChild","lastElementChild","children","childElementCount"],je=["querySelector","querySelectorAll"],ze=me({get childNodes(){return this.__shady_childNodes},get firstChild(){return this.__shady_firstChild},get lastChild(){return this.__shady_lastChild},get childElementCount(){return this.__shady_childElementCount},get children(){return this.__shady_children},get firstElementChild(){return this.__shady_firstElementChild},get lastElementChild(){return this.__shady_lastElementChild},get shadowRoot(){return this.__shady_shadowRoot}}),Ve=me({get textContent(){return this.__shady_textContent},set textContent(e){this.__shady_textContent=e},get innerHTML(){return this.__shady_innerHTML},set innerHTML(e){return this.__shady_innerHTML=e}}),Ge=me({get parentElement(){return this.__shady_parentElement},get parentNode(){return this.__shady_parentNode},get nextSibling(){return this.__shady_nextSibling},get previousSibling(){return this.__shady_previousSibling},get nextElementSibling(){return this.__shady_nextElementSibling},get previousElementSibling(){return this.__shady_previousElementSibling},get className(){return this.__shady_className},set className(e){return this.__shady_className=e}});function We(e){for(var t in e){var n=e[t];n&&(n.enumerable=!1)}}We(ze),We(Ve),We(Ge);var He=J.B||!0===J.D,qe=He?function(){}:function(e){var t=Y(e);t.Ka||(t.Ka=!0,pe(e,Ge))},Xe=He?function(){}:function(e){var t=Y(e);t.Ja||(t.Ja=!0,pe(e,ze),window.customElements&&window.customElements.polyfillWrapFlushCallback&&!J.D||pe(e,Ve))},Ye="__eventWrappers"+Date.now(),Ze=function(){var e=Object.getOwnPropertyDescriptor(Event.prototype,"composed");return e?function(t){return e.get.call(t)}:null}(),Je=function(){function e(){}var t=!1,n={get capture(){return t=!0,!1}};return window.addEventListener("test",e,n),window.removeEventListener("test",e,n),t}();function Ke(e){if(e&&"object"===n(e))var t=!!e.capture,r=!!e.once,i=!!e.passive,o=e.O;else t=!!e,i=r=!1;return{Ga:o,capture:t,once:r,passive:i,Fa:Je?e:t}}var $e={blur:!0,focus:!0,focusin:!0,focusout:!0,click:!0,dblclick:!0,mousedown:!0,mouseenter:!0,mouseleave:!0,mousemove:!0,mouseout:!0,mouseover:!0,mouseup:!0,wheel:!0,beforeinput:!0,input:!0,keydown:!0,keyup:!0,compositionstart:!0,compositionupdate:!0,compositionend:!0,touchstart:!0,touchend:!0,touchmove:!0,touchcancel:!0,pointerover:!0,pointerenter:!0,pointerdown:!0,pointermove:!0,pointerup:!0,pointercancel:!0,pointerout:!0,pointerleave:!0,gotpointercapture:!0,lostpointercapture:!0,dragstart:!0,drag:!0,dragenter:!0,dragleave:!0,dragover:!0,drop:!0,dragend:!0,DOMActivate:!0,DOMFocusIn:!0,DOMFocusOut:!0,keypress:!0},Qe={DOMAttrModified:!0,DOMAttributeNameChanged:!0,DOMCharacterDataModified:!0,DOMElementNameChanged:!0,DOMNodeInserted:!0,DOMNodeInsertedIntoDocument:!0,DOMNodeRemoved:!0,DOMNodeRemovedFromDocument:!0,DOMSubtreeModified:!0};function et(e){return e instanceof Node?e.__shady_getRootNode():e}function tt(e,t){var n=[],r=e;for(e=et(e);r;)n.push(r),r=r.__shady_assignedSlot?r.__shady_assignedSlot:r.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&r.host&&(t||r!==e)?r.host:r.__shady_parentNode;return n[n.length-1]===document&&n.push(window),n}function nt(e,t){if(!Q)return e;e=tt(e,!0);for(var n,r,i=0,o=void 0,a=void 0;i<t.length;i++)if((r=et(n=t[i]))!==o&&(a=e.indexOf(r),o=r),!Q(r)||-1<a)return n}function rt(e){function t(t,n){return(t=new e(t,n)).__composed=n&&!!n.composed,t}return t.__proto__=e,t.prototype=e.prototype,t}var it={focus:!0,blur:!0};function ot(e){return e.__target!==e.target||e.__relatedTarget!==e.relatedTarget}function at(e,t,n){if(n=t.__handlers&&t.__handlers[e.type]&&t.__handlers[e.type][n])for(var r,i=0;(r=n[i])&&(!ot(e)||e.target!==e.relatedTarget)&&(r.call(t,e),!e.__immediatePropagationStopped);i++);}function st(e){var t,n=e.composedPath();Object.defineProperty(e,"currentTarget",{get:function(){return i},configurable:!0});for(var r=n.length-1;0<=r;r--){var i=n[r];if(at(e,i,"capture"),e.ma)return}for(Object.defineProperty(e,"eventPhase",{get:function(){return Event.AT_TARGET}}),r=0;r<n.length;r++){var o=Z(i=n[r]);if(o=o&&o.root,(0===r||o&&o===t)&&(at(e,i,"bubble"),i!==window&&(t=i.__shady_getRootNode()),e.ma))break}}function ct(e,t,n,r,i,o){for(var a=0;a<e.length;a++){var s=e[a],c=s.type,u=s.capture,l=s.once,h=s.passive;if(t===s.node&&n===c&&r===u&&i===l&&o===h)return a}return-1}function ut(e){return _e(),this.__shady_native_dispatchEvent(e)}function lt(e,t,r){var i=Ke(r),o=i.capture,a=i.once,s=i.passive,c=i.Ga;if(i=i.Fa,t){var u=n(t);if(("function"===u||"object"===u)&&("object"!==u||t.handleEvent&&"function"==typeof t.handleEvent)){if(Qe[e])return this.__shady_native_addEventListener(e,t,i);var l=c||this;if(c=t[Ye]){if(-1<ct(c,l,e,o,a,s))return}else t[Ye]=[];c=function(n){if(a&&this.__shady_removeEventListener(e,t,r),n.__target||dt(n),l!==this){var i=Object.getOwnPropertyDescriptor(n,"currentTarget");Object.defineProperty(n,"currentTarget",{get:function(){return l},configurable:!0})}if(n.__previousCurrentTarget=n.currentTarget,(!Q(l)&&"slot"!==l.localName||-1!=n.composedPath().indexOf(l))&&(n.composed||-1<n.composedPath().indexOf(l)))if(ot(n)&&n.target===n.relatedTarget)n.eventPhase===Event.BUBBLING_PHASE&&n.stopImmediatePropagation();else if(n.eventPhase===Event.CAPTURING_PHASE||n.bubbles||n.target===l||l instanceof Window){var o="function"===u?t.call(l,n):t.handleEvent&&t.handleEvent(n);return l!==this&&(i?(Object.defineProperty(n,"currentTarget",i),i=null):delete n.currentTarget),o}},t[Ye].push({node:l,type:e,capture:o,once:a,passive:s,lb:c}),it[e]?(this.__handlers=this.__handlers||{},this.__handlers[e]=this.__handlers[e]||{capture:[],bubble:[]},this.__handlers[e][o?"capture":"bubble"].push(c)):this.__shady_native_addEventListener(e,c,i)}}}function ht(e,t,n){if(t){var r=Ke(n);n=r.capture;var i=r.once,o=r.passive,a=r.Ga;if(r=r.Fa,Qe[e])return this.__shady_native_removeEventListener(e,t,r);var s=a||this;a=void 0;var c=null;try{c=t[Ye]}catch(e){}c&&-1<(i=ct(c,s,e,n,i,o))&&(a=c.splice(i,1)[0].lb,c.length||(t[Ye]=void 0)),this.__shady_native_removeEventListener(e,a||t,r),a&&it[e]&&this.__handlers&&this.__handlers[e]&&-1<(t=(e=this.__handlers[e][n?"capture":"bubble"]).indexOf(a))&&e.splice(t,1)}}var ft=me({get composed(){return void 0===this.__composed&&(Ze?this.__composed="focusin"===this.type||"focusout"===this.type||Ze(this):!1!==this.isTrusted&&(this.__composed=$e[this.type])),this.__composed||!1},composedPath:function(){return this.__composedPath||(this.__composedPath=tt(this.__target,this.composed)),this.__composedPath},get target(){return nt(this.currentTarget||this.__previousCurrentTarget,this.composedPath())},get relatedTarget(){return this.__relatedTarget?(this.__relatedTargetComposedPath||(this.__relatedTargetComposedPath=tt(this.__relatedTarget,!0)),nt(this.currentTarget||this.__previousCurrentTarget,this.__relatedTargetComposedPath)):null},stopPropagation:function(){Event.prototype.stopPropagation.call(this),this.ma=!0},stopImmediatePropagation:function(){Event.prototype.stopImmediatePropagation.call(this),this.ma=this.__immediatePropagationStopped=!0}});function dt(e){if(e.__target=e.target,e.__relatedTarget=e.relatedTarget,J.B){var t=Object.getPrototypeOf(e);if(!t.hasOwnProperty("__shady_patchedProto")){var n=Object.create(t);n.__shady_sourceProto=t,de(n,ft),t.__shady_patchedProto=n}e.__proto__=t.__shady_patchedProto}else de(e,ft)}var pt=rt(Event),mt=rt(CustomEvent),vt=rt(MouseEvent),gt=Object.getOwnPropertyNames(Element.prototype).filter((function(e){return"on"===e.substring(0,2)})),yt=Object.getOwnPropertyNames(HTMLElement.prototype).filter((function(e){return"on"===e.substring(0,2)}));function bt(e){return{set:function(t){var n=Y(this),r=e.substring(2);n.N||(n.N={}),n.N[e]&&this.removeEventListener(r,n.N[e]),this.__shady_addEventListener(r,t),n.N[e]=t},get:function(){var t=Z(this);return t&&t.N&&t.N[e]},configurable:!0}}function _t(e,t){return{index:e,aa:[],ha:t}}function wt(e,t,n,r){var i=0,o=0,a=0,s=0,c=Math.min(t-i,r-o);if(0==i&&0==o)e:{for(a=0;a<c;a++)if(e[a]!==n[a])break e;a=c}if(t==e.length&&r==n.length){s=e.length;for(var u=n.length,l=0;l<c-a&&xt(e[--s],n[--u]);)l++;s=l}if(o+=a,r-=s,0==(t-=s)-(i+=a)&&0==r-o)return[];if(i==t){for(t=_t(i,0);o<r;)t.aa.push(n[o++]);return[t]}if(o==r)return[_t(i,t-i)];for(r=r-(a=o)+1,s=t-(c=i)+1,t=Array(r),u=0;u<r;u++)t[u]=Array(s),t[u][0]=u;for(u=0;u<s;u++)t[0][u]=u;for(u=1;u<r;u++)for(l=1;l<s;l++)if(e[c+l-1]===n[a+u-1])t[u][l]=t[u-1][l-1];else{var h=t[u-1][l]+1,f=t[u][l-1]+1;t[u][l]=h<f?h:f}for(c=t.length-1,a=t[0].length-1,r=t[c][a],e=[];0<c||0<a;)0==c?(e.push(2),a--):0==a?(e.push(3),c--):(s=t[c-1][a-1],(h=(u=t[c-1][a])<(l=t[c][a-1])?u<s?u:s:l<s?l:s)==s?(s==r?e.push(0):(e.push(1),r=s),c--,a--):h==u?(e.push(3),c--,r=u):(e.push(2),a--,r=l));for(e.reverse(),t=void 0,c=[],a=0;a<e.length;a++)switch(e[a]){case 0:t&&(c.push(t),t=void 0),i++,o++;break;case 1:t||(t=_t(i,0)),t.ha++,i++,t.aa.push(n[o]),o++;break;case 2:t||(t=_t(i,0)),t.ha++,i++;break;case 3:t||(t=_t(i,0)),t.aa.push(n[o]),o++}return t&&c.push(t),c}function xt(e,t){return e===t}var St=me({dispatchEvent:ut,addEventListener:lt,removeEventListener:ht}),Et=null;function Mt(){return Et||(Et=window.ShadyCSS&&window.ShadyCSS.ScopingShim),Et||null}function Ct(e,t,n){var r=Mt();return!(!r||"class"!==t||(r.setElementClass(e,n),0))}function Tt(e,t){var n=Mt();n&&n.unscopeNode(e,t)}function At(e){if(e.nodeType!==Node.ELEMENT_NODE)return"";var t=Mt();return t?t.currentScopeForNode(e):""}function Pt(e,t){if(e)for(e.nodeType===Node.ELEMENT_NODE&&t(e),e=e.__shady_firstChild;e;e=e.__shady_nextSibling)e.nodeType===Node.ELEMENT_NODE&&Pt(e,t)}var Lt=window.document,Rt=J.la,kt=Object.getOwnPropertyDescriptor(Node.prototype,"isConnected"),Nt=kt&&kt.get;function Ot(e){for(var t;t=e.__shady_firstChild;)e.__shady_removeChild(t)}function Dt(e,t,n){if(e=(e=Z(e))&&e.Z){if(t)if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE)for(var r=0,i=t.childNodes.length;r<i;r++)e.addedNodes.push(t.childNodes[r]);else e.addedNodes.push(t);n&&e.removedNodes.push(n),function(e){e.a||(e.a=!0,ae((function(){e.flush()})))}(e)}}var Ft=me({get parentNode(){var e=Z(this);return void 0!==(e=e&&e.parentNode)?e:this.__shady_native_parentNode},get firstChild(){var e=Z(this);return void 0!==(e=e&&e.firstChild)?e:this.__shady_native_firstChild},get lastChild(){var e=Z(this);return void 0!==(e=e&&e.lastChild)?e:this.__shady_native_lastChild},get nextSibling(){var e=Z(this);return void 0!==(e=e&&e.nextSibling)?e:this.__shady_native_nextSibling},get previousSibling(){var e=Z(this);return void 0!==(e=e&&e.previousSibling)?e:this.__shady_native_previousSibling},get childNodes(){if($(this)){var e=Z(this);if(!e.childNodes){e.childNodes=[];for(var t=this.__shady_firstChild;t;t=t.__shady_nextSibling)e.childNodes.push(t)}var n=e.childNodes}else n=this.__shady_native_childNodes;return n.item=function(e){return n[e]},n},get parentElement(){var e=Z(this);return(e=e&&e.parentNode)&&e.nodeType!==Node.ELEMENT_NODE&&(e=null),void 0!==e?e:this.__shady_native_parentElement},get isConnected(){if(Nt&&Nt.call(this))return!0;if(this.nodeType==Node.DOCUMENT_FRAGMENT_NODE)return!1;var e=this.ownerDocument;if(se){if(e.__shady_native_contains(this))return!0}else if(e.documentElement&&e.documentElement.__shady_native_contains(this))return!0;for(e=this;e&&!(e instanceof Document);)e=e.__shady_parentNode||(Q(e)?e.host:void 0);return!!(e&&e instanceof Document)},get textContent(){if($(this)){for(var e=[],t=this.__shady_firstChild;t;t=t.__shady_nextSibling)t.nodeType!==Node.COMMENT_NODE&&e.push(t.__shady_textContent);return e.join("")}return this.__shady_native_textContent},set textContent(e){switch(null!=e||(e=""),this.nodeType){case Node.ELEMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:if(!$(this)&&J.B){var t=this.__shady_firstChild;(t!=this.__shady_lastChild||t&&t.nodeType!=Node.TEXT_NODE)&&Ot(this),this.__shady_native_textContent=e}else Ot(this),(0<e.length||this.nodeType===Node.ELEMENT_NODE)&&this.__shady_insertBefore(document.createTextNode(e));break;default:this.nodeValue=e}},insertBefore:function(e,t){if(this.ownerDocument!==Lt&&e.ownerDocument!==Lt)return this.__shady_native_insertBefore(e,t),e;if(e===this)throw Error("Failed to execute 'appendChild' on 'Node': The new child element contains the parent.");if(t){var n=Z(t);if(void 0!==(n=n&&n.parentNode)&&n!==this||void 0===n&&t.__shady_native_parentNode!==this)throw Error("Failed to execute 'insertBefore' on 'Node': The node before which the new node is to be inserted is not a child of this node.")}if(t===e)return e;Dt(this,e);var r=[],i=(n=On(this))?n.host.localName:At(this),s=e.__shady_parentNode;if(s){var c=At(e),u=!!n||!On(e)||Rt&&void 0!==this.__noInsertionPoint;s.__shady_removeChild(e,u)}s=!0;var l=(!Rt||void 0===e.__noInsertionPoint&&void 0===this.__noInsertionPoint)&&!function e(t,n){var r=Mt();if(!r)return!0;if(t.nodeType===Node.DOCUMENT_FRAGMENT_NODE){for(r=!0,t=t.__shady_firstChild;t;t=t.__shady_nextSibling)r=r&&e(t,n);return r}return t.nodeType!==Node.ELEMENT_NODE||r.currentScopeForNode(t)===n}(e,i),h=n&&!e.__noInsertionPoint&&(!Rt||e.nodeType===Node.DOCUMENT_FRAGMENT_NODE);return(h||l)&&(l&&(c=c||At(e)),Pt(e,(function(e){if(h&&"slot"===e.localName&&r.push(e),l){var t=c;Mt()&&(t&&Tt(e,t),(t=Mt())&&t.scopeNode(e,i))}}))),r.length&&(Cn(n),n.c.push.apply(n.c,r instanceof Array?r:a(o(r))),wn(n)),$(this)&&(function(e,t,n){ln(t,2);var r=Y(t);if(void 0!==r.firstChild&&(r.childNodes=null),e.nodeType===Node.DOCUMENT_FRAGMENT_NODE)for(e=e.__shady_native_firstChild;e;e=e.__shady_native_nextSibling)hn(e,t,r,n);else hn(e,t,r,n)}(e,this,t),(u=Z(this)).root?(s=!1,ee(this)&&wn(u.root)):n&&"slot"===this.localName&&(s=!1,wn(n))),s?(n=Q(this)?this.host:this,t?(t=function e(t){var n=t;if(t&&"slot"===t.localName){var r=Z(t);(r=r&&r.V)&&(n=r.length?r[0]:e(t.__shady_nextSibling))}return n}(t),n.__shady_native_insertBefore(e,t)):n.__shady_native_appendChild(e)):e.ownerDocument!==this.ownerDocument&&this.ownerDocument.adoptNode(e),e},appendChild:function(e){if(this!=e||!Q(e))return this.__shady_insertBefore(e)},removeChild:function(e,t){if(t=void 0!==t&&t,this.ownerDocument!==Lt)return this.__shady_native_removeChild(e);if(e.__shady_parentNode!==this)throw Error("The node to be removed is not a child of this node: "+e);Dt(this,null,e);var n=On(e),r=n&&function(e,t){if(e.a){Tn(e);var n,r=e.b;for(n in r)for(var i=r[n],o=0;o<i.length;o++){var a=i[o];if(ce(t,a)){i.splice(o,1);var s=e.a.indexOf(a);if(0<=s&&(e.a.splice(s,1),(s=Z(a.__shady_parentNode))&&s.ca&&s.ca--),o--,s=(a=Z(a)).V)for(var c=0;c<s.length;c++){var u=s[c],l=u.__shady_native_parentNode;l&&l.__shady_native_removeChild(u)}a.V=[],a.assignedNodes=[],s=!0}}return s}}(n,e),i=Z(this);if($(this)&&(function(e,t){var n=Y(e);e===(t=Y(t)).firstChild&&(t.firstChild=n.nextSibling),e===t.lastChild&&(t.lastChild=n.previousSibling),e=n.previousSibling;var r=n.nextSibling;e&&(Y(e).nextSibling=r),r&&(Y(r).previousSibling=e),n.parentNode=n.previousSibling=n.nextSibling=void 0,void 0!==t.childNodes&&(t.childNodes=null)}(e,this),ee(this))){wn(i.root);var o=!0}if(Mt()&&!t&&n&&e.nodeType!==Node.TEXT_NODE){var a=At(e);Pt(e,(function(e){Tt(e,a)}))}return function e(t){var n=Z(t);if(n&&void 0!==n.ka)for(n=t.__shady_firstChild;n;n=n.__shady_nextSibling)e(n);(t=Z(t))&&(t.ka=void 0)}(e),n&&((t="slot"===this.localName)&&(o=!0),(r||t)&&wn(n)),o||(o=Q(this)?this.host:this,(!i.root&&"slot"!==e.localName||o===e.__shady_native_parentNode)&&o.__shady_native_removeChild(e)),e},replaceChild:function(e,t){return this.__shady_insertBefore(e,t),this.__shady_removeChild(t),e},cloneNode:function(e){if("template"==this.localName)return this.__shady_native_cloneNode(e);var t=this.__shady_native_cloneNode(!1);if(e&&t.nodeType!==Node.ATTRIBUTE_NODE){e=this.__shady_firstChild;for(var n;e;e=e.__shady_nextSibling)n=e.__shady_cloneNode(!0),t.__shady_appendChild(n)}return t},getRootNode:function(e){if(this&&this.nodeType){var t=Y(this),n=t.ka;return void 0===n&&(Q(this)?(n=this,t.ka=n):(n=(n=this.__shady_parentNode)?n.__shady_getRootNode(e):this,document.documentElement.__shady_native_contains(this)&&(t.ka=n))),n}},contains:function(e){return ce(this,e)}}),It=me({get assignedSlot(){var e=this.__shady_parentNode;return(e=e&&e.__shady_shadowRoot)&&xn(e),(e=Z(this))&&e.assignedSlot||null}});function Ut(e,t,n){var r=[];return function e(t,n,r,i){for(t=t.__shady_firstChild;t;t=t.__shady_nextSibling){var o;if(o=t.nodeType===Node.ELEMENT_NODE){var a=n,s=r,c=i,u=a(o=t);u&&c.push(o),s&&s(u)?o=u:(e(o,a,s,c),o=void 0)}if(o)break}}(e,t,n,r),r}var Bt=me({get firstElementChild(){var e=Z(this);if(e&&void 0!==e.firstChild){for(e=this.__shady_firstChild;e&&e.nodeType!==Node.ELEMENT_NODE;)e=e.__shady_nextSibling;return e}return this.__shady_native_firstElementChild},get lastElementChild(){var e=Z(this);if(e&&void 0!==e.lastChild){for(e=this.__shady_lastChild;e&&e.nodeType!==Node.ELEMENT_NODE;)e=e.__shady_previousSibling;return e}return this.__shady_native_lastElementChild},get children(){return $(this)?ue(Array.prototype.filter.call(he(this),(function(e){return e.nodeType===Node.ELEMENT_NODE}))):this.__shady_native_children},get childElementCount(){var e=this.__shady_children;return e?e.length:0}}),jt=me({querySelector:function(e){return Ut(this,(function(t){return ne.call(t,e)}),(function(e){return!!e}))[0]||null},querySelectorAll:function(e,t){if(t){t=Array.prototype.slice.call(this.__shady_native_querySelectorAll(e));var n=this.__shady_getRootNode();return ue(t.filter((function(e){return e.__shady_getRootNode()==n})))}return ue(Ut(this,(function(t){return ne.call(t,e)})))}}),zt=J.la&&!J.D?ve({},Bt):Bt;ve(Bt,jt);var Vt=window.document;function Gt(e,t){if("slot"===t)ee(e=e.__shady_parentNode)&&wn(Z(e).root);else if("slot"===e.localName&&"name"===t&&(t=On(e))){if(t.a){Tn(t);var n=e.La,r=An(e);if(r!==n){var i=(n=t.b[n]).indexOf(e);0<=i&&n.splice(i,1),(n=t.b[r]||(t.b[r]=[])).push(e),1<n.length&&(t.b[r]=Pn(n))}}wn(t)}}var Wt=me({get previousElementSibling(){var e=Z(this);if(e&&void 0!==e.previousSibling){for(e=this.__shady_previousSibling;e&&e.nodeType!==Node.ELEMENT_NODE;)e=e.__shady_previousSibling;return e}return this.__shady_native_previousElementSibling},get nextElementSibling(){var e=Z(this);if(e&&void 0!==e.nextSibling){for(e=this.__shady_nextSibling;e&&e.nodeType!==Node.ELEMENT_NODE;)e=e.__shady_nextSibling;return e}return this.__shady_native_nextElementSibling},get slot(){return this.getAttribute("slot")},set slot(e){this.__shady_setAttribute("slot",e)},get className(){return this.getAttribute("class")||""},set className(e){this.__shady_setAttribute("class",e)},setAttribute:function(e,t){this.ownerDocument!==Vt?this.__shady_native_setAttribute(e,t):Ct(this,e,t)||(this.__shady_native_setAttribute(e,t),Gt(this,e))},removeAttribute:function(e){this.ownerDocument!==Vt?this.__shady_native_removeAttribute(e):Ct(this,e,"")?""===this.getAttribute(e)&&this.__shady_native_removeAttribute(e):(this.__shady_native_removeAttribute(e),Gt(this,e))}});J.la||gt.forEach((function(e){Wt[e]=bt(e)}));var Ht=me({attachShadow:function(e){if(!this)throw Error("Must provide a host.");if(!e)throw Error("Not enough arguments.");if(e.shadyUpgradeFragment&&!J.Ia){var t=e.shadyUpgradeFragment;if(t.__proto__=ShadowRoot.prototype,_n(t,this,e),fn(t,t),e=t.__noInsertionPoint?null:t.querySelectorAll("slot"),t.__noInsertionPoint=void 0,e&&e.length){var n=t;Cn(n),n.c.push.apply(n.c,e instanceof Array?e:a(o(e))),wn(t)}t.host.__shady_native_appendChild(t)}else t=new bn(vn,this,e);return this.__CE_shadowRoot=t},get shadowRoot(){var e=Z(this);return e&&e.bb||null}});ve(Wt,Ht);var qt=document.implementation.createHTMLDocument("inert"),Xt=me({get innerHTML(){return $(this)?Ae("template"===this.localName?this.content:this,he):this.__shady_native_innerHTML},set innerHTML(e){if("template"===this.localName)this.__shady_native_innerHTML=e;else{Ot(this);var t=this.localName||"div";for(t=this.namespaceURI&&this.namespaceURI!==qt.namespaceURI?qt.createElementNS(this.namespaceURI,t):qt.createElement(t),J.B?t.__shady_native_innerHTML=e:t.innerHTML=e;e=t.__shady_firstChild;)this.__shady_insertBefore(e)}}}),Yt=me({blur:function(){var e=Z(this);(e=(e=e&&e.root)&&e.activeElement)?e.__shady_blur():this.__shady_native_blur()}});J.la||yt.forEach((function(e){Yt[e]=bt(e)}));var Zt=me({assignedNodes:function(e){if("slot"===this.localName){var t=this.__shady_getRootNode();return t&&Q(t)&&xn(t),(t=Z(this))&&(e&&e.flatten?t.V:t.assignedNodes)||[]}},addEventListener:function(e,t,r){if("slot"!==this.localName||"slotchange"===e)lt.call(this,e,t,r);else{"object"!==n(r)&&(r={capture:!!r});var i=this.__shady_parentNode;if(!i)throw Error("ShadyDOM cannot attach event to slot unless it has a `parentNode`");r.O=this,i.__shady_addEventListener(e,t,r)}},removeEventListener:function(e,t,r){if("slot"!==this.localName||"slotchange"===e)ht.call(this,e,t,r);else{"object"!==n(r)&&(r={capture:!!r});var i=this.__shady_parentNode;if(!i)throw Error("ShadyDOM cannot attach event to slot unless it has a `parentNode`");r.O=this,i.__shady_removeEventListener(e,t,r)}}}),Jt=me({getElementById:function(e){return""===e?null:Ut(this,(function(t){return t.id==e}),(function(e){return!!e}))[0]||null}}),Kt=me({get activeElement(){var e=J.B?document.__shady_native_activeElement:document.activeElement;if(!e||!e.nodeType)return null;var t=!!Q(this);if(!(this===document||t&&this.host!==e&&this.host.__shady_native_contains(e)))return null;for(t=On(e);t&&t!==this;)t=On(e=t.host);return this===document?t?null:e:t===this?e:null}}),$t=window.document,Qt=me({importNode:function(e,t){if(e.ownerDocument!==$t||"template"===e.localName)return this.__shady_native_importNode(e,t);var n=this.__shady_native_importNode(e,!1);if(t)for(e=e.__shady_firstChild;e;e=e.__shady_nextSibling)t=this.__shady_importNode(e,!0),n.__shady_appendChild(t);return n}}),en=me({dispatchEvent:ut,addEventListener:lt.bind(window),removeEventListener:ht.bind(window)}),tn={};Object.getOwnPropertyDescriptor(HTMLElement.prototype,"parentElement")&&(tn.parentElement=Ft.parentElement),Object.getOwnPropertyDescriptor(HTMLElement.prototype,"contains")&&(tn.contains=Ft.contains),Object.getOwnPropertyDescriptor(HTMLElement.prototype,"children")&&(tn.children=Bt.children),Object.getOwnPropertyDescriptor(HTMLElement.prototype,"innerHTML")&&(tn.innerHTML=Xt.innerHTML),Object.getOwnPropertyDescriptor(HTMLElement.prototype,"className")&&(tn.className=Wt.className);var nn={EventTarget:[St],Node:[Ft,window.EventTarget?null:St],Text:[It],Comment:[It],CDATASection:[It],ProcessingInstruction:[It],Element:[Wt,Bt,It,!J.B||"innerHTML"in Element.prototype?Xt:null,window.HTMLSlotElement?null:Zt],HTMLElement:[Yt,tn],HTMLSlotElement:[Zt],DocumentFragment:[zt,Jt],Document:[Qt,zt,Jt,Kt],Window:[en]},rn=J.B?null:["innerHTML","textContent"];function on(e,t,n,r){t.forEach((function(t){return e&&t&&de(e,t,n,r)}))}function an(e){var t,n=e?null:rn;for(t in nn)on(window[t]&&window[t].prototype,nn[t],e,n)}function sn(e){return e.__shady_protoIsPatched=!0,on(e,nn.EventTarget),on(e,nn.Node),on(e,nn.Element),on(e,nn.HTMLElement),on(e,nn.HTMLSlotElement),e}["Text","Comment","CDATASection","ProcessingInstruction"].forEach((function(e){var t=window[e],n=Object.create(t.prototype);n.__shady_protoIsPatched=!0,on(n,nn.EventTarget),on(n,nn.Node),nn[e]&&on(n,nn[e]),t.prototype.__shady_patchedProto=n}));var cn=J.ua,un=J.B;function ln(e,t){if(cn&&!e.__shady_protoIsPatched&&!Q(e)){var n=Object.getPrototypeOf(e),r=n.hasOwnProperty("__shady_patchedProto")&&n.__shady_patchedProto;r||(sn(r=Object.create(n)),n.__shady_patchedProto=r),Object.setPrototypeOf(e,r)}un||(1===t?qe(e):2===t&&Xe(e))}function hn(e,t,n,r){ln(e,1),r=r||null;var i=Y(e),o=r?Y(r):null;i.previousSibling=r?o.previousSibling:t.__shady_lastChild,(o=Z(i.previousSibling))&&(o.nextSibling=e),(o=Z(i.nextSibling=r))&&(o.previousSibling=e),i.parentNode=t,r?r===n.firstChild&&(n.firstChild=e):(n.lastChild=e,n.firstChild||(n.firstChild=e)),n.childNodes=null}function fn(e,t){var n=Y(e);if(t||void 0===n.firstChild){n.childNodes=null;var r=n.firstChild=e.__shady_native_firstChild;for(n.lastChild=e.__shady_native_lastChild,ln(e,2),n=r,r=void 0;n;n=n.__shady_native_nextSibling){var i=Y(n);i.parentNode=t||e,i.nextSibling=n.__shady_native_nextSibling,i.previousSibling=r||null,r=n,ln(n,1)}}}var dn=me({addEventListener:function(e,t,r){"object"!==n(r)&&(r={capture:!!r}),r.O=r.O||this,this.host.__shady_addEventListener(e,t,r)},removeEventListener:function(e,t,r){"object"!==n(r)&&(r={capture:!!r}),r.O=r.O||this,this.host.__shady_removeEventListener(e,t,r)}});function pn(e,t){de(e,dn,t),de(e,Kt,t),de(e,Xt,t),de(e,Bt,t),J.D&&!t?(de(e,Ft,t),de(e,Jt,t)):J.B||(de(e,Ge),de(e,ze),de(e,Ve))}var mn,vn={},gn=J.deferConnectionCallbacks&&"loading"===document.readyState;function yn(e){var t=[];do{t.unshift(e)}while(e=e.__shady_parentNode);return t}function bn(e,t,n){if(e!==vn)throw new TypeError("Illegal constructor");this.a=null,_n(this,t,n)}function _n(e,t,n){if(e.host=t,e.mode=n&&n.mode,fn(e.host),(t=Y(e.host)).root=e,t.bb="closed"!==e.mode?e:null,(t=Y(e)).firstChild=t.lastChild=t.parentNode=t.nextSibling=t.previousSibling=null,J.preferPerformance)for(;t=e.host.__shady_native_firstChild;)e.host.__shady_native_removeChild(t);else wn(e)}function wn(e){e.T||(e.T=!0,be((function(){return xn(e)})))}function xn(e){var t;if(t=e.T){for(var n;e;)e.T&&(n=e),Q(e=(t=e).host.__shady_getRootNode())&&(t=Z(t.host))&&0<t.ca||(e=void 0);t=n}(n=t)&&n._renderSelf()}function Sn(e,t,n){var r=Y(t),i=r.oa;r.oa=null,n||(n=(e=e.b[t.__shady_slot||"__catchall"])&&e[0]),n?(Y(n).assignedNodes.push(t),r.assignedSlot=n):r.assignedSlot=void 0,i!==r.assignedSlot&&r.assignedSlot&&(Y(r.assignedSlot).ra=!0)}function En(e,t,n){for(var r=0,i=void 0;r<n.length&&(i=n[r]);r++)if("slot"==i.localName){var o=Z(i).assignedNodes;o&&o.length&&En(e,t,o)}else t.push(n[r])}function Mn(e,t){t.__shady_native_dispatchEvent(new Event("slotchange")),(t=Z(t)).assignedSlot&&Mn(e,t.assignedSlot)}function Cn(e){e.c=e.c||[],e.a=e.a||[],e.b=e.b||{}}function Tn(e){if(e.c&&e.c.length){for(var t,n=e.c,r=0;r<n.length;r++){var i=n[r];fn(i);var o=i.__shady_parentNode;fn(o),(o=Z(o)).ca=(o.ca||0)+1,o=An(i),e.b[o]?((t=t||{})[o]=!0,e.b[o].push(i)):e.b[o]=[i],e.a.push(i)}if(t)for(var a in t)e.b[a]=Pn(e.b[a]);e.c=[]}}function An(e){var t=e.name||e.getAttribute("name")||"__catchall";return e.La=t}function Pn(e){return e.sort((function(e,t){e=yn(e);for(var n=yn(t),r=0;r<e.length;r++){t=e[r];var i=n[r];if(t!==i)return(e=he(t.__shady_parentNode)).indexOf(t)-e.indexOf(i)}}))}function Ln(e){return Tn(e),!(!e.a||!e.a.length)}if(bn.prototype._renderSelf=function(){var e=gn;if(gn=!0,this.T=!1,this.a){Tn(this);for(var t,n=0;n<this.a.length;n++){var r=Z(t=this.a[n]),i=r.assignedNodes;if(r.assignedNodes=[],r.V=[],r.Ba=i)for(r=0;r<i.length;r++){var o=Z(i[r]);o.oa=o.assignedSlot,o.assignedSlot===t&&(o.assignedSlot=null)}}for(n=this.host.__shady_firstChild;n;n=n.__shady_nextSibling)Sn(this,n);for(n=0;n<this.a.length;n++){if(!(i=Z(t=this.a[n])).assignedNodes.length)for(r=t.__shady_firstChild;r;r=r.__shady_nextSibling)Sn(this,r,t);if((r=(r=Z(t.__shady_parentNode))&&r.root)&&(Ln(r)||r.T)&&r._renderSelf(),En(this,i.V,i.assignedNodes),r=i.Ba){for(o=0;o<r.length;o++)Z(r[o]).oa=null;i.Ba=null,r.length>i.assignedNodes.length&&(i.ra=!0)}i.ra&&(i.ra=!1,Mn(this,t))}for(t=this.a,n=[],i=0;i<t.length;i++)(o=Z(r=t[i].__shady_parentNode))&&o.root||!(0>n.indexOf(r))||n.push(r);for(t=0;t<n.length;t++){for(i=(o=n[t])===this?this.host:o,r=[],o=o.__shady_firstChild;o;o=o.__shady_nextSibling)if("slot"==o.localName)for(var a=Z(o).V,s=0;s<a.length;s++)r.push(a[s]);else r.push(o);o=le(i),a=wt(r,r.length,o,o.length);for(var c=s=0,u=void 0;s<a.length&&(u=a[s]);s++){for(var l=0,h=void 0;l<u.aa.length&&(h=u.aa[l]);l++)h.__shady_native_parentNode===i&&i.__shady_native_removeChild(h),o.splice(u.index+c,1);c-=u.ha}for(c=0,u=void 0;c<a.length&&(u=a[c]);c++)for(s=o[u.index],l=u.index;l<u.index+u.ha;l++)h=r[l],i.__shady_native_insertBefore(h,s),o.splice(l,0,h)}}if(!J.preferPerformance&&!this.Aa)for(n=this.host.__shady_firstChild;n;n=n.__shady_nextSibling)t=Z(n),n.__shady_native_parentNode!==this.host||"slot"!==n.localName&&t.assignedSlot||this.host.__shady_native_removeChild(n);this.Aa=!0,gn=e,mn&&mn()},function(e){e.__proto__=DocumentFragment.prototype,pn(e,"__shady_"),pn(e),Object.defineProperties(e,{nodeType:{value:Node.DOCUMENT_FRAGMENT_NODE,configurable:!0},nodeName:{value:"#document-fragment",configurable:!0},nodeValue:{value:null,configurable:!0}}),["localName","namespaceURI","prefix"].forEach((function(t){Object.defineProperty(e,t,{value:void 0,configurable:!0})})),["ownerDocument","baseURI","isConnected"].forEach((function(t){Object.defineProperty(e,t,{get:function(){return this.host[t]},configurable:!0})}))}(bn.prototype),window.customElements&&window.customElements.define&&J.sa&&!J.preferPerformance){var Rn=new Map;mn=function(){var e=[];Rn.forEach((function(t,n){e.push([n,t])})),Rn.clear();for(var t=0;t<e.length;t++){var n=e[t][0];e[t][1]?n.__shadydom_connectedCallback():n.__shadydom_disconnectedCallback()}},gn&&document.addEventListener("readystatechange",(function(){gn=!1,mn()}),{once:!0});var kn=window.customElements.define,Nn=function(e,t){var n=t.prototype.connectedCallback,r=t.prototype.disconnectedCallback;kn.call(window.customElements,e,function(e,t,n){var r=0,i="__isConnected"+r++;return(t||n)&&(e.prototype.connectedCallback=e.prototype.__shadydom_connectedCallback=function(){gn?Rn.set(this,!0):this[i]||(this[i]=!0,t&&t.call(this))},e.prototype.disconnectedCallback=e.prototype.__shadydom_disconnectedCallback=function(){gn?this.isConnected||Rn.set(this,!1):this[i]&&(this[i]=!1,n&&n.call(this))}),e}(t,n,r)),t.prototype.connectedCallback=n,t.prototype.disconnectedCallback=r};window.customElements.define=Nn,Object.defineProperty(window.CustomElementRegistry.prototype,"define",{value:Nn,configurable:!0})}function On(e){if(Q(e=e.__shady_getRootNode()))return e}function Dn(e){this.node=e}function Fn(e){Object.defineProperty(Dn.prototype,e,{get:function(){return this.node["__shady_"+e]},set:function(t){this.node["__shady_"+e]=t},configurable:!0})}(r=Dn.prototype).addEventListener=function(e,t,n){return this.node.__shady_addEventListener(e,t,n)},r.removeEventListener=function(e,t,n){return this.node.__shady_removeEventListener(e,t,n)},r.appendChild=function(e){return this.node.__shady_appendChild(e)},r.insertBefore=function(e,t){return this.node.__shady_insertBefore(e,t)},r.removeChild=function(e){return this.node.__shady_removeChild(e)},r.replaceChild=function(e,t){return this.node.__shady_replaceChild(e,t)},r.cloneNode=function(e){return this.node.__shady_cloneNode(e)},r.getRootNode=function(e){return this.node.__shady_getRootNode(e)},r.contains=function(e){return this.node.__shady_contains(e)},r.dispatchEvent=function(e){return this.node.__shady_dispatchEvent(e)},r.setAttribute=function(e,t){this.node.__shady_setAttribute(e,t)},r.getAttribute=function(e){return this.node.__shady_native_getAttribute(e)},r.hasAttribute=function(e){return this.node.__shady_native_hasAttribute(e)},r.removeAttribute=function(e){this.node.__shady_removeAttribute(e)},r.attachShadow=function(e){return this.node.__shady_attachShadow(e)},r.focus=function(){this.node.__shady_native_focus()},r.blur=function(){this.node.__shady_blur()},r.importNode=function(e,t){if(this.node.nodeType===Node.DOCUMENT_NODE)return this.node.__shady_importNode(e,t)},r.getElementById=function(e){if(this.node.nodeType===Node.DOCUMENT_NODE)return this.node.__shady_getElementById(e)},r.querySelector=function(e){return this.node.__shady_querySelector(e)},r.querySelectorAll=function(e,t){return this.node.__shady_querySelectorAll(e,t)},r.assignedNodes=function(e){if("slot"===this.node.localName)return this.node.__shady_assignedNodes(e)},s.Object.defineProperties(Dn.prototype,{activeElement:{configurable:!0,enumerable:!0,get:function(){if(Q(this.node)||this.node.nodeType===Node.DOCUMENT_NODE)return this.node.__shady_activeElement}},_activeElement:{configurable:!0,enumerable:!0,get:function(){return this.activeElement}},host:{configurable:!0,enumerable:!0,get:function(){if(Q(this.node))return this.node.host}},parentNode:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_parentNode}},firstChild:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_firstChild}},lastChild:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_lastChild}},nextSibling:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_nextSibling}},previousSibling:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_previousSibling}},childNodes:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_childNodes}},parentElement:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_parentElement}},firstElementChild:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_firstElementChild}},lastElementChild:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_lastElementChild}},nextElementSibling:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_nextElementSibling}},previousElementSibling:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_previousElementSibling}},children:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_children}},childElementCount:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_childElementCount}},shadowRoot:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_shadowRoot}},assignedSlot:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_assignedSlot}},isConnected:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_isConnected}},innerHTML:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_innerHTML},set:function(e){this.node.__shady_innerHTML=e}},textContent:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_textContent},set:function(e){this.node.__shady_textContent=e}},slot:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_slot},set:function(e){this.node.__shady_slot=e}},className:{configurable:!0,enumerable:!0,get:function(){return this.node.__shady_className},set:function(e){return this.node.__shady_className=e}}}),gt.forEach((function(e){return Fn(e)})),yt.forEach((function(e){return Fn(e)}));var In=new WeakMap;function Un(e){if(Q(e)||e instanceof Dn)return e;var t=In.get(e);return t||(t=new Dn(e),In.set(e,t)),t}if(J.sa){var Bn=J.B?function(e){return e}:function(e){return Xe(e),qe(e),e},jn={inUse:J.sa,patch:Bn,isShadyRoot:Q,enqueue:be,flush:_e,flushInitial:function(e){!e.Aa&&e.T&&xn(e)},settings:J,filterMutations:function(e,t){var n=t.getRootNode();return e.map((function(e){var t=n===e.target.getRootNode();if(t&&e.addedNodes){if((t=[].slice.call(e.addedNodes).filter((function(e){return n===e.getRootNode()}))).length)return e=Object.create(e),Object.defineProperty(e,"addedNodes",{value:t,configurable:!0}),e}else if(t)return e})).filter((function(e){return e}))},observeChildren:function(e,t){var n=Y(e);n.Z||(n.Z=new we),n.Z.ia.add(t);var r=n.Z;return{Ma:t,S:r,Na:e,takeRecords:function(){return r.takeRecords()}}},unobserveChildren:function(e){var t=e&&e.S;t&&(t.ia.delete(e.Ma),t.ia.size||(Y(e.Na).Z=null))},deferConnectionCallbacks:J.deferConnectionCallbacks,preferPerformance:J.preferPerformance,handlesDynamicScoping:!0,wrap:J.D?Un:Bn,wrapIfNeeded:!0===J.D?Un:function(e){return e},Wrapper:Dn,composedPath:function(e){return e.__composedPath||(e.__composedPath=tt(e.target,!0)),e.__composedPath},noPatch:J.D,patchOnDemand:J.ua,nativeMethods:Le,nativeTree:Re,patchElementProto:sn};window.ShadyDOM=jn,function(){var e=["dispatchEvent","addEventListener","removeEventListener"];window.EventTarget?Oe(window.EventTarget.prototype,e):(Oe(Node.prototype,e),Oe(Window.prototype,e)),Pe?Oe(Node.prototype,"parentNode firstChild lastChild previousSibling nextSibling childNodes parentElement textContent".split(" ")):Ne(Node.prototype,{parentNode:{get:function(){return De.currentNode=this,De.parentNode()}},firstChild:{get:function(){return De.currentNode=this,De.firstChild()}},lastChild:{get:function(){return De.currentNode=this,De.lastChild()}},previousSibling:{get:function(){return De.currentNode=this,De.previousSibling()}},nextSibling:{get:function(){return De.currentNode=this,De.nextSibling()}},childNodes:{get:function(){var e=[];De.currentNode=this;for(var t=De.firstChild();t;)e.push(t),t=De.nextSibling();return e}},parentElement:{get:function(){return Fe.currentNode=this,Fe.parentNode()}},textContent:{get:function(){switch(this.nodeType){case Node.ELEMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:for(var e,t=document.createTreeWalker(this,NodeFilter.SHOW_TEXT,null,!1),n="";e=t.nextNode();)n+=e.nodeValue;return n;default:return this.nodeValue}},set:function(e){switch(null!=e||(e=""),this.nodeType){case Node.ELEMENT_NODE:case Node.DOCUMENT_FRAGMENT_NODE:Ue(this),(0<e.length||this.nodeType===Node.ELEMENT_NODE)&&this.__shady_native_insertBefore(document.createTextNode(e),void 0);break;default:this.nodeValue=e}}}}),Oe(Node.prototype,"appendChild insertBefore removeChild replaceChild cloneNode contains".split(" ")),Oe(HTMLElement.prototype,["parentElement","contains"]),e={firstElementChild:{get:function(){return Fe.currentNode=this,Fe.firstChild()}},lastElementChild:{get:function(){return Fe.currentNode=this,Fe.lastChild()}},children:{get:function(){var e=[];Fe.currentNode=this;for(var t=Fe.firstChild();t;)e.push(t),t=Fe.nextSibling();return ue(e)}},childElementCount:{get:function(){return this.children?this.children.length:0}}},Pe?(Oe(Element.prototype,Be),Oe(Element.prototype,["previousElementSibling","nextElementSibling","innerHTML","className"]),Oe(HTMLElement.prototype,["children","innerHTML","className"])):(Ne(Element.prototype,e),Ne(Element.prototype,{previousElementSibling:{get:function(){return Fe.currentNode=this,Fe.previousSibling()}},nextElementSibling:{get:function(){return Fe.currentNode=this,Fe.nextSibling()}},innerHTML:{get:function(){return Ae(this,le)},set:function(e){var t="template"===this.localName?this.content:this;Ue(t);var n=this.localName||"div";for((n=this.namespaceURI&&this.namespaceURI!==Ie.namespaceURI?Ie.createElementNS(this.namespaceURI,n):Ie.createElement(n)).innerHTML=e,e="template"===this.localName?n.content:n;n=e.__shady_native_firstChild;)t.__shady_native_insertBefore(n,void 0)}},className:{get:function(){return this.getAttribute("class")||""},set:function(e){this.setAttribute("class",e)}}})),Oe(Element.prototype,"setAttribute getAttribute hasAttribute removeAttribute focus blur".split(" ")),Oe(Element.prototype,je),Oe(HTMLElement.prototype,["focus","blur"]),window.HTMLTemplateElement&&Oe(window.HTMLTemplateElement.prototype,["innerHTML"]),Pe?Oe(DocumentFragment.prototype,Be):Ne(DocumentFragment.prototype,e),Oe(DocumentFragment.prototype,je),Pe?(Oe(Document.prototype,Be),Oe(Document.prototype,["activeElement"])):Ne(Document.prototype,e),Oe(Document.prototype,["importNode","getElementById"]),Oe(Document.prototype,je)}(),an("__shady_"),Object.defineProperty(document,"_activeElement",Kt.activeElement),de(Window.prototype,en,"__shady_"),J.D?J.ua&&de(Element.prototype,Ht):(an(),function(){if(!Ze&&Object.getOwnPropertyDescriptor(Event.prototype,"isTrusted")){var e=function(){var e=new MouseEvent("click",{bubbles:!0,cancelable:!0,composed:!0});this.__shady_dispatchEvent(e)};Element.prototype.click?Element.prototype.click=e:HTMLElement.prototype.click&&(HTMLElement.prototype.click=e)}}()),function(){for(var e in it)window.__shady_native_addEventListener(e,(function(e){e.__target||(dt(e),st(e))}),!0)}(),window.Event=pt,window.CustomEvent=mt,window.MouseEvent=vt,window.ShadowRoot=bn}var zn=window.Document.prototype.createElement,Vn=window.Document.prototype.createElementNS,Gn=window.Document.prototype.importNode,Wn=window.Document.prototype.prepend,Hn=window.Document.prototype.append,qn=window.DocumentFragment.prototype.prepend,Xn=window.DocumentFragment.prototype.append,Yn=window.Node.prototype.cloneNode,Zn=window.Node.prototype.appendChild,Jn=window.Node.prototype.insertBefore,Kn=window.Node.prototype.removeChild,$n=window.Node.prototype.replaceChild,Qn=Object.getOwnPropertyDescriptor(window.Node.prototype,"textContent"),er=window.Element.prototype.attachShadow,tr=Object.getOwnPropertyDescriptor(window.Element.prototype,"innerHTML"),nr=window.Element.prototype.getAttribute,rr=window.Element.prototype.setAttribute,ir=window.Element.prototype.removeAttribute,or=window.Element.prototype.getAttributeNS,ar=window.Element.prototype.setAttributeNS,sr=window.Element.prototype.removeAttributeNS,cr=window.Element.prototype.insertAdjacentElement,ur=window.Element.prototype.insertAdjacentHTML,lr=window.Element.prototype.prepend,hr=window.Element.prototype.append,fr=window.Element.prototype.before,dr=window.Element.prototype.after,pr=window.Element.prototype.replaceWith,mr=window.Element.prototype.remove,vr=window.HTMLElement,gr=Object.getOwnPropertyDescriptor(window.HTMLElement.prototype,"innerHTML"),yr=window.HTMLElement.prototype.insertAdjacentElement,br=window.HTMLElement.prototype.insertAdjacentHTML,_r=new Set;function wr(e){var t=_r.has(e);return e=/^[a-z][.0-9_a-z]*-[-.0-9_a-z]*$/.test(e),!t&&e}"annotation-xml color-profile font-face font-face-src font-face-uri font-face-format font-face-name missing-glyph".split(" ").forEach((function(e){return _r.add(e)}));var xr=document.contains?document.contains.bind(document):document.documentElement.contains.bind(document.documentElement);function Sr(e){var t=e.isConnected;if(void 0!==t)return t;if(xr(e))return!0;for(;e&&!(e.__CE_isImportDocument||e instanceof Document);)e=e.parentNode||(window.ShadowRoot&&e instanceof ShadowRoot?e.host:void 0);return!(!e||!(e.__CE_isImportDocument||e instanceof Document))}function Er(e){var t=e.children;if(t)return Array.prototype.slice.call(t);for(t=[],e=e.firstChild;e;e=e.nextSibling)e.nodeType===Node.ELEMENT_NODE&&t.push(e);return t}function Mr(e,t){for(;t&&t!==e&&!t.nextSibling;)t=t.parentNode;return t&&t!==e?t.nextSibling:null}function Cr(){var e=!(null==qr||!qr.noDocumentConstructionObserver),t=!(null==qr||!qr.shadyDomFastWalk);this.X=[],this.a=[],this.R=!1,this.shadyDomFastWalk=t,this.jb=!e}function Tr(e,t,n,r){var i=window.ShadyDom;if(e.shadyDomFastWalk&&i&&i.inUse){if(t.nodeType===Node.ELEMENT_NODE&&n(t),t.querySelectorAll)for(e=i.nativeMethods.querySelectorAll.call(t,"*"),t=0;t<e.length;t++)n(e[t])}else!function e(t,n,r){for(var i=t;i;){if(i.nodeType===Node.ELEMENT_NODE){var o=i;n(o);var a=o.localName;if("link"===a&&"import"===o.getAttribute("rel")){if(i=o.import,void 0===r&&(r=new Set),i instanceof Node&&!r.has(i))for(r.add(i),i=i.firstChild;i;i=i.nextSibling)e(i,n,r);i=Mr(t,o);continue}if("template"===a){i=Mr(t,o);continue}if(o=o.__CE_shadowRoot)for(o=o.firstChild;o;o=o.nextSibling)e(o,n,r)}i=i.firstChild?i.firstChild:Mr(t,i)}}(t,n,r)}function Ar(e,t){e.R&&Tr(e,t,(function(t){return Pr(e,t)}))}function Pr(e,t){if(e.R&&!t.__CE_patched){t.__CE_patched=!0;for(var n=0;n<e.X.length;n++)e.X[n](t);for(n=0;n<e.a.length;n++)e.a[n](t)}}function Lr(e,t){var n=[];for(Tr(e,t,(function(e){return n.push(e)})),t=0;t<n.length;t++){var r=n[t];1===r.__CE_state?e.connectedCallback(r):Nr(e,r)}}function Rr(e,t){var n=[];for(Tr(e,t,(function(e){return n.push(e)})),t=0;t<n.length;t++){var r=n[t];1===r.__CE_state&&e.disconnectedCallback(r)}}function kr(e,t,n){var r=(n=void 0===n?{}:n).kb,i=n.upgrade||function(t){return Nr(e,t)},o=[];for(Tr(e,t,(function(t){if(e.R&&Pr(e,t),"link"===t.localName&&"import"===t.getAttribute("rel")){var n=t.import;n instanceof Node&&(n.__CE_isImportDocument=!0,n.__CE_registry=document.__CE_registry),n&&"complete"===n.readyState?n.__CE_documentLoadHandled=!0:t.addEventListener("load",(function(){var n=t.import;if(!n.__CE_documentLoadHandled){n.__CE_documentLoadHandled=!0;var o=new Set;r&&(r.forEach((function(e){return o.add(e)})),o.delete(n)),kr(e,n,{kb:o,upgrade:i})}}))}else o.push(t)}),r),t=0;t<o.length;t++)i(o[t])}function Nr(e,t){try{var n=t.ownerDocument,r=n.__CE_registry,i=r&&(n.defaultView||n.__CE_isImportDocument)?Gr(r,t.localName):void 0;if(i&&void 0===t.__CE_state){i.constructionStack.push(t);try{try{if(new i.constructorFunction!==t)throw Error("The custom element constructor did not produce the element being upgraded.")}finally{i.constructionStack.pop()}}catch(e){throw t.__CE_state=2,e}if(t.__CE_state=1,t.__CE_definition=i,i.attributeChangedCallback&&t.hasAttributes()){var o=i.observedAttributes;for(i=0;i<o.length;i++){var a=o[i],s=t.getAttribute(a);null!==s&&e.attributeChangedCallback(t,a,null,s,null)}}Sr(t)&&e.connectedCallback(t)}}catch(e){Dr(e)}}function Or(e,t,n,r){var i=t.__CE_registry;if(i&&(null===r||"http://www.w3.org/1999/xhtml"===r)&&(i=Gr(i,n)))try{var o=new i.constructorFunction;if(void 0===o.__CE_state||void 0===o.__CE_definition)throw Error("Failed to construct '"+n+"': The returned value was not constructed with the HTMLElement constructor.");if("http://www.w3.org/1999/xhtml"!==o.namespaceURI)throw Error("Failed to construct '"+n+"': The constructed element's namespace must be the HTML namespace.");if(o.hasAttributes())throw Error("Failed to construct '"+n+"': The constructed element must not have any attributes.");if(null!==o.firstChild)throw Error("Failed to construct '"+n+"': The constructed element must not have any children.");if(null!==o.parentNode)throw Error("Failed to construct '"+n+"': The constructed element must not have a parent node.");if(o.ownerDocument!==t)throw Error("Failed to construct '"+n+"': The constructed element's owner document is incorrect.");if(o.localName!==n)throw Error("Failed to construct '"+n+"': The constructed element's local name is incorrect.");return o}catch(i){return Dr(i),t=null===r?zn.call(t,n):Vn.call(t,r,n),Object.setPrototypeOf(t,HTMLUnknownElement.prototype),t.__CE_state=2,t.__CE_definition=void 0,Pr(e,t),t}return Pr(e,t=null===r?zn.call(t,n):Vn.call(t,r,n)),t}function Dr(e){var t=e.message,n=e.sourceURL||e.fileName||"",r=e.line||e.lineNumber||0,i=e.column||e.columnNumber||0,o=void 0;void 0===ErrorEvent.prototype.initErrorEvent?o=new ErrorEvent("error",{cancelable:!0,message:t,filename:n,lineno:r,colno:i,error:e}):((o=document.createEvent("ErrorEvent")).initErrorEvent("error",!1,!0,t,n,r),o.preventDefault=function(){Object.defineProperty(this,"defaultPrevented",{configurable:!0,get:function(){return!0}})}),void 0===o.error&&Object.defineProperty(o,"error",{configurable:!0,enumerable:!0,get:function(){return e}}),window.dispatchEvent(o),o.defaultPrevented||console.error(e)}function Fr(){var e=this;this.C=void 0,this.Ca=new Promise((function(t){e.a=t}))}function Ir(e){var t=document;this.S=void 0,this.M=e,this.a=t,kr(this.M,this.a),"loading"===this.a.readyState&&(this.S=new MutationObserver(this.b.bind(this)),this.S.observe(this.a,{childList:!0,subtree:!0}))}function Ur(e){e.S&&e.S.disconnect()}function Br(e){this.ea=new Map,this.fa=new Map,this.xa=new Map,this.na=!1,this.qa=new Map,this.da=function(e){return e()},this.P=!1,this.ga=[],this.M=e,this.ya=e.jb?new Ir(e):void 0}function jr(e,t){if(!wr(t))throw new SyntaxError("The element name '"+t+"' is not valid.");if(Gr(e,t))throw Error("A custom element with name '"+t+"' has already been defined.");if(e.na)throw Error("A custom element is already being defined.")}function zr(e,t,n){var r;e.na=!0;try{var i=n.prototype;if(!(i instanceof Object))throw new TypeError("The custom element constructor's prototype is not an object.");var o=function(e){var t=i[e];if(void 0!==t&&!(t instanceof Function))throw Error("The '"+e+"' callback must be a function.");return t},a=o("connectedCallback"),s=o("disconnectedCallback"),c=o("adoptedCallback"),u=(r=o("attributeChangedCallback"))&&n.observedAttributes||[]}catch(e){throw e}finally{e.na=!1}return n={localName:t,constructorFunction:n,connectedCallback:a,disconnectedCallback:s,adoptedCallback:c,attributeChangedCallback:r,observedAttributes:u,constructionStack:[]},e.fa.set(t,n),e.xa.set(n.constructorFunction,n),n}function Vr(e){if(!1!==e.P){e.P=!1;for(var t=[],n=e.ga,r=new Map,i=0;i<n.length;i++)r.set(n[i],[]);for(kr(e.M,document,{upgrade:function(n){if(void 0===n.__CE_state){var i=n.localName,o=r.get(i);o?o.push(n):e.fa.has(i)&&t.push(n)}}}),i=0;i<t.length;i++)Nr(e.M,t[i]);for(i=0;i<n.length;i++){for(var o=n[i],a=r.get(o),s=0;s<a.length;s++)Nr(e.M,a[s]);(o=e.qa.get(o))&&o.resolve(void 0)}n.length=0}}function Gr(e,t){var n=e.fa.get(t);if(n)return n;if(n=e.ea.get(t)){e.ea.delete(t);try{return zr(e,t,n())}catch(e){Dr(e)}}}function Wr(e,t,n){function r(t){return function(n){for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];i=[];for(var o=[],a=0;a<r.length;a++){var s=r[a];if(s instanceof Element&&Sr(s)&&o.push(s),s instanceof DocumentFragment)for(s=s.firstChild;s;s=s.nextSibling)i.push(s);else i.push(s)}for(t.apply(this,r),r=0;r<o.length;r++)Rr(e,o[r]);if(Sr(this))for(r=0;r<i.length;r++)(o=i[r])instanceof Element&&Lr(e,o)}}void 0!==n.prepend&&(t.prepend=r(n.prepend)),void 0!==n.append&&(t.append=r(n.append))}Cr.prototype.connectedCallback=function(e){var t=e.__CE_definition;if(t.connectedCallback)try{t.connectedCallback.call(e)}catch(e){Dr(e)}},Cr.prototype.disconnectedCallback=function(e){var t=e.__CE_definition;if(t.disconnectedCallback)try{t.disconnectedCallback.call(e)}catch(e){Dr(e)}},Cr.prototype.attributeChangedCallback=function(e,t,n,r,i){var o=e.__CE_definition;if(o.attributeChangedCallback&&-1<o.observedAttributes.indexOf(t))try{o.attributeChangedCallback.call(e,t,n,r,i)}catch(e){Dr(e)}},Fr.prototype.resolve=function(e){if(this.C)throw Error("Already resolved.");this.C=e,this.a(e)},Ir.prototype.b=function(e){var t=this.a.readyState;for("interactive"!==t&&"complete"!==t||Ur(this),t=0;t<e.length;t++)for(var n=e[t].addedNodes,r=0;r<n.length;r++)kr(this.M,n[r])},(r=Br.prototype).$a=function(e,t){var n=this;if(!(t instanceof Function))throw new TypeError("Custom element constructor getters must be functions.");jr(this,e),this.ea.set(e,t),this.ga.push(e),this.P||(this.P=!0,this.da((function(){return Vr(n)})))},r.define=function(e,t){var n=this;if(!(t instanceof Function))throw new TypeError("Custom element constructors must be functions.");jr(this,e),zr(this,e,t),this.ga.push(e),this.P||(this.P=!0,this.da((function(){return Vr(n)})))},r.upgrade=function(e){kr(this.M,e)},r.get=function(e){if(e=Gr(this,e))return e.constructorFunction},r.whenDefined=function(e){if(!wr(e))return Promise.reject(new SyntaxError("'"+e+"' is not a valid custom element name."));var t=this.qa.get(e);if(t)return t.Ca;t=new Fr,this.qa.set(e,t);var n=this.fa.has(e)||this.ea.has(e);return e=-1===this.ga.indexOf(e),n&&e&&t.resolve(void 0),t.Ca},r.polyfillWrapFlushCallback=function(e){this.ya&&Ur(this.ya);var t=this.da;this.da=function(n){return e((function(){return t(n)}))}},window.CustomElementRegistry=Br,Br.prototype.define=Br.prototype.define,Br.prototype.upgrade=Br.prototype.upgrade,Br.prototype.get=Br.prototype.get,Br.prototype.whenDefined=Br.prototype.whenDefined,Br.prototype.polyfillDefineLazy=Br.prototype.$a,Br.prototype.polyfillWrapFlushCallback=Br.prototype.polyfillWrapFlushCallback;var Hr={},qr=window.customElements;function Xr(){var e=new Cr;!function(e){function t(){var t=this.constructor,n=document.__CE_registry.xa.get(t);if(!n)throw Error("Failed to construct a custom element: The constructor was not registered with `customElements`.");var r=n.constructionStack;if(0===r.length)return r=zn.call(document,n.localName),Object.setPrototypeOf(r,t.prototype),r.__CE_state=1,r.__CE_definition=n,Pr(e,r),r;var i=r.length-1,o=r[i];if(o===Hr)throw Error("Failed to construct '"+n.localName+"': This element was already constructed.");return r[i]=Hr,Object.setPrototypeOf(o,t.prototype),Pr(e,o),o}t.prototype=vr.prototype,Object.defineProperty(HTMLElement.prototype,"constructor",{writable:!0,configurable:!0,enumerable:!1,value:t}),window.HTMLElement=t}(e),function(e){Document.prototype.createElement=function(t){return Or(e,this,t,null)},Document.prototype.importNode=function(t,n){return t=Gn.call(this,t,!!n),this.__CE_registry?kr(e,t):Ar(e,t),t},Document.prototype.createElementNS=function(t,n){return Or(e,this,n,t)},Wr(e,Document.prototype,{prepend:Wn,append:Hn})}(e),Wr(e,DocumentFragment.prototype,{prepend:qn,append:Xn}),function(e){function t(t,n){Object.defineProperty(t,"textContent",{enumerable:n.enumerable,configurable:!0,get:n.get,set:function(t){if(this.nodeType===Node.TEXT_NODE)n.set.call(this,t);else{var r=void 0;if(this.firstChild){var i=this.childNodes,o=i.length;if(0<o&&Sr(this)){r=Array(o);for(var a=0;a<o;a++)r[a]=i[a]}}if(n.set.call(this,t),r)for(t=0;t<r.length;t++)Rr(e,r[t])}}})}Node.prototype.insertBefore=function(t,n){if(t instanceof DocumentFragment){var r=Er(t);if(t=Jn.call(this,t,n),Sr(this))for(n=0;n<r.length;n++)Lr(e,r[n]);return t}return r=t instanceof Element&&Sr(t),n=Jn.call(this,t,n),r&&Rr(e,t),Sr(this)&&Lr(e,t),n},Node.prototype.appendChild=function(t){if(t instanceof DocumentFragment){var n=Er(t);if(t=Zn.call(this,t),Sr(this))for(var r=0;r<n.length;r++)Lr(e,n[r]);return t}return n=t instanceof Element&&Sr(t),r=Zn.call(this,t),n&&Rr(e,t),Sr(this)&&Lr(e,t),r},Node.prototype.cloneNode=function(t){return t=Yn.call(this,!!t),this.ownerDocument.__CE_registry?kr(e,t):Ar(e,t),t},Node.prototype.removeChild=function(t){var n=t instanceof Element&&Sr(t),r=Kn.call(this,t);return n&&Rr(e,t),r},Node.prototype.replaceChild=function(t,n){if(t instanceof DocumentFragment){var r=Er(t);if(t=$n.call(this,t,n),Sr(this))for(Rr(e,n),n=0;n<r.length;n++)Lr(e,r[n]);return t}r=t instanceof Element&&Sr(t);var i=$n.call(this,t,n),o=Sr(this);return o&&Rr(e,n),r&&Rr(e,t),o&&Lr(e,t),i},Qn&&Qn.get?t(Node.prototype,Qn):function(e,t){e.R=!0,e.X.push(t)}(e,(function(e){t(e,{enumerable:!0,configurable:!0,get:function(){for(var e=[],t=this.firstChild;t;t=t.nextSibling)t.nodeType!==Node.COMMENT_NODE&&e.push(t.textContent);return e.join("")},set:function(e){for(;this.firstChild;)Kn.call(this,this.firstChild);null!=e&&""!==e&&Zn.call(this,document.createTextNode(e))}})}))}(e),function(e){function t(t,n){Object.defineProperty(t,"innerHTML",{enumerable:n.enumerable,configurable:!0,get:n.get,set:function(t){var r=this,i=void 0;if(Sr(this)&&(i=[],Tr(e,this,(function(e){e!==r&&i.push(e)}))),n.set.call(this,t),i)for(var o=0;o<i.length;o++){var a=i[o];1===a.__CE_state&&e.disconnectedCallback(a)}return this.ownerDocument.__CE_registry?kr(e,this):Ar(e,this),t}})}function n(t,n){t.insertAdjacentElement=function(t,r){var i=Sr(r);return t=n.call(this,t,r),i&&Rr(e,r),Sr(t)&&Lr(e,r),t}}function r(t,n){function r(t,n){for(var r=[];t!==n;t=t.nextSibling)r.push(t);for(n=0;n<r.length;n++)kr(e,r[n])}t.insertAdjacentHTML=function(e,t){if("beforebegin"===(e=e.toLowerCase())){var i=this.previousSibling;n.call(this,e,t),r(i||this.parentNode.firstChild,this)}else if("afterbegin"===e)i=this.firstChild,n.call(this,e,t),r(this.firstChild,i);else if("beforeend"===e)i=this.lastChild,n.call(this,e,t),r(i||this.firstChild,null);else{if("afterend"!==e)throw new SyntaxError("The value provided ("+String(e)+") is not one of 'beforebegin', 'afterbegin', 'beforeend', or 'afterend'.");i=this.nextSibling,n.call(this,e,t),r(this.nextSibling,i)}}}er&&(Element.prototype.attachShadow=function(t){if(t=er.call(this,t),e.R&&!t.__CE_patched){t.__CE_patched=!0;for(var n=0;n<e.X.length;n++)e.X[n](t)}return this.__CE_shadowRoot=t}),tr&&tr.get?t(Element.prototype,tr):gr&&gr.get?t(HTMLElement.prototype,gr):function(e,t){e.R=!0,e.a.push(t)}(e,(function(e){t(e,{enumerable:!0,configurable:!0,get:function(){return Yn.call(this,!0).innerHTML},set:function(e){var t="template"===this.localName,n=t?this.content:this,r=Vn.call(document,this.namespaceURI,this.localName);for(r.innerHTML=e;0<n.childNodes.length;)Kn.call(n,n.childNodes[0]);for(e=t?r.content:r;0<e.childNodes.length;)Zn.call(n,e.childNodes[0])}})})),Element.prototype.setAttribute=function(t,n){if(1!==this.__CE_state)return rr.call(this,t,n);var r=nr.call(this,t);rr.call(this,t,n),n=nr.call(this,t),e.attributeChangedCallback(this,t,r,n,null)},Element.prototype.setAttributeNS=function(t,n,r){if(1!==this.__CE_state)return ar.call(this,t,n,r);var i=or.call(this,t,n);ar.call(this,t,n,r),r=or.call(this,t,n),e.attributeChangedCallback(this,n,i,r,t)},Element.prototype.removeAttribute=function(t){if(1!==this.__CE_state)return ir.call(this,t);var n=nr.call(this,t);ir.call(this,t),null!==n&&e.attributeChangedCallback(this,t,n,null,null)},Element.prototype.removeAttributeNS=function(t,n){if(1!==this.__CE_state)return sr.call(this,t,n);var r=or.call(this,t,n);sr.call(this,t,n);var i=or.call(this,t,n);r!==i&&e.attributeChangedCallback(this,n,r,i,t)},yr?n(HTMLElement.prototype,yr):cr&&n(Element.prototype,cr),br?r(HTMLElement.prototype,br):ur&&r(Element.prototype,ur),Wr(e,Element.prototype,{prepend:lr,append:hr}),function(e){function t(t){return function(n){for(var r=[],i=0;i<arguments.length;++i)r[i]=arguments[i];i=[];for(var o=[],a=0;a<r.length;a++){var s=r[a];if(s instanceof Element&&Sr(s)&&o.push(s),s instanceof DocumentFragment)for(s=s.firstChild;s;s=s.nextSibling)i.push(s);else i.push(s)}for(t.apply(this,r),r=0;r<o.length;r++)Rr(e,o[r]);if(Sr(this))for(r=0;r<i.length;r++)(o=i[r])instanceof Element&&Lr(e,o)}}var n=Element.prototype;void 0!==fr&&(n.before=t(fr)),void 0!==dr&&(n.after=t(dr)),void 0!==pr&&(n.replaceWith=function(t){for(var n=[],r=0;r<arguments.length;++r)n[r]=arguments[r];r=[];for(var i=[],o=0;o<n.length;o++){var a=n[o];if(a instanceof Element&&Sr(a)&&i.push(a),a instanceof DocumentFragment)for(a=a.firstChild;a;a=a.nextSibling)r.push(a);else r.push(a)}for(o=Sr(this),pr.apply(this,n),n=0;n<i.length;n++)Rr(e,i[n]);if(o)for(Rr(e,this),n=0;n<r.length;n++)(i=r[n])instanceof Element&&Lr(e,i)}),void 0!==mr&&(n.remove=function(){var t=Sr(this);mr.call(this),t&&Rr(e,this)})}(e)}(e),e=new Br(e),document.__CE_registry=e,Object.defineProperty(window,"customElements",{configurable:!0,enumerable:!0,value:e})}function Yr(){this.end=this.start=0,this.rules=this.parent=this.previous=null,this.cssText=this.parsedCssText="",this.atRule=!1,this.type=0,this.parsedSelector=this.selector=this.keyframesName=""}function Zr(e){var t=e=e.replace(ni,"").replace(ri,""),n=new Yr;n.start=0,n.end=t.length;for(var r=n,i=0,o=t.length;i<o;i++)if("{"===t[i]){r.rules||(r.rules=[]);var a=r,s=a.rules[a.rules.length-1]||null;(r=new Yr).start=i+1,r.parent=a,r.previous=s,a.rules.push(r)}else"}"===t[i]&&(r.end=i+1,r=r.parent||n);return function e(t,n){var r=n.substring(t.start,t.end-1);if(t.parsedCssText=t.cssText=r.trim(),t.parent&&(r=(r=(r=function(e){return e.replace(/\\([0-9a-f]{1,6})\s/gi,(function(e,t){for(t=6-(e=t).length;t--;)e="0"+e;return"\\"+e}))}(r=n.substring(t.previous?t.previous.end:t.parent.start,t.start-1))).replace(li," ")).substring(r.lastIndexOf(";")+1),r=t.parsedSelector=t.selector=r.trim(),t.atRule=0===r.indexOf("@"),t.atRule?0===r.indexOf("@media")?t.type=ei:r.match(ci)&&(t.type=Qr,t.keyframesName=t.selector.split(li).pop()):t.type=0===r.indexOf("--")?ti:$r),r=t.rules)for(var i=0,o=r.length,a=void 0;i<o&&(a=r[i]);i++)e(a,n);return t}(n,e)}qr&&!qr.forcePolyfill&&"function"==typeof qr.define&&"function"==typeof qr.get||Xr(),window.__CE_installPolyfill=Xr;var Jr,Kr,$r=1,Qr=7,ei=4,ti=1e3,ni=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//gim,ri=/@import[^;]*;/gim,ii=/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?(?:[;\n]|$)/gim,oi=/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?{[^}]*?}(?:[;\n]|$)?/gim,ai=/@apply\s*\(?[^);]*\)?\s*(?:[;\n]|$)?/gim,si=/[^;:]*?:[^;]*?var\([^;]*\)(?:[;\n]|$)?/gim,ci=/^@[^\s]*keyframes/,li=/\s+/g,ui=!(window.ShadyDOM&&window.ShadyDOM.inUse);function hi(e){Jr=(!e||!e.shimcssproperties)&&(ui||!(navigator.userAgent.match(/AppleWebKit\/601|Edge\/15/)||!window.CSS||!CSS.supports||!CSS.supports("box-shadow","0 0 0 var(--foo)")))}window.ShadyCSS&&void 0!==window.ShadyCSS.cssBuild&&(Kr=window.ShadyCSS.cssBuild);var fi=!(!window.ShadyCSS||!window.ShadyCSS.disableRuntime);window.ShadyCSS&&void 0!==window.ShadyCSS.nativeCss?Jr=window.ShadyCSS.nativeCss:window.ShadyCSS?(hi(window.ShadyCSS),window.ShadyCSS=void 0):hi(window.WebComponents&&window.WebComponents.flags);var di=Jr,pi=/(?:^|[;\s{]\s*)(--[\w-]*?)\s*:\s*(?:((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};{])+)|\{([^}]*)\}(?:(?=[;\s}])|$))/gi,mi=/(?:^|\W+)@apply\s*\(?([^);\n]*)\)?/gi,vi=/(--[\w-]+)\s*([:,;)]|$)/gi,gi=/(animation\s*:)|(animation-name\s*:)/,yi=/@media\s(.*)/,bi=/\{[^}]*\}/g,_i=new Set;function wi(e,t){return e?("string"==typeof e&&(e=Zr(e)),t&&Ei(e,t),function e(t,n,r){r=void 0===r?"":r;var i="";if(t.cssText||t.rules){var o,a=t.rules;if((o=a)&&(o=!((o=a[0])&&o.selector&&0===o.selector.indexOf("--"))),o){o=0;for(var s=a.length,c=void 0;o<s&&(c=a[o]);o++)i=e(c,n,i)}else(i=(n=n?t.cssText:(n=(n=t.cssText).replace(ii,"").replace(oi,"")).replace(ai,"").replace(si,"")).trim())&&(i="  "+i+"\n")}return i&&(t.selector&&(r+=t.selector+" {\n"),r+=i,t.selector&&(r+="}\n\n")),r}(e,di)):""}function xi(e){return!e.__cssRules&&e.textContent&&(e.__cssRules=Zr(e.textContent)),e.__cssRules||null}function Si(e){return!!e.parent&&e.parent.type===Qr}function Ei(e,t,n,r){if(e){var i=!1,o=e.type;if(r&&o===ei){var a=e.selector.match(yi);a&&(window.matchMedia(a[1]).matches||(i=!0))}if(o===$r?t(e):n&&o===Qr?n(e):o===ti&&(i=!0),(e=e.rules)&&!i)for(i=0,o=e.length,a=void 0;i<o&&(a=e[i]);i++)Ei(a,t,n,r)}}function Mi(e,t,n,r){var i=document.createElement("style");return t&&i.setAttribute("scope",t),i.textContent=e,Ai(i,n,r),i}var Ci=null;function Ti(e){e=document.createComment(" Shady DOM styles for "+e+" ");var t=document.head;return t.insertBefore(e,(Ci?Ci.nextSibling:null)||t.firstChild),Ci=e}function Ai(e,t,n){(t=t||document.head).insertBefore(e,n&&n.nextSibling||t.firstChild),Ci?e.compareDocumentPosition(Ci)===Node.DOCUMENT_POSITION_PRECEDING&&(Ci=e):Ci=e}function Pi(e,t){for(var n=0,r=e.length;t<r;t++)if("("===e[t])n++;else if(")"===e[t]&&0==--n)return t;return-1}function Li(e,t){ui?e.setAttribute("class",t):window.ShadyDOM.nativeMethods.setAttribute.call(e,"class",t)}var Ri=window.ShadyDOM&&window.ShadyDOM.wrap||function(e){return e};function ki(e){var t=e.localName,n="";return t?-1<t.indexOf("-")||(n=t,t=e.getAttribute&&e.getAttribute("is")||""):(t=e.is,n=e.extends),{is:t,ba:n}}function Ni(e){for(var t=[],n="",r=0;0<=r&&r<e.length;r++)if("("===e[r]){var i=Pi(e,r);n+=e.slice(r,i+1),r=i}else","===e[r]?(t.push(n),n=""):n+=e[r];return n&&t.push(n),t}function Oi(e){if(void 0!==Kr)return Kr;if(void 0===e.__cssBuild){var t=e.getAttribute("css-build");if(t)e.__cssBuild=t;else{if(""!==(t=(t="template"===e.localName?e.content.firstChild:e.firstChild)instanceof Comment&&"css-build"===(t=t.textContent.trim().split(":"))[0]?t[1]:"")){var n="template"===e.localName?e.content.firstChild:e.firstChild;n.parentNode.removeChild(n)}e.__cssBuild=t}}return e.__cssBuild||""}function Di(e){return!(""===(e=void 0===e?"":e)||!di)&&(ui?"shadow"===e:"shady"===e)}function Fi(){}function Ii(e,t,n){var r;if(t.nodeType===Node.ELEMENT_NODE&&n(t),r="template"===t.localName?(t.content||t._content||t).childNodes:t.children||t.childNodes)for(t=0;t<r.length;t++)Ii(e,r[t],n)}function Ui(e,t,n){if(t)if(e.classList)n?(e.classList.remove("style-scope"),e.classList.remove(t)):(e.classList.add("style-scope"),e.classList.add(t));else if(e.getAttribute){var r=e.getAttribute("class");n?r&&Li(e,t=r.replace("style-scope","").replace(t,"")):Li(e,(r?r+" ":"")+"style-scope "+t)}}function Bi(e,t,n){Ii(to,e,(function(e){Ui(e,t,!0),Ui(e,n)}))}function ji(e,t){Ii(to,e,(function(e){Ui(e,t||"",!0)}))}function zi(e,t,n,r,i){var o=to;return""===(i=void 0===i?"":i)&&(i=ui||"shady"===(void 0===r?"":r)?wi(t,n):function(e,t,n,r,i){var o=Vi(n,r);return n=n?"."+n:"",wi(t,(function(t){t.c||(t.selector=t.w=Gi(e,t,e.b,n,o),t.c=!0),i&&i(t,n,o)}))}(o,t,(e=ki(e)).is,e.ba,n)+"\n\n"),i.trim()}function Vi(e,t){return t?"[is="+e+"]":e}function Gi(e,t,n,r,i){var o=Ni(t.selector);if(!Si(t)){t=0;for(var a=o.length,s=void 0;t<a&&(s=o[t]);t++)o[t]=n.call(e,s,r,i)}return o.filter((function(e){return!!e})).join(",")}function Wi(e){return e.replace(Xi,(function(e,t,n){return-1<n.indexOf("+")?n=n.replace(/\+/g,"___"):-1<n.indexOf("___")&&(n=n.replace(/___/g,"+")),":"+t+"("+n+")"}))}function Hi(e,t){e=e.split(/(\[.+?\])/);for(var n=[],r=0;r<e.length;r++)if(1==r%2)n.push(e[r]);else{var i=e[r];""===i&&r===e.length-1||((i=i.split(":"))[0]+=t,n.push(i.join(":")))}return n.join("")}function qi(e){":root"===e.selector&&(e.selector="html")}Fi.prototype.b=function(e,t,n){var r=!1;e=e.trim();var i=Xi.test(e);i&&(e=Wi(e=e.replace(Xi,(function(e,t,n){return":"+t+"("+n.replace(/\s/g,"")+")"}))));var o=eo.test(e);if(o){var a=function(e){for(var t,n=[];t=e.match(eo);){var r=t.index,i=Pi(e,r);if(-1===i)throw Error(t.input+" selector missing ')'");t=e.slice(r,i+1),e=e.replace(t,""),n.push(t)}return{wa:e,matches:n}}(e);e=a.wa,a=a.matches}return e=(e=e.replace(Ji,":host $1")).replace(Yi,(function(e,i,o){return r||(e=function(e,t,n,r){var i=e.indexOf("::slotted");if(0<=e.indexOf(":host")?e=function(e,t){var n=e.match(Ki);return(n=n&&n[2].trim()||"")?n[0].match(Zi)?e.replace(Ki,(function(e,n,r){return t+r})):n.split(Zi)[0]===t?n:"should_not_match":e.replace(":host",t)}(e,r):0!==i&&(e=n?Hi(e,n):e),n=!1,0<=i&&(t="",n=!0),n){var o=!0;n&&(e=e.replace($i,(function(e,t){return" > "+t})))}return{value:e,Qa:t,stop:o}}(o,i,t,n),r=r||e.stop,i=e.Qa,o=e.value),i+o})),o&&(e=function(e,t){var n=e.split("");return t.reduce((function(e,t,r){return e+t+n[r+1]}),n[0])}(e,a)),i&&(e=Wi(e)),e.replace(Qi,(function(e,t,n,r){return'[dir="'+n+'"] '+t+r+", "+t+'[dir="'+n+'"]'+r}))},Fi.prototype.c=function(e){return e.match(":host")?"":e.match("::slotted")?this.b(e,":not(.style-scope)"):Hi(e.trim(),":not(.style-scope)")},s.Object.defineProperties(Fi.prototype,{a:{configurable:!0,enumerable:!0,get:function(){return"style-scope"}}});var Xi=/:(nth[-\w]+)\(([^)]+)\)/,Yi=/(^|[\s>+~]+)((?:\[.+?\]|[^\s>+~=[])+)/g,Zi=/[[.:#*]/,Ji=/^(::slotted)/,Ki=/(:host)(?:\(((?:\([^)(]*\)|[^)(]*)+?)\))/,$i=/(?:::slotted)(?:\(((?:\([^)(]*\)|[^)(]*)+?)\))/,Qi=/(.*):dir\((?:(ltr|rtl))\)(.*)/,eo=/:(?:matches|any|-(?:webkit|moz)-any)/,to=new Fi;function no(e,t,n,r,i){this.H=e||null,this.b=t||null,this.ta=n||[],this.F=null,this.cssBuild=i||"",this.ba=r||"",this.a=this.G=this.L=null}function ro(e){return e?e.__styleInfo:null}function io(e,t){return e.__styleInfo=t}function oo(e){var t=this.matches||this.matchesSelector||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector;return t&&t.call(this,e)}no.prototype.c=function(){return this.H},no.prototype._getStyleRules=no.prototype.c;var ao=/:host\s*>\s*/,so=navigator.userAgent.match("Trident");function co(){}function uo(e){if(!e.v){var t={},n={};lo(e,n)&&(t.K=n,e.rules=null),t.cssText=e.parsedCssText.replace(bi,"").replace(pi,""),e.v=t}}function lo(e,t){var n=e.v;if(!n){n=e.parsedCssText;for(var r;e=pi.exec(n);)"inherit"===(r=(e[2]||e[3]).trim())&&"unset"===r||(t[e[1].trim()]=r),r=!0;return r}if(n.K)return Object.assign(t,n.K),!0}function ho(e,t,n){return t&&(t=0<=t.indexOf(";")?fo(e,t,n):function e(t,n){var r=t.indexOf("var(");if(-1===r)return n(t,"","","");var i=Pi(t,r+3),o=t.substring(r+4,i);return r=t.substring(0,r),t=e(t.substring(i+1),n),-1===(i=o.indexOf(","))?n(r,o.trim(),"",t):n(r,o.substring(0,i).trim(),o.substring(i+1).trim(),t)}(t,(function(t,r,i,o){return r?((r=ho(e,n[r],n))&&"initial"!==r?"apply-shim-inherit"===r&&(r="inherit"):r=ho(e,n[i]||i,n)||i,t+(r||"")+o):t+o}))),t&&t.trim()||""}function fo(e,t,n){t=t.split(";");for(var r,i,o=0;o<t.length;o++)if(r=t[o]){if(mi.lastIndex=0,i=mi.exec(r))r=ho(e,n[i[1]],n);else if(-1!==(i=r.indexOf(":"))){var a=r.substring(i);a=ho(e,a=a.trim(),n)||a,r=r.substring(0,i)+a}t[o]=r&&r.lastIndexOf(";")===r.length-1?r.slice(0,-1):r||""}return t.join(";")}function po(e){return function(t){return t.replace(e.l,e.a)}}function mo(e,t){var n=vo,r=xi(e);e.textContent=wi(r,(function(e){var r=e.cssText=e.parsedCssText;e.v&&e.v.cssText&&(r=r.replace(ii,"").replace(oi,""),e.cssText=fo(n,r,t))}))}s.Object.defineProperties(co.prototype,{a:{configurable:!0,enumerable:!0,get:function(){return"x-scope"}}});var vo=new co,go={},yo=window.customElements;if(yo&&!ui&&!fi){var bo=yo.define;yo.define=function(e,t,n){go[e]||(go[e]=Ti(e)),bo.call(yo,e,t,n)}}function _o(){this.cache={}}function wo(){}_o.prototype.store=function(e,t,n,r){var i=this.cache[e]||[];i.push({K:t,styleElement:n,G:r}),100<i.length&&i.shift(),this.cache[e]=i};var xo=new RegExp(to.a+"\\s*([^\\s]*)");function So(e){return(e=(e.classList&&e.classList.value?e.classList.value:e.getAttribute("class")||"").match(xo))?e[1]:""}function Eo(e){var t=Ri(e).getRootNode();return t===e||t===e.ownerDocument?"":(e=t.host)?ki(e).is:""}function Mo(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.target!==document.documentElement&&n.target!==document.head)for(var r=0;r<n.addedNodes.length;r++){var i=n.addedNodes[r];if(i.nodeType===Node.ELEMENT_NODE){var o=i.getRootNode(),a=So(i);if(a&&o===i.ownerDocument&&("style"!==i.localName&&"template"!==i.localName||""===Oi(i)))ji(i,a);else if(o instanceof ShadowRoot)for((o=Eo(i))!==a&&Bi(i,a,o),i=window.ShadyDOM.nativeMethods.querySelectorAll.call(i,":not(."+to.a+")"),a=0;a<i.length;a++){var s=Eo(o=i[a]);s&&Ui(o,s)}}}}}if(!(ui||window.ShadyDOM&&window.ShadyDOM.handlesDynamicScoping)){var Co=new MutationObserver(Mo),To=function(e){Co.observe(e,{childList:!0,subtree:!0})};if(window.customElements&&!window.customElements.polyfillWrapFlushCallback)To(document);else{var Ao=function(){To(document.body)};window.HTMLImports?window.HTMLImports.whenReady(Ao):requestAnimationFrame((function(){"loading"===document.readyState?document.addEventListener("readystatechange",(function e(){Ao(),document.removeEventListener("readystatechange",e)})):Ao()}))}wo=function(){Mo(Co.takeRecords())}}var Po={},Lo=Promise.resolve();function Ro(e){(e=Po[e])&&(e._applyShimCurrentVersion=e._applyShimCurrentVersion||0,e._applyShimValidatingVersion=e._applyShimValidatingVersion||0,e._applyShimNextVersion=(e._applyShimNextVersion||0)+1)}function ko(e){return e._applyShimCurrentVersion===e._applyShimNextVersion}var No={},Oo=new _o;function Do(){this.Y={},this.c=document.documentElement;var e=new Yr;e.rules=[],this.l=io(this.c,new no(e)),this.J=!1,this.a=this.b=null}function Fo(e){var t=ki(e),n=t.is;t=t.ba;var r=go[n]||null,i=Po[n];if(i)return io(e,t=new no(n=i._styleAst,r,i.a,t,i=Oi(i))),t}function Io(e){if(!e.b&&window.ShadyCSS&&window.ShadyCSS.ApplyShim){e.b=window.ShadyCSS.ApplyShim,e.b.invalidCallback=Ro;var t=!0}else t=!1;return function(e){!e.a&&window.ShadyCSS&&window.ShadyCSS.CustomStyleInterface&&(e.a=window.ShadyCSS.CustomStyleInterface,e.a.transformCallback=function(t){e.Ha(t)},e.a.validateCallback=function(){requestAnimationFrame((function(){(e.a.enqueued||e.J)&&e.flushCustomStyles()}))})}(e),t}function Uo(e,t,n){var r=ki(t).is;if(n.F){var i,o=n.F;for(i in o)null===i?t.style.removeProperty(i):t.style.setProperty(i,o[i])}!(o=Po[r])&&t!==e.c||o&&""!==Oi(o)||!o||!o._style||ko(o)||((ko(o)||o._applyShimValidatingVersion!==o._applyShimNextVersion)&&(Io(e),e.b&&e.b.transformRules(o._styleAst,r),o._style.textContent=zi(t,n.H),function(e){e._applyShimValidatingVersion=e._applyShimNextVersion,e._validating||(e._validating=!0,Lo.then((function(){e._applyShimCurrentVersion=e._applyShimNextVersion,e._validating=!1})))}(o)),ui&&(e=t.shadowRoot)&&(e=e.querySelector("style"))&&(e.textContent=zi(t,n.H)),n.H=o._styleAst)}function Bo(e,t){return(t=Ri(t).getRootNode().host)?ro(t)||Fo(t)?t:Bo(e,t):e.c}function jo(e,t,n){var r=Bo(e,t),i=ro(r),o=i.L;for(var a in r===e.c||o||(jo(e,r,i),o=i.L),e=Object.create(o||null),r=function(e,t,n){var r={},i={};return Ei(t,(function(t){!function(e,t,n,r){if(t.v||uo(t),t.v.K){var i=ki(e);e=i.is,i=i.ba,i=e?Vi(e,i):"html";var o=t.parsedSelector,a=!!o.match(ao)||"html"===i&&-1<o.indexOf("html"),s=0===o.indexOf(":host")&&!a;"shady"===n&&(s=!(a=o===i+" > *."+i||-1!==o.indexOf("html"))&&0===o.indexOf(i)),(a||s)&&(n=i,s&&(t.w||(t.w=Gi(to,t,to.b,e?"."+e:"",i)),n=t.w||i),a&&"html"===i&&(n=t.w||t.J),r({wa:n,Xa:s,mb:a}))}}(e,t,n,(function(n){oo.call(e._element||e,n.wa)&&(n.Xa?lo(t,r):lo(t,i))}))}),null,!0),{cb:i,Va:r}}(t,n.H,n.cssBuild),t=function(e,t){var n={},r=[];return Ei(e,(function(e){e.v||uo(e);var i=e.w||e.parsedSelector;t&&e.v.K&&i&&oo.call(t,i)&&(lo(e,n),e=e.index,i=parseInt(e/32,10),r[i]=(r[i]||0)|1<<e%32)}),null,!0),{K:n,key:r}}(i.H,t).K,Object.assign(e,r.Va,t,r.cb),t=n.F)((i=t[a])||0===i)&&(e[a]=i);for(a=vo,t=Object.getOwnPropertyNames(e),i=0;i<t.length;i++)e[r=t[i]]=ho(a,e[r],e);n.L=e}(r=Do.prototype).flush=function(){wo()},r.Ta=function(e){return xi(e)},r.hb=function(e){return wi(e)},r.prepareTemplate=function(e,t,n){this.prepareTemplateDom(e,t),this.prepareTemplateStyles(e,t,n)},r.prepareTemplateStyles=function(e,t,n){if(!e._prepared&&!fi){ui||go[t]||(go[t]=Ti(t)),e._prepared=!0,e.name=t,e.extends=n,Po[t]=e;var r=Oi(e),i=Di(r);n={is:t,extends:n};for(var o=[],a=e.content.querySelectorAll("style"),s=0;s<a.length;s++){var c=a[s];if(c.hasAttribute("shady-unscoped")){if(!ui){var u=c.textContent;if(!_i.has(u)){_i.add(u);var l=document.createElement("style");l.setAttribute("shady-unscoped",""),l.textContent=u,document.head.appendChild(l)}c.parentNode.removeChild(c)}}else o.push(c.textContent),c.parentNode.removeChild(c)}o=o.join("").trim()+(No[t]||""),Io(this),i||((a=!r)&&(a=mi.test(o)||pi.test(o),mi.lastIndex=0,pi.lastIndex=0),s=Zr(o),a&&di&&this.b&&this.b.transformRules(s,t),e._styleAst=s),a=[],di||(a=function(e){var t={},n=[],r=0;for(var i in Ei(e,(function(e){uo(e),e.index=r++,e=e.v.cssText;for(var n;n=vi.exec(e);){var i=n[1];":"!==n[2]&&(t[i]=!0)}}),(function(e){n.push(e)})),e.b=n,e=[],t)e.push(i);return e}(e._styleAst)),a.length&&!di||(s=ui?e.content:null,t=go[t]||null,r=(r=zi(n,e._styleAst,null,r,i?o:"")).length?Mi(r,n.is,s,t):null,e._style=r),e.a=a}},r.ab=function(e,t){No[t]=e.join(" ")},r.prepareTemplateDom=function(e,t){if(!fi){var n=Oi(e);ui||"shady"===n||e._domPrepared||(e._domPrepared=!0,function(e,t){Ii(to,e,(function(e){Ui(e,t||"")}))}(e.content,t))}},r.flushCustomStyles=function(){if(!fi){var e=Io(this);if(this.a){var t=this.a.processStyles();if((e||this.a.enqueued)&&!Di(this.l.cssBuild)){if(di){if(!this.l.cssBuild)for(e=0;e<t.length;e++){var n=this.a.getStyleForCustomStyle(t[e]);if(n&&di&&this.b){var r=xi(n);Io(this),this.b.transformRules(r),n.textContent=wi(r)}}}else{for(function(e,t){(t=t.map((function(t){return e.a.getStyleForCustomStyle(t)})).filter((function(e){return!!e}))).sort((function(e,t){return(e=t.compareDocumentPosition(e))&Node.DOCUMENT_POSITION_FOLLOWING?1:e&Node.DOCUMENT_POSITION_PRECEDING?-1:0})),e.l.H.rules=t.map((function(e){return xi(e)}))}(this,t),jo(this,this.c,this.l),e=0;e<t.length;e++)(n=this.a.getStyleForCustomStyle(t[e]))&&mo(n,this.l.L);this.J&&this.styleDocument()}this.a.enqueued=!1}}}},r.styleElement=function(e,t){if(fi){if(t){ro(e)||io(e,new no(null));var n=ro(e);n.F=n.F||{},Object.assign(n.F,t),Uo(this,e,n)}}else if(n=ro(e)||Fo(e))if(e!==this.c&&(this.J=!0),t&&(n.F=n.F||{},Object.assign(n.F,t)),di)Uo(this,e,n);else if(this.flush(),jo(this,e,n),n.ta&&n.ta.length){var r;t=ki(e).is;e:{if(r=Oo.cache[t])for(var i=r.length-1;0<=i;i--){var o=r[i];t:{for(var a=n.ta,s=0;s<a.length;s++){var c=a[s];if(o.K[c]!==n.L[c]){a=!1;break t}}a=!0}if(a){r=o;break e}}r=void 0}a=r?r.styleElement:null,i=n.G,(o=r&&r.G)||(o=t+"-"+(o=this.Y[t]=(this.Y[t]||0)+1)),n.G=o,o=n.G,s=vo,s=a?a.textContent||"":function(e,t,n,r){var i=ki(t),o=Vi(i.is,i.ba),a=new RegExp("(?:^|[^.#[:])"+(t.extends?"\\"+o.slice(0,-1)+"\\]":o)+"($|[.:[\\s>+~])"),s=ro(t);i=s.H,s=s.cssBuild;var c=function(e,t){e=e.b;var n={};if(!ui&&e)for(var r=0,i=e[r];r<e.length;i=e[++r]){var o=i,a=t;o.l=new RegExp("\\b"+o.keyframesName+"(?!\\B|-)","g"),o.a=o.keyframesName+"-"+a,o.w=o.w||o.selector,o.selector=o.w.replace(o.keyframesName,o.a),n[i.keyframesName]=po(i)}return n}(i,r);return zi(t,i,(function(t){var i="";if(t.v||uo(t),t.v.cssText&&(i=fo(e,t.v.cssText,n)),t.cssText=i,!ui&&!Si(t)&&t.cssText){var s=i=t.cssText;if(null==t.Da&&(t.Da=gi.test(i)),t.Da)if(null==t.ja)for(var u in t.ja=[],c)i!==(s=(s=c[u])(i))&&(i=s,t.ja.push(u));else{for(u=0;u<t.ja.length;++u)i=(s=c[t.ja[u]])(i);s=i}t.cssText=s,t.w=t.w||t.selector,i="."+r,s=0;for(var l=(u=Ni(t.w)).length,h=void 0;s<l&&(h=u[s]);s++)u[s]=h.match(a)?h.replace(o,i):i+" "+h;t.selector=u.join(",")}}),s)}(s,e,n.L,o);var u=(c=ro(e)).a;u&&!ui&&u!==a&&(u._useCount--,0>=u._useCount&&u.parentNode&&u.parentNode.removeChild(u)),ui?c.a?(c.a.textContent=s,a=c.a):s&&(a=Mi(s,o,e.shadowRoot,c.b)):a?a.parentNode||(so&&-1<s.indexOf("@media")&&(a.textContent=s),Ai(a,null,c.b)):s&&(a=Mi(s,o,null,c.b)),a&&(a._useCount=a._useCount||0,c.a!=a&&a._useCount++,c.a=a),o=a,ui||(a=n.G,c=s=e.getAttribute("class")||"",i&&(c=s.replace(new RegExp("\\s*x-scope\\s*"+i+"\\s*","g")," ")),s!==(c+=(c?" ":"")+"x-scope "+a)&&Li(e,c)),r||Oo.store(t,n.L,o,n.G)}},r.styleDocument=function(e){this.styleSubtree(this.c,e)},r.styleSubtree=function(e,t){var n=Ri(e),r=n.shadowRoot,i=e===this.c;if((r||i)&&this.styleElement(e,t),e=i?n:r)for(e=Array.from(e.querySelectorAll("*")).filter((function(e){return Ri(e).shadowRoot})),t=0;t<e.length;t++)this.styleSubtree(e[t])},r.Ha=function(e){var t=this,n=Oi(e);if(n!==this.l.cssBuild&&(this.l.cssBuild=n),!Di(n)){var r=xi(e);Ei(r,(function(e){if(ui)qi(e);else{var r=to;e.selector=e.parsedSelector,qi(e),e.selector=e.w=Gi(r,e,r.c,void 0,void 0)}di&&""===n&&(Io(t),t.b&&t.b.transformRule(e))})),di?e.textContent=wi(r):this.l.H.rules.push(r)}},r.getComputedStyleValue=function(e,t){var n;return di||(n=(ro(e)||ro(Bo(this,e))).L[t]),(n=n||window.getComputedStyle(e).getPropertyValue(t))?n.trim():""},r.gb=function(e,t){var n,r=Ri(e).getRootNode();if(n=t?("string"==typeof t?t:String(t)).split(/\s/):[],!(t=r.host&&r.host.localName)&&(r=e.getAttribute("class"))){r=r.split(/\s/);for(var i=0;i<r.length;i++)if(r[i]===to.a){t=r[i+1];break}}t&&n.push(to.a,t),di||(t=ro(e))&&t.G&&n.push(vo.a,t.G),Li(e,n.join(" "))},r.Oa=function(e){return ro(e)},r.fb=function(e,t){Ui(e,t)},r.ib=function(e,t){Ui(e,t,!0)},r.eb=function(e){return Eo(e)},r.Ra=function(e){return So(e)},Do.prototype.flush=Do.prototype.flush,Do.prototype.prepareTemplate=Do.prototype.prepareTemplate,Do.prototype.styleElement=Do.prototype.styleElement,Do.prototype.styleDocument=Do.prototype.styleDocument,Do.prototype.styleSubtree=Do.prototype.styleSubtree,Do.prototype.getComputedStyleValue=Do.prototype.getComputedStyleValue,Do.prototype.setElementClass=Do.prototype.gb,Do.prototype._styleInfoForNode=Do.prototype.Oa,Do.prototype.transformCustomStyleForDocument=Do.prototype.Ha,Do.prototype.getStyleAst=Do.prototype.Ta,Do.prototype.styleAstToString=Do.prototype.hb,Do.prototype.flushCustomStyles=Do.prototype.flushCustomStyles,Do.prototype.scopeNode=Do.prototype.fb,Do.prototype.unscopeNode=Do.prototype.ib,Do.prototype.scopeForNode=Do.prototype.eb,Do.prototype.currentScopeForNode=Do.prototype.Ra,Do.prototype.prepareAdoptedCssText=Do.prototype.ab,Object.defineProperties(Do.prototype,{nativeShadow:{get:function(){return ui}},nativeCss:{get:function(){return di}}});var zo,Vo,Go=new Do;window.ShadyCSS&&(zo=window.ShadyCSS.ApplyShim,Vo=window.ShadyCSS.CustomStyleInterface),window.ShadyCSS={ScopingShim:Go,prepareTemplate:function(e,t,n){Go.flushCustomStyles(),Go.prepareTemplate(e,t,n)},prepareTemplateDom:function(e,t){Go.prepareTemplateDom(e,t)},prepareTemplateStyles:function(e,t,n){Go.flushCustomStyles(),Go.prepareTemplateStyles(e,t,n)},styleSubtree:function(e,t){Go.flushCustomStyles(),Go.styleSubtree(e,t)},styleElement:function(e){Go.flushCustomStyles(),Go.styleElement(e)},styleDocument:function(e){Go.flushCustomStyles(),Go.styleDocument(e)},flushCustomStyles:function(){Go.flushCustomStyles()},getComputedStyleValue:function(e,t){return Go.getComputedStyleValue(e,t)},nativeCss:di,nativeShadow:ui,cssBuild:Kr,disableRuntime:fi},zo&&(window.ShadyCSS.ApplyShim=zo),Vo&&(window.ShadyCSS.CustomStyleInterface=Vo),function(e){function t(e){return""==e&&(o.call(this),this.h=!0),e.toLowerCase()}function n(e){var t=e.charCodeAt(0);return 32<t&&127>t&&-1==[34,35,60,62,63,96].indexOf(t)?e:encodeURIComponent(e)}function r(e){var t=e.charCodeAt(0);return 32<t&&127>t&&-1==[34,35,60,62,96].indexOf(t)?e:encodeURIComponent(e)}function i(e,i,a){function s(e){g.push(e)}var c=i||"scheme start",d=0,p="",m=!1,v=!1,g=[];e:for(;(null!=e[d-1]||0==d)&&!this.h;){var y=e[d];switch(c){case"scheme start":if(!y||!h.test(y)){if(i){s("Invalid scheme.");break e}p="",c="no scheme";continue}p+=y.toLowerCase(),c="scheme";break;case"scheme":if(y&&f.test(y))p+=y.toLowerCase();else{if(":"!=y){if(i){null!=y&&s("Code point not allowed in scheme: "+y);break e}p="",d=0,c="no scheme";continue}if(this.g=p,p="",i)break e;void 0!==u[this.g]&&(this.A=!0),c="file"==this.g?"relative":this.A&&a&&a.g==this.g?"relative or authority":this.A?"authority first slash":"scheme data"}break;case"scheme data":"?"==y?(this.o="?",c="query"):"#"==y?(this.u="#",c="fragment"):null!=y&&"\t"!=y&&"\n"!=y&&"\r"!=y&&(this.pa+=n(y));break;case"no scheme":if(a&&void 0!==u[a.g]){c="relative";continue}s("Missing scheme."),o.call(this),this.h=!0;break;case"relative or authority":if("/"!=y||"/"!=e[d+1]){s("Expected /, got: "+y),c="relative";continue}c="authority ignore slashes";break;case"relative":if(this.A=!0,"file"!=this.g&&(this.g=a.g),null==y){this.i=a.i,this.m=a.m,this.j=a.j.slice(),this.o=a.o,this.s=a.s,this.f=a.f;break e}if("/"==y||"\\"==y)"\\"==y&&s("\\ is an invalid code point."),c="relative slash";else if("?"==y)this.i=a.i,this.m=a.m,this.j=a.j.slice(),this.o="?",this.s=a.s,this.f=a.f,c="query";else{if("#"!=y){c=e[d+1];var b=e[d+2];("file"!=this.g||!h.test(y)||":"!=c&&"|"!=c||null!=b&&"/"!=b&&"\\"!=b&&"?"!=b&&"#"!=b)&&(this.i=a.i,this.m=a.m,this.s=a.s,this.f=a.f,this.j=a.j.slice(),this.j.pop()),c="relative path";continue}this.i=a.i,this.m=a.m,this.j=a.j.slice(),this.o=a.o,this.u="#",this.s=a.s,this.f=a.f,c="fragment"}break;case"relative slash":if("/"!=y&&"\\"!=y){"file"!=this.g&&(this.i=a.i,this.m=a.m,this.s=a.s,this.f=a.f),c="relative path";continue}"\\"==y&&s("\\ is an invalid code point."),c="file"==this.g?"file host":"authority ignore slashes";break;case"authority first slash":if("/"!=y){s("Expected '/', got: "+y),c="authority ignore slashes";continue}c="authority second slash";break;case"authority second slash":if(c="authority ignore slashes","/"!=y){s("Expected '/', got: "+y);continue}break;case"authority ignore slashes":if("/"!=y&&"\\"!=y){c="authority";continue}s("Expected authority, got: "+y);break;case"authority":if("@"==y){for(m&&(s("@ already seen."),p+="%40"),m=!0,y=0;y<p.length;y++)"\t"==(b=p[y])||"\n"==b||"\r"==b?s("Invalid whitespace in authority."):":"==b&&null===this.f?this.f="":(b=n(b),null!==this.f?this.f+=b:this.s+=b);p=""}else{if(null==y||"/"==y||"\\"==y||"?"==y||"#"==y){d-=p.length,p="",c="host";continue}p+=y}break;case"file host":if(null==y||"/"==y||"\\"==y||"?"==y||"#"==y){2!=p.length||!h.test(p[0])||":"!=p[1]&&"|"!=p[1]?(0!=p.length&&(this.i=t.call(this,p),p=""),c="relative path start"):c="relative path";continue}"\t"==y||"\n"==y||"\r"==y?s("Invalid whitespace in file host."):p+=y;break;case"host":case"hostname":if(":"!=y||v){if(null==y||"/"==y||"\\"==y||"?"==y||"#"==y){if(this.i=t.call(this,p),p="",c="relative path start",i)break e;continue}"\t"!=y&&"\n"!=y&&"\r"!=y?("["==y?v=!0:"]"==y&&(v=!1),p+=y):s("Invalid code point in host/hostname: "+y)}else if(this.i=t.call(this,p),p="",c="port","hostname"==i)break e;break;case"port":if(/[0-9]/.test(y))p+=y;else{if(null==y||"/"==y||"\\"==y||"?"==y||"#"==y||i){if(""!=p&&((p=parseInt(p,10))!=u[this.g]&&(this.m=p+""),p=""),i)break e;c="relative path start";continue}"\t"==y||"\n"==y||"\r"==y?s("Invalid code point in port: "+y):(o.call(this),this.h=!0)}break;case"relative path start":if("\\"==y&&s("'\\' not allowed in path."),c="relative path","/"!=y&&"\\"!=y)continue;break;case"relative path":null!=y&&"/"!=y&&"\\"!=y&&(i||"?"!=y&&"#"!=y)?"\t"!=y&&"\n"!=y&&"\r"!=y&&(p+=n(y)):("\\"==y&&s("\\ not allowed in relative path."),(b=l[p.toLowerCase()])&&(p=b),".."==p?(this.j.pop(),"/"!=y&&"\\"!=y&&this.j.push("")):"."==p&&"/"!=y&&"\\"!=y?this.j.push(""):"."!=p&&("file"==this.g&&0==this.j.length&&2==p.length&&h.test(p[0])&&"|"==p[1]&&(p=p[0]+":"),this.j.push(p)),p="","?"==y?(this.o="?",c="query"):"#"==y&&(this.u="#",c="fragment"));break;case"query":i||"#"!=y?null!=y&&"\t"!=y&&"\n"!=y&&"\r"!=y&&(this.o+=r(y)):(this.u="#",c="fragment");break;case"fragment":null!=y&&"\t"!=y&&"\n"!=y&&"\r"!=y&&(this.u+=y)}d++}}function o(){this.s=this.pa=this.g="",this.f=null,this.m=this.i="",this.j=[],this.u=this.o="",this.A=this.h=!1}function a(e,t){void 0===t||t instanceof a||(t=new a(String(t))),this.a=e,o.call(this),i.call(this,this.a.replace(/^[ \t\r\n\f]+|[ \t\r\n\f]+$/g,""),null,t)}var s=!1;try{var c=new URL("b","http://a");c.pathname="c%20d",s="http://a/c%20d"===c.href}catch(e){}if(!s){var u=Object.create(null);u.ftp=21,u.file=0,u.gopher=70,u.http=80,u.https=443,u.ws=80,u.wss=443;var l=Object.create(null);l["%2e"]=".",l[".%2e"]="..",l["%2e."]="..",l["%2e%2e"]="..";var h=/[a-zA-Z]/,f=/[a-zA-Z0-9\+\-\.]/;a.prototype={toString:function(){return this.href},get href(){if(this.h)return this.a;var e="";return""==this.s&&null==this.f||(e=this.s+(null!=this.f?":"+this.f:"")+"@"),this.protocol+(this.A?"//"+e+this.host:"")+this.pathname+this.o+this.u},set href(e){o.call(this),i.call(this,e)},get protocol(){return this.g+":"},set protocol(e){this.h||i.call(this,e+":","scheme start")},get host(){return this.h?"":this.m?this.i+":"+this.m:this.i},set host(e){!this.h&&this.A&&i.call(this,e,"host")},get hostname(){return this.i},set hostname(e){!this.h&&this.A&&i.call(this,e,"hostname")},get port(){return this.m},set port(e){!this.h&&this.A&&i.call(this,e,"port")},get pathname(){return this.h?"":this.A?"/"+this.j.join("/"):this.pa},set pathname(e){!this.h&&this.A&&(this.j=[],i.call(this,e,"relative path start"))},get search(){return this.h||!this.o||"?"==this.o?"":this.o},set search(e){!this.h&&this.A&&(this.o="?","?"==e[0]&&(e=e.slice(1)),i.call(this,e,"query"))},get hash(){return this.h||!this.u||"#"==this.u?"":this.u},set hash(e){this.h||(e?(this.u="#","#"==e[0]&&(e=e.slice(1)),i.call(this,e,"fragment")):this.u="")},get origin(){var e;if(this.h||!this.g)return"";switch(this.g){case"data":case"file":case"javascript":case"mailto":return"null"}return(e=this.host)?this.g+"://"+e:""}};var d=e.URL;d&&(a.createObjectURL=function(e){return d.createObjectURL.apply(d,arguments)},a.revokeObjectURL=function(e){d.revokeObjectURL(e)}),e.URL=a}}(window),Object.getOwnPropertyDescriptor(Node.prototype,"baseURI")||Object.defineProperty(Node.prototype,"baseURI",{get:function(){var e=(this.ownerDocument||this).querySelector("base[href]");return e&&e.href||window.location.href},configurable:!0,enumerable:!0});var Wo=document.createElement("style");Wo.textContent="body {transition: opacity ease-in 0.2s; } \nbody[unresolved] {opacity: 0; display: block; overflow: hidden; position: relative; } \n";var Ho=document.querySelector("head");Ho.insertBefore(Wo,Ho.firstChild);var qo=window.customElements,Xo=!1,Yo=null;function Zo(){window.HTMLTemplateElement.bootstrap&&window.HTMLTemplateElement.bootstrap(window.document),Yo&&Yo(),Xo=!0,window.WebComponents.ready=!0,document.dispatchEvent(new CustomEvent("WebComponentsReady",{bubbles:!0}))}qo.polyfillWrapFlushCallback&&qo.polyfillWrapFlushCallback((function(e){Yo=e,Xo&&e()})),"complete"!==document.readyState?(window.addEventListener("load",Zo),window.addEventListener("DOMContentLoaded",(function(){window.removeEventListener("load",Zo),Zo()}))):Zo()}).call(this)}).call(this,n(54),n(367).setImmediate)},function(e,t,n){(function(e){var r=void 0!==e&&e||"undefined"!=typeof self&&self||window,i=Function.prototype.apply;function o(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new o(i.call(setTimeout,r,arguments),clearTimeout)},t.setInterval=function(){return new o(i.call(setInterval,r,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},o.prototype.unref=o.prototype.ref=function(){},o.prototype.close=function(){this._clearFn.call(r,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},n(368),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,n(54))},function(e,t,n){(function(e,t){!function(e,n){"use strict";if(!e.setImmediate){var r,i=1,o={},a=!1,s=e.document,c=Object.getPrototypeOf&&Object.getPrototypeOf(e);c=c&&c.setTimeout?c:e,"[object process]"==={}.toString.call(e.process)?r=function(e){t.nextTick((function(){l(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?function(){var t="setImmediate$"+Math.random()+"$",n=function(n){n.source===e&&"string"==typeof n.data&&0===n.data.indexOf(t)&&l(+n.data.slice(t.length))};e.addEventListener?e.addEventListener("message",n,!1):e.attachEvent("onmessage",n),r=function(n){e.postMessage(t+n,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){l(e.data)},r=function(t){e.port2.postMessage(t)}}():s&&"onreadystatechange"in s.createElement("script")?function(){var e=s.documentElement;r=function(t){var n=s.createElement("script");n.onreadystatechange=function(){l(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}():r=function(e){setTimeout(l,0,e)},c.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var a={callback:e,args:t};return o[i]=a,r(i),i++},c.clearImmediate=u}function u(e){delete o[e]}function l(e){if(a)setTimeout(l,0,e);else{var t=o[e];if(t){a=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{u(e),a=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,n(54),n(55))},function(e,t,n){var r=n(139),i=n(30)("socket.io-client:url");e.exports=function(e,t){var n=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(i("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),i("parse %s",e),n=r(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var o=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+o+":"+n.port,n.href=n.protocol+"://"+o+(t&&t.port===n.port?"":":"+n.port),n}},function(e,t,n){function r(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}e.exports=function(e){function t(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return i.colors[Math.abs(t)%i.colors.length]}function i(e){var n;function r(){for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];if(r.enabled){var a=r,s=Number(new Date),c=s-(n||s);a.diff=c,a.prev=n,a.curr=s,n=s,t[0]=i.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");var u=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(function(e,n){if("%%"===e)return e;u++;var r=i.formatters[n];if("function"==typeof r){var o=t[u];e=r.call(a,o),t.splice(u,1),u--}return e})),i.formatArgs.call(a,t),(a.log||i.log).apply(a,t)}}return r.namespace=e,r.enabled=i.enabled(e),r.useColors=i.useColors(),r.color=t(e),r.destroy=o,r.extend=a,"function"==typeof i.init&&i.init(r),i.instances.push(r),r}function o(){var e=i.instances.indexOf(this);return-1!==e&&(i.instances.splice(e,1),!0)}function a(e,t){var n=i(this.namespace+(void 0===t?":":t)+e);return n.log=this.log,n}function s(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return i.debug=i,i.default=i,i.coerce=function(e){return e instanceof Error?e.stack||e.message:e},i.disable=function(){var e=[].concat(r(i.names.map(s)),r(i.skips.map(s).map((function(e){return"-"+e})))).join(",");return i.enable(""),e},i.enable=function(e){var t;i.save(e),i.names=[],i.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length;for(t=0;t<r;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?i.skips.push(new RegExp("^"+e.substr(1)+"$")):i.names.push(new RegExp("^"+e+"$")));for(t=0;t<i.instances.length;t++){var o=i.instances[t];o.enabled=i.enabled(o.namespace)}},i.enabled=function(e){if("*"===e[e.length-1])return!0;var t,n;for(t=0,n=i.skips.length;t<n;t++)if(i.skips[t].test(e))return!1;for(t=0,n=i.names.length;t<n;t++)if(i.names[t].test(e))return!0;return!1},i.humanize=n(371),Object.keys(e).forEach((function(t){i[t]=e[t]})),i.instances=[],i.names=[],i.skips=[],i.formatters={},i.selectColor=t,i.enable(i.load()),i}},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r=1e3,i=6e4,o=60*i,a=24*o;function u(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}e.exports=function(e,t){t=t||{};var c=n(e);if("string"===c&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"weeks":case"week":case"w":return 6048e5*n;case"days":case"day":case"d":return n*a;case"hours":case"hour":case"hrs":case"hr":case"h":return n*o;case"minutes":case"minute":case"mins":case"min":case"m":return n*i;case"seconds":case"second":case"secs":case"sec":case"s":return n*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}(e);if("number"===c&&isFinite(e))return t.long?function(e){var t=Math.abs(e);return t>=a?u(e,t,a,"day"):t>=o?u(e,t,o,"hour"):t>=i?u(e,t,i,"minute"):t>=r?u(e,t,r,"second"):e+" ms"}(e):function(e){var t=Math.abs(e);return t>=a?Math.round(e/a)+"d":t>=o?Math.round(e/o)+"h":t>=i?Math.round(e/i)+"m":t>=r?Math.round(e/r)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){(function(r){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=Object({NODE_ENV:"production"}).DEBUG),e}(t=e.exports=n(373)).log=function(){return"object"===("undefined"==typeof console?"undefined":i(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),n){var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var i=0,o=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&"%c"===e&&(o=++i)})),e.splice(o,0,r)}},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=o,t.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(o())}).call(this,n(55))},function(e,t,n){function r(e){var n;function r(){if(r.enabled){var e=r,i=+new Date,o=i-(n||i);e.diff=o,e.prev=n,e.curr=i,n=i;for(var a=new Array(arguments.length),s=0;s<a.length;s++)a[s]=arguments[s];a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&a.unshift("%O");var c=0;a[0]=a[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;c++;var i=t.formatters[r];if("function"==typeof i){var o=a[c];n=i.call(e,o),a.splice(c,1),c--}return n})),t.formatArgs.call(e,a),(r.log||t.log||console.log.bind(console)).apply(e,a)}}return r.namespace=e,r.enabled=t.enabled(e),r.useColors=t.useColors(),r.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),r.destroy=i,"function"==typeof t.init&&t.init(r),t.instances.push(r),r}function i(){var e=t.instances.indexOf(this);return-1!==e&&(t.instances.splice(e,1),!0)}(t=e.exports=r.debug=r.default=r).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){var n;t.save(e),t.names=[],t.skips=[];var r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")));for(n=0;n<t.instances.length;n++){var o=t.instances[n];o.enabled=t.enabled(o.namespace)}},t.enabled=function(e){if("*"===e[e.length-1])return!0;var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(374),t.instances=[],t.names=[],t.skips=[],t.formatters={}},function(e,t){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var r=1e3,i=6e4,o=60*i,a=24*o;function c(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,t){t=t||{};var u=n(e);if("string"===u&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"days":case"day":case"d":return n*a;case"hours":case"hour":case"hrs":case"hr":case"h":return n*o;case"minutes":case"minute":case"mins":case"min":case"m":return n*i;case"seconds":case"second":case"secs":case"sec":case"s":return n*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}(e);if("number"===u&&!1===isNaN(e))return t.long?function(e){return c(e,a,"day")||c(e,o,"hour")||c(e,i,"minute")||c(e,r,"second")||e+" ms"}(e):function(e){return e>=a?Math.round(e/a)+"d":e>=o?Math.round(e/o)+"h":e>=i?Math.round(e/i)+"m":e>=r?Math.round(e/r)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=n(140),o=n(141),a=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===a.call(Blob),c="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===a.call(File);t.deconstructPacket=function(e){var t=[],n=e.data,a=e;return a.data=function e(t,n){if(!t)return t;if(o(t)){var a={_placeholder:!0,num:n.length};return n.push(t),a}if(i(t)){for(var s=new Array(t.length),c=0;c<t.length;c++)s[c]=e(t[c],n);return s}if("object"===r(t)&&!(t instanceof Date)){for(var u in s={},t)s[u]=e(t[u],n);return s}return t}(n,t),a.attachments=t.length,{packet:a,buffers:t}},t.reconstructPacket=function(e,t){return e.data=function e(t,n){if(!t)return t;if(t&&t._placeholder)return n[t.num];if(i(t))for(var o=0;o<t.length;o++)t[o]=e(t[o],n);else if("object"===r(t))for(var a in t)t[a]=e(t[a],n);return t}(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,t){var n=0,a=e;!function e(u,l,h){if(!u)return u;if(s&&u instanceof Blob||c&&u instanceof File){n++;var f=new FileReader;f.onload=function(){h?h[l]=this.result:a=this.result,--n||t(a)},f.readAsArrayBuffer(u)}else if(i(u))for(var d=0;d<u.length;d++)e(u[d],d,u);else if("object"===r(u)&&!o(u))for(var p in u)e(u[p],p,u)}(a),n||t(a)}},function(e,t,n){"use strict";t.byteLength=function(e){var t=u(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=u(e),a=r[0],s=r[1],c=new o(function(e,t,n){return 3*(t+n)/4-n}(0,a,s)),l=0,h=s>0?a-4:a;for(n=0;n<h;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],c[l++]=t>>16&255,c[l++]=t>>8&255,c[l++]=255&t;return 2===s&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,c[l++]=255&t),1===s&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,c[l++]=t>>8&255,c[l++]=255&t),c},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],a=0,s=n-i;a<s;a+=16383)o.push(h(e,a,a+16383>s?s:a+16383));return 1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),o.join("")};for(var r=[],i=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=a.length;s<c;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e){return r[e>>18&63]+r[e>>12&63]+r[e>>6&63]+r[63&e]}function h(e,t,n){for(var r,i=[],o=t;o<n;o+=3)r=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),i.push(l(r));return i.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,c=(1<<s)-1,u=c>>1,l=-7,h=n?i-1:0,f=n?-1:1,d=e[t+h];for(h+=f,o=d&(1<<-l)-1,d>>=-l,l+=s;l>0;o=256*o+e[t+h],h+=f,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+e[t+h],h+=f,l-=8);if(0===o)o=1-u;else{if(o===c)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,r),o-=u}return(d?-1:1)*a*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var a,s,c,u=8*o-i-1,l=(1<<u)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),(t+=a+h>=1?f/c:f*Math.pow(2,1-h))*c>=2&&(a++,c/=2),a+h>=l?(s=0,a=l):a+h>=1?(s=(t*c-1)*Math.pow(2,i),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;e[n+d]=255&s,d+=p,s/=256,i-=8);for(a=a<<i|s,u+=i;u>0;e[n+d]=255&a,d+=p,a/=256,u-=8);e[n+d-p]|=128*m}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){e.exports=n(380),e.exports.parser=n(48)},function(e,t,n){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=n(143),o=n(47),a=n(30)("engine.io-client:socket"),s=n(147),c=n(48),u=n(139),l=n(69);function h(e,t){if(!(this instanceof h))return new h(e,t);t=t||{},e&&"object"===r(e)&&(t=e,e=null),e?(e=u(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=u(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=l.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.withCredentials=!1!==t.withCredentials,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(t.extraHeaders&&Object.keys(t.extraHeaders).length>0&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}e.exports=h,h.priorWebsocketSuccess=!1,o(h.prototype),h.protocol=c.protocol,h.Socket=h,h.Transport=n(104),h.transports=n(143),h.parser=n(48),h.prototype.createTransport=function(e){a('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);t.EIO=c.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new i[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,withCredentials:n.withCredentials||this.withCredentials,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},h.prototype.open=function(){var e;if(this.rememberUpgrade&&h.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout((function(){t.emit("error","No transports available")}),0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},h.prototype.setTransport=function(e){a("setting transport %s",e.name);var t=this;this.transport&&(a("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",(function(){t.onDrain()})).on("packet",(function(e){t.onPacket(e)})).on("error",(function(e){t.onError(e)})).on("close",(function(){t.onClose("transport close")}))},h.prototype.probe=function(e){a('probing transport "%s"',e);var t=this.createTransport(e,{probe:1}),n=!1,r=this;function i(){if(r.onlyBinaryUpgrades){var i=!this.supportsBinary&&r.transport.supportsBinary;n=n||i}n||(a('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",(function(i){if(!n)if("pong"===i.type&&"probe"===i.data){if(a('probe transport "%s" pong',e),r.upgrading=!0,r.emit("upgrading",t),!t)return;h.priorWebsocketSuccess="websocket"===t.name,a('pausing current transport "%s"',r.transport.name),r.transport.pause((function(){n||"closed"!==r.readyState&&(a("changing transport and sending upgrade packet"),f(),r.setTransport(t),t.send([{type:"upgrade"}]),r.emit("upgrade",t),t=null,r.upgrading=!1,r.flush())}))}else{a('probe transport "%s" failed',e);var o=new Error("probe error");o.transport=t.name,r.emit("upgradeError",o)}})))}function o(){n||(n=!0,f(),t.close(),t=null)}function s(n){var i=new Error("probe error: "+n);i.transport=t.name,o(),a('probe transport "%s" failed because of error: %s',e,n),r.emit("upgradeError",i)}function c(){s("transport closed")}function u(){s("socket closed")}function l(e){t&&e.name!==t.name&&(a('"%s" works - aborting "%s"',e.name,t.name),o())}function f(){t.removeListener("open",i),t.removeListener("error",s),t.removeListener("close",c),r.removeListener("close",u),r.removeListener("upgrading",l)}h.priorWebsocketSuccess=!1,t.once("open",i),t.once("error",s),t.once("close",c),this.once("close",u),this.once("upgrading",l),t.open()},h.prototype.onOpen=function(){if(a("socket open"),this.readyState="open",h.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){a("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},h.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(a('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else a('packet received with socket readyState "%s"',this.readyState)},h.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},h.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout((function(){"closed"!==t.readyState&&t.onClose("ping timeout")}),e||t.pingInterval+t.pingTimeout)},h.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout((function(){a("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)}),e.pingInterval)},h.prototype.ping=function(){var e=this;this.sendPacket("ping",(function(){e.emit("ping")}))},h.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},h.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(a("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},h.prototype.write=h.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},h.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var i={type:e,data:t,options:n};this.emit("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}},h.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",(function(){this.upgrading?r():t()})):this.upgrading?r():t()}function t(){e.onClose("forced close"),a("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function r(){e.once("upgrade",n),e.once("upgradeError",n)}return this},h.prototype.onError=function(e){a("socket error %j",e),h.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},h.prototype.onClose=function(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(a('socket close with reason: "%s"',e),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)},h.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~s(this.transports,e[n])&&t.push(e[n]);return t}},function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},function(e,t,n){var r=n(103),i=n(144),o=n(47),a=n(70),s=n(30)("engine.io-client:polling-xhr");function c(){}function u(e){if(i.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!=typeof location){var t="https:"===location.protocol,n=location.port;n||(n=t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}}function l(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}if(e.exports=u,e.exports.Request=l,a(u,i),u.prototype.supportsBinary=!0,u.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.withCredentials=this.withCredentials,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new l(e)},u.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),i=this;r.on("success",t),r.on("error",(function(e){i.onError("xhr post error",e)})),this.sendXhr=r},u.prototype.doPoll=function(){s("xhr poll");var e=this.request(),t=this;e.on("data",(function(e){t.onData(e)})),e.on("error",(function(e){t.onError("xhr poll error",e)})),this.pollXhr=e},o(l.prototype),l.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new r(e),n=this;try{s("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var i in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(i)&&t.setRequestHeader(i,this.extraHeaders[i])}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=this.withCredentials),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");(n.supportsBinary&&"application/octet-stream"===e||"application/octet-stream; charset=UTF-8"===e)&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout((function(){n.onError("number"==typeof t.status?t.status:0)}),0))},s("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout((function(){n.onError(e)}),0)}"undefined"!=typeof document&&(this.index=l.requestsCount++,l.requests[this.index]=this)},l.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},l.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},l.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},l.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=c:this.xhr.onreadystatechange=c,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete l.requests[this.index],this.xhr=null}},l.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e=("application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},l.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},l.prototype.abort=function(){this.cleanup()},l.requestsCount=0,l.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",f);else if("function"==typeof addEventListener){var h="onpagehide"in self?"pagehide":"unload";addEventListener(h,f,!1)}function f(){for(var e in l.requests)l.requests.hasOwnProperty(e)&&l.requests[e].abort()}},function(e,t){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){e.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),n>r&&(n=r),t>=r||t>=n||0===r)return new ArrayBuffer(0);for(var i=new Uint8Array(e),o=new Uint8Array(n-t),a=t,s=0;a<n;a++,s++)o[s]=i[a];return o.buffer}},function(e,t){function n(){}e.exports=function(e,t,r){var i=!1;return r=r||n,o.count=e,0===e?t():o;function o(e,n){if(o.count<=0)throw new Error("after called too many times");--o.count,e?(i=!0,t(e),t=r):0!==o.count||i||t(null,n)}}},function(e,t){var n,r,i,o=String.fromCharCode;function a(e){for(var t,n,r=[],i=0,o=e.length;i<o;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<o?56320==(64512&(n=e.charCodeAt(i++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),i--):r.push(t);return r}function s(e,t){if(e>=55296&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function c(e,t){return o(e>>t&63|128)}function u(e,t){if(0==(4294967168&e))return o(e);var n="";return 0==(4294965248&e)?n=o(e>>6&31|192):0==(4294901760&e)?(s(e,t)||(e=65533),n=o(e>>12&15|224),n+=c(e,6)):0==(4292870144&e)&&(n=o(e>>18&7|240),n+=c(e,12),n+=c(e,6)),n+o(63&e|128)}function l(){if(i>=r)throw Error("Invalid byte index");var e=255&n[i];if(i++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function h(e){var t,o;if(i>r)throw Error("Invalid byte index");if(i==r)return!1;if(t=255&n[i],i++,0==(128&t))return t;if(192==(224&t)){if((o=(31&t)<<6|l())>=128)return o;throw Error("Invalid continuation byte")}if(224==(240&t)){if((o=(15&t)<<12|l()<<6|l())>=2048)return s(o,e)?o:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&(o=(7&t)<<18|l()<<12|l()<<6|l())>=65536&&o<=1114111)return o;throw Error("Invalid UTF-8 detected")}e.exports={version:"2.1.2",encode:function(e,t){for(var n=!1!==(t=t||{}).strict,r=a(e),i=r.length,o=-1,s="";++o<i;)s+=u(r[o],n);return s},decode:function(e,t){var s=!1!==(t=t||{}).strict;n=a(e),r=n.length,i=0;for(var c,u=[];!1!==(c=h(s));)u.push(c);return function(e){for(var t,n=e.length,r=-1,i="";++r<n;)(t=e[r])>65535&&(i+=o((t-=65536)>>>10&1023|55296),t=56320|1023&t),i+=o(t);return i}(u)}}},function(e,t){!function(){"use strict";for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=new Uint8Array(256),r=0;r<e.length;r++)n[e.charCodeAt(r)]=r;t.encode=function(t){var n,r=new Uint8Array(t),i=r.length,o="";for(n=0;n<i;n+=3)o+=e[r[n]>>2],o+=e[(3&r[n])<<4|r[n+1]>>4],o+=e[(15&r[n+1])<<2|r[n+2]>>6],o+=e[63&r[n+2]];return i%3==2?o=o.substring(0,o.length-1)+"=":i%3==1&&(o=o.substring(0,o.length-2)+"=="),o},t.decode=function(e){var t,r,i,o,a,s=.75*e.length,c=e.length,u=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var l=new ArrayBuffer(s),h=new Uint8Array(l);for(t=0;t<c;t+=4)r=n[e.charCodeAt(t)],i=n[e.charCodeAt(t+1)],o=n[e.charCodeAt(t+2)],a=n[e.charCodeAt(t+3)],h[u++]=r<<2|i>>4,h[u++]=(15&i)<<4|o>>2,h[u++]=(3&o)<<6|63&a;return l}}()},function(e,t){var n=void 0!==n?n:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,r=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),i=r&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),o=n&&n.prototype.append&&n.prototype.getBlob;function a(e){return e.map((function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var n=new Uint8Array(e.byteLength);n.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=n.buffer}return t}return e}))}function s(e,t){t=t||{};var r=new n;return a(e).forEach((function(e){r.append(e)})),t.type?r.getBlob(t.type):r.getBlob()}function c(e,t){return new Blob(a(e),t||{})}"undefined"!=typeof Blob&&(s.prototype=Blob.prototype,c.prototype=Blob.prototype),e.exports=r?i?Blob:c:o?s:void 0},function(e,t,n){(function(t){var r=n(144),i=n(70);e.exports=l;var o,a=/\n/g,s=/\\n/g;function c(){}function u(){return"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{}}function l(e){if(r.call(this,e),this.query=this.query||{},!o){var t=u();o=t.___eio=t.___eio||[]}this.index=o.length;var n=this;o.push((function(e){n.onData(e)})),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",(function(){n.script&&(n.script.onerror=c)}),!1)}i(l,r),l.prototype.supportsBinary=!1,l.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},l.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)}),100)},l.prototype.doWrite=function(e,t){var n=this;if(!this.form){var r,i=document.createElement("form"),o=document.createElement("textarea"),c=this.iframeId="eio_iframe_"+this.index;i.className="socketio",i.style.position="absolute",i.style.top="-1000px",i.style.left="-1000px",i.target=c,i.method="POST",i.setAttribute("accept-charset","utf-8"),o.name="d",i.appendChild(o),document.body.appendChild(i),this.form=i,this.area=o}function u(){l(),t()}function l(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(e)}catch(e){(r=document.createElement("iframe")).name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}this.form.action=this.uri(),l(),e=e.replace(s,"\\\n"),this.area.value=e.replace(a,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&u()}:this.iframe.onload=u}}).call(this,n(54))},function(e,t,n){(function(t){var r,i,o=n(104),a=n(48),s=n(69),c=n(70),u=n(146),l=n(30)("engine.io-client:websocket");if("undefined"!=typeof WebSocket?r=WebSocket:"undefined"!=typeof self&&(r=self.WebSocket||self.MozWebSocket),"undefined"==typeof window)try{i=n(392)}catch(e){}var h=r||i;function f(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=r&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(h=i),o.call(this,e)}e.exports=f,c(f,o),f.prototype.name="websocket",f.prototype.supportsBinary=!0,f.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new h(e,t):new h(e):new h(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},f.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},f.prototype.write=function(e){var n=this;this.writable=!1;for(var r=e.length,i=0,o=r;i<o;i++)!function(e){a.encodePacket(e,n.supportsBinary,(function(i){if(!n.usingBrowserWebSocket){var o={};e.options&&(o.compress=e.options.compress),n.perMessageDeflate&&("string"==typeof i?t.byteLength(i):i.length)<n.perMessageDeflate.threshold&&(o.compress=!1)}try{n.usingBrowserWebSocket?n.ws.send(i):n.ws.send(i,o)}catch(e){l("websocket closed before onclose event")}--r||(n.emit("flush"),setTimeout((function(){n.writable=!0,n.emit("drain")}),0))}))}(e[i])},f.prototype.onClose=function(){o.prototype.onClose.call(this)},f.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},f.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=u()),this.supportsBinary||(e.b64=1),(e=s.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},f.prototype.check=function(){return!(!h||"__initialize"in h&&this.name===f.prototype.name)}}).call(this,n(102).Buffer)},function(e,t){},function(e,t){e.exports=function(e,t){for(var n=[],r=(t=t||0)||0;r<e.length;r++)n[r-t]=e[r];return n}},function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}},function(e,t,n){"use strict";var r=n(14),i=n(151),o=n(397),a=n(157);function s(e){var t=new o(e),n=i(o.prototype.request,t);return r.extend(n,o.prototype,t),r.extend(n,t),n}var c=s(n(154));c.Axios=o,c.create=function(e){return s(a(c.defaults,e))},c.Cancel=n(158),c.CancelToken=n(409),c.isCancel=n(153),c.all=function(e){return Promise.all(e)},c.spread=n(410),e.exports=c,e.exports.default=c},function(e,t){e.exports=function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}},function(e,t,n){"use strict";var r=n(14),i=n(152),o=n(398),a=n(399),s=n(157);function c(e){this.defaults=e,this.interceptors={request:new o,response:new o}}c.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=s(this.defaults,e)).method=e.method?e.method.toLowerCase():"get";var t=[a,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)n=n.then(t.shift(),t.shift());return n},c.prototype.getUri=function(e){return e=s(this.defaults,e),i(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){c.prototype[e]=function(t,n){return this.request(r.merge(n||{},{method:e,url:t}))}})),r.forEach(["post","put","patch"],(function(e){c.prototype[e]=function(t,n,i){return this.request(r.merge(i||{},{method:e,url:t,data:n}))}})),e.exports=c},function(e,t,n){"use strict";var r=n(14);function i(){this.handlers=[]}i.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},function(e,t,n){"use strict";var r=n(14),i=n(400),o=n(153),a=n(154),s=n(407),c=n(408);function u(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return u(e),e.baseURL&&!s(e.url)&&(e.url=c(e.baseURL,e.url)),e.headers=e.headers||{},e.data=i(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||a.adapter)(e).then((function(t){return u(e),t.data=i(t.data,t.headers,e.transformResponse),t}),(function(t){return o(t)||(u(e),t&&t.response&&(t.response.data=i(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},function(e,t,n){"use strict";var r=n(14);e.exports=function(e,t,n){return r.forEach(n,(function(n){e=n(e,t)})),e}},function(e,t,n){"use strict";var r=n(14);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},function(e,t,n){"use strict";var r=n(156);e.exports=function(e,t,n){var i=n.config.validateStatus;!i||i(n.status)?e(n):t(r("Request failed with status code "+n.status,n.config,null,n.request,n))}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,i){return e.config=t,n&&(e.code=n),e.request=r,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},function(e,t,n){"use strict";var r=n(14),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,o,a={};return e?(r.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=r.trim(e.substr(0,o)).toLowerCase(),n=r.trim(e.substr(o+1)),t){if(a[t]&&i.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([n]):a[t]?a[t]+", "+n:n}})),a):a}},function(e,t,n){"use strict";var r=n(14);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=i(window.location.href),function(t){var n=r.isString(t)?i(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},function(e,t,n){"use strict";var r=n(14);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,i,o,a){var s=[];s.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),r.isString(i)&&s.push("path="+i),r.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var r=n(158);function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,n){var r={"./iproov-en.json":412};function i(e){var t=o(e);return n(t)}function o(e){if(!n.o(r,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}i.keys=function(){return Object.keys(r)},i.resolve=o,e.exports=i,i.id=411},function(e){e.exports=JSON.parse('{"language_file":"en-GB","app_name":"iProov","error":"Error","prompt_hold_still":"Put your face in the oval","prompt_loading":"Please wait…","prompt_loading_slow":"Connecting, network is slow…","prompt_connecting":"Connecting…","prompt_connecting_slow":"Connecting, network is slow…","prompt_tap_to_begin":"Tap the screen to begin","prompt_too_far":"Move closer","prompt_too_bright":"Go somewhere shadier","progress_streaming":"Streaming…","progress_streaming_slow":"Streaming, network is slow…","progress_processing":"Processing…","iproov_success":"You have iProoved successfully","prompt_scanning":"Scanning…","unknown_error":"Unknown Error","starting_detector":"Starting detector…","error_ssl_exception":"SSL Exception","progress_identifying_face":"Identifying face…","progress_confirming_identity":"Confirming identity…","progress_assessing_genuine_presence":"Assessing genuine presence…","progress_loading":"Loading…","progress_creating_identity":"Creating identity…","progress_finding_face":"Finding face…","authenticate":"Authenticate","enrol":"Enrol","message_format":"%@ to %@","prompt_too_close":"Too close","failure_motion_too_much_movement":"Please do not move while iProoving","failure_lighting_flash_reflection_too_low":"Ambient light too strong or screen brightness too low","failure_lighting_backlit":"Strong light source detected behind you","failure_lighting_too_dark":"Your environment appears too dark","failure_lighting_face_too_bright":"Too much light detected on your face","failure_motion_too_much_mouth_movement":"Please do not talk while iProoving","message_format_with_username":"%@ as %@ to %@","prompt_roll_too_high":"Avoid tilting your head","prompt_roll_too_low":"Avoid tilting your head","prompt_yaw_too_low":"Turn slightly to your right","prompt_yaw_too_high":"Turn slightly to your left","prompt_pitch_too_high":"Hold the device at eye level","prompt_pitch_too_low":"Hold the device at eye level","error_streaming":"Streaming error","error_encoder":"Encoder error","error_camera":"Camera error","error_camera_in_use":"The camera is currently already in use and cannot be accessed","error_camera_permission_denied":"Camera permission denied","error_camera_permission_denied_message_ios":"Please allow camera access for this app in iOS Settings","error_server_abort":"Server abort","error_server":"Server error","error_lighting_model":"Lighting model error","error_encoder_unknown_message":"Unknown encoder error","error_encoder_code_message":"Error code %@","error_capture_already_active":"An existing capture is already in progress","prompt_get_ready":"Get ready…","prompt_too_right":"Move left","prompt_too_left":"Move right","prompt_too_high":"Move down","prompt_too_low":"Move up","prompt_beginning_in":"Starting in…","prompt_grant_permission":"Grant Camera Access","prompt_grant_permission_message":"Camera access must be granted to use iProov","passed":"Passed","failed":"Failed","failure_user_timeout":"Sorry, your session has timed out","failure_network_problem":"Sorry, network problem","failure_ambiguous_outcome":"Sorry, ambiguous outcome","error_sdk_internal":"An error has occurred","error_asset_fetch":"Unable to fetch assets","error_no_face_found":"No face could be found","error_client_stream":"Unable to contact graphics card","error_not_supported":"Unsupported","error_not_supported_message":"Your device is not supported","error_fullscreen_change":"Exited full-screen without completing iProov","error_exited_native_bridge":"Exited the app without completing iProov","error_no_camera":"No Camera Detected","error_no_camera_message":"A camera must be available to use iProov","error_camera_permission_denied_message":"Permission to access the camera has been denied. Please allow camera access to use iProov. If you have already allowed access, please reload the page.","error_user_timeout":"Your session has expired","error_camera_permission_denied_message_android":"You must allow access to your camera in order to iProov yourself","error_flashmark":"Malformed flashmark","error_multi_screen_title":"Application is in multi-window mode","error_multi_screen_message":"Application is in multi-window mode.\\\\nPlease make it full-screen and try again","error_device_not_supported":"Sorry, your device is currently not supported","error_camera_unavailable":"Unable to access the camera, access is only available through https or localhost","prompt_rotate_portrait":"Please rotate your device to portrait","error_service_connection_lost":"Connection to the Service has been lost"}')},function(e,t,n){"use strict";n.r(t),n.d(t,"IProovSupport",(function(){return $l})),n.d(t,"IProovMe",(function(){return Cf}));var r=n(159),i=n(160),o=n.n(i);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u="BaseInterface.stopProgress",l="BaseInterface.startProgress",h="BaseInterface.startStreaming",f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.setFont()}return function(e,t,n){t&&c(e.prototype,t)}(e,[{key:"init",value:function(e,t,n){this.interface=new e(this.base,this.colours,t,n)}},{key:"setColours",value:function(e,t){this.colours=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{},t)}},{key:"setFont",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/fonts/GothamRounded.css",t=this.base.createAssetURL(e);document.querySelector("head").insertAdjacentHTML("beforeend",'<link rel="stylesheet" href="'.concat(t,'" type="text/css">'))}}]),e}();const d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?Symbol:e=>`Symbol(${e})`;function p(){}const m=Number.isNaN||function(e){return e!=e},v=p;function g(e){return"object"==typeof e&&null!==e||"function"==typeof e}function y(e){return e.slice()}function b(e,t,n,r,i){new Uint8Array(e).set(new Uint8Array(n,r,i),t)}function _(e){return!1!==function(e){return!("number"!=typeof e||m(e)||e<0)}(e)&&e!==1/0}function w(e,t,n){if("function"!=typeof e)throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,t,n)}function x(e,t,n,r){const i=e[t];if(void 0!==i){if("function"!=typeof i)throw new TypeError(i+" is not a method");switch(n){case 0:return()=>E(i,e,r);case 1:return t=>{const n=[t].concat(r);return E(i,e,n)}}}return()=>k(void 0)}function S(e,t,n){const r=e[t];if(void 0!==r)return w(r,e,n)}function E(e,t,n){try{return k(w(e,t,n))}catch(e){return N(e)}}function M(e){if(e=Number(e),m(e)||e<0)throw new RangeError("highWaterMark property of a queuing strategy must be non-negative and non-NaN");return e}function C(e){if(void 0===e)return()=>1;if("function"!=typeof e)throw new TypeError("size property of a queuing strategy must be a function");return t=>e(t)}const T=Promise,A=Promise.prototype.then,P=Promise.resolve.bind(T),L=Promise.reject.bind(T);function R(e){return new T(e)}function k(e){return P(e)}function N(e){return L(e)}function O(e,t,n){return A.call(e,t,n)}function D(e,t,n){O(O(e,t,n),void 0,v)}function F(e,t){D(e,t)}function I(e,t){D(e,void 0,t)}function U(e,t,n){return O(e,t,n)}function B(e){O(e,void 0,v)}class j{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(e){const t=this._back;let n=t;16383===t._elements.length&&(n={_elements:[],_next:void 0}),t._elements.push(e),n!==t&&(this._back=n,t._next=n),++this._size}shift(){const e=this._front;let t=e;const n=this._cursor;let r=n+1;const i=e._elements,o=i[n];return 16384===r&&(t=e._next,r=0),--this._size,this._cursor=r,e!==t&&(this._front=t),i[n]=void 0,o}forEach(e){let t=this._cursor,n=this._front,r=n._elements;for(;!(t===r.length&&void 0===n._next||t===r.length&&(t=0,0===(r=(n=n._next)._elements).length));)e(r[t]),++t}peek(){const e=this._front,t=this._cursor;return e._elements[t]}}function z(e,t,n){let r=null;!0===n&&(r=Object.prototype);const i=Object.create(r);return i.value=e,i.done=t,i}function V(e,t){e._forAuthorCode=!0,e._ownerReadableStream=t,t._reader=e,"readable"===t._state?H(e):"closed"===t._state?function(e){H(e),Z(e)}(e):X(e,t._storedError)}function G(e,t){return qt(e._ownerReadableStream,t)}function q(e){"readable"===e._ownerReadableStream._state?Y(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):function(e,t){X(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness"))}(e),e._ownerReadableStream._reader=void 0,e._ownerReadableStream=void 0}function W(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function H(e){e._closedPromise=R((t,n)=>{e._closedPromise_resolve=t,e._closedPromise_reject=n})}function X(e,t){H(e),Y(e,t)}function Y(e,t){B(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0}function Z(e){e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0}const J=d("[[CancelSteps]]"),K=d("[[PullSteps]]");function $(e,t=!1){const n=new re(e);return n._forAuthorCode=t,n}function Q(e){return R((t,n)=>{const r={_resolve:t,_reject:n};e._reader._readRequests.push(r)})}function ee(e,t,n){const r=e._reader;r._readRequests.shift()._resolve(z(t,n,r._forAuthorCode))}function te(e){return e._reader._readRequests.length}function ne(e){const t=e._reader;return void 0!==t&&!!ie(t)}class re{constructor(e){if(!1===Wt(e))throw new TypeError("ReadableStreamDefaultReader can only be constructed with a ReadableStream instance");if(!0===Ht(e))throw new TypeError("This stream has already been locked for exclusive reading by another reader");V(this,e),this._readRequests=new j}get closed(){return ie(this)?this._closedPromise:N(ae("closed"))}cancel(e){return ie(this)?void 0===this._ownerReadableStream?N(W("cancel")):G(this,e):N(ae("cancel"))}read(){return ie(this)?void 0===this._ownerReadableStream?N(W("read from")):oe(this):N(ae("read"))}releaseLock(){if(!ie(this))throw ae("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");q(this)}}}function ie(e){return!!g(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readRequests")}function oe(e){const t=e._ownerReadableStream;return t._disturbed=!0,"closed"===t._state?k(z(void 0,!0,e._forAuthorCode)):"errored"===t._state?N(t._storedError):t._readableStreamController[K]()}function ae(e){return new TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}let se;"symbol"==typeof d.asyncIterator&&(se={[d.asyncIterator](){return this}},Object.defineProperty(se,d.asyncIterator,{enumerable:!1}));const ce={next(){if(!1===ue(this))return N(le("next"));const e=this._asyncIteratorReader;return void 0===e._ownerReadableStream?N(W("iterate")):U(oe(e),t=>{const n=t.done;return n&&q(e),z(t.value,n,!0)})},return(e){if(!1===ue(this))return N(le("next"));const t=this._asyncIteratorReader;if(void 0===t._ownerReadableStream)return N(W("finish iterating"));if(t._readRequests.length>0)return N(new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled"));if(!1===this._preventCancel){const n=G(t,e);return q(t),U(n,()=>z(e,!0,!0))}return q(t),k(z(e,!0,!0))}};function ue(e){return!!g(e)&&!!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorReader")}function le(e){return new TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}function he(e){const t=e._queue.shift();return e._queueTotalSize-=t.size,e._queueTotalSize<0&&(e._queueTotalSize=0),t.value}function fe(e,t,n){if(!_(n=Number(n)))throw new RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:t,size:n}),e._queueTotalSize+=n}function de(e){e._queue=new j,e._queueTotalSize=0}void 0!==se&&Object.setPrototypeOf(ce,se),Object.defineProperty(ce,"next",{enumerable:!1}),Object.defineProperty(ce,"return",{enumerable:!1});const pe=d("[[AbortSteps]]"),me=d("[[ErrorSteps]]");class ve{constructor(e={},t={}){!function(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new j,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}(this);const n=t.size;let r=t.highWaterMark;if(void 0!==e.type)throw new RangeError("Invalid type is specified");const i=C(n);void 0===r&&(r=1),function(e,t,n,r){const i=Object.create(Oe.prototype),o=x(t,"write",1,[i]),a=x(t,"close",0,[]),s=x(t,"abort",1,[]);!function(e,t,n,r,i,o,a,s){t._controlledWritableStream=e,e._writableStreamController=t,t._queue=void 0,t._queueTotalSize=void 0,de(t),t._started=!1,t._strategySizeAlgorithm=s,t._strategyHWM=a,t._writeAlgorithm=r,t._closeAlgorithm=i,t._abortAlgorithm=o;const c=Be(t);Te(e,c),D(k(n()),()=>{t._started=!0,Ie(t)},n=>{t._started=!0,xe(e,n)})}(e,i,(function(){return S(t,"start",[i])}),o,a,s,n,r)}(this,e,r=M(r),i)}get locked(){if(!1===ye(this))throw ze("locked");return be(this)}abort(e){return!1===ye(this)?N(ze("abort")):!0===be(this)?N(new TypeError("Cannot abort a stream that already has a writer")):_e(this,e)}close(){return!1===ye(this)?N(ze("close")):!0===be(this)?N(new TypeError("Cannot close a stream that already has a writer")):!0===Me(this)?N(new TypeError("Cannot close an already-closing stream")):we(this)}getWriter(){if(!1===ye(this))throw ze("getWriter");return ge(this)}}function ge(e){return new Ae(e)}function ye(e){return!!g(e)&&!!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")}function be(e){return void 0!==e._writer}function _e(e,t){const n=e._state;if("closed"===n||"errored"===n)return k(void 0);if(void 0!==e._pendingAbortRequest)return e._pendingAbortRequest._promise;let r=!1;"erroring"===n&&(r=!0,t=void 0);const i=R((n,i)=>{e._pendingAbortRequest={_promise:void 0,_resolve:n,_reject:i,_reason:t,_wasAlreadyErroring:r}});return e._pendingAbortRequest._promise=i,!1===r&&Se(e,t),i}function we(e){const t=e._state;if("closed"===t||"errored"===t)return N(new TypeError(`The stream (in ${t} state) is not in the writable state and cannot be closed`));const n=R((t,n)=>{const r={_resolve:t,_reject:n};e._closeRequest=r}),r=e._writer;return void 0!==r&&!0===e._backpressure&&"writable"===t&&rt(r),function(e){fe(e,"close",0),Ie(e)}(e._writableStreamController),n}function xe(e,t){"writable"!==e._state?Ee(e):Se(e,t)}function Se(e,t){const n=e._writableStreamController;e._state="erroring",e._storedError=t;const r=e._writer;void 0!==r&&Re(r,t),!1===function(e){return void 0!==e._inFlightWriteRequest||void 0!==e._inFlightCloseRequest}(e)&&!0===n._started&&Ee(e)}function Ee(e){e._state="errored",e._writableStreamController[me]();const t=e._storedError;if(e._writeRequests.forEach(e=>{e._reject(t)}),e._writeRequests=new j,void 0===e._pendingAbortRequest)return void Ce(e);const n=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,!0===n._wasAlreadyErroring)return n._reject(t),void Ce(e);D(e._writableStreamController[pe](n._reason),()=>{n._resolve(),Ce(e)},t=>{n._reject(t),Ce(e)})}function Me(e){return void 0!==e._closeRequest||void 0!==e._inFlightCloseRequest}function Ce(e){void 0!==e._closeRequest&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);const t=e._writer;void 0!==t&&qe(t,e._storedError)}function Te(e,t){const n=e._writer;void 0!==n&&t!==e._backpressure&&(!0===t?function(e){Ye(e)}(n):rt(n)),e._backpressure=t}class Ae{constructor(e){if(!1===ye(e))throw new TypeError("WritableStreamDefaultWriter can only be constructed with a WritableStream instance");if(!0===be(e))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=e,e._writer=this;const t=e._state;if("writable"===t)!1===Me(e)&&!0===e._backpressure?Ye(this):Je(this),We(this);else if("erroring"===t)Ze(this,e._storedError),We(this);else if("closed"===t)Je(this),function(e){We(e),Xe(e)}(this);else{const t=e._storedError;Ze(this,t),He(this,t)}}get closed(){return!1===Pe(this)?N(Ve("closed")):this._closedPromise}get desiredSize(){if(!1===Pe(this))throw Ve("desiredSize");if(void 0===this._ownerWritableStream)throw Ge("desiredSize");return function(e){const t=e._ownerWritableStream,n=t._state;return"errored"===n||"erroring"===n?null:"closed"===n?0:Fe(t._writableStreamController)}(this)}get ready(){return!1===Pe(this)?N(Ve("ready")):this._readyPromise}abort(e){return!1===Pe(this)?N(Ve("abort")):void 0===this._ownerWritableStream?N(Ge("abort")):function(e,t){return _e(e._ownerWritableStream,t)}(this,e)}close(){if(!1===Pe(this))return N(Ve("close"));const e=this._ownerWritableStream;return void 0===e?N(Ge("close")):!0===Me(e)?N(new TypeError("Cannot close an already-closing stream")):Le(this)}releaseLock(){if(!1===Pe(this))throw Ve("releaseLock");void 0!==this._ownerWritableStream&&ke(this)}write(e){return!1===Pe(this)?N(Ve("write")):void 0===this._ownerWritableStream?N(Ge("write to")):Ne(this,e)}}function Pe(e){return!!g(e)&&!!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")}function Le(e){return we(e._ownerWritableStream)}function Re(e,t){"pending"===e._readyPromiseState?Ke(e,t):function(e,t){Ze(e,t)}(e,t)}function ke(e){const t=e._ownerWritableStream,n=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");Re(e,n),function(e,t){"pending"===e._closedPromiseState?qe(e,t):function(e,t){He(e,t)}(e,t)}(e,n),t._writer=void 0,e._ownerWritableStream=void 0}function Ne(e,t){const n=e._ownerWritableStream,r=n._writableStreamController,i=function(e,t){try{return e._strategySizeAlgorithm(t)}catch(t){return Ue(e,t),1}}(r,t);if(n!==e._ownerWritableStream)return N(Ge("write to"));const o=n._state;if("errored"===o)return N(n._storedError);if(!0===Me(n)||"closed"===o)return N(new TypeError("The stream is closing or closed and cannot be written to"));if("erroring"===o)return N(n._storedError);const a=function(e){return R((t,n)=>{const r={_resolve:t,_reject:n};e._writeRequests.push(r)})}(n);return function(e,t,n){const r={chunk:t};try{fe(e,r,n)}catch(t){return void Ue(e,t)}const i=e._controlledWritableStream;!1===Me(i)&&"writable"===i._state&&Te(i,Be(e)),Ie(e)}(r,t,i),a}class Oe{constructor(){throw new TypeError("WritableStreamDefaultController cannot be constructed explicitly")}error(e){if(!1===function(e){return!!g(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")}(this))throw new TypeError("WritableStreamDefaultController.prototype.error can only be used on a WritableStreamDefaultController");"writable"===this._controlledWritableStream._state&&je(this,e)}[pe](e){const t=this._abortAlgorithm(e);return De(this),t}[me](){de(this)}}function De(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Fe(e){return e._strategyHWM-e._queueTotalSize}function Ie(e){const t=e._controlledWritableStream;if(!1===e._started)return;if(void 0!==t._inFlightWriteRequest)return;if("erroring"===t._state)return void Ee(t);if(0===e._queue.length)return;const n=function(e){return e._queue.peek().value}(e);"close"===n?function(e){const t=e._controlledWritableStream;(function(e){e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0})(t),he(e);const n=e._closeAlgorithm();De(e),D(n,()=>{!function(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,"erroring"===e._state&&(e._storedError=void 0,void 0!==e._pendingAbortRequest&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";const t=e._writer;void 0!==t&&Xe(t)}(t)},e=>{!function(e,t){e._inFlightCloseRequest._reject(t),e._inFlightCloseRequest=void 0,void 0!==e._pendingAbortRequest&&(e._pendingAbortRequest._reject(t),e._pendingAbortRequest=void 0),xe(e,t)}(t,e)})}(e):function(e,t){const n=e._controlledWritableStream;(function(e){e._inFlightWriteRequest=e._writeRequests.shift()})(n),D(e._writeAlgorithm(t),()=>{!function(e){e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}(n);const t=n._state;if(he(e),!1===Me(n)&&"writable"===t){const t=Be(e);Te(n,t)}Ie(e)},t=>{"writable"===n._state&&De(e),function(e,t){e._inFlightWriteRequest._reject(t),e._inFlightWriteRequest=void 0,xe(e,t)}(n,t)})}(e,n.chunk)}function Ue(e,t){"writable"===e._controlledWritableStream._state&&je(e,t)}function Be(e){return Fe(e)<=0}function je(e,t){const n=e._controlledWritableStream;De(e),Se(n,t)}function ze(e){return new TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function Ve(e){return new TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function Ge(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function We(e){e._closedPromise=R((t,n)=>{e._closedPromise_resolve=t,e._closedPromise_reject=n,e._closedPromiseState="pending"})}function He(e,t){We(e),qe(e,t)}function qe(e,t){B(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected"}function Xe(e){e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved"}function Ye(e){e._readyPromise=R((t,n)=>{e._readyPromise_resolve=t,e._readyPromise_reject=n}),e._readyPromiseState="pending"}function Ze(e,t){Ye(e),Ke(e,t)}function Je(e){Ye(e),rt(e)}function Ke(e,t){B(e._readyPromise),e._readyPromise_reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected"}function rt(e){e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled"}function $e(e){if("object"!=typeof e||null===e)return!1;try{return"boolean"==typeof e.aborted}catch(e){return!1}}const Qe="undefined"!=typeof DOMException?DOMException:void 0,et=function(e){if("function"!=typeof e&&"object"!=typeof e)return!1;try{return new e,!0}catch(e){return!1}}(Qe)?Qe:function(){const e=function(e,t){this.message=e||"",this.name=t||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}();function tt(e,t,n,r,i,o){const a=$(e),s=ge(t);e._disturbed=!0;let c=!1,u=k(void 0);return R((l,h)=>{let f;if(void 0!==o){if(f=()=>{const n=new et("Aborted","AbortError"),o=[];!1===r&&o.push(()=>"writable"===t._state?_e(t,n):k(void 0)),!1===i&&o.push(()=>"readable"===e._state?qt(e,n):k(void 0)),v(()=>Promise.all(o.map(e=>e())),!0,n)},!0===o.aborted)return void f();o.addEventListener("abort",f)}if(m(e,a._closedPromise,e=>{!1===r?v(()=>_e(t,e),!0,e):g(!0,e)}),m(t,s._closedPromise,t=>{!1===i?v(()=>qt(e,t),!0,t):g(!0,t)}),function(e,t,n){"closed"===e._state?n():F(t,n)}(e,a._closedPromise,()=>{!1===n?v(()=>function(e){const t=e._ownerWritableStream,n=t._state;return!0===Me(t)||"closed"===n?k(void 0):"errored"===n?N(t._storedError):Le(e)}(s)):g()}),!0===Me(t)||"closed"===t._state){const t=new TypeError("the destination writable stream closed before all data could be piped to it");!1===i?v(()=>qt(e,t),!0,t):g(!0,t)}function d(){const e=u;return O(u,()=>e!==u?d():void 0)}function m(e,t,n){"errored"===e._state?n(e._storedError):I(t,n)}function v(e,n,r){function i(){D(e(),()=>y(n,r),e=>y(!0,e))}!0!==c&&(c=!0,"writable"===t._state&&!1===Me(t)?F(d(),i):i())}function g(e,n){!0!==c&&(c=!0,"writable"===t._state&&!1===Me(t)?F(d(),()=>y(e,n)):y(e,n))}function y(e,t){ke(s),q(a),void 0!==o&&o.removeEventListener("abort",f),e?h(t):l(void 0)}B(R((e,t)=>{!function n(r){r?e():O(!0===c?k(!0):O(s._readyPromise,()=>O(oe(a),e=>!0===e.done||(u=O(Ne(s,e.value),void 0,p),!1))),n,t)}(!1)}))})}class nt{constructor(){throw new TypeError}get desiredSize(){if(!1===it(this))throw ft("desiredSize");return ut(this)}close(){if(!1===it(this))throw ft("close");if(!1===lt(this))throw new TypeError("The stream is not in a state that permits close");dt(this)}enqueue(e){if(!1===it(this))throw ft("enqueue");if(!1===lt(this))throw new TypeError("The stream is not in a state that permits enqueue");return st(this,e)}error(e){if(!1===it(this))throw ft("error");ct(this,e)}[J](e){de(this);const t=this._cancelAlgorithm(e);return at(this),t}[K](){const e=this._controlledReadableStream;if(this._queue.length>0){const t=he(this);return!0===this._closeRequested&&0===this._queue.length?(at(this),Xt(e)):ot(this),k(z(t,!1,e._reader._forAuthorCode))}const t=Q(e);return ot(this),t}}function it(e){return!!g(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")}function ot(e){!1!==function(e){const t=e._controlledReadableStream;return!1!==lt(e)&&!1!==e._started&&(!0===Ht(t)&&te(t)>0||ut(e)>0)}(e)&&(!0!==e._pulling?(e._pulling=!0,D(e._pullAlgorithm(),()=>{e._pulling=!1,!0===e._pullAgain&&(e._pullAgain=!1,ot(e))},t=>{ct(e,t)})):e._pullAgain=!0)}function at(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function dt(e){const t=e._controlledReadableStream;e._closeRequested=!0,0===e._queue.length&&(at(e),Xt(t))}function st(e,t){const n=e._controlledReadableStream;if(!0===Ht(n)&&te(n)>0)ee(n,t,!1);else{let n;try{n=e._strategySizeAlgorithm(t)}catch(t){throw ct(e,t),t}try{fe(e,t,n)}catch(t){throw ct(e,t),t}}ot(e)}function ct(e,t){const n=e._controlledReadableStream;"readable"===n._state&&(de(e),at(e),Yt(n,t))}function ut(e){const t=e._controlledReadableStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}function lt(e){const t=e._controlledReadableStream._state;return!1===e._closeRequested&&"readable"===t}function ht(e,t,n,r,i,o,a){t._controlledReadableStream=e,t._queue=void 0,t._queueTotalSize=void 0,de(t),t._started=!1,t._closeRequested=!1,t._pullAgain=!1,t._pulling=!1,t._strategySizeAlgorithm=a,t._strategyHWM=o,t._pullAlgorithm=r,t._cancelAlgorithm=i,e._readableStreamController=t,D(k(n()),()=>{t._started=!0,ot(t)},e=>{ct(t,e)})}function ft(e){return new TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}const pt=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};class mt{constructor(){throw new TypeError("ReadableStreamBYOBRequest cannot be used directly")}get view(){if(!1===yt(this))throw Nt("view");return this._view}respond(e){if(!1===yt(this))throw Nt("respond");if(void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");this._view.buffer,function(e,t){if(!1===_(t=Number(t)))throw new RangeError("bytesWritten must be a finite");At(e,t)}(this._associatedReadableByteStreamController,e)}respondWithNewView(e){if(!1===yt(this))throw Nt("respond");if(void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");if(!ArrayBuffer.isView(e))throw new TypeError("You can only respond with array buffer views");e.buffer,function(e,t){const n=e._pendingPullIntos.peek();if(n.byteOffset+n.bytesFilled!==t.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(n.byteLength!==t.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");n.buffer=t.buffer,At(e,t.byteLength)}(this._associatedReadableByteStreamController,e)}}class vt{constructor(){throw new TypeError("ReadableByteStreamController constructor cannot be used directly")}get byobRequest(){if(!1===gt(this))throw Ot("byobRequest");if(void 0===this._byobRequest&&this._pendingPullIntos.length>0){const e=this._pendingPullIntos.peek(),t=new Uint8Array(e.buffer,e.byteOffset+e.bytesFilled,e.byteLength-e.bytesFilled),n=Object.create(mt.prototype);!function(e,t,n){e._associatedReadableByteStreamController=t,e._view=n}(n,this,t),this._byobRequest=n}return this._byobRequest}get desiredSize(){if(!1===gt(this))throw Ot("desiredSize");return kt(this)}close(){if(!1===gt(this))throw Ot("close");if(!0===this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");const e=this._controlledReadableByteStream._state;if("readable"!==e)throw new TypeError(`The stream (in ${e} state) is not in the readable state and cannot be closed`);!function(e){const t=e._controlledReadableByteStream;if(e._queueTotalSize>0)e._closeRequested=!0;else{if(e._pendingPullIntos.length>0&&e._pendingPullIntos.peek().bytesFilled>0){const t=new TypeError("Insufficient bytes to fill elements in the given buffer");throw Rt(e,t),t}Lt(e),Xt(t)}}(this)}enqueue(e){if(!1===gt(this))throw Ot("enqueue");if(!0===this._closeRequested)throw new TypeError("stream is closed or draining");const t=this._controlledReadableByteStream._state;if("readable"!==t)throw new TypeError(`The stream (in ${t} state) is not in the readable state and cannot be enqueued to`);if(!ArrayBuffer.isView(e))throw new TypeError("You can only enqueue array buffer views when using a ReadableByteStreamController");e.buffer,function(e,t){const n=e._controlledReadableByteStream,r=t.buffer,i=t.byteOffset,o=t.byteLength,a=r;!0===ne(n)?0===te(n)?xt(e,a,i,o):ee(n,new Uint8Array(a,i,o),!1):!0===It(n)?(xt(e,a,i,o),Tt(e)):xt(e,a,i,o),bt(e)}(this,e)}error(e){if(!1===gt(this))throw Ot("error");Rt(this,e)}[J](e){this._pendingPullIntos.length>0&&(this._pendingPullIntos.peek().bytesFilled=0),de(this);const t=this._cancelAlgorithm(e);return Lt(this),t}[K](){const e=this._controlledReadableByteStream;if(this._queueTotalSize>0){const t=this._queue.shift();let n;this._queueTotalSize-=t.byteLength,Mt(this);try{n=new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}catch(e){return N(e)}return k(z(n,!1,e._reader._forAuthorCode))}const t=this._autoAllocateChunkSize;if(void 0!==t){let n;try{n=new ArrayBuffer(t)}catch(e){return N(e)}const r={buffer:n,byteOffset:0,byteLength:t,bytesFilled:0,elementSize:1,ctor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(r)}const n=Q(e);return bt(this),n}}function gt(e){return!!g(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")}function yt(e){return!!g(e)&&!!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")}function bt(e){!1!==function(e){const t=e._controlledReadableByteStream;return"readable"===t._state&&!0!==e._closeRequested&&!1!==e._started&&(!0===ne(t)&&te(t)>0||!0===It(t)&&Ft(t)>0||kt(e)>0)}(e)&&(!0!==e._pulling?(e._pulling=!0,D(e._pullAlgorithm(),()=>{e._pulling=!1,!0===e._pullAgain&&(e._pullAgain=!1,bt(e))},t=>{Rt(e,t)})):e._pullAgain=!0)}function _t(e,t){let n=!1;"closed"===e._state&&(n=!0);const r=wt(t);"default"===t.readerType?ee(e,r,n):function(e,t,n){const r=e._reader;r._readIntoRequests.shift()._resolve(z(t,n,r._forAuthorCode))}(e,r,n)}function wt(e){const t=e.bytesFilled,n=e.elementSize;return new e.ctor(e.buffer,e.byteOffset,t/n)}function xt(e,t,n,r){e._queue.push({buffer:t,byteOffset:n,byteLength:r}),e._queueTotalSize+=r}function St(e,t){const n=t.elementSize,r=t.bytesFilled-t.bytesFilled%n,i=Math.min(e._queueTotalSize,t.byteLength-t.bytesFilled),o=t.bytesFilled+i,a=o-o%n;let s=i,c=!1;a>r&&(s=a-t.bytesFilled,c=!0);const u=e._queue;for(;s>0;){const n=u.peek(),r=Math.min(s,n.byteLength),i=t.byteOffset+t.bytesFilled;b(t.buffer,i,n.buffer,n.byteOffset,r),n.byteLength===r?u.shift():(n.byteOffset+=r,n.byteLength-=r),e._queueTotalSize-=r,Et(e,r,t),s-=r}return c}function Et(e,t,n){Ct(e),n.bytesFilled+=t}function Mt(e){0===e._queueTotalSize&&!0===e._closeRequested?(Lt(e),Xt(e._controlledReadableByteStream)):bt(e)}function Ct(e){void 0!==e._byobRequest&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=void 0,e._byobRequest=void 0)}function Tt(e){for(;e._pendingPullIntos.length>0;){if(0===e._queueTotalSize)return;const t=e._pendingPullIntos.peek();!0===St(e,t)&&(Pt(e),_t(e._controlledReadableByteStream,t))}}function At(e,t){const n=e._pendingPullIntos.peek();if("closed"===e._controlledReadableByteStream._state){if(0!==t)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream");!function(e,t){t.buffer=t.buffer;const n=e._controlledReadableByteStream;if(!0===It(n))for(;Ft(n)>0;)_t(n,Pt(e))}(e,n)}else!function(e,t,n){if(n.bytesFilled+t>n.byteLength)throw new RangeError("bytesWritten out of range");if(Et(e,t,n),n.bytesFilled<n.elementSize)return;Pt(e);const r=n.bytesFilled%n.elementSize;if(r>0){const t=n.byteOffset+n.bytesFilled,i=n.buffer.slice(t-r,t);xt(e,i,0,i.byteLength)}n.buffer=n.buffer,n.bytesFilled-=r,_t(e._controlledReadableByteStream,n),Tt(e)}(e,t,n);bt(e)}function Pt(e){const t=e._pendingPullIntos.shift();return Ct(e),t}function Lt(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function Rt(e,t){const n=e._controlledReadableByteStream;"readable"===n._state&&(function(e){Ct(e),e._pendingPullIntos=new j}(e),de(e),Lt(e),Yt(n,t))}function kt(e){const t=e._controlledReadableByteStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}function Nt(e){return new TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function Ot(e){return new TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function Dt(e){return R((t,n)=>{const r={_resolve:t,_reject:n};e._reader._readIntoRequests.push(r)})}function Ft(e){return e._reader._readIntoRequests.length}function It(e){const t=e._reader;return void 0!==t&&!!Bt(t)}class Ut{constructor(e){if(!Wt(e))throw new TypeError("ReadableStreamBYOBReader can only be constructed with a ReadableStream instance given a byte source");if(!1===gt(e._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");if(Ht(e))throw new TypeError("This stream has already been locked for exclusive reading by another reader");V(this,e),this._readIntoRequests=new j}get closed(){return Bt(this)?this._closedPromise:N(jt("closed"))}cancel(e){return Bt(this)?void 0===this._ownerReadableStream?N(W("cancel")):G(this,e):N(jt("cancel"))}read(e){return Bt(this)?void 0===this._ownerReadableStream?N(W("read from")):ArrayBuffer.isView(e)?(e.buffer,0===e.byteLength?N(new TypeError("view must have non-zero byteLength")):function(e,t){const n=e._ownerReadableStream;return n._disturbed=!0,"errored"===n._state?N(n._storedError):function(e,t){const n=e._controlledReadableByteStream;let r=1;t.constructor!==DataView&&(r=t.constructor.BYTES_PER_ELEMENT);const i=t.constructor,o={buffer:t.buffer,byteOffset:t.byteOffset,byteLength:t.byteLength,bytesFilled:0,elementSize:r,ctor:i,readerType:"byob"};if(e._pendingPullIntos.length>0)return e._pendingPullIntos.push(o),Dt(n);if("closed"===n._state)return k(z(new i(o.buffer,o.byteOffset,0),!0,n._reader._forAuthorCode));if(e._queueTotalSize>0){if(!0===St(e,o)){const t=wt(o);return Mt(e),k(z(t,!1,n._reader._forAuthorCode))}if(!0===e._closeRequested){const t=new TypeError("Insufficient bytes to fill elements in the given buffer");return Rt(e,t),N(t)}}e._pendingPullIntos.push(o);const a=Dt(n);return bt(e),a}(n._readableStreamController,t)}(this,e)):N(new TypeError("view must be an array buffer view")):N(jt("read"))}releaseLock(){if(!Bt(this))throw jt("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");q(this)}}}function Bt(e){return!!g(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")}function jt(e){return new TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}class zt{constructor(e={},t={}){Gt(this);const n=t.size;let r=t.highWaterMark;const i=e.type;if("bytes"===String(i)){if(void 0!==n)throw new RangeError("The strategy for a byte stream cannot have a size function");void 0===r&&(r=0),function(e,t,n){const r=Object.create(vt.prototype),i=x(t,"pull",0,[r]),o=x(t,"cancel",1,[]);let a=t.autoAllocateChunkSize;if(void 0!==a&&(a=Number(a),!1===pt(a)||a<=0))throw new RangeError("autoAllocateChunkSize must be a positive integer");!function(e,t,n,r,i,o,a){t._controlledReadableByteStream=e,t._pullAgain=!1,t._pulling=!1,t._byobRequest=void 0,t._queue=t._queueTotalSize=void 0,de(t),t._closeRequested=!1,t._started=!1,t._strategyHWM=M(o),t._pullAlgorithm=r,t._cancelAlgorithm=i,t._autoAllocateChunkSize=a,t._pendingPullIntos=new j,e._readableStreamController=t,D(k(n()),()=>{t._started=!0,bt(t)},e=>{Rt(t,e)})}(e,r,(function(){return S(t,"start",[r])}),i,o,n,a)}(this,e,r=M(r))}else{if(void 0!==i)throw new RangeError("Invalid type is specified");{const t=C(n);void 0===r&&(r=1),function(e,t,n,r){const i=Object.create(nt.prototype),o=x(t,"pull",0,[i]),a=x(t,"cancel",1,[]);ht(e,i,(function(){return S(t,"start",[i])}),o,a,n,r)}(this,e,r=M(r),t)}}}get locked(){if(!1===Wt(this))throw Zt("locked");return Ht(this)}cancel(e){return!1===Wt(this)?N(Zt("cancel")):!0===Ht(this)?N(new TypeError("Cannot cancel a stream that already has a reader")):qt(this,e)}getReader({mode:e}={}){if(!1===Wt(this))throw Zt("getReader");if(void 0===e)return $(this,!0);if("byob"===(e=String(e)))return function(e,t=!1){const n=new Ut(e);return n._forAuthorCode=t,n}(this,!0);throw new RangeError("Invalid mode is specified")}pipeThrough({writable:e,readable:t},{preventClose:n,preventAbort:r,preventCancel:i,signal:o}={}){if(!1===Wt(this))throw Zt("pipeThrough");if(!1===ye(e))throw new TypeError("writable argument to pipeThrough must be a WritableStream");if(!1===Wt(t))throw new TypeError("readable argument to pipeThrough must be a ReadableStream");if(n=Boolean(n),r=Boolean(r),i=Boolean(i),void 0!==o&&!$e(o))throw new TypeError("ReadableStream.prototype.pipeThrough's signal option must be an AbortSignal");if(!0===Ht(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(!0===be(e))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");return B(tt(this,e,n,r,i,o)),t}pipeTo(e,{preventClose:t,preventAbort:n,preventCancel:r,signal:i}={}){return!1===Wt(this)?N(Zt("pipeTo")):!1===ye(e)?N(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream")):(t=Boolean(t),n=Boolean(n),r=Boolean(r),void 0===i||$e(i)?!0===Ht(this)?N(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):!0===be(e)?N(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):tt(this,e,t,n,r,i):N(new TypeError("ReadableStream.prototype.pipeTo's signal option must be an AbortSignal")))}tee(){if(!1===Wt(this))throw Zt("tee");return y(function(e,t){const n=$(e);let r,i,o,a,s,c=!1,u=!1,l=!1;const h=R(e=>{s=e});function f(){return!0===c||(c=!0,B(U(oe(n),e=>{if(c=!1,!0===e.done)return!1===u&&dt(o._readableStreamController),void(!1===l&&dt(a._readableStreamController));const t=e.value,n=t,r=t;!1===u&&st(o._readableStreamController,n),!1===l&&st(a._readableStreamController,r)}))),k(void 0)}function d(){}return o=Vt(d,f,(function(t){if(u=!0,r=t,!0===l){const t=y([r,i]),n=qt(e,t);s(n)}return h})),a=Vt(d,f,(function(t){if(l=!0,i=t,!0===u){const t=y([r,i]),n=qt(e,t);s(n)}return h})),I(n._closedPromise,e=>{ct(o._readableStreamController,e),ct(a._readableStreamController,e)}),[o,a]}(this))}getIterator({preventCancel:e=!1}={}){if(!1===Wt(this))throw Zt("getIterator");return function(e,t=!1){const n=$(e),r=Object.create(ce);return r._asyncIteratorReader=n,r._preventCancel=Boolean(t),r}(this,e)}}function Vt(e,t,n,r=1,i=(()=>1)){const o=Object.create(zt.prototype);return Gt(o),ht(o,Object.create(nt.prototype),e,t,n,r,i),o}function Gt(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function Wt(e){return!!g(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")}function Ht(e){return void 0!==e._reader}function qt(e,t){return e._disturbed=!0,"closed"===e._state?k(void 0):"errored"===e._state?N(e._storedError):(Xt(e),U(e._readableStreamController[J](t),p))}function Xt(e){e._state="closed";const t=e._reader;void 0!==t&&(ie(t)&&(t._readRequests.forEach(e=>{e._resolve(z(void 0,!0,t._forAuthorCode))}),t._readRequests=new j),Z(t))}function Yt(e,t){e._state="errored",e._storedError=t;const n=e._reader;void 0!==n&&(ie(n)?(n._readRequests.forEach(e=>{e._reject(t)}),n._readRequests=new j):(n._readIntoRequests.forEach(e=>{e._reject(t)}),n._readIntoRequests=new j),Y(n,t))}function Zt(e){return new TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}function Jt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}"symbol"==typeof d.asyncIterator&&Object.defineProperty(zt.prototype,d.asyncIterator,{value:zt.prototype.getIterator,enumerable:!1,writable:!0,configurable:!0});var Kt="Face.faceFeedback",$t="Face.drawFace",Qt="Face.noChange",en="Face.ready",tn={},nn=Object.freeze({kiosk:{moveRight:.05,moveDown:.07,moveLeft:.05,moveUp:.07,moveCloser:.5,moveBack:2},desktop:{moveRight:.25,moveDown:.12,moveLeft:.25,moveUp:.12,moveCloser:.5,moveBack:2},mobile_ios:{moveRight:-.1,moveDown:-.1,moveLeft:-.1,moveUp:-.1,moveCloser:.775,moveBack:1.25},mobile_generic:{moveRight:-.1,moveDown:-.1,moveLeft:-.1,moveUp:-.1,moveCloser:.7,moveBack:1.15},limited:{moveRight:-.1,moveDown:-.1,moveLeft:-.1,moveUp:-.1,moveCloser:.7,moveBack:1.1}}),rn=function(){function e(t,n){var r=n.isKioskMode,i=void 0!==r&&r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.socketConnected=!1,this.noFaceTimer=null,this.isKioskMode=i,this.shouldTimeout=!0,this.setStates(),this.build(),this.listen(),this.setPositionConfig(),this.setNoFaceTimeout(),this.loadPositionConfig()}return function(e,t,n){t&&Jt(e.prototype,t)}(e,[{key:"listen",value:function(){var e=this;this.base.listenEvent(bl.clientStarted,(function(t){return e.start(t)})),this.base.listenEvent(Cn.imageProcessed,(function(t){var n=e.times.length+1;e.times.push(performance.now());var r=e.times.slice(1).map((function(t,n){return t-e.times[n]})).reduce((function(e,t){return e+t}),0)/n;6===n&&(e.smooth=Math.max(1,Math.floor(1e3/Math.max(1e3/6,r+Tn))),e.times=[]),e.resetNoFaceFoundTimer(t),e.feedback(t)}),!1),this.base.listenEvent([kr.landscape,kr.enterFullScreen,kr.exitFullScreen],(function(){e.build()})),this.base.listenEvent(Bu.streaming,(function(){return e.build()})),this.base.listenEvent(kr.landscape,(function(){return e.paused=!0})),this.base.listenEvent(kr.portrait,(function(){return e.paused=!1}))}},{key:"setNoFaceTimeout",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;return this.noFaceTimeout=e,this.noFaceTimeout}},{key:"setPositionConfig",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:nn;return this.configs=e,this.configs}},{key:"loadPositionConfig",value:function(){if(this.base.device.handheld){var e=this.base.device.ios?"mobile_ios":"mobile_generic",t=Wn<=480&&Hn<=640;this.config=this.configs[t?"limited":e]}else this.config=this.configs[this.isKioskMode?"kiosk":"desktop"]}},{key:"build",value:function(){this.unsetTimer(this.noChangeTimer),this.noChangeTimer=null,this.unsetTimer(this.noFaceTimer),this.noFaceTimer=null,this.smooth=1,this.times=[],this.states={},this.state=null,this.paused=!1,this.timeSinceLastFace=0}},{key:"start",value:function(e){this.extractConfig(e),this.loadPositionConfig(),this.socketConnected=!0,this.base.sendEvent(en)}},{key:"extractConfig",value:function(e){if(e.factors){var t=e.factors.face_envelope;if(t&&(this.base.console.log("Received face detect factors from client_start ".concat(t)),this.setPositionConfig(this.base.extractFromFactors(t))),this.shouldTimeout){var n=e.factors.face_finder_timeout_seconds;n&&(this.base.console.log("Received face finder timeout factor from client_start: ".concat(n)),this.setNoFaceTimeout(n))}}}},{key:"unsetTimer",value:function(e){e&&(clearTimeout(e),e=null)}},{key:"setStates",value:function(){tn={noFace:this.base.language.term("prompt_hold_still"),moveCloser:this.base.language.term("prompt_too_far"),moveBack:this.base.language.term("prompt_too_close"),moveLeft:this.base.language.term("prompt_too_right"),moveRight:this.base.language.term("prompt_too_left"),moveDown:this.base.language.term("prompt_too_high"),moveUp:this.base.language.term("prompt_too_low"),foundFace:this.base.language.term("prompt_get_ready")}}},{key:"canStart",value:function(){return this.socketConnected}},{key:"resetNoFaceFoundTimer",value:function(e){var t=this,n=e.face,r=e.successRate;if(this.shouldTimeout){if(this.noFaceTimer&&n&&r>=.5)return this.base.console.log("noFaceTimer unset"),this.unsetTimer(this.noFaceTimer),void(this.noFaceTimer=null);if(!this.noFaceTimer&&r<.5){var i=1e3*this.noFaceTimeout;this.base.console.log("noFaceTimer set with successRate ".concat(r,", will bail in ").concat(i,"ms")),this.noFaceTimer=setTimeout((function(){t.base.sendEvent(lf.error,{feedback:"no_face_found",reason:t.base.language.term("error_no_face_found")})}),i)}}}},{key:"feedback",value:function(e){if(!this.paused&&e&&e.face){this.calculateTimeSinceLastFace(performance.now());var t=this.normaliseFace(e.face),n=t.left,r=t.right,i=t.top,o=t.bottom,a=t.width,s=t.height,c=this.config,u=c.moveUp,l=c.moveDown,h=c.moveLeft,f=c.moveRight,d=c.moveCloser,p=c.moveBack,m=this.width>this.height?s:a;m>p||n<h&&r<f?this.smoother("moveBack"):o<u?this.smoother("moveUp"):i<l?this.smoother("moveDown"):r<h?this.smoother("moveLeft"):n<f?this.smoother("moveRight"):m<d?this.smoother("moveCloser"):this.smoother("foundFace")}else this.smoother("noFace")}},{key:"calculateTimeSinceLastFace",value:function(e){this.previousFaceTime&&(this.timeSinceLastFace=e-this.previousFaceTime),this.previousFaceTime=e}},{key:"normaliseFace",value:function(e){this.base.device.ios?(this.width=Hn,this.height=Wn):(this.width=Wn,this.height=Hn);var t=e.width,n=e.height,r=e.x,i=e.y,o=n/2/this.height,a=t/2/this.width;return{left:(this.width-t-r)/this.width+a,right:r/this.width-a,top:i/this.height-o,bottom:(this.height-n-i)/this.height+o,width:t/this.width,height:n/this.height}}},{key:"smoother",value:function(e){var t=this;this.canStart()&&(this.state!==e?(this.unsetTimer(this.noChangeTimer),this.states.hasOwnProperty(e)?this.states[e]++:this.states[e]=1,this.states[e]>=this.smooth&&(this.state=e,this.base.sendEvent(Kt,e),this.base.sendEvent(lf.feedback,{key:e,message:tn[e]}),Object.keys(this.states).forEach((function(e){t.states[e]=0})))):("noFace"!==this.state&&"foundFace"!==this.state&&(this.noChangeTimer||(this.noChangeTimer=setTimeout((function(){t.base.sendEvent(Qt),t.unsetTimer(t.noChangeTimer)}),5e3))),Object.keys(this.states).forEach((function(n){n!==e&&t.states[n]>0&&t.states[n]--}))))}}]),e}();function on(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function an(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){on(o,r,i,a,s,"next",e)}function s(e){on(o,r,i,a,s,"throw",e)}a(void 0)}))}}function sn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var cn={positionWeight:.5,certaintyWeight:.1,sizeWeight:.4,sizeTargetMobile:.8,sizeTargetDesktop:.4,threshold:.7},un={sizeMinMobile:160,sizeMaxMobile:800,sizeMinDesktop:100,sizeMaxDesktop:480},ln=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.video=n.video,this.isDetecting=!1,this.hasInit=!1,this.sortScore=cn,this.faceConfig=un,this.scaleFactor=this.base.device.mobile?1.05:1.1,this.shiftFactor=this.base.device.mobile?.05:.1,this.minSize=this.base.device.handheld?this.faceConfig.sizeMinMobile:this.faceConfig.sizeMinDesktop,this.maxSize=this.base.device.handheld?this.faceConfig.sizeMaxMobile:this.faceConfig.sizeMaxDesktop,this.threshold=1,this.canvasMultiplier=1,this.preloadPromise=this.preload(),this.resetAdaptiveState(),this.listen()}return function(e,t,n){t&&sn(e.prototype,t)}(e,[{key:"listen",value:function(){var e=this;window.addEventListener("unload",(function(){e.cleanUp(!0)})),this.base.listenEvent(bl.clientStarted,(function(t){return e.setConfigFromFactors(t)})),this.base.listenEvent([kr.dimensionsUpdated,Zn.resolutionChange],(function(){e.isDetecting&&(e.cleanUp(),e.init(),e.enableDetect())})),this.base.listenEvent([lf.error,h],(function(){e.endDetect(),e.cleanUp(!0)})),this.base.listenEvent(kr.exitFullScreen,(function(){e.sendTelemetry()}))}},{key:"resetAdaptiveState",value:function(){this.fdInterval&&(clearInterval(this.fdInterval),this.fdInterval=null),this.fdElapsedSeconds=0,this.fdIterations=0,this.fdFoundFaces=[],this.fdDetectStart=null,this.fdDetectTimes=[],this.lastFace=null,this.faceObjectsFound=0,this.fdHasReducedThreshold=!1}},{key:"preload",value:function(){var e=an(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"init",value:function(){var e=an(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.width=this.base.device.ios?Hn:Wn,this.height=this.base.device.ios?Wn:Hn,this.base.console.log("Face detector video input: W:".concat(this.width," H:").concat(this.height)),this.hasInit=!0;case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"enableDetect",value:function(){var e=an(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.preloadPromise;case 2:this.base.sendEvent(Cn.started),this.fdInterval=setInterval(this.faceDetectWatcherTick.bind(this),1e3),this.isDetecting=!0;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"detect",value:function(){var e=an(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isDetecting){e.next=2;break}return e.abrupt("return",this.endDetect());case 2:return this.hasInit||this.init(),e.prev=3,++this.fdIterations,this.fdDetectStart=performance.now(),e.next=8,this.engineDetect();case 8:t=e.sent,this.imageProcessed(t),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(3),this.base.console.error("".concat(this.constructor.NAME," error: ").concat(e.t0.message),e.t0),this.base.sendEvent(lf.error,{reason:this.base.language.term("error_streaming"),feedback:"client_stream"});case 16:return e.abrupt("return",this.endDetect());case 17:case"end":return e.stop()}}),e,this,[[3,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"createCanvas",value:function(e){var t=this.width*this.canvasMultiplier,n=this.height*this.canvasMultiplier;return this.base.console.log("Face detector canvas: W:".concat(t," H:").concat(n)),this.base.dom.createElement("canvas",e,null,{width:t,height:n})}},{key:"getImageData",value:function(){return this.context.drawImage(this.video,0,0,this.width,this.height,0,0,this.width*this.canvasMultiplier,this.height*this.canvasMultiplier),this.context.getImageData(0,0,this.width*this.canvasMultiplier,this.height*this.canvasMultiplier)}},{key:"engineDetect",value:function(){var e=an(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"endDetect",value:function(){var e=null!==this.fdDetectStart,t=performance.now();this.base.sendEvent(Cn.stoppedFaceDetect,null,!1),e&&this.fdDetectTimes.push(t-this.fdDetectStart)}},{key:"disableDetect",value:function(){clearInterval(this.fdInterval),this.isDetecting=!1,this.fdInterval=null,!0===this.sendTelemetry()&&this.resetAdaptiveState()}},{key:"imageProcessed",value:function(e){var t=this.faceObjectsFound/this.fdIterations;e&&(e.x/=this.canvasMultiplier,e.y/=this.canvasMultiplier,e.width/=this.canvasMultiplier,e.height/=this.canvasMultiplier),this.base.sendEvent($t,e,!1),null!==e&&(this.lastFace=e,++this.faceObjectsFound),this.fdFoundFaces.push(e||[]),this.base.sendEvent(Cn.imageProcessed,{face:e,successRate:t},!1)}},{key:"noFaceFound",value:function(){this.base.sendEvent($t,null,!1)}},{key:"setConfigFromFactors",value:function(e){var t=e.factors;if(t){var n=t.face_pico_thresholds,r=t.face_thresholds,i=t.face_sort_score;r?(this.faceConfig=this.base.extractFromFactors(r),this.base.console.debug("Face detector: remote config - setting face_thresholds")):n&&(this.faceConfig=this.base.extractFromFactors(n),this.base.console.warn("Face detector: remote (old!) config - setting face_pico_thresholds")),i&&(this.sortScore=this.base.extractFromFactors(i),this.base.console.debug("Face detector: remote config - setting sortScore"))}}},{key:"getSortScore",value:function(e){var t=this.width,n=this.height,r=this.sortScore,i=r.positionWeight,o=r.certaintyWeight,a=r.sizeWeight,s=r.sizeTargetMobile,c=r.sizeTargetDesktop,u=this.base.device.handheld?s:c,l=e[0],h=e[1],f=e[2],d=parseFloat(l)/t,p=parseFloat(h)/n,m=u-(Math.abs(parseFloat(f)/t)-u),v=e[3];return(i*(Math.sqrt(2)-Math.sqrt(Math.pow(Math.abs(d-.5),2)+Math.pow(Math.abs(p-.5),2)))+o*(v/100)+a*m)/(i+o+a)}},{key:"cleanUp",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.resetAdaptiveState(),this.hasInit=!1,this.isDetecting=!1;try{this.engineCleanup(e)}catch(e){this.base.console.warn(e)}}},{key:"engineCleanup",value:function(e){}},{key:"sendTelemetry",value:function(){var e=this.fdDetectTimes.length;if(e>0)return this.base.sendEvent(Bu.telemetry,{event:"html5.face_detector",data:{model:this.constructor.NAME,mean:this.fdDetectTimes.reduce((function(e,t){return e+t}),0)/e,count:e,faces:this.fdFoundFaces}}),!0}},{key:"faceDetectWatcherTick",value:function(){++this.fdElapsedSeconds;var e=this.faceObjectsFound/this.fdIterations;this.base.console.log("Face Detector: ".concat(this.fdElapsedSeconds,"s elapsed, FD success rate: ").concat(e)),"CLEAR"===this.handleWatcherTick(this.fdElapsedSeconds,e)&&clearInterval(this.fdInterval)}},{key:"handleWatcherTick",value:function(e,t){if(e>12&&!this.hasSentSustainedNoFace&&(this.hasSentSustainedNoFace=!0,this.base.sendEvent(Cn.sustainedNoFace,{face_detection_success_rate:t,faces:this.fdFoundFaces,last_face:this.lastFace})),e>30)return"CLEAR";e>=6&&t<.75&&!this.fdHasReducedThreshold&&(this.base.console.log("Face Detector: low success rate, reducing threshold to 85%"),this.threshold=Math.floor(.85*this.threshold),this.fdHasReducedThreshold=!0)}}]),e}();ln.NAME="AdapterBase";var hn=n(71),fn=n.n(hn);function dn(e){return(dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function mn(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function vn(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){mn(o,r,i,a,s,"next",e)}function s(e){mn(o,r,i,a,s,"throw",e)}a(void 0)}))}}function gn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yn(e,t,n){return(yn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=_n(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function bn(e,t){return(bn=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _n(e){return(_n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function wn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){return e+t}),0)/t.length||0}var xn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bn(e,t)}(n,ln);var t=function(e){return function(){var t,n=_n(e);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()){var r=_n(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return function(e,t){return!t||"object"!==dn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,t)}}(n);function n(e,r){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(i=t.call(this,e,r)).threshold=.85,i.canvasMultiplier=.5,i}return function(e,t,n){t&&gn(e.prototype,t)}(n,[{key:"init",value:function(){var e=vn(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:yn(_n(n.prototype),"init",this).call(this),this.canvas=this.createCanvas("blazeface-canvas"),this.context=this.canvas.getContext("2d"),this.workerURL=null;case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"onMessage",value:function(e){var t=e.data,n=t.exec,r=t.payload;return"loadModels"===n?this.workerLoadModelsFuture.resolve():"engineDetect"===n?this.engineDetectFuture.resolve(r):("log"===n&&this.base.console.log("Worker log: "+JSON.stringify(r)),void("error"===n&&this.base.console.error("Worker error: "+JSON.stringify(r))))}},{key:"onWorkerError",value:function(e){this.base.console.error("BlazefaceAdapter: ".concat(e.message," / ").concat(JSON.stringify(e))),this.base.sendEvent(lf.error,{reason:this.base.language.term("error_sdk_internal"),feedback:"client_error"}),this.endDetect()}},{key:"preload",value:function(){var e=vn(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.base.createAssetURL("/wasm/blazeface-worker.js"),e.prev=1,e.next=4,fn.a.get(t,{responseType:"arraybuffer"});case 4:return n=e.sent,e.next=7,this.workerData(n.data);case 7:return e.abrupt("return",e.sent);case 10:e.prev=10,e.t0=e.catch(1),this.base.console.error("BlazefaceAdapter unable to fetch: ".concat(t),e.t0),this.base.sendEvent(lf.error,{reason:this.base.language.term("error_asset_fetch"),feedback:"network_problem"});case 14:case"end":return e.stop()}}),e,this,[[1,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"workerData",value:function(){var e=vn(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.workerURL=URL.createObjectURL(new Blob([t],{type:"text/javascript"})),e.abrupt("return",this.createWorker());case 5:e.prev=5,e.t0=e.catch(0),this.base.console.error("BlazefaceAdapter client error",e.t0),this.base.sendEvent(lf.error,{reason:this.base.language.term("error_sdk_internal"),feedback:"client_error"});case 9:case"end":return e.stop()}}),e,this,[[0,5]])})));return function(t){return e.apply(this,arguments)}}()},{key:"createWorker",value:function(){var e=vn(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.workerLoadModelsFuture=xh(),this.worker=new Worker(this.workerURL),this.worker.onmessage=this.onMessage.bind(this),this.worker.onerror=this.onWorkerError.bind(this),this.worker.postMessage({cmd:"loadModels",payload:{importPaths:[{assetPath:"/blazeface-worker/@tensorflow/tfjs/1.7.2.js"},{assetPath:"/blazeface-worker/@tensorflow/tfjs-backend-wasm/1.7.2.js"},{assetPath:"/blazeface-worker/@tensorflow-models/blazeface/0.0.5.js"}].map((function(e){return t.base.createAssetURL("/".concat(e.assetPath))})),wasmPath:this.base.createAssetURL("/models/tfjs-backend-wasm.wasm"),modelPath:this.base.createAssetURL("/models/blazeface-1"),maxFaces:1,inputWidth:128,inputHeight:128,scoreThreshold:.8,iouThreshold:.3}}),e.abrupt("return",this.workerLoadModelsFuture.promise);case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"terminateWorker",value:function(){this.worker&&(this.worker.terminate(),this.worker=null)}},{key:"engineDetect",value:function(){var e=vn(regeneratorRuntime.mark((function e(){var t,n,r,o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.engineDetectFuture=xh(),t=this.getImageData().data.buffer,n=this.width*this.canvasMultiplier,r=this.height*this.canvasMultiplier,this.worker.postMessage({cmd:"engineDetect",payload:{width:n,height:r,channels:4,buffer:t}},[t]),e.next=8,this.engineDetectFuture.promise;case 8:if(o=e.sent,(a=o.predictions).length){e.next=12;break}return e.abrupt("return",null);case 12:return e.abrupt("return",this.processPrediction(a[0]));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"processPrediction",value:function(e){var t=e.probability,n=e.landmarks,r=t[0],i=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return pn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(n,6),o=i[0],a=i[1],s=(i[2],i[3]),c=(i[4],i[5],a[0]-o[0]),u=[wn(a[0],o[0]),wn(a[1],o[1])],l=3*Math.max(c,function(e,t){return Math.pow(e.map((function(e,n){return Math.pow(Math.abs(e-t[n]),2)})).reduce((function(e,t){return e+t})),.5)}(s,u))*.825,h=l,p=function(e){var t=e.x,n=e.y,r=e.width,i=e.height,o=e.score;return{x:Math.floor(t),y:Math.floor(n),width:Math.round(r),height:Math.round(i),score:o,toSortScore:function(){return[t,n,r,i,o]}}}({x:u[0]+.3*(s[0]-u[0]),y:u[1]+.3*(s[1]-u[1]),width:l,height:h,score:r});return this.getSortScore(p.toSortScore())>this.sortScore.threshold?p:null}},{key:"engineCleanup",value:function(e){e&&(this.terminateWorker(),URL.revokeObjectURL(this.workerURL)),this.canvas&&this.base.dom.deleteElement(this.canvas),yn(_n(n.prototype),"engineCleanup",this).call(this,e)}}]),n}();function Sn(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function En(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}xn.NAME="BlazefaceAdapter";var Mn,Cn={imageProcessed:"FaceDetect.imageProcessed",stoppedFaceDetect:"FaceDetect.stoppedFaceDetect",sustainedNoFace:"FaceDetect.sustainedNoFace",started:"FaceDetect.started"},Tn=50,An=function(){function e(t,n,r){var i=r.isKioskMode;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.isKioskMode=i,this.video=n,this.aborted=!1,this.face=new rn(t,{isKioskMode:i}),this.faceReady=xh(),this.reset(),this.listen(),this.setDetector()}return function(e,t,n){t&&En(e.prototype,t)}(e,[{key:"listen",value:function(){var e=this;this.base.listenEvent(en,(function(){e.faceReady.resolve()})),this.base.listenEvent(Zn.loaded,(function(){e.videoReady.resolve()})),this.base.listenEvent(Cn.stoppedFaceDetect,(function(){return e.nextFrame()}),!1),this.base.listenEvent([lr.stopped,Bu.streaming,bl.claimAborted,bl.error],(function(){e.detector.disableDetect(),e.reset()}))}},{key:"tryStart",value:function(){var e=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Sn(o,r,i,a,s,"next",e)}function s(e){Sn(o,r,i,a,s,"throw",e)}a(void 0)}))}}(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.detector.enableDetect();case 2:this.detector.detect();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setDetector",value:function(){this.detector=new xn(this.base,this.video),this.base.console.log("Face Detect Library: ".concat(this.detector.constructor.NAME))}},{key:"reset",value:function(){var e=this;this.videoReady=xh(),Promise.all([this.faceReady.promise,this.videoReady.promise]).then((function(){return e.tryStart()}))}},{key:"nextFrame",value:function(){var e=this;this.detector.isDetecting&&setTimeout((function(){e.detector.detect()}),Tn)}}]),e}();function Pn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ln=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.camera=t,this.build(),this.listen()}return function(e,t,n){t&&Pn(e.prototype,t)}(e,[{key:"listen",value:function(){var e=this;this.camera.base.listenEvent(Bu.flashCodeSet,(function(e){Mn=e.code.length})),this.camera.base.listenEvent(bl.lastFrame,(function(){return e.build()}))}},{key:"build",value:function(){this.frames=3,this.count=0,this.min=200,this.start=!1,this.time=(new Date).getTime()}}]),e}();function Rn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Rn(Object(n),!0).forEach((function(t){Nn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Nn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function On(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function Dn(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){On(o,r,i,a,s,"next",e)}function s(e){On(o,r,i,a,s,"throw",e)}a(void 0)}))}}function Fn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var In="Encoder.encodedFrame",Un="Encoder.sentFrame";function Bn(e){return(Mn+2)*e}function jn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0;return{videoSrcX:e,videoSrcY:t,videoSrcWidth:n,videoSrcHeight:r,canvasWidth:Math.round(i),canvasHeight:Math.round(o)}}var zn=function(){function e(t,n,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),t.encoder=this,this.base=t,this.video=n,this.faceDetect=r,this.framerate=5,this.crop=1.4,this.factorModifiers={scale:1,crop:1,fpf:2},this.scaleFactor=1,this.width=250,this.height=333,this.fpf=2,this.count=0,this.encodeStart=0,this.frames=[],this.workers=[],this.hasStartedEncoding=!1,this.debug=!1,this.face={width:0,height:0,x:0,y:0},this.frameCaptures=[],this.cropFactors=jn(),this.webm={video:{version:5,camera:"Front",orientation:"000",type:"video/webm",part:1,final:!1}},this.workerObjectURL=null,this.canvas=document.createElement("canvas"),this.canvas.id="iproov-wasm-encoder",this.primaryWorkerSetup=this.createWorker().catch((function(e){return i.base.console.error("WebM encoder failed to create: ".concat(e.message),e)})),this.debug&&(this.canvas.style.cssText="position: absolute; z-index: 99999999999; bottom: 30px; right: 30px; background: #fff; border: 4px solid red;",this.base.app.appendChild(this.canvas)),this.listen()}return function(e,t,n){t&&Fn(e.prototype,t)}(e,[{key:"extractVideoFrame",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null===e&&(e=this.cropFactors),0===e.canvasWidth)throw new Error("cropFactors was not initialized");null===t&&(t=this.canvas);var n=t.getContext("2d");return n.drawImage(this.video.video,e.videoSrcX,e.videoSrcY,e.videoSrcWidth,e.videoSrcHeight,0,0,e.canvasWidth,e.canvasHeight),n.getImageData(0,0,e.canvasWidth,e.canvasHeight)}},{key:"listen",value:function(){var e=this,t=this;this.base.listenEvent(kr.exitFullScreen,(function(){Iu.streaming||e.cleanUp(e.worker)})),this.base.listenEvent(h,Dn(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.primaryWorkerSetup;case 2:t.worker=n.sent,t.setCropFactors(),e.base.console.debug("Start encoding WebM frames"),t.start(t.worker);case 6:case"end":return n.stop()}}),n)})))),this.base.listenEvent(qn.encode,(function(t){var n=e.extractVideoFrame();e.frames.push({data:n,flash:t.flash,frame:t.frame}),e.frameCaptures[t.frame-1]&&e.frameCaptures[t.frame-1].resolve()})),this.base.listenEvent(Cn.imageProcessed,(function(t){e.handleFaceFound(t)})),this.base.listenEvent(bl.clientStarted,(function(t){e.webm.video.token=t.token,t.factors&&(t.factors.video_scale&&(e.factorModifiers.scale=t.factors.video_scale),t.factors.video_crop&&(e.factorModifiers.crop=t.factors.video_crop),t.factors.video_fpf&&(e.factorModifiers.fpf=t.factors.video_fpf))})),this.base.listenEvent(Cn.sustainedNoFace,function(){var t=Dn(regeneratorRuntime.mark((function t(n){var r,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.telemetryCapture();case 2:r=t.sent,i=r.dataURL,e.base.sendEvent(Bu.telemetry,{event:"html5.sustained_no_face",data:kn({},n,{frame:i})});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),window.addEventListener("unload",(function(){e.cleanUp(e.worker,!0)})),this.base.listenEvent([lf.error,bl.edgeResult],(function(){e.cleanUp(e.worker,!0)}))}},{key:"handleFaceFound",value:function(e){return!(!e.face||this.hasStartedEncoding||(this.face=e.face,0))}},{key:"setCropFactors",value:function(){var e=this.face,t=this.scaleFactor,n=this.crop,r=this.base.device,i=r.mobile,o=r.tablet,a=(r.desktop,r.ios),s=r.detector,c=a?Hn:Wn,u=a?Wn:Hn,l=(i||o)&&!this.base.device.isLandscape(),h=e.width/4*3,f=e.height;if(l){var d=2*Math.max(180,Math.ceil(130/(1/n)));h>d?t=.5:(t=d/2/h,this.base.console.debug("Set scaleFactor to: "+t+" as face width was "+h)),a&&parseFloat(s.browser.version)<12.1&&(t/=2,this.base.console.debug("Halving scaleFactor to: "+t+" due to iOS < 12.1"))}if(t=Math.min(1,t*this.factorModifiers.scale),l)return this.cropFactors=jn(0,0,c,u,c*t,u*t),this.cropFactors;n*=this.factorModifiers.crop;var p=-e.x+h/2,m=-e.y+f/2,v=h*n-h,g=f*n-f,y=h+2*v,b=f+2*g,_=-Math.min(0,p+v),w=-Math.min(0,m+g),x=y+Math.min(0,c+p+v-y)+Math.min(0,-p-v),S=b+Math.min(0,u+m+g-b)+Math.min(0,-m-g),E=this.width*(x/y),M=this.height*(S/b);return this.cropFactors=jn(_,w,x,S,E*t,M*t),this.cropFactors}},{key:"extractWorkerData",value:function(){var e=Dn(regeneratorRuntime.mark((function e(t){var n,r,i=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=function(e,t){i.base.console.error("WebM worker error event: ".concat(t.message),t),i.cleanUp(e,!0),i.base.sendEvent(lf.error,{reason:i.base.language.term("error_sdk_internal"),feedback:"client_error"})},e.prev=1,this.workerObjectURL=URL.createObjectURL(new Blob([t],{type:"text/javascript"})),r=new Worker(this.workerObjectURL),this.workers.push(r),r.postMessage(this.base.createAssetURL("/wasm/webm-wasm.wasm")),r.addEventListener("error",(function(e){return n(r,e)})),e.next=9,this.nextEvent(r,"message");case 9:return this.base.console.debug("WebM encoder worker initialized"),e.abrupt("return",r);case 13:e.prev=13,e.t0=e.catch(1),n(worker,e.t0);case 16:case"end":return e.stop()}}),e,this,[[1,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"createWorker",value:function(){var e=Dn(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this.workerObjectURL){e.next=16;break}return e.prev=2,t=this.base.createAssetURL("/wasm/webm-worker.js"),e.next=6,fn.a.get(t,{responseType:"arraybuffer"});case 6:return n=e.sent,e.next=9,this.extractWorkerData(n.data);case 9:return e.abrupt("return",e.sent);case 12:e.prev=12,e.t0=e.catch(2),this.base.console.error("WebM worker cant fetch: ".concat(path),e.t0),this.base.sendEvent(lf.error,{reason:this.base.language.term("error_asset_fetch"),feedback:"network_problem"});case 16:case"end":return e.stop()}}),e,this,[[2,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"configureWorker",value:function(e,t,n,r,i,o){var a=this;this.canvas.width=t,this.canvas.height=n,this.base.console.log("WebM worker configure: ".concat(t,"x").concat(n)),e.addEventListener("message",(function(e){e.data&&(a.base.console.debug("Finished encoding ".concat(a.count," in ").concat(performance.now()-a.encodeStart,"ms")),o(e.data))})),e.postMessage({width:t,height:n,realtime:!0,timebaseDen:r}),this.base.console.debug("WebM worker configured"),i()}},{key:"start",value:function(e){var t=this;if(!this.hasStartedEncoding){this.hasStartedEncoding=!0;var n=this.setCropFactors(),r=n.canvasWidth,i=n.canvasHeight;this.base.console.debug("WebM cropped canvas size: ".concat(r,"x").concat(i));for(var o=function(e){var n={};n.promise=new Promise((function(e){n.resolve=e})),t.frameCaptures.push(n)},a=0;a<=Bn(this.fpf);++a)o();this.configureWorker(e,r,i,this.framerate,(function(){t.cameraStream(t).pipeTo(new ve({write:function(t){e.postMessage(t.data.buffer,[t.data.buffer])}}))}),(function(e){t.base.console.log("Sending WebM encoded frame ".concat(t.webm.video.part," with size ").concat(e.byteLength,"...")),t.webm.video.dataURL=e,t.webm.video.final=t.webm.video.part>=Bn(t.fpf),1===t.webm.video.part&&(t.webm.video.face=kn({model:t.faceDetect.detector.constructor.NAME},t.face)),t.base.sendEvent(In,t.webm),t.webm.video.part++}))}}},{key:"telemetryCapture",value:function(){var e=Dn(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(){var e=Dn(regeneratorRuntime.mark((function e(n,r){var i,o,a,s;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.createWorker();case 3:i=e.sent,e.next=10;break;case 6:return e.prev=6,e.t0=e.catch(0),r(e.t0),e.abrupt("return");case 10:o=t.video.video,a=o.width,s=o.height,t.configureWorker(i,a/2,s/2,1,(function(){var e=t.extractVideoFrame(jn(0,0,a,s,a/2,s/2));i.postMessage(e.data.buffer,[e.data.buffer])}),(function(e){t.cleanUp(i),n({dataURL:e})}));case 12:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"cameraStream",value:function(e){var t=Bn(this.fpf);return new zt({start:function(t){return Dn(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.base.console.debug("Starting WebM encoder...");case 1:case"end":return t.stop()}}),t)})))()},pull:function(n){var r=this;return Dn(regeneratorRuntime.mark((function i(){var o;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,e.frameCaptures[e.count].promise;case 2:(o=e.frames.shift()).frame>t?(e.worker.postMessage(null),n.close(),r.base.app.removeChild(r.canvas),r.canvas=null):(e.encodeStart=performance.now(),e.base.console.debug("Send frame ".concat(o.frame," to WebM encoder for flash ").concat(o.flash," at ").concat(e.encodeStart," ms (mode: ").concat(e.base.device.handheld?"mobile":"desktop",")")),e.count++,n.enqueue(o.data));case 4:case"end":return i.stop()}}),i)})))()}})}},{key:"cleanUpWorker",value:function(e){e&&"function"==typeof e.terminate&&(this.workers=this.workers.filter((function(t){return t!==e})),e.terminate(),e=null)}},{key:"cleanUp",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.cleanUpWorker(e),n&&(this.hasStartedEncoding=!1,this.frames=null,this.workers.map((function(e){return t.cleanUpWorker(e)})),this.base.dom.deleteElement(this.canvas),this.canvas=null,URL.revokeObjectURL(this.workerObjectURL),this.workerObjectURL=null)}},{key:"nextEvent",value:function(e,t){return new Promise((function(n){e.addEventListener(t,n,{once:!0})}))}}]),e}();function Vn(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function Gn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Wn,Hn,tr,qn={flash:"VideoFrames.flash",finished:"VideoFrames.finished",encode:"VideoFrames.encode",maxFlashes:"VideoFrames.maxFlashes",framesPerFlash:"VideoFrames.framesPerFlash"},Xn=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.video=n,this.clientStarted=!1,this.doRun=!1,this.aborted=!1,this.cameraFlashLength=200,this.framesPerFlash=2,this.currentFlash=0,this.currentFrame=0,this.videoFrame=0,this.lastFlashedAt=performance.now(),this.listen()}return function(e,t,n){t&&Gn(e.prototype,t)}(e,[{key:"listen",value:function(){var e=this;this.base.listenEvent(bl.clientStarted,(function(t){e.clientStarted=!0,t.factors&&t.factors.video_fpf&&(e.framesPerFlash=t.factors.video_fpf,e.base.sendEvent(qn.framesPerFlash,e.framesPerFlash)),e.doRun&&e.nextFrame()})),this.base.listenEvent(h,(function(){e.clientStarted?(e.aborted=!1,e.nextFrame()):e.doRun=!0})),this.base.listenEvent([lf.error,bl.error,lr.error,Bu.error,kr.exitFullScreen],(function(){e.aborted=!0,e.videoFrame=null}))}},{key:"nextFrame",value:function(){var e=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Vn(o,r,i,a,s,"next",e)}function s(e){Vn(o,r,i,a,s,"throw",e)}a(void 0)}))}}(regeneratorRuntime.mark((function e(){var t,n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.aborted){e.next=3;break}return this.base.console.log("VideoFrames aborted, stopping nextFrame"),e.abrupt("return");case 3:if(!((t=this.getVideoFrame(this.video))>0&&t===this.videoFrame)){e.next=8;break}return this.base.console.log("Duplicate frame ".concat(t)),requestAnimationFrame(this.nextFrame.bind(this)),e.abrupt("return");case 8:return this.videoFrame=t,this.currentFrame%this.framesPerFlash==0&&this.nextFlash(t),this.currentFrame++,n=performance.now(),this.base.console.log("Encode frame ".concat(this.currentFrame," at ").concat(n," from video frame ").concat(t," for flash ").concat(this.currentFlash)),e.next=15,this.base.encoder.primaryWorkerSetup;case 15:this.base.sendEvent(qn.encode,{flash:this.currentFlash,frame:this.currentFrame}),r=performance.now()-n,this.currentFrame===Mn*this.framesPerFlash+1&&(this.base.sendEvent(qn.maxFlashes,this.currentFrame),this.base.console.log("Reached maxFlashes")),this.currentFrame<Bn(this.framesPerFlash)?(i=this.cameraFlashLength/this.framesPerFlash-r,setTimeout(this.nextFrame.bind(this),Math.max(1,i))):(this.base.sendEvent(qn.finished,this.currentFrame),this.base.console.log("Finished flashing"));case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"nextFlash",value:function(e){this.currentFlash++,this.base.console.log("Flash: ".concat(this.currentFlash," Frame: ").concat(e)),this.base.sendEvent(qn.flash,{flash:this.currentFlash,frame:e}),this.lastFlashedAt=performance.now()}},{key:"getVideoFrame",value:function(e){var t=e.webkitDecodedFrameCount||e.mozPaintedFrames;return t||"function"!=typeof e.getVideoPlaybackQuality||(t=e.getVideoPlaybackQuality().totalVideoFrames),Number.isInteger(t)||(t=0),t}}]),e}();function Yn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Zn={loaded:"Video.loaded",configReset:"Video.configReset",noData:"Video.noData",resolutionChange:"Video.resolutionChange"},Jn={video:{width:{exact:640},height:{exact:480},facingMode:"user"}},Kn={video:{width:640,height:480,facingMode:"user"}},$n={video:{width:{exact:800},height:{exact:480},facingMode:"user"}},Qn={video:{width:1280,height:720,facingMode:"user"}},er={video:{width:640,height:360,facingMode:"user"}},hr=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.setConfig(),this.setSizes(),this.createVideo(),this.stop=!1,this.visible=!0,this.timeout=null,this.toggle(),this.listen(),this.processDomEvents()}return function(e,t,n){t&&Yn(e.prototype,t)}(e,[{key:"listen",value:function(){var e=this;this.base.listenEvent(lr.mediaStreaming,(function(t){e.stop=!1,e.setSource(t.stream),e.playVideo()})),this.base.listenEvent([lr.stopped,lf.error],(function(){e.stopVideo()})),this.base.listenEvent(lr.configFailed,(function(){tr=Jn,e.setSizes(),e.base.sendEvent(Zn.configReset)}))}},{key:"setConfig",value:function(){this.base.device.ios?parseFloat(this.base.device.detector.browser.version)>=12.1?(this.base.console.log("iOS Safari v12.1+ video config loaded"),tr=er):(this.base.console.log("iOS video config loaded"),tr=Qn):this.base.device.safari?(this.base.console.log("Safari video config loaded"),tr=Kn):!this.base.device.handheld||this.base.device.samsung||this.base.device.detector.ua.match("KING KONG")?(this.base.console.log("Default Desktop video config loaded"),tr=Jn):(this.base.console.log("Mobile video config loaded"),tr=$n)}},{key:"setSizes",value:function(){var e=tr.video,t=e.height.exact||e.height,n=e.width.exact||e.width;if(n!==Wn||t!==Hn){var r=this.base.device.android||this.base.device.isLandscape()&&this.base.device.ios;Wn=r?t:n,Hn=r?n:t,this.base.console.log("Set video size: W:".concat(Wn," H:").concat(Hn))}}},{key:"createVideo",value:function(){this.base.console.log("Create video element ".concat(Wn,"x").concat(Hn)),this.video=this.base.dom.createElement("video","iproov-video",this.base.app,{width:Wn,height:Hn,autoplay:"",playsinline:"",muted:""})}},{key:"processDomEvents",value:function(){var e=this;this.video.addEventListener("loadedmetadata",(function(){e.base.console.log("Video loaded meta data"),e.setVideoProperties(),e.base.sendEvent(Zn.loaded,e.video)})),this.video.addEventListener("resize",(function(){Wn=e.base.device.ios?e.video.videoHeight:e.video.videoWidth,Hn=e.base.device.ios?e.video.videoWidth:e.video.videoHeight,e.base.console.log("Video resolution changed to ".concat(Wn,"x").concat(Hn)),e.base.sendEvent(Zn.resolutionChange)}))}},{key:"toggle",value:function(){this.visible=!this.visible,this.video.style.visibility=this.visible?"visible":"hidden"}},{key:"setVideoProperties",value:function(){var e=this.stream.getTracks()[0].getSettings();if(e){var t=e.aspectRatio,n=e.frameRate;this.video.setAttribute("width",Wn),this.video.setAttribute("height",Hn),this.base.console.log("Set video properties: W:".concat(Wn," / H:").concat(Hn," AR:").concat(t," FR:").concat(n))}}},{key:"setSource",value:function(e){if(this.stream=e,this.stop)this.stopVideo();else try{"srcObject"in this.video?this.video.srcObject=e:this.video.src=window.URL.createObjectURL(e),this.frames=new Xn(this.base,this.video)}catch(e){this.base.console.error("Video problem setting source: ".concat(e.message))}}},{key:"pauseVideo",value:function(){this.video.pause()}},{key:"playVideo",value:function(){var e=this,t=setTimeout((function(){e.video.readyState===e.video.HAVE_NOTHING&&(e.base.console.warn("Camera not providing video"),e.base.sendEvent(Zn.noData,{feedback:"error_camera",reason:e.base.language.term("error_camera")}))}),8e3);this.video.addEventListener("canplay",(function(){e.base.console.log("Camera is providing video"),clearTimeout(t)})),this.video.play()}},{key:"stopVideo",value:function(){this.stream&&this.stream.getTracks()[0].stop(),this.stop=!0}}]),e}();function nr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var rr=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.camera=t,this.build(),this.listen()}return function(e,t,n){t&&nr(e.prototype,t)}(e,[{key:"listen",value:function(){var e=this;this.camera.base.listenEvent(h,(function(){e.start=e.getNormalisedFrame(),e.camera.base.console.log("Started recording on frame: ".concat(e.start))})),this.camera.base.listenEvent(bl.lastFrame,(function(){e.build()}))}},{key:"build",value:function(){this.count=0,this.current=0,this.previous=0,this.start=0,this.finish=0,this.final=!1,this.offset=0,this.changes=[],this.first=!1,this.time=(new Date).getTime()}},{key:"getNormalisedFrame",value:function(){return this.current+this.offset}}]),e}();function ir(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function or(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){ir(o,r,i,a,s,"next",e)}function s(e){ir(o,r,i,a,s,"throw",e)}a(void 0)}))}}function ar(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var sr=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.button=n,this.hasPermissionAPI="permissions"in navigator}return function(e,t,n){t&&ar(e.prototype,t)}(e,[{key:"handleChange",value:function(e){switch(this.base.console.log("Test permission change: ".concat(e)),e){case"granted":this.base.console.log("Permission already granted"),this.permissionGranted(!0);break;case"prompt":this.base.console.log("Permission prompted"),this.permissionGranted(null);break;case"denied":this.base.console.log("Camera permission already denied"),this.base.sendEvent(lr.denied)}}},{key:"getPermissionStatus",value:function(){var e=or(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hasPermissionAPI){e.next=11;break}return e.prev=1,e.next=4,navigator.permissions.query({name:"camera"});case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(1),this.base.console.log("Permissions query problem - bad descriptor? Error: "+e.t0.message),e.abrupt("return",null);case 11:return e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,this,[[1,7]])})));return function(){return e.apply(this,arguments)}}()},{key:"test",value:function(){var e=or(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getPermissionStatus();case 2:if(null!==(t=e.sent)){e.next=6;break}return this.base.console.log("Permission API is not supported; will obtain permission via getMediaDevices"),e.abrupt("return",this.permissionGranted(null));case 6:try{this.handleChange(t.state),t.onchange=function(e){var t=e.srcElement.state;n.handleChange(t)}}catch(e){this.base.console.warn("Failed to get camera permission ".concat(e)),this.permissionGranted(!1)}case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"permissionGranted",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.base.sendEvent(lr.granted,{hasPermission:e})}}]),e}();function cr(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function br(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){cr(o,r,i,a,s,"next",e)}function s(e){cr(o,r,i,a,s,"throw",e)}a(void 0)}))}}function ur(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var lr={stopped:"Camera.stopped",noCamera:"Camera.noCamera",mediaStreaming:"Camera.mediaStreaming",denied:"Camera.denied",granted:"Camera.granted",error:"Camera.error",configFailed:"Camera.configFailed"},fr="unknown",dr=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.on=!1,this.aborted=!1,this.fallback=!1,this.hasTriedSimpleConfig=!1,this.input=[];try{this.frame=new rr(this),this.flash=new Ln(this),this.permissions=new sr(this.base,n)}catch(e){this.base.console.error("Problem setting up camera: ".concat(e.message))}this.listen(),this.permissions.button.addEventListener("click",(function(){r.fallback=!0,r.startCamera(r.fallback)}))}return function(e,t,n){t&&ur(e.prototype,t)}(e,[{key:"listen",value:function(){var e=this;this.base.listenEvent(lf.finished,br(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.testMedia()){t.next=4;break}return e.base.console.error("getUserMedia is not implemented in this browser"),e.base.sendEvent(lr.error,{feedback:"client_camera",reason:e.base.language.term("error_camera_unavailable")}),t.abrupt("return");case 4:return t.next=6,e.testCamera();case 6:e.base.listenEvent([kr.start,Zn.configReset],(function(){e.aborted=!1,e.startCamera(e.fallback)}));case 7:case"end":return t.stop()}}),t)})))),this.base.listenEvent(l,(function(){e.imageCapture(),e.base.vibrate.run()})),this.base.listenEvent(Bu.streaming,(function(){e.base.vibrate.run()})),this.base.listenEvent(kr.exitFullScreen,(function(){e.base.vibrate.run(),e.stopCamera()})),this.base.listenEvent(bl.lastFrame,(function(){e.frame.final=!0,e.stopCamera()})),this.base.listenEvent(Bu.abort,(function(){return e.abort()})),this.base.listenEvent([bl.edgeResult,bl.error,Bu.error,lf.error],(function(){e.on&&(e.stopCamera(),e.cleanUp())}))}},{key:"imageCapture",value:function(){var e=this;if("undefined"!=typeof ImageCapture){var t=new ImageCapture(this.stream.getVideoTracks()[0]),n=t.track.getCapabilities(),r={};n.focusMode&&n.focusMode.includes("manual")&&(r.focusMode="manual"),n.whiteBalanceMode&&n.whiteBalanceMode.includes("manual")&&(r.whiteBalanceMode="manual"),Object.keys(r).length>0&&t.track.applyConstraints({advanced:[r]}).then((function(n){e.base.console.log(t.track.getSettings())}),(function(t){e.base.console.warn("Constraints error",t)}))}}},{key:"vibrate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;this.canVibrate&&navigator.vibrate([e])}},{key:"reset",value:function(){this.aborted=!1,this.on=!1,this.frame.first=!1}},{key:"abort",value:function(){this.stopCamera(),this.reset(),this.aborted=!0}},{key:"testCamera",value:function(){var e=br(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.enumerateDevices();case 3:if(t=e.sent,this.input=t.filter((function(e){return"videoinput"===e.kind})),0!==this.input.length){e.next=8;break}return this.noCamera(),e.abrupt("return");case 8:if(this.name=fr=this.input[0].label,!this.name){e.next=12;break}return this.base.sendEvent(lr.granted,{hasPermission:!0}),e.abrupt("return");case 12:this.permissions.test(),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(0),this.noCamera(),this.base.console.log("Unable to set camera meta",e.t0);case 19:case"end":return e.stop()}}),e,this,[[0,15]])})));return function(){return e.apply(this,arguments)}}()},{key:"noCamera",value:function(){this.base.console.log("Client has no camera"),this.aborted=!0,this.base.sendEvent(lr.noCamera)}},{key:"startCamera",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.aborted||this.on||(this.base.console.log("start camera with video config:"+JSON.stringify(tr)),navigator.mediaDevices.getUserMedia(tr).then((function(n){e.stream=n,e.aborted?e.stopTrack():(t&&e.base.sendEvent(lr.granted,{hasPermission:!0}),e.on=!0,e.base.sendEvent(lr.mediaStreaming,{stream:n,camera:e}))})).catch((function(t){return e.handleError(t)})))}},{key:"handleError",value:function(e){this.reset();var t=e.code,n=e.name,r=e.message;this.base.console.warn("Camera error: Code: ".concat(t," Name: ").concat(n," Message: ").concat(r||"Unknown Error")),"NotFoundError"==n||"DevicesNotFoundError"==n?this.base.sendEvent(lr.noCamera):"NotReadableError"==n||"TrackStartError"==n?this.base.sendEvent(lr.error,{feedback:"client_camera",reason:this.base.language.term("error_camera_in_use")}):"OverconstrainedError"==n||"ConstraintNotSatisfiedError"==n?!this.hasTriedSimpleConfig&&this.base.device.android&&(this.base.console.log("Video constraints failed, using limited version now"),this.base.sendEvent(lr.configFailed),this.hasTriedSimpleConfig=!0):"NotAllowedError"==n||"PermissionDeniedError"==n?this.base.sendEvent(lr.denied):(this.base.console.error("Unable to access the camera. Code: ".concat(t," Name: ").concat(n," Message: ").concat(r||"Unknown Error")),this.base.sendEvent(lr.error,{feedback:"client_camera",reason:this.base.language.term("error_camera")}))}},{key:"stopTrack",value:function(){this.stream&&this.stream.getTracks()[0].stop()}},{key:"stopCamera",value:function(){this.on=!1,this.stopTrack(),this.base.sendEvent(lr.stopped)}},{key:"testMedia",value:function(){return navigator.mediaDevices&&"function"==typeof navigator.mediaDevices.enumerateDevices}},{key:"cleanUp",value:function(){this.steam=null,this.flash=null,this.permissions=null}}]),e}();function pr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var mr={r:[],g:[],b:[]},vr=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.emitter=t.emitter,this.listen()}return function(e,t,n){t&&pr(e.prototype,t)}(e,[{key:"listen",value:function(){var e=this;this.emitter.listen(bl.clientStarted,(function(t){e.colours(t.flash_code)}))}},{key:"colours",value:function(e){var t=e.split("");if(!t)throw new Error("Unable to process colours!");t.unshift("0"),t.push("0"),t.forEach((function(e,n){switch(t[n]){case"1":mr.r[n]=1,mr.g[n]=1,mr.b[n]=1;break;case"0":mr.r[n]=0,mr.g[n]=0,mr.b[n]=0;break;case"b":mr.r[n]=0,mr.g[n]=0,mr.b[n]=1;break;case"c":mr.r[n]=0,mr.g[n]=1,mr.b[n]=1;break;case"g":mr.r[n]=0,mr.g[n]=1,mr.b[n]=0;break;case"m":mr.r[n]=1,mr.g[n]=0,mr.b[n]=1;break;case"r":mr.r[n]=1,mr.g[n]=0,mr.b[n]=0;break;case"y":mr.r[n]=1,mr.g[n]=1,mr.b[n]=0;break;default:throw new Error("Invalid code")}}))}}]),e}(),gr=n(49),yr=n.n(gr);function _r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var wr="BaseSVG.injected",xr="BaseSVG",Sr=function(){function e(t,n,r,i,o,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.width=n,this.height=r,this.colours=i,this.customLogo=o,this.title=a,this.shouldShowCountdown=this.base.settings.config.show_countdown,this.flashed=1,this.feedback=void 0,this.socketConnected=!1}return function(e,t,n){t&&_r(e.prototype,t)}(e,[{key:"setTextArea",value:function(e,t){e.textContent=t}},{key:"setTextAreasSize",value:function(){this.info.setAttribute("text-anchor","middle"),this.info.setAttribute("x",144),this.status.setAttribute("text-anchor","middle"),this.status.setAttribute("x",144)}},{key:"colourSetter",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"fill";switch(n){case"fill":e.setAttribute("fill",t),e.style.fill=t;break;case"stroke":e.style.stroke=t;break;default:this.base.console.warn("Invalid type: ".concat(n," for colourSetter!"))}}},{key:"inject",value:function(e){this.base.app.insertAdjacentHTML("beforeend",e),this.base.sendEvent(wr)}},{key:"positionLeft",value:function(e){return this.width/2-this.height/2*(xu/Su)+e}},{key:"positionRight",value:function(e){return this.height/2*(xu/Su)+this.width/2-e}},{key:"positionBottom",value:function(e){return this.width/2*(Su/xu)+this.height/2-e}},{key:"positionTop",value:function(e){return this.height/2-this.width/2*(Su/xu)+e}},{key:"hide",value:function(e){e.style.display="none"}},{key:"show",value:function(e){e.style.display="block"}},{key:"setCustomLogo",value:function(e){var t=this;if("null"===e||""===e)this.logo.innerHTML="";else if(null!==e){this.logo.innerHTML="";var n=new Image;n.src=e,n.onload=function(){var r=28/n.height*n.width;t.logo.innerHTML='<image xlink:href="'.concat(e,'" href="').concat(e,'" width="').concat(r,'" height="28" preserveAspectRatio="xMinYMid meet">')}}}},{key:"setCustomTitle",value:function(e,t){var n=t.type,r=t.user_name,i=t.sp_name;if(this.titleIsDisabled(e))this.title="";else{var o=[this.base.titleCase(n),r,i].filter(Boolean),a=this.base.language.term(2===o.length?"message_format":"message_format_with_username"),s=this.title?this.title:a;this.title=this.buildTitle(s,o)}}},{key:"titleIsDisabled",value:function(e){return["","false","null"].filter((function(t){return e===t})).length>0}},{key:"buildTitle",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=e;return n&&n.includes("%@")&&t.map((function(e){n=n.replace("%@",e)})),n}},{key:"resize",value:function(){var e=this;this.delay&&clearTimeout(this.delay),this.delay=setTimeout((function(){e.repositionSVG(),e.delay=null}),100)}},{key:"initialColours",value:function(e,t){this.colourSetter(e,t)}},{key:"forceStart",value:function(){this.click=function(){this.scan()},this.clickHandler=this.click.bind(this),this.svgContainer.addEventListener("click",this.clickHandler),this.spacebar=function(e){32===e.keyCode&&this.scan()},this.spaceHandler=this.spacebar.bind(this),document.addEventListener("keypress",this.spaceHandler)}},{key:"updateInfo",value:function(){this.base.sendEvent(lf.feedback,{key:"socket_connected",message:this.title}),this.setTextArea(this.info,this.title)}},{key:"fadeIn",value:function(){var e=this;setTimeout((function(){e.svgContainer.classList.add("fade-in")}),500)}},{key:"canStart",value:function(){return this.socketConnected}}]),e}();function Er(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Mr=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.enabled=yr.a.isEnabled,this.setSupported(),this.processDOMEvents()}return function(e,t,n){t&&Er(e.prototype,t)}(e,[{key:"setSupported",value:function(){this.supported=!this.base.device.ios}},{key:"processDOMEvents",value:function(){var e=this;this.enabled&&(yr.a.on("change",this.handler.bind(this)),this.base.appWrapper.addEventListener("webkitfullscreenchange",this.handler.bind(this))),this.base.listenEvent(xr,(function(t){t.exit.addEventListener("click",(function(t){t.preventDefault(),e.supported?e.exit():e.base.sendEvent(kr.exitFullScreen)}))}))}},{key:"open",value:function(){this.enabled&&yr.a.request(this.base.appWrapper)}},{key:"exit",value:function(){this.isFullScreen()&&yr.a.exit()}},{key:"isFullScreen",value:function(){if(this.enabled)return yr.a.isFullscreen}},{key:"handler",value:function(){var e=this.isFullScreen()?kr.enterFullScreen:kr.exitFullScreen;this.base.sendEvent(e)}}]),e}();function Cr(e){return(Cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ar=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.isDebug=!1,this.setDebug(),this.listenDomEvents()}return function(e,t,n){t&&Tr(e.prototype,t)}(e,[{key:"listenDomEvents",value:function(){var e=this;window.addEventListener("storage",(function(t){"iProovDebug"===t.key&&e.setDebug()}))}},{key:"setDebug",value:function(){var e=sessionStorage.getItem("iProovDebug");e&&e.length>0?this.isDebug=!0:this.isDebug=!1}},{key:"log",value:function(e){var t=this;this.sendLog("log",e);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];r&&r.forEach((function(e){return t.sendLog("log",e)}))}},{key:"debug",value:function(e){console.debug(e),this.sendLog("debug",e)}},{key:"error",value:function(e){console.error(e),this.sendLog("error",e)}},{key:"warn",value:function(e){console.warn(e),this.sendLog("warn",e)}},{key:"sendLog",value:function(e,t){this.isDebug&&window.console&&"log"===e&&console.log(t),this.base.sendEvent(bl.sendLog,this.createLog(e,t),!1)}},{key:"createLog",value:function(e,t){return[(new Date).toJSON(),"HTML5_"+this.base.version,(e||"info").toUpperCase(),"object"===Cr(t)?JSON.stringify(t):t].join(" ")}}]),e}();function Pr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Lr=function(){function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,n||(this.container=this.base.container.shadowRoot.querySelector("#iproov-rotate"),this.container.querySelector("img").src=t.createAssetURL("/animations/screen-rotate.gif"),this.base.listenEvent(kr.start,(function(){r.run(),r.listenDomEvents(),r.listen()})))}return function(e,t,n){t&&Pr(e.prototype,t)}(e,[{key:"listenDomEvents",value:function(){this.rotate=function(){this.run()},this.runHandler=this.rotate.bind(this),window.addEventListener("resize",this.runHandler)}},{key:"listen",value:function(){var e=this;this.base.listenEvent([Bu.abort,lf.error,Bu.error,bl.edgeStatus,bl.edgeResult],(function(){e.container.style.display="none",window.removeEventListener("resize",e.runHandler)}))}},{key:"run",value:function(){var e=this.isLandscape();this.base.console.log("Screen orientation change: Landscape: ".concat(e," ?")),Iu.streaming?this.base.console.log("Screen rotate UI blocked due to streaming started"):(this.container.style.display=e?"block":"none",this.base.appWrapper.style.display=e?"none":"block",this.base.sendEvent(e?kr.landscape:kr.portrait),e&&this.base.sendEvent(lf.feedback,{key:"prompt_rotate_portrait",message:this.base.language.term("prompt_rotate_portrait")}))}},{key:"isLandscape",value:function(){return window.innerWidth>window.innerHeight}}]),e}();function Rr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}for(var kr={start:"Screen.start",enterFullScreen:"Screen.enterFullScreen",exitFullScreen:"Screen.exitFullScreen",dimensionsUpdated:"Screen.dimensionsUpdated",landscape:"Screen.landscape",portrait:"Screen.portrait"},Nr=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.button=n,this.fullscreen=new Mr(this.base),this.colours=new vr(this.base),this.metrics=new ku(this.base),this.rotate=new Lr(this.base,r),this.listen()}return function(e,t,n){t&&Rr(e.prototype,t)}(e,[{key:"listen",value:function(){var e=this;this.base.isNativeBridge?this.base.console.debug("Native bridge enabled, skipping events"):(this.base.listenEvent(lf.finished,(function(){e.button.addEventListener("click",(function(){Iu.streaming?e.base.sendEvent(lf.error,{feedback:"user_timeout",reason:e.base.language.term("user_timeout")}):(e.base.sendEvent(kr.start),e.fullscreen.supported&&"screen"!==sessionStorage.getItem("iProovDebug")&&e.fullscreen.open(),e.fullscreen.supported||(e.base.sendEvent(kr.enterFullScreen),document.addEventListener("keydown",(function(t){27===t.keyCode&&e.base.sendEvent(kr.exitFullScreen)}))))}))})),this.base.listenEvent([qn.finished,lr.denied,lr.error,bl.claimAborted,bl.error,kr.exitFullScreen,lf.error,bl.edgeResult,qn.finished],(function(){e.fullscreen.exit()})))}},{key:"listenDomEvents",value:function(){var e=this;window.onbeforeunload=function(){e.base.sendEvent(kr.exitFullScreen)}}}]),e}(),Or=[],Dr=0;Dr<256;Dr++)Or[Dr]=(Dr<16?"0":"")+Dr.toString(16);var Fr={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(Or[255&e]+Or[e>>8&255]+Or[e>>16&255]+Or[e>>24&255]+"-"+Or[255&t]+Or[t>>8&255]+"-"+Or[t>>16&15|64]+Or[t>>24&255]+"-"+Or[63&n|128]+Or[n>>8&255]+"-"+Or[n>>16&255]+Or[n>>24&255]+Or[255&r]+Or[r>>8&255]+Or[r>>16&255]+Or[r>>24&255]).toUpperCase()},clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,r,i){return r+(e-t)*(i-r)/(n-t)},lerp:function(e,t,n){return(1-n)*e+n*t},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*Fr.DEG2RAD},radToDeg:function(e){return e*Fr.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,r,i){var o=Math.cos,a=Math.sin,s=o(n/2),c=a(n/2),u=o((t+r)/2),l=a((t+r)/2),h=o((t-r)/2),f=a((t-r)/2),d=o((r-t)/2),p=a((r-t)/2);"XYX"===i?e.set(s*l,c*h,c*f,s*u):"YZY"===i?e.set(c*f,s*l,c*h,s*u):"ZXZ"===i?e.set(c*h,c*f,s*l,s*u):"XZX"===i?e.set(s*l,c*p,c*d,s*u):"YXY"===i?e.set(c*d,s*l,c*p,s*u):"ZYZ"===i?e.set(c*p,c*d,s*l,s*u):console.warn("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order.")}};function Ir(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._w=void 0!==r?r:1}Object.assign(Ir,{slerp:function(e,t,n,r){return n.copy(e).slerp(t,r)},slerpFlat:function(e,t,n,r,i,o,a){var s=n[r+0],c=n[r+1],u=n[r+2],l=n[r+3],h=i[o+0],f=i[o+1],d=i[o+2],p=i[o+3];if(l!==p||s!==h||c!==f||u!==d){var m=1-a,v=s*h+c*f+u*d+l*p,g=v>=0?1:-1,y=1-v*v;if(y>Number.EPSILON){var b=Math.sqrt(y),_=Math.atan2(b,v*g);m=Math.sin(m*_)/b,a=Math.sin(a*_)/b}var w=a*g;if(s=s*m+h*w,c=c*m+f*w,u=u*m+d*w,l=l*m+p*w,m===1-a){var x=1/Math.sqrt(s*s+c*c+u*u+l*l);s*=x,c*=x,u*=x,l*=x}}e[t]=s,e[t+1]=c,e[t+2]=u,e[t+3]=l}}),Object.defineProperties(Ir.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}}}),Object.assign(Ir.prototype,{isQuaternion:!0,set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},setFromEuler:function(e,t){if(!e||!e.isEuler)throw new Error("Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,r=e._y,i=e._z,o=e.order,a=Math.cos,s=Math.sin,c=a(n/2),u=a(r/2),l=a(i/2),h=s(n/2),f=s(r/2),d=s(i/2);return"XYZ"===o?(this._x=h*u*l+c*f*d,this._y=c*f*l-h*u*d,this._z=c*u*d+h*f*l,this._w=c*u*l-h*f*d):"YXZ"===o?(this._x=h*u*l+c*f*d,this._y=c*f*l-h*u*d,this._z=c*u*d-h*f*l,this._w=c*u*l+h*f*d):"ZXY"===o?(this._x=h*u*l-c*f*d,this._y=c*f*l+h*u*d,this._z=c*u*d+h*f*l,this._w=c*u*l-h*f*d):"ZYX"===o?(this._x=h*u*l-c*f*d,this._y=c*f*l+h*u*d,this._z=c*u*d-h*f*l,this._w=c*u*l+h*f*d):"YZX"===o?(this._x=h*u*l+c*f*d,this._y=c*f*l+h*u*d,this._z=c*u*d-h*f*l,this._w=c*u*l-h*f*d):"XZY"===o&&(this._x=h*u*l-c*f*d,this._y=c*f*l-h*u*d,this._z=c*u*d+h*f*l,this._w=c*u*l+h*f*d),!1!==t&&this._onChangeCallback(),this},setFromAxisAngle:function(e,t){var n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this},setFromRotationMatrix:function(e){var t,n=e.elements,r=n[0],i=n[4],o=n[8],a=n[1],s=n[5],c=n[9],u=n[2],l=n[6],h=n[10],f=r+s+h;return f>0?(t=.5/Math.sqrt(f+1),this._w=.25/t,this._x=(l-c)*t,this._y=(o-u)*t,this._z=(a-i)*t):r>s&&r>h?(t=2*Math.sqrt(1+r-s-h),this._w=(l-c)/t,this._x=.25*t,this._y=(i+a)/t,this._z=(o+u)/t):s>h?(t=2*Math.sqrt(1+s-r-h),this._w=(o-u)/t,this._x=(i+a)/t,this._y=.25*t,this._z=(c+l)/t):(t=2*Math.sqrt(1+h-r-s),this._w=(a-i)/t,this._x=(o+u)/t,this._y=(c+l)/t,this._z=.25*t),this._onChangeCallback(),this},setFromUnitVectors:function(e,t){var n=e.dot(t)+1;return n<1e-6?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(Fr.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,t){var n=this.angleTo(e);if(0===n)return this;var r=Math.min(1,t/n);return this.slerp(e,r),this},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this},multiply:function(e,t){return void 0!==t?(console.warn("Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,t){var n=e._x,r=e._y,i=e._z,o=e._w,a=t._x,s=t._y,c=t._z,u=t._w;return this._x=n*u+o*a+r*c-i*s,this._y=r*u+o*s+i*a-n*c,this._z=i*u+o*c+n*s-r*a,this._w=o*u-n*a-r*s-i*c,this._onChangeCallback(),this},slerp:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,i=this._z,o=this._w,a=o*e._w+n*e._x+r*e._y+i*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;var s=1-a*a;if(s<=Number.EPSILON){var c=1-t;return this._w=c*o+t*this._w,this._x=c*n+t*this._x,this._y=c*r+t*this._y,this._z=c*i+t*this._z,this.normalize(),this._onChangeCallback(),this}var u=Math.sqrt(s),l=Math.atan2(u,a),h=Math.sin((1-t)*l)/u,f=Math.sin(t*l)/u;return this._w=o*h+this._w*f,this._x=n*h+this._x*f,this._y=r*h+this._y*f,this._z=i*h+this._z*f,this._onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,t){return void 0===t&&(t=0),this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}});var Ur=new jr,Br=new Ir;function jr(e,t,n){this.x=e||0,this.y=t||0,this.z=n||0}Object.assign(jr.prototype,{isVector3:!0,set:function(e,t,n){return this.x=e,this.y=t,this.z=n,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,t){return void 0!==t?(console.warn("Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this},sub:function(e,t){return void 0!==t?(console.warn("Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this},multiply:function(e,t){return void 0!==t?(console.warn("Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this},applyEuler:function(e){return e&&e.isEuler||console.error("Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Br.setFromEuler(e))},applyAxisAngle:function(e,t){return this.applyQuaternion(Br.setFromAxisAngle(e,t))},applyMatrix3:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6]*r,this.y=i[1]*t+i[4]*n+i[7]*r,this.z=i[2]*t+i[5]*n+i[8]*r,this},applyNormalMatrix:function(e){return this.applyMatrix3(e).normalize()},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements,o=1/(i[3]*t+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*t+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*t+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*t+i[6]*n+i[10]*r+i[14])*o,this},applyQuaternion:function(e){var t=this.x,n=this.y,r=this.z,i=e.x,o=e.y,a=e.z,s=e.w,c=s*t+o*r-a*n,u=s*n+a*t-i*r,l=s*r+i*n-o*t,h=-i*t-o*n-a*r;return this.x=c*s+h*-i+u*-a-l*-o,this.y=u*s+h*-o+l*-i-c*-a,this.z=l*s+h*-a+c*-o-u*-i,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){var t=this.x,n=this.y,r=this.z,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r,this.y=i[1]*t+i[5]*n+i[9]*r,this.z=i[2]*t+i[6]*n+i[10]*r,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},cross:function(e,t){return void 0!==t?(console.warn("Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)},crossVectors:function(e,t){var n=e.x,r=e.y,i=e.z,o=t.x,a=t.y,s=t.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this},projectOnVector:function(e){var t=e.lengthSq();if(0===t)return this.set(0,0,0);var n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)},projectOnPlane:function(e){return Ur.copy(this).projectOnVector(e),this.sub(Ur)},reflect:function(e){return this.sub(Ur.copy(e).multiplyScalar(2*this.dot(e)))},angleTo:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;var n=this.dot(e)/t;return Math.acos(Fr.clamp(n,-1,1))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this},setFromMatrixPosition:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this},setFromMatrixColumn:function(e,t){return this.fromArray(e.elements,4*t)},setFromMatrix3Column:function(e,t){return this.fromArray(e.elements,3*t)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}});var zr=new jr,Vr=new Yr,Gr=new jr(0,0,0),Wr=new jr(1,1,1),Hr=new jr,qr=new jr,Xr=new jr;function Yr(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("Matrix4: the constructor no longer reads arguments. use .set() instead.")}function Zr(){}Object.assign(Yr.prototype,{isMatrix4:!0,set:function(e,t,n,r,i,o,a,s,c,u,l,h,f,d,p,m){var v=this.elements;return v[0]=e,v[4]=t,v[8]=n,v[12]=r,v[1]=i,v[5]=o,v[9]=a,v[13]=s,v[2]=c,v[6]=u,v[10]=l,v[14]=h,v[3]=f,v[7]=d,v[11]=p,v[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Yr).fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this},copyPosition:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this},extractBasis:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this},extractRotation:function(e){var t=this.elements,n=e.elements,r=1/zr.setFromMatrixColumn(e,0).length(),i=1/zr.setFromMatrixColumn(e,1).length(),o=1/zr.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*i,t[5]=n[5]*i,t[6]=n[6]*i,t[7]=0,t[8]=n[8]*o,t[9]=n[9]*o,t[10]=n[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromEuler:function(e){e&&e.isEuler||console.error("Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,r=e.y,i=e.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(r),c=Math.sin(r),u=Math.cos(i),l=Math.sin(i);if("XYZ"===e.order){var h=o*u,f=o*l,d=a*u,p=a*l;t[0]=s*u,t[4]=-s*l,t[8]=c,t[1]=f+d*c,t[5]=h-p*c,t[9]=-a*s,t[2]=p-h*c,t[6]=d+f*c,t[10]=o*s}else if("YXZ"===e.order){var m=s*u,v=s*l,g=c*u,y=c*l;t[0]=m+y*a,t[4]=g*a-v,t[8]=o*c,t[1]=o*l,t[5]=o*u,t[9]=-a,t[2]=v*a-g,t[6]=y+m*a,t[10]=o*s}else if("ZXY"===e.order)m=s*u,v=s*l,g=c*u,y=c*l,t[0]=m-y*a,t[4]=-o*l,t[8]=g+v*a,t[1]=v+g*a,t[5]=o*u,t[9]=y-m*a,t[2]=-o*c,t[6]=a,t[10]=o*s;else if("ZYX"===e.order)h=o*u,f=o*l,d=a*u,p=a*l,t[0]=s*u,t[4]=d*c-f,t[8]=h*c+p,t[1]=s*l,t[5]=p*c+h,t[9]=f*c-d,t[2]=-c,t[6]=a*s,t[10]=o*s;else if("YZX"===e.order){var b=o*s,_=o*c,w=a*s,x=a*c;t[0]=s*u,t[4]=x-b*l,t[8]=w*l+_,t[1]=l,t[5]=o*u,t[9]=-a*u,t[2]=-c*u,t[6]=_*l+w,t[10]=b-x*l}else"XZY"===e.order&&(b=o*s,_=o*c,w=a*s,x=a*c,t[0]=s*u,t[4]=-l,t[8]=c*u,t[1]=b*l+x,t[5]=o*u,t[9]=_*l-w,t[2]=w*l-_,t[6]=a*u,t[10]=x*l+b);return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this},makeRotationFromQuaternion:function(e){return this.compose(Gr,e,Wr)},lookAt:function(e,t,n){var r=this.elements;return Xr.subVectors(e,t),0===Xr.lengthSq()&&(Xr.z=1),Xr.normalize(),Hr.crossVectors(n,Xr),0===Hr.lengthSq()&&(1===Math.abs(n.z)?Xr.x+=1e-4:Xr.z+=1e-4,Xr.normalize(),Hr.crossVectors(n,Xr)),Hr.normalize(),qr.crossVectors(Xr,Hr),r[0]=Hr.x,r[4]=qr.x,r[8]=Xr.x,r[1]=Hr.y,r[5]=qr.y,r[9]=Xr.y,r[2]=Hr.z,r[6]=qr.z,r[10]=Xr.z,this},multiply:function(e,t){return void 0!==t?(console.warn("Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,r=t.elements,i=this.elements,o=n[0],a=n[4],s=n[8],c=n[12],u=n[1],l=n[5],h=n[9],f=n[13],d=n[2],p=n[6],m=n[10],v=n[14],g=n[3],y=n[7],b=n[11],_=n[15],w=r[0],x=r[4],S=r[8],E=r[12],M=r[1],C=r[5],T=r[9],A=r[13],P=r[2],L=r[6],R=r[10],k=r[14],N=r[3],O=r[7],D=r[11],F=r[15];return i[0]=o*w+a*M+s*P+c*N,i[4]=o*x+a*C+s*L+c*O,i[8]=o*S+a*T+s*R+c*D,i[12]=o*E+a*A+s*k+c*F,i[1]=u*w+l*M+h*P+f*N,i[5]=u*x+l*C+h*L+f*O,i[9]=u*S+l*T+h*R+f*D,i[13]=u*E+l*A+h*k+f*F,i[2]=d*w+p*M+m*P+v*N,i[6]=d*x+p*C+m*L+v*O,i[10]=d*S+p*T+m*R+v*D,i[14]=d*E+p*A+m*k+v*F,i[3]=g*w+y*M+b*P+_*N,i[7]=g*x+y*C+b*L+_*O,i[11]=g*S+y*T+b*R+_*D,i[15]=g*E+y*A+b*k+_*F,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],i=e[12],o=e[1],a=e[5],s=e[9],c=e[13],u=e[2],l=e[6],h=e[10],f=e[14];return e[3]*(+i*s*l-r*c*l-i*a*h+n*c*h+r*a*f-n*s*f)+e[7]*(+t*s*f-t*c*h+i*o*h-r*o*f+r*c*u-i*s*u)+e[11]*(+t*c*l-t*a*f-i*o*l+n*o*f+i*a*u-n*c*u)+e[15]*(-r*a*u-t*s*l+t*a*h+r*o*l-n*o*h+n*s*u)},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this},setPosition:function(e,t,n){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this},getInverse:function(e,t){var n=this.elements,r=e.elements,i=r[0],o=r[1],a=r[2],s=r[3],c=r[4],u=r[5],l=r[6],h=r[7],f=r[8],d=r[9],p=r[10],m=r[11],v=r[12],g=r[13],y=r[14],b=r[15],_=d*y*h-g*p*h+g*l*m-u*y*m-d*l*b+u*p*b,w=v*p*h-f*y*h-v*l*m+c*y*m+f*l*b-c*p*b,x=f*g*h-v*d*h+v*u*m-c*g*m-f*u*b+c*d*b,S=v*d*l-f*g*l-v*u*p+c*g*p+f*u*y-c*d*y,E=i*_+o*w+a*x+s*S;if(0===E){var M="Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(M);return console.warn(M),this.identity()}var C=1/E;return n[0]=_*C,n[1]=(g*p*s-d*y*s-g*a*m+o*y*m+d*a*b-o*p*b)*C,n[2]=(u*y*s-g*l*s+g*a*h-o*y*h-u*a*b+o*l*b)*C,n[3]=(d*l*s-u*p*s-d*a*h+o*p*h+u*a*m-o*l*m)*C,n[4]=w*C,n[5]=(f*y*s-v*p*s+v*a*m-i*y*m-f*a*b+i*p*b)*C,n[6]=(v*l*s-c*y*s-v*a*h+i*y*h+c*a*b-i*l*b)*C,n[7]=(c*p*s-f*l*s+f*a*h-i*p*h-c*a*m+i*l*m)*C,n[8]=x*C,n[9]=(v*d*s-f*g*s-v*o*m+i*g*m+f*o*b-i*d*b)*C,n[10]=(c*g*s-v*u*s+v*o*h-i*g*h-c*o*b+i*u*b)*C,n[11]=(f*u*s-c*d*s-f*o*h+i*d*h+c*o*m-i*u*m)*C,n[12]=S*C,n[13]=(f*g*a-v*d*a+v*o*p-i*g*p-f*o*y+i*d*y)*C,n[14]=(v*u*a-c*g*a-v*o*l+i*g*l+c*o*y-i*u*y)*C,n[15]=(c*d*a-f*u*a+f*o*l-i*d*l-c*o*p+i*u*p)*C,this},scale:function(e){var t=this.elements,n=e.x,r=e.y,i=e.z;return t[0]*=n,t[4]*=r,t[8]*=i,t[1]*=n,t[5]*=r,t[9]*=i,t[2]*=n,t[6]*=r,t[10]*=i,t[3]*=n,t[7]*=r,t[11]*=i,this},getMaxScaleOnAxis:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))},makeTranslation:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this},makeRotationX:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this},makeRotationY:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this},makeRotationZ:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=1-n,o=e.x,a=e.y,s=e.z,c=i*o,u=i*a;return this.set(c*o+n,c*a-r*s,c*s+r*a,0,c*a+r*s,u*a+n,u*s-r*o,0,c*s-r*a,u*s+r*o,i*s*s+n,0,0,0,0,1),this},makeScale:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this},compose:function(e,t,n){var r=this.elements,i=t._x,o=t._y,a=t._z,s=t._w,c=i+i,u=o+o,l=a+a,h=i*c,f=i*u,d=i*l,p=o*u,m=o*l,v=a*l,g=s*c,y=s*u,b=s*l,_=n.x,w=n.y,x=n.z;return r[0]=(1-(p+v))*_,r[1]=(f+b)*_,r[2]=(d-y)*_,r[3]=0,r[4]=(f-b)*w,r[5]=(1-(h+v))*w,r[6]=(m+g)*w,r[7]=0,r[8]=(d+y)*x,r[9]=(m-g)*x,r[10]=(1-(h+p))*x,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this},decompose:function(e,t,n){var r=this.elements,i=zr.set(r[0],r[1],r[2]).length(),o=zr.set(r[4],r[5],r[6]).length(),a=zr.set(r[8],r[9],r[10]).length();this.determinant()<0&&(i=-i),e.x=r[12],e.y=r[13],e.z=r[14],Vr.copy(this);var s=1/i,c=1/o,u=1/a;return Vr.elements[0]*=s,Vr.elements[1]*=s,Vr.elements[2]*=s,Vr.elements[4]*=c,Vr.elements[5]*=c,Vr.elements[6]*=c,Vr.elements[8]*=u,Vr.elements[9]*=u,Vr.elements[10]*=u,t.setFromRotationMatrix(Vr),n.x=i,n.y=o,n.z=a,this},makePerspective:function(e,t,n,r,i,o){void 0===o&&console.warn("Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*i/(t-e),c=2*i/(n-r),u=(t+e)/(t-e),l=(n+r)/(n-r),h=-(o+i)/(o-i),f=-2*o*i/(o-i);return a[0]=s,a[4]=0,a[8]=u,a[12]=0,a[1]=0,a[5]=c,a[9]=l,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(e,t,n,r,i,o){var a=this.elements,s=1/(t-e),c=1/(n-r),u=1/(o-i),l=(t+e)*s,h=(n+r)*c,f=(o+i)*u;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-l,a[1]=0,a[5]=2*c,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*u,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<16;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}),Object.assign(Zr.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),r=0,i=n.length;r<i;r++)n[r].call(this,e)}}}});var Jr=new Yr,Kr=new Ir;function $r(e,t,n,r){this._x=e||0,this._y=t||0,this._z=n||0,this._order=r||$r.DefaultOrder}function Qr(){this.mask=1}function ei(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("Matrix3: the constructor no longer reads arguments. use .set() instead.")}$r.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],$r.DefaultOrder="XYZ",Object.defineProperties($r.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}}}),Object.assign($r.prototype,{isEuler:!0,set:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._order=r||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this},setFromRotationMatrix:function(e,t,n){var r=Fr.clamp,i=e.elements,o=i[0],a=i[4],s=i[8],c=i[1],u=i[5],l=i[9],h=i[2],f=i[6],d=i[10];return"XYZ"===(t=t||this._order)?(this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-l,d),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,u),this._z=0)):"YXZ"===t?(this._x=Math.asin(-r(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(s,d),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-h,o),this._z=0)):"ZXY"===t?(this._x=Math.asin(r(f,-1,1)),Math.abs(f)<.9999999?(this._y=Math.atan2(-h,d),this._z=Math.atan2(-a,u)):(this._y=0,this._z=Math.atan2(c,o))):"ZYX"===t?(this._y=Math.asin(-r(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(f,d),this._z=Math.atan2(c,o)):(this._x=0,this._z=Math.atan2(-a,u))):"YZX"===t?(this._z=Math.asin(r(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-l,u),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(s,d))):"XZY"===t?(this._z=Math.asin(-r(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(f,u),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-l,d),this._y=0)):console.warn("Euler: .setFromRotationMatrix() given unsupported order: "+t),this._order=t,!1!==n&&this._onChangeCallback(),this},setFromQuaternion:function(e,t,n){return Jr.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Jr,t,n)},setFromVector3:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)},reorder:function(e){return Kr.setFromEuler(this),this.setFromQuaternion(Kr,e)},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new jr(this._x,this._y,this._z)},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}}),Object.assign(Qr.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask|=1<<e|0},enableAll:function(){this.mask=-1},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},disableAll:function(){this.mask=0},test:function(e){return 0!=(this.mask&e.mask)}}),Object.assign(ei.prototype,{isMatrix3:!0,set:function(e,t,n,r,i,o,a,s,c){var u=this.elements;return u[0]=e,u[1]=r,u[2]=a,u[3]=t,u[4]=i,u[5]=s,u[6]=n,u[7]=o,u[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this},setFromMatrix4:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,t){var n=e.elements,r=t.elements,i=this.elements,o=n[0],a=n[3],s=n[6],c=n[1],u=n[4],l=n[7],h=n[2],f=n[5],d=n[8],p=r[0],m=r[3],v=r[6],g=r[1],y=r[4],b=r[7],_=r[2],w=r[5],x=r[8];return i[0]=o*p+a*g+s*_,i[3]=o*m+a*y+s*w,i[6]=o*v+a*b+s*x,i[1]=c*p+u*g+l*_,i[4]=c*m+u*y+l*w,i[7]=c*v+u*b+l*x,i[2]=h*p+f*g+d*_,i[5]=h*m+f*y+d*w,i[8]=h*v+f*b+d*x,this},multiplyScalar:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this},determinant:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],i=e[3],o=e[4],a=e[5],s=e[6],c=e[7],u=e[8];return t*o*u-t*a*c-n*i*u+n*a*s+r*i*c-r*o*s},getInverse:function(e,t){e&&e.isMatrix4&&console.error("Matrix3: .getInverse() no longer takes a Matrix4 argument.");var n=e.elements,r=this.elements,i=n[0],o=n[1],a=n[2],s=n[3],c=n[4],u=n[5],l=n[6],h=n[7],f=n[8],d=f*c-u*h,p=u*l-f*s,m=h*s-c*l,v=i*d+o*p+a*m;if(0===v){var g="Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===t)throw new Error(g);return console.warn(g),this.identity()}var y=1/v;return r[0]=d*y,r[1]=(a*h-f*o)*y,r[2]=(u*o-a*c)*y,r[3]=p*y,r[4]=(f*i-a*l)*y,r[5]=(a*s-u*i)*y,r[6]=m*y,r[7]=(o*l-h*i)*y,r[8]=(c*i-o*s)*y,this},transpose:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this},setUvTransform:function(e,t,n,r,i,o,a){var s=Math.cos(i),c=Math.sin(i);this.set(n*s,n*c,-n*(s*o+c*a)+o+e,-r*c,r*s,-r*(-c*o+s*a)+a+t,0,0,1)},scale:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this},rotate:function(e){var t=Math.cos(e),n=Math.sin(e),r=this.elements,i=r[0],o=r[3],a=r[6],s=r[1],c=r[4],u=r[7];return r[0]=t*i+n*s,r[3]=t*o+n*c,r[6]=t*a+n*u,r[1]=-n*i+t*s,r[4]=-n*o+t*c,r[7]=-n*a+t*u,this},translate:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this},equals:function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0},fromArray:function(e,t){void 0===t&&(t=0);for(var n=0;n<9;n++)this.elements[n]=e[n+t];return this},toArray:function(e,t){void 0===e&&(e=[]),void 0===t&&(t=0);var n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}});var li=0,ti=new jr,ni=new Ir,ri=new Yr,ii=new jr,oi=new jr,ai=new jr,si=new Ir,ci=new jr(1,0,0),ui=new jr(0,1,0),hi=new jr(0,0,1),fi={type:"added"},di={type:"removed"};function pi(){Object.defineProperty(this,"id",{value:li++}),this.uuid=Fr.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=pi.DefaultUp.clone();var e=new jr,t=new $r,n=new Ir,r=new jr(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Yr},normalMatrix:{value:new ei}}),this.matrix=new Yr,this.matrixWorld=new Yr,this.matrixAutoUpdate=pi.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Qr,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function mi(){pi.call(this),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function vi(){pi.call(this),this.type="Camera",this.matrixWorldInverse=new Yr,this.projectionMatrix=new Yr,this.projectionMatrixInverse=new Yr}function gi(e,t,n,r,i,o){vi.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=void 0!==e?e:-1,this.right=void 0!==t?t:1,this.top=void 0!==n?n:1,this.bottom=void 0!==r?r:-1,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}pi.DefaultUp=new jr(0,1,0),pi.DefaultMatrixAutoUpdate=!0,pi.prototype=Object.assign(Object.create(Zr.prototype),{constructor:pi,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,t){return ni.setFromAxisAngle(e,t),this.quaternion.multiply(ni),this},rotateOnWorldAxis:function(e,t){return ni.setFromAxisAngle(e,t),this.quaternion.premultiply(ni),this},rotateX:function(e){return this.rotateOnAxis(ci,e)},rotateY:function(e){return this.rotateOnAxis(ui,e)},rotateZ:function(e){return this.rotateOnAxis(hi,e)},translateOnAxis:function(e,t){return ti.copy(e).applyQuaternion(this.quaternion),this.position.add(ti.multiplyScalar(t)),this},translateX:function(e){return this.translateOnAxis(ci,e)},translateY:function(e){return this.translateOnAxis(ui,e)},translateZ:function(e){return this.translateOnAxis(hi,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(ri.getInverse(this.matrixWorld))},lookAt:function(e,t,n){e.isVector3?ii.copy(e):ii.set(e,t,n);var r=this.parent;this.updateWorldMatrix(!0,!1),oi.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ri.lookAt(oi,ii,this.up):ri.lookAt(ii,oi,this.up),this.quaternion.setFromRotationMatrix(ri),r&&(ri.extractRotation(r.matrixWorld),ni.setFromRotationMatrix(ri),this.quaternion.premultiply(ni.inverse()))},add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(fi)):console.error("Object3D.add: object not an instance of Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(di)),this},attach:function(e){return this.updateWorldMatrix(!0,!1),ri.getInverse(this.matrixWorld),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),ri.multiply(e.parent.matrixWorld)),e.applyMatrix4(ri),e.updateWorldMatrix(!1,!1),this.add(e),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n].getObjectByProperty(e,t);if(void 0!==i)return i}},getWorldPosition:function(e){return void 0===e&&(console.warn("Object3D: .getWorldPosition() target is now required"),e=new jr),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return void 0===e&&(console.warn("Object3D: .getWorldQuaternion() target is now required"),e=new Ir),this.updateMatrixWorld(!0),this.matrixWorld.decompose(oi,e,ai),e},getWorldScale:function(e){return void 0===e&&(console.warn("Object3D: .getWorldScale() target is now required"),e=new jr),this.updateMatrixWorld(!0),this.matrixWorld.decompose(oi,si,e),e},getWorldDirection:function(e){void 0===e&&(console.warn("Object3D: .getWorldDirection() target is now required"),e=new jr),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var r=this.children,i=0,o=r.length;i<o;i++)r[i].updateWorldMatrix(!1,!0)},toJSON:function(e){var t=void 0===e||"string"==typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function i(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){r.geometry=i(e.geometries,this.geometry);var o=this.geometry.parameters;if(void 0!==o&&void 0!==o.shapes){var a=o.shapes;if(Array.isArray(a))for(var s=0,c=a.length;s<c;s++){var u=a[s];i(e.shapes,u)}else i(e.shapes,a)}}if(void 0!==this.material)if(Array.isArray(this.material)){var l=[];for(s=0,c=this.material.length;s<c;s++)l.push(i(e.materials,this.material[s]));r.material=l}else r.material=i(e.materials,this.material);if(this.children.length>0)for(r.children=[],s=0;s<this.children.length;s++)r.children.push(this.children[s].toJSON(e).object);if(t){var h=m(e.geometries),f=m(e.materials),d=m(e.textures),p=m(e.images);a=m(e.shapes),h.length>0&&(n.geometries=h),f.length>0&&(n.materials=f),d.length>0&&(n.textures=d),p.length>0&&(n.images=p),a.length>0&&(n.shapes=a)}return n.object=r,n;function m(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e,t){if(void 0===t&&(t=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this}}),mi.prototype=Object.assign(Object.create(pi.prototype),{constructor:mi,isScene:!0,copy:function(e,t){return pi.prototype.copy.call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var t=pi.prototype.toJSON.call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.environment&&(t.object.environment=this.environment.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t},dispose:function(){this.dispatchEvent({type:"dispose"})}}),vi.prototype=Object.assign(Object.create(pi.prototype),{constructor:vi,isCamera:!0,copy:function(e,t){return pi.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("Camera: .getWorldDirection() target is now required"),e=new jr),this.updateMatrixWorld(!0);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){pi.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(e,t){pi.prototype.updateWorldMatrix.call(this,e,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),gi.prototype=Object.assign(Object.create(vi.prototype),{constructor:gi,isOrthographicCamera:!0,copy:function(e,t){return vi.prototype.copy.call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this},setViewOffset:function(e,t,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-e,o=n+e,a=r+t,s=r-t;if(null!==this.view&&this.view.enabled){var c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o=(i+=c*this.view.offsetX)+c*this.view.width,s=(a-=u*this.view.offsetY)-u*this.view.height}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=pi.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}});var yi,bi=1001,_i=1003,wi=1006,xi=1015,Si=1022,Ei=1023;function Mi(e,t){this.x=e||0,this.y=t||0}Object.defineProperties(Mi.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),Object.assign(Mi.prototype,{isVector2:!0,set:function(e,t){return this.x=e,this.y=t,this},setScalar:function(e){return this.x=e,this.y=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,t){return void 0!==t?(console.warn("Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this},sub:function(e,t){return void 0!==t?(console.warn("Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var e=Math.atan2(this.y,this.x);return e<0&&(e+=2*Math.PI),e},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this},rotateAround:function(e,t){var n=Math.cos(t),r=Math.sin(t),i=this.x-e.x,o=this.y-e.y;return this.x=i*n-o*r+e.x,this.y=i*r+o*n+e.y,this}});var Ci=function(e){var t;if("undefined"==typeof HTMLCanvasElement)return e.src;if(e instanceof HTMLCanvasElement)t=e;else{void 0===yi&&(yi=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),yi.width=e.width,yi.height=e.height;var n=yi.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=yi}return t.width>2048||t.height>2048?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")},Ti=0;function Ai(e,t,n,r,i,o,a,s,c,u){Object.defineProperty(this,"id",{value:Ti++}),this.uuid=Fr.generateUUID(),this.name="",this.image=void 0!==e?e:Ai.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==t?t:Ai.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:bi,this.wrapT=void 0!==r?r:bi,this.magFilter=void 0!==i?i:wi,this.minFilter=void 0!==o?o:1008,this.anisotropy=void 0!==c?c:1,this.format=void 0!==a?a:Ei,this.internalFormat=null,this.type=void 0!==s?s:1009,this.offset=new Mi(0,0),this.repeat=new Mi(1,1),this.center=new Mi(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ei,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==u?u:3e3,this.version=0,this.onUpdate=null}function Pi(e,t,n,r,i,o,a,s,c,u,l,h){Ai.call(this,null,o,a,s,c,u,r,i,l,h),this.image={data:e||null,width:t||1,height:n||1},this.magFilter=void 0!==c?c:_i,this.minFilter=void 0!==u?u:_i,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.needsUpdate=!0}Ai.DEFAULT_IMAGE=void 0,Ai.DEFAULT_MAPPING=300,Ai.prototype=Object.assign(Object.create(Zr.prototype),{constructor:Ai,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=Fr.generateUUID()),!t&&void 0===e.images[r.uuid]){var i;if(Array.isArray(r)){i=[];for(var o=0,a=r.length;o<a;o++)i.push(Ci(r[o]))}else i=Ci(r);e.images[r.uuid]={uuid:r.uuid,url:i}}n.image=r.uuid}return t||(e.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case 1e3:e.x=e.x-Math.floor(e.x);break;case bi:e.x=e.x<0?0:1;break;case 1002:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case 1e3:e.y=e.y-Math.floor(e.y);break;case bi:e.y=e.y<0?0:1;break;case 1002:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(Ai.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Pi.prototype=Object.create(Ai.prototype),Pi.prototype.constructor=Pi,Pi.prototype.isDataTexture=!0;var Li=[new jr,new jr,new jr,new jr,new jr,new jr,new jr,new jr],Ri=new jr,ki=new Gi,Ni=new jr,Oi=new jr,Di=new jr,Fi=new jr,Ii=new jr,Ui=new jr,Bi=new jr,ji=new jr,zi=new jr,Vi=new jr;function Gi(e,t){this.min=void 0!==e?e:new jr(1/0,1/0,1/0),this.max=void 0!==t?t:new jr(-1/0,-1/0,-1/0)}function Wi(e,t,n,r,i){var o,a;for(o=0,a=e.length-3;o<=a;o+=3){Vi.fromArray(e,o);var s=i.x*Math.abs(Vi.x)+i.y*Math.abs(Vi.y)+i.z*Math.abs(Vi.z),c=t.dot(Vi),u=n.dot(Vi),l=r.dot(Vi);if(Math.max(-Math.max(c,u,l),Math.min(c,u,l))>s)return!1}return!0}Object.assign(Gi.prototype,{isBox3:!0,set:function(e,t){return this.min.copy(e),this.max.copy(t),this},setFromArray:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,c=e.length;s<c;s+=3){var u=e[s],l=e[s+1],h=e[s+2];u<t&&(t=u),l<n&&(n=l),h<r&&(r=h),u>i&&(i=u),l>o&&(o=l),h>a&&(a=h)}return this.min.set(t,n,r),this.max.set(i,o,a),this},setFromBufferAttribute:function(e){for(var t=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,c=e.count;s<c;s++){var u=e.getX(s),l=e.getY(s),h=e.getZ(s);u<t&&(t=u),l<n&&(n=l),h<r&&(r=h),u>i&&(i=u),l>o&&(o=l),h>a&&(a=h)}return this.min.set(t,n,r),this.max.set(i,o,a),this},setFromPoints:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this},setFromCenterAndSize:function(e,t){var n=Ri.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this},setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return void 0===e&&(console.warn("Box3: .getCenter() target is now required"),e=new jr),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return void 0===e&&(console.warn("Box3: .getSize() target is now required"),e=new jr),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(e){e.updateWorldMatrix(!1,!1);var t=e.geometry;void 0!==t&&(null===t.boundingBox&&t.computeBoundingBox(),ki.copy(t.boundingBox),ki.applyMatrix4(e.matrixWorld),this.expandByPoint(ki.min),this.expandByPoint(ki.max));for(var n=e.children,r=0,i=n.length;r<i;r++)this.expandByObject(n[r]);return this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,t){return void 0===t&&(console.warn("Box3: .getParameter() target is now required"),t=new jr),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(e){return this.clampPoint(e.center,Ri),Ri.distanceToSquared(e.center)<=e.radius*e.radius},intersectsPlane:function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant},intersectsTriangle:function(e){if(this.isEmpty())return!1;this.getCenter(Bi),ji.subVectors(this.max,Bi),Ni.subVectors(e.a,Bi),Oi.subVectors(e.b,Bi),Di.subVectors(e.c,Bi),Fi.subVectors(Oi,Ni),Ii.subVectors(Di,Oi),Ui.subVectors(Ni,Di);var t=[0,-Fi.z,Fi.y,0,-Ii.z,Ii.y,0,-Ui.z,Ui.y,Fi.z,0,-Fi.x,Ii.z,0,-Ii.x,Ui.z,0,-Ui.x,-Fi.y,Fi.x,0,-Ii.y,Ii.x,0,-Ui.y,Ui.x,0];return!!Wi(t,Ni,Oi,Di,ji)&&!!Wi(t=[1,0,0,0,1,0,0,0,1],Ni,Oi,Di,ji)&&(zi.crossVectors(Fi,Ii),Wi(t=[zi.x,zi.y,zi.z],Ni,Oi,Di,ji))},clampPoint:function(e,t){return void 0===t&&(console.warn("Box3: .clampPoint() target is now required"),t=new jr),t.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return Ri.copy(e).clamp(this.min,this.max).sub(e).length()},getBoundingSphere:function(e){return void 0===e&&console.error("Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(Ri).length(),e},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(e){return this.isEmpty()||(Li[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),Li[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),Li[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),Li[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),Li[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),Li[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),Li[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),Li[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(Li)),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var Hi=new Gi;function qi(e,t){this.center=void 0!==e?e:new jr,this.radius=void 0!==t?t:0}Object.assign(qi.prototype,{set:function(e,t){return this.center.copy(e),this.radius=t,this},setFromPoints:function(e,t){var n=this.center;void 0!==t?n.copy(t):Hi.setFromPoints(e).getCenter(n);for(var r=0,i=0,o=e.length;i<o;i++)r=Math.max(r,n.distanceToSquared(e[i]));return this.radius=Math.sqrt(r),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},empty:function(){return this.radius<=0},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,t){var n=this.center.distanceToSquared(e);return void 0===t&&(console.warn("Sphere: .clampPoint() target is now required"),t=new jr),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t},getBoundingBox:function(e){return void 0===e&&(console.warn("Sphere: .getBoundingBox() target is now required"),e=new Gi),e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}});var Xi=new jr,Yi=new jr,Zi=new ei;function Ji(e,t){this.normal=void 0!==e?e:new jr(1,0,0),this.constant=void 0!==t?t:0}Object.assign(Ji.prototype,{isPlane:!0,set:function(e,t){return this.normal.copy(e),this.constant=t,this},setComponents:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this},setFromCoplanarPoints:function(e,t,n){var r=Xi.subVectors(n,t).cross(Yi.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,t){return void 0===t&&(console.warn("Plane: .projectPoint() target is now required"),t=new jr),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(e,t){void 0===t&&(console.warn("Plane: .intersectLine() target is now required"),t=new jr);var n=e.delta(Xi),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):void 0;var i=-(e.start.dot(this.normal)+this.constant)/r;return i<0||i>1?void 0:t.copy(n).multiplyScalar(i).add(e.start)},intersectsLine:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return void 0===e&&(console.warn("Plane: .coplanarPoint() target is now required"),e=new jr),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(e,t){var n=t||Zi.getNormalMatrix(e),r=this.coplanarPoint(Xi).applyMatrix4(e),i=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(i),this},translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}});var Ki=new qi,$i=new jr;function Qi(e,t,n,r,i,o){this.planes=[void 0!==e?e:new Ji,void 0!==t?t:new Ji,void 0!==n?n:new Ji,void 0!==r?r:new Ji,void 0!==i?i:new Ji,void 0!==o?o:new Ji]}Object.assign(Qi.prototype,{set:function(e,t,n,r,i,o){var a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this},setFromProjectionMatrix:function(e){var t=this.planes,n=e.elements,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],c=n[5],u=n[6],l=n[7],h=n[8],f=n[9],d=n[10],p=n[11],m=n[12],v=n[13],g=n[14],y=n[15];return t[0].setComponents(a-r,l-s,p-h,y-m).normalize(),t[1].setComponents(a+r,l+s,p+h,y+m).normalize(),t[2].setComponents(a+i,l+c,p+f,y+v).normalize(),t[3].setComponents(a-i,l-c,p-f,y-v).normalize(),t[4].setComponents(a-o,l-u,p-d,y-g).normalize(),t[5].setComponents(a+o,l+u,p+d,y+g).normalize(),this},intersectsObject:function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),Ki.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Ki)},intersectsSprite:function(e){return Ki.center.set(0,0,0),Ki.radius=.7071067811865476,Ki.applyMatrix4(e.matrixWorld),this.intersectsSphere(Ki)},intersectsSphere:function(e){for(var t=this.planes,n=e.center,r=-e.radius,i=0;i<6;i++)if(t[i].distanceToPoint(n)<r)return!1;return!0},intersectsBox:function(e){for(var t=this.planes,n=0;n<6;n++){var r=t[n];if($i.x=r.normal.x>0?e.max.x:e.min.x,$i.y=r.normal.y>0?e.max.y:e.min.y,$i.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint($i)<0)return!1}return!0},containsPoint:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}});var eo={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},to={h:0,s:0,l:0},no={h:0,s:0,l:0};function ro(e,t,n){return void 0===t&&void 0===n?this.set(e):this.setRGB(e,t,n)}function io(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function oo(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function ao(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}Object.assign(ro.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this},setScalar:function(e){return this.r=e,this.g=e,this.b=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this},setRGB:function(e,t,n){return this.r=e,this.g=t,this.b=n,this},setHSL:function(e,t,n){if(e=Fr.euclideanModulo(e,1),t=Fr.clamp(t,0,1),n=Fr.clamp(n,0,1),0===t)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+t):n+t-n*t,i=2*n-r;this.r=io(i,r,e+1/3),this.g=io(i,r,e),this.b=io(i,r,e-1/3)}return this},setStyle:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("Color: Alpha component of "+e+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var r,i=n[1],o=n[2];switch(i){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,t(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,t(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var a=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,c=parseInt(r[3],10)/100;return t(r[5]),this.setHSL(a,s,c)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(e)){var u=n[1],l=u.length;if(3===l)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6===l)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this},setColorName:function(e){var t=eo[e];return void 0!==t?this.setHex(t):console.warn("Color: Unknown color "+e),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,t){return void 0===t&&(t=2),this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this},copyLinearToGamma:function(e,t){void 0===t&&(t=2);var n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(e){return this.r=oo(e.r),this.g=oo(e.g),this.b=oo(e.b),this},copyLinearToSRGB:function(e){return this.r=ao(e.r),this.g=ao(e.g),this.b=ao(e.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){void 0===e&&(console.warn("Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,n,r=this.r,i=this.g,o=this.b,a=Math.max(r,i,o),s=Math.min(r,i,o),c=(s+a)/2;if(s===a)t=0,n=0;else{var u=a-s;switch(n=c<=.5?u/(a+s):u/(2-a-s),a){case r:t=(i-o)/u+(i<o?6:0);break;case i:t=(o-r)/u+2;break;case o:t=(r-i)/u+4}t/=6}return e.h=t,e.s=n,e.l=c,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,t,n){return this.getHSL(to),to.h+=e,to.s+=t,to.l+=n,this.setHSL(to.h,to.s,to.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this},lerpHSL:function(e,t){this.getHSL(to),e.getHSL(no);var n=Fr.lerp(to.h,no.h,t),r=Fr.lerp(to.s,no.s,t),i=Fr.lerp(to.l,no.l,t);return this.setHSL(n,r,i),this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,t){return void 0===t&&(t=0),this.r=e[t],this.g=e[t+1],this.b=e[t+2],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e},toJSON:function(){return this.getHex()}}),ro.NAMES=eo;var so={common:{diffuse:{value:new ro(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new ei},uv2Transform:{value:new ei},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Mi(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new ro(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new ro(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new ei}},sprite:{diffuse:{value:new ro(15658734)},opacity:{value:1},center:{value:new Mi(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new ei}}};function co(e,t,n,r){this.x=e||0,this.y=t||0,this.z=n||0,this.w=void 0!==r?r:1}function uo(){var e=null,t=!1,n=null;function r(i,o){!1!==t&&(n(i,o),e.requestAnimationFrame(r))}return{start:function(){!0!==t&&null!==n&&(e.requestAnimationFrame(r),t=!0)},stop:function(){t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function lo(e,t){var n=t.isWebGL2,r=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var n=r.get(t);n&&(e.deleteBuffer(n.buffer),r.delete(t))},update:function(t,i){t.isInterleavedBufferAttribute&&(t=t.data);var o=r.get(t);void 0===o?r.set(t,function(t,n){var r=t.array,i=t.usage,o=e.createBuffer();e.bindBuffer(n,o),e.bufferData(n,r,i),t.onUploadCallback();var a=e.FLOAT;return r instanceof Float32Array?a=e.FLOAT:r instanceof Float64Array?console.warn("WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?a=e.UNSIGNED_SHORT:r instanceof Int16Array?a=e.SHORT:r instanceof Uint32Array?a=e.UNSIGNED_INT:r instanceof Int32Array?a=e.INT:r instanceof Int8Array?a=e.BYTE:r instanceof Uint8Array&&(a=e.UNSIGNED_BYTE),{buffer:o,type:a,bytesPerElement:r.BYTES_PER_ELEMENT,version:t.version}}(t,i)):o.version<t.version&&(function(t,r,i){var o=r.array,a=r.updateRange;e.bindBuffer(i,t),-1===a.count?e.bufferSubData(i,0,o):(n?e.bufferSubData(i,a.offset*o.BYTES_PER_ELEMENT,o,a.offset,a.count):e.bufferSubData(i,a.offset*o.BYTES_PER_ELEMENT,o.subarray(a.offset,a.offset+a.count)),a.count=-1)}(o.buffer,t,i),o.version=t.version)}}}function ho(e,t,n,r,i,o){this.a=e,this.b=t,this.c=n,this.normal=r&&r.isVector3?r:new jr,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new ro,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==o?o:0}Object.defineProperties(co.prototype,{width:{get:function(){return this.z},set:function(e){this.z=e}},height:{get:function(){return this.w},set:function(e){this.w=e}}}),Object.assign(co.prototype,{isVector4:!0,set:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this},setScalar:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this},add:function(e,t){return void 0!==t?(console.warn("Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this},addScaledVector:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this},sub:function(e,t){return void 0!==t?(console.warn("Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var t=this.x,n=this.y,r=this.z,i=this.w,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*t+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*t+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*t+o[7]*n+o[11]*r+o[15]*i,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this},setAxisAngleFromRotationMatrix:function(e){var t,n,r,i,o=e.elements,a=o[0],s=o[4],c=o[8],u=o[1],l=o[5],h=o[9],f=o[2],d=o[6],p=o[10];if(Math.abs(s-u)<.01&&Math.abs(c-f)<.01&&Math.abs(h-d)<.01){if(Math.abs(s+u)<.1&&Math.abs(c+f)<.1&&Math.abs(h+d)<.1&&Math.abs(a+l+p-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var m=(a+1)/2,v=(l+1)/2,g=(p+1)/2,y=(s+u)/4,b=(c+f)/4,_=(h+d)/4;return m>v&&m>g?m<.01?(n=0,r=.707106781,i=.707106781):(r=y/(n=Math.sqrt(m)),i=b/n):v>g?v<.01?(n=.707106781,r=0,i=.707106781):(n=y/(r=Math.sqrt(v)),i=_/r):g<.01?(n=.707106781,r=.707106781,i=0):(n=b/(i=Math.sqrt(g)),r=_/i),this.set(n,r,i,t),this}var w=Math.sqrt((d-h)*(d-h)+(c-f)*(c-f)+(u-s)*(u-s));return Math.abs(w)<.001&&(w=1),this.x=(d-h)/w,this.y=(c-f)/w,this.z=(u-s)/w,this.w=Math.acos((a+l+p-1)/2),this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this},clampScalar:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this},clampLength:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this},lerpVectors:function(e,t,n){return this.subVectors(t,e).multiplyScalar(n).add(e)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,t){return void 0===t&&(t=0),this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this},toArray:function(e,t){return void 0===e&&(e=[]),void 0===t&&(t=0),e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e},fromBufferAttribute:function(e,t,n){return void 0!==n&&console.warn("Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}}),Object.assign(ho.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var t=0,n=e.vertexNormals.length;t<n;t++)this.vertexNormals[t]=e.vertexNormals[t].clone();for(t=0,n=e.vertexColors.length;t<n;t++)this.vertexColors[t]=e.vertexColors[t].clone();return this}});var fo=0,po=new Yr,mo=new pi,vo=new jr;function go(){Object.defineProperty(this,"id",{value:fo+=2}),this.uuid=Fr.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}go.prototype=Object.assign(Object.create(Zr.prototype),{constructor:go,isGeometry:!0,applyMatrix4:function(e){for(var t=(new ei).getNormalMatrix(e),n=0,r=this.vertices.length;n<r;n++)this.vertices[n].applyMatrix4(e);for(n=0,r=this.faces.length;n<r;n++){var i=this.faces[n];i.normal.applyMatrix3(t).normalize();for(var o=0,a=i.vertexNormals.length;o<a;o++)i.vertexNormals[o].applyMatrix3(t).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(e){return po.makeRotationX(e),this.applyMatrix4(po),this},rotateY:function(e){return po.makeRotationY(e),this.applyMatrix4(po),this},rotateZ:function(e){return po.makeRotationZ(e),this.applyMatrix4(po),this},translate:function(e,t,n){return po.makeTranslation(e,t,n),this.applyMatrix4(po),this},scale:function(e,t,n){return po.makeScale(e,t,n),this.applyMatrix4(po),this},lookAt:function(e){return mo.lookAt(e),mo.updateMatrix(),this.applyMatrix4(mo.matrix),this},fromBufferGeometry:function(e){var t=this,n=null!==e.index?e.index.array:void 0,r=e.attributes;if(void 0===r.position)return console.error("Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var i=r.position.array,o=void 0!==r.normal?r.normal.array:void 0,a=void 0!==r.color?r.color.array:void 0,s=void 0!==r.uv?r.uv.array:void 0,c=void 0!==r.uv2?r.uv2.array:void 0;void 0!==c&&(this.faceVertexUvs[1]=[]);for(var u=0;u<i.length;u+=3)t.vertices.push((new jr).fromArray(i,u)),void 0!==a&&t.colors.push((new ro).fromArray(a,u));function l(e,n,r,i){var u=void 0===a?[]:[t.colors[e].clone(),t.colors[n].clone(),t.colors[r].clone()],l=new ho(e,n,r,void 0===o?[]:[(new jr).fromArray(o,3*e),(new jr).fromArray(o,3*n),(new jr).fromArray(o,3*r)],u,i);t.faces.push(l),void 0!==s&&t.faceVertexUvs[0].push([(new Mi).fromArray(s,2*e),(new Mi).fromArray(s,2*n),(new Mi).fromArray(s,2*r)]),void 0!==c&&t.faceVertexUvs[1].push([(new Mi).fromArray(c,2*e),(new Mi).fromArray(c,2*n),(new Mi).fromArray(c,2*r)])}var h=e.groups;if(h.length>0)for(u=0;u<h.length;u++)for(var f=h[u],d=f.start,p=d,m=d+f.count;p<m;p+=3)void 0!==n?l(n[p],n[p+1],n[p+2],f.materialIndex):l(p,p+1,p+2,f.materialIndex);else if(void 0!==n)for(u=0;u<n.length;u+=3)l(n[u],n[u+1],n[u+2]);else for(u=0;u<i.length/3;u+=3)l(u,u+1,u+2);return this.computeFaceNormals(),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(vo).negate(),this.translate(vo.x,vo.y,vo.z),this},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,t=this.boundingSphere.radius,n=0===t?1:1/t,r=new Yr;return r.set(n,0,0,-n*e.x,0,n,0,-n*e.y,0,0,n,-n*e.z,0,0,0,1),this.applyMatrix4(r),this},computeFaceNormals:function(){for(var e=new jr,t=new jr,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],o=this.vertices[i.a],a=this.vertices[i.b],s=this.vertices[i.c];e.subVectors(s,a),t.subVectors(o,a),e.cross(t),e.normalize(),i.normal.copy(e)}},computeVertexNormals:function(e){var t,n,r,i,o,a;for(void 0===e&&(e=!0),a=new Array(this.vertices.length),t=0,n=this.vertices.length;t<n;t++)a[t]=new jr;if(e){var s,c,u,l=new jr,h=new jr;for(r=0,i=this.faces.length;r<i;r++)o=this.faces[r],s=this.vertices[o.a],c=this.vertices[o.b],u=this.vertices[o.c],l.subVectors(u,c),h.subVectors(s,c),l.cross(h),a[o.a].add(l),a[o.b].add(l),a[o.c].add(l)}else for(this.computeFaceNormals(),r=0,i=this.faces.length;r<i;r++)a[(o=this.faces[r]).a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(t=0,n=this.vertices.length;t<n;t++)a[t].normalize();for(r=0,i=this.faces.length;r<i;r++){var f=(o=this.faces[r]).vertexNormals;3===f.length?(f[0].copy(a[o.a]),f[1].copy(a[o.b]),f[2].copy(a[o.c])):(f[0]=a[o.a].clone(),f[1]=a[o.b].clone(),f[2]=a[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e,t,n;for(this.computeFaceNormals(),e=0,t=this.faces.length;e<t;e++){var r=(n=this.faces[e]).vertexNormals;3===r.length?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,t,n,r,i;for(n=0,r=this.faces.length;n<r;n++)for((i=this.faces[n]).__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),e=0,t=i.vertexNormals.length;e<t;e++)i.__originalVertexNormals[e]?i.__originalVertexNormals[e].copy(i.vertexNormals[e]):i.__originalVertexNormals[e]=i.vertexNormals[e].clone();var o=new go;for(o.faces=this.faces,e=0,t=this.morphTargets.length;e<t;e++){if(!this.morphNormals[e]){this.morphNormals[e]={},this.morphNormals[e].faceNormals=[],this.morphNormals[e].vertexNormals=[];var a=this.morphNormals[e].faceNormals,s=this.morphNormals[e].vertexNormals;for(n=0,r=this.faces.length;n<r;n++)c=new jr,u={a:new jr,b:new jr,c:new jr},a.push(c),s.push(u)}var c,u,l=this.morphNormals[e];for(o.vertices=this.morphTargets[e].vertices,o.computeFaceNormals(),o.computeVertexNormals(),n=0,r=this.faces.length;n<r;n++)i=this.faces[n],c=l.faceNormals[n],u=l.vertexNormals[n],c.copy(i.normal),u.a.copy(i.vertexNormals[0]),u.b.copy(i.vertexNormals[1]),u.c.copy(i.vertexNormals[2])}for(n=0,r=this.faces.length;n<r;n++)(i=this.faces[n]).normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Gi),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new qi),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,t,n){if(e&&e.isGeometry){var r,i=this.vertices.length,o=this.vertices,a=e.vertices,s=this.faces,c=e.faces,u=this.colors,l=e.colors;void 0===n&&(n=0),void 0!==t&&(r=(new ei).getNormalMatrix(t));for(var h=0,f=a.length;h<f;h++){var d=a[h].clone();void 0!==t&&d.applyMatrix4(t),o.push(d)}for(h=0,f=l.length;h<f;h++)u.push(l[h].clone());for(h=0,f=c.length;h<f;h++){var p,m,v,g=c[h],y=g.vertexNormals,b=g.vertexColors;(p=new ho(g.a+i,g.b+i,g.c+i)).normal.copy(g.normal),void 0!==r&&p.normal.applyMatrix3(r).normalize();for(var _=0,w=y.length;_<w;_++)m=y[_].clone(),void 0!==r&&m.applyMatrix3(r).normalize(),p.vertexNormals.push(m);for(p.color.copy(g.color),_=0,w=b.length;_<w;_++)v=b[_],p.vertexColors.push(v.clone());p.materialIndex=g.materialIndex+n,s.push(p)}for(h=0,f=e.faceVertexUvs.length;h<f;h++){var x=e.faceVertexUvs[h];for(void 0===this.faceVertexUvs[h]&&(this.faceVertexUvs[h]=[]),_=0,w=x.length;_<w;_++){for(var S=x[_],E=[],M=0,C=S.length;M<C;M++)E.push(S[M].clone());this.faceVertexUvs[h].push(E)}}}else console.error("Geometry.merge(): geometry not an instance of Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("Geometry.mergeMesh(): mesh not an instance of Mesh.",e)},mergeVertices:function(){var e,t,n,r,i,o,a,s,c={},u=[],l=[],h=Math.pow(10,4);for(n=0,r=this.vertices.length;n<r;n++)e=this.vertices[n],void 0===c[t=Math.round(e.x*h)+"_"+Math.round(e.y*h)+"_"+Math.round(e.z*h)]?(c[t]=n,u.push(this.vertices[n]),l[n]=u.length-1):l[n]=l[c[t]];var f=[];for(n=0,r=this.faces.length;n<r;n++){(i=this.faces[n]).a=l[i.a],i.b=l[i.b],i.c=l[i.c],o=[i.a,i.b,i.c];for(var d=0;d<3;d++)if(o[d]===o[(d+1)%3]){f.push(n);break}}for(n=f.length-1;n>=0;n--){var p=f[n];for(this.faces.splice(p,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(p,1)}var m=this.vertices.length-u.length;return this.vertices=u,m},setFromPoints:function(e){this.vertices=[];for(var t=0,n=e.length;t<n;t++){var r=e[t];this.vertices.push(new jr(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,t=e.length,n=0;n<t;n++)e[n]._id=n;e.sort((function(e,t){return e.materialIndex-t.materialIndex}));var r,i,o=this.faceVertexUvs[0],a=this.faceVertexUvs[1];for(o&&o.length===t&&(r=[]),a&&a.length===t&&(i=[]),n=0;n<t;n++){var s=e[n]._id;r&&r.push(o[s]),i&&i.push(a[s])}r&&(this.faceVertexUvs[0]=r),i&&(this.faceVertexUvs[1]=i)},toJSON:function(){var e={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}for(var r=[],i=0;i<this.vertices.length;i++){var o=this.vertices[i];r.push(o.x,o.y,o.z)}var a=[],s=[],c={},u=[],l={},h=[],f={};for(i=0;i<this.faces.length;i++){var d=this.faces[i],p=void 0!==this.faceVertexUvs[0][i],m=d.normal.length()>0,v=d.vertexNormals.length>0,g=1!==d.color.r||1!==d.color.g||1!==d.color.b,y=d.vertexColors.length>0,b=0;if(b=S(b=S(b=S(b=S(b=S(b=S(b=S(b=S(b,0,0),1,!0),2,!1),3,p),4,m),5,v),6,g),7,y),a.push(b),a.push(d.a,d.b,d.c),a.push(d.materialIndex),p){var _=this.faceVertexUvs[0][i];a.push(C(_[0]),C(_[1]),C(_[2]))}if(m&&a.push(E(d.normal)),v){var w=d.vertexNormals;a.push(E(w[0]),E(w[1]),E(w[2]))}if(g&&a.push(M(d.color)),y){var x=d.vertexColors;a.push(M(x[0]),M(x[1]),M(x[2]))}}function S(e,t,n){return n?e|1<<t:e&~(1<<t)}function E(e){var t=e.x.toString()+e.y.toString()+e.z.toString();return void 0!==c[t]||(c[t]=s.length/3,s.push(e.x,e.y,e.z)),c[t]}function M(e){var t=e.r.toString()+e.g.toString()+e.b.toString();return void 0!==l[t]||(l[t]=u.length,u.push(e.getHex())),l[t]}function C(e){var t=e.x.toString()+e.y.toString();return void 0!==f[t]||(f[t]=h.length/2,h.push(e.x,e.y)),f[t]}return e.data={},e.data.vertices=r,e.data.normals=s,u.length>0&&(e.data.colors=u),h.length>0&&(e.data.uvs=[h]),e.data.faces=a,e},clone:function(){return(new go).copy(this)},copy:function(e){var t,n,r,i,o,a;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var s=e.vertices;for(t=0,n=s.length;t<n;t++)this.vertices.push(s[t].clone());var c=e.colors;for(t=0,n=c.length;t<n;t++)this.colors.push(c[t].clone());var u=e.faces;for(t=0,n=u.length;t<n;t++)this.faces.push(u[t].clone());for(t=0,n=e.faceVertexUvs.length;t<n;t++){var l=e.faceVertexUvs[t];for(void 0===this.faceVertexUvs[t]&&(this.faceVertexUvs[t]=[]),r=0,i=l.length;r<i;r++){var h=l[r],f=[];for(o=0,a=h.length;o<a;o++){var d=h[o];f.push(d.clone())}this.faceVertexUvs[t].push(f)}}var p=e.morphTargets;for(t=0,n=p.length;t<n;t++){var m={};if(m.name=p[t].name,void 0!==p[t].vertices)for(m.vertices=[],r=0,i=p[t].vertices.length;r<i;r++)m.vertices.push(p[t].vertices[r].clone());if(void 0!==p[t].normals)for(m.normals=[],r=0,i=p[t].normals.length;r<i;r++)m.normals.push(p[t].normals[r].clone());this.morphTargets.push(m)}var v=e.morphNormals;for(t=0,n=v.length;t<n;t++){var g={};if(void 0!==v[t].vertexNormals)for(g.vertexNormals=[],r=0,i=v[t].vertexNormals.length;r<i;r++){var y=v[t].vertexNormals[r],b={};b.a=y.a.clone(),b.b=y.b.clone(),b.c=y.c.clone(),g.vertexNormals.push(b)}if(void 0!==v[t].faceNormals)for(g.faceNormals=[],r=0,i=v[t].faceNormals.length;r<i;r++)g.faceNormals.push(v[t].faceNormals[r].clone());this.morphNormals.push(g)}var _=e.skinWeights;for(t=0,n=_.length;t<n;t++)this.skinWeights.push(_[t].clone());var w=e.skinIndices;for(t=0,n=w.length;t<n;t++)this.skinIndices.push(w[t].clone());var x=e.lineDistances;for(t=0,n=x.length;t<n;t++)this.lineDistances.push(x[t]);var S=e.boundingBox;null!==S&&(this.boundingBox=S.clone());var E=e.boundingSphere;return null!==E&&(this.boundingSphere=E.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var yo=new jr;function bo(e,t,n){if(Array.isArray(e))throw new TypeError("BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function _o(e,t,n){bo.call(this,new Int8Array(e),t,n)}function wo(e,t,n){bo.call(this,new Uint8Array(e),t,n)}function xo(e,t,n){bo.call(this,new Uint8ClampedArray(e),t,n)}function So(e,t,n){bo.call(this,new Int16Array(e),t,n)}function Eo(e,t,n){bo.call(this,new Uint16Array(e),t,n)}function Mo(e,t,n){bo.call(this,new Int32Array(e),t,n)}function Co(e,t,n){bo.call(this,new Uint32Array(e),t,n)}function To(e,t,n){bo.call(this,new Float32Array(e),t,n)}function Ao(e,t,n){bo.call(this,new Float64Array(e),t,n)}function Po(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function Lo(e){if(0===e.length)return-1/0;for(var t=e[0],n=1,r=e.length;n<r;++n)e[n]>t&&(t=e[n]);return t}Object.defineProperty(bo.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(bo.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[e+r]=t.array[n+r];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("BufferAttribute.copyColorsArray(): color is undefined",r),o=new ro),t[n++]=o.r,t[n++]=o.g,t[n++]=o.b}return this},copyVector2sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("BufferAttribute.copyVector2sArray(): vector is undefined",r),o=new Mi),t[n++]=o.x,t[n++]=o.y}return this},copyVector3sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new jr),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z}return this},copyVector4sArray:function(e){for(var t=this.array,n=0,r=0,i=e.length;r<i;r++){var o=e[r];void 0===o&&(console.warn("BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new co),t[n++]=o.x,t[n++]=o.y,t[n++]=o.z,t[n++]=o.w}return this},applyMatrix3:function(e){for(var t=0,n=this.count;t<n;t++)yo.x=this.getX(t),yo.y=this.getY(t),yo.z=this.getZ(t),yo.applyMatrix3(e),this.setXYZ(t,yo.x,yo.y,yo.z);return this},applyMatrix4:function(e){for(var t=0,n=this.count;t<n;t++)yo.x=this.getX(t),yo.y=this.getY(t),yo.z=this.getZ(t),yo.applyMatrix4(e),this.setXYZ(t,yo.x,yo.y,yo.z);return this},applyNormalMatrix:function(e){for(var t=0,n=this.count;t<n;t++)yo.x=this.getX(t),yo.y=this.getY(t),yo.z=this.getZ(t),yo.applyNormalMatrix(e),this.setXYZ(t,yo.x,yo.y,yo.z);return this},transformDirection:function(e){for(var t=0,n=this.count;t<n;t++)yo.x=this.getX(t),yo.y=this.getY(t),yo.z=this.getZ(t),yo.transformDirection(e),this.setXYZ(t,yo.x,yo.y,yo.z);return this},set:function(e,t){return void 0===t&&(t=0),this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this},setXYZW:function(e,t,n,r,i){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=i,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),_o.prototype=Object.create(bo.prototype),_o.prototype.constructor=_o,wo.prototype=Object.create(bo.prototype),wo.prototype.constructor=wo,xo.prototype=Object.create(bo.prototype),xo.prototype.constructor=xo,So.prototype=Object.create(bo.prototype),So.prototype.constructor=So,Eo.prototype=Object.create(bo.prototype),Eo.prototype.constructor=Eo,Mo.prototype=Object.create(bo.prototype),Mo.prototype.constructor=Mo,Co.prototype=Object.create(bo.prototype),Co.prototype.constructor=Co,To.prototype=Object.create(bo.prototype),To.prototype.constructor=To,Ao.prototype=Object.create(bo.prototype),Ao.prototype.constructor=Ao,Object.assign(Po.prototype,{computeGroups:function(e){for(var t,n=[],r=void 0,i=e.faces,o=0;o<i.length;o++){var a=i[o];a.materialIndex!==r&&(r=a.materialIndex,void 0!==t&&(t.count=3*o-t.start,n.push(t)),t={start:3*o,materialIndex:r})}void 0!==t&&(t.count=3*o-t.start,n.push(t)),this.groups=n},fromGeometry:function(e){var t,n=e.faces,r=e.vertices,i=e.faceVertexUvs,o=i[0]&&i[0].length>0,a=i[1]&&i[1].length>0,s=e.morphTargets,c=s.length;if(c>0){t=[];for(var u=0;u<c;u++)t[u]={name:s[u].name,data:[]};this.morphTargets.position=t}var l,h=e.morphNormals,f=h.length;if(f>0){for(l=[],u=0;u<f;u++)l[u]={name:h[u].name,data:[]};this.morphTargets.normal=l}var d=e.skinIndices,p=e.skinWeights,m=d.length===r.length,v=p.length===r.length;for(r.length>0&&0===n.length&&console.error("DirectGeometry: Faceless geometries are not supported."),u=0;u<n.length;u++){var g=n[u];this.vertices.push(r[g.a],r[g.b],r[g.c]);var y=g.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var b=g.normal;this.normals.push(b,b,b)}var _,w=g.vertexColors;if(3===w.length)this.colors.push(w[0],w[1],w[2]);else{var x=g.color;this.colors.push(x,x,x)}!0===o&&(void 0!==(_=i[0][u])?this.uvs.push(_[0],_[1],_[2]):(console.warn("DirectGeometry.fromGeometry(): Undefined vertexUv ",u),this.uvs.push(new Mi,new Mi,new Mi))),!0===a&&(void 0!==(_=i[1][u])?this.uvs2.push(_[0],_[1],_[2]):(console.warn("DirectGeometry.fromGeometry(): Undefined vertexUv2 ",u),this.uvs2.push(new Mi,new Mi,new Mi)));for(var S=0;S<c;S++){var E=s[S].vertices;t[S].data.push(E[g.a],E[g.b],E[g.c])}for(S=0;S<f;S++){var M=h[S].vertexNormals[u];l[S].data.push(M.a,M.b,M.c)}m&&this.skinIndices.push(d[g.a],d[g.b],d[g.c]),v&&this.skinWeights.push(p[g.a],p[g.b],p[g.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this}});var Ro=1,ko=new Yr,No=new pi,Oo=new jr,Do=new Gi,Fo=new Gi,Io=new jr;function Uo(){Object.defineProperty(this,"id",{value:Ro+=2}),this.uuid=Fr.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}function Bo(e){return(Bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jo(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&function(e,t){(Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(e,t)}function zo(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Vo(e){return(Vo=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Uo.prototype=Object.assign(Object.create(Zr.prototype),{constructor:Uo,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(Lo(e)>65535?Co:Eo)(e,1):this.index=e},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,t){return this.attributes[e]=t,this},deleteAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,t,n){this.groups.push({start:e,count:t,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix4:function(e){var t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var r=(new ei).getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}var i=this.attributes.tangent;return void 0!==i&&(i.transformDirection(e),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(e){return ko.makeRotationX(e),this.applyMatrix4(ko),this},rotateY:function(e){return ko.makeRotationY(e),this.applyMatrix4(ko),this},rotateZ:function(e){return ko.makeRotationZ(e),this.applyMatrix4(ko),this},translate:function(e,t,n){return ko.makeTranslation(e,t,n),this.applyMatrix4(ko),this},scale:function(e,t,n){return ko.makeScale(e,t,n),this.applyMatrix4(ko),this},lookAt:function(e){return No.lookAt(e),No.updateMatrix(),this.applyMatrix4(No.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Oo).negate(),this.translate(Oo.x,Oo.y,Oo.z),this},setFromObject:function(e){var t=e.geometry;if(e.isPoints||e.isLine){var n=new To(3*t.vertices.length,3),r=new To(3*t.colors.length,3);if(this.setAttribute("position",n.copyVector3sArray(t.vertices)),this.setAttribute("color",r.copyColorsArray(t.colors)),t.lineDistances&&t.lineDistances.length===t.vertices.length){var i=new To(t.lineDistances.length,1);this.setAttribute("lineDistance",i.copyArray(t.lineDistances))}null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone())}else e.isMesh&&t&&t.isGeometry&&this.fromGeometry(t);return this},setFromPoints:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];t.push(i.x,i.y,i.z||0)}return this.setAttribute("position",new To(t,3)),this},updateFromObject:function(e){var t,n=e.geometry;if(e.isMesh){var r=n.__directGeometry;if(!0===n.elementsNeedUpdate&&(r=void 0,n.elementsNeedUpdate=!1),void 0===r)return this.fromGeometry(n);r.verticesNeedUpdate=n.verticesNeedUpdate,r.normalsNeedUpdate=n.normalsNeedUpdate,r.colorsNeedUpdate=n.colorsNeedUpdate,r.uvsNeedUpdate=n.uvsNeedUpdate,r.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=r}return!0===n.verticesNeedUpdate&&(void 0!==(t=this.attributes.position)&&(t.copyVector3sArray(n.vertices),t.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(t=this.attributes.normal)&&(t.copyVector3sArray(n.normals),t.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(t=this.attributes.color)&&(t.copyColorsArray(n.colors),t.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(t=this.attributes.uv)&&(t.copyVector2sArray(n.uvs),t.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(t=this.attributes.lineDistance)&&(t.copyArray(n.lineDistances),t.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(e.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=(new Po).fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var t=new Float32Array(3*e.vertices.length);if(this.setAttribute("position",new bo(t,3).copyVector3sArray(e.vertices)),e.normals.length>0){var n=new Float32Array(3*e.normals.length);this.setAttribute("normal",new bo(n,3).copyVector3sArray(e.normals))}if(e.colors.length>0){var r=new Float32Array(3*e.colors.length);this.setAttribute("color",new bo(r,3).copyColorsArray(e.colors))}if(e.uvs.length>0){var i=new Float32Array(2*e.uvs.length);this.setAttribute("uv",new bo(i,2).copyVector2sArray(e.uvs))}if(e.uvs2.length>0){var o=new Float32Array(2*e.uvs2.length);this.setAttribute("uv2",new bo(o,2).copyVector2sArray(e.uvs2))}for(var a in this.groups=e.groups,e.morphTargets){for(var s=[],c=e.morphTargets[a],u=0,l=c.length;u<l;u++){var h=c[u],f=new To(3*h.data.length,3);f.name=h.name,s.push(f.copyVector3sArray(h.data))}this.morphAttributes[a]=s}if(e.skinIndices.length>0){var d=new To(4*e.skinIndices.length,4);this.setAttribute("skinIndex",d.copyVector4sArray(e.skinIndices))}if(e.skinWeights.length>0){var p=new To(4*e.skinWeights.length,4);this.setAttribute("skinWeight",p.copyVector4sArray(e.skinWeights))}return null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Gi);var e=this.attributes.position,t=this.morphAttributes.position;if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(var n=0,r=t.length;n<r;n++){var i=t[n];Do.setFromBufferAttribute(i),this.morphTargetsRelative?(Io.addVectors(this.boundingBox.min,Do.min),this.boundingBox.expandByPoint(Io),Io.addVectors(this.boundingBox.max,Do.max),this.boundingBox.expandByPoint(Io)):(this.boundingBox.expandByPoint(Do.min),this.boundingBox.expandByPoint(Do.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new qi);var e=this.attributes.position,t=this.morphAttributes.position;if(e){var n=this.boundingSphere.center;if(Do.setFromBufferAttribute(e),t)for(var r=0,i=t.length;r<i;r++){var o=t[r];Fo.setFromBufferAttribute(o),this.morphTargetsRelative?(Io.addVectors(Do.min,Fo.min),Do.expandByPoint(Io),Io.addVectors(Do.max,Fo.max),Do.expandByPoint(Io)):(Do.expandByPoint(Fo.min),Do.expandByPoint(Fo.max))}Do.getCenter(n);var a=0;for(r=0,i=e.count;r<i;r++)Io.fromBufferAttribute(e,r),a=Math.max(a,n.distanceToSquared(Io));if(t)for(r=0,i=t.length;r<i;r++){o=t[r];for(var s=this.morphTargetsRelative,c=0,u=o.count;c<u;c++)Io.fromBufferAttribute(o,c),s&&(Oo.fromBufferAttribute(e,c),Io.add(Oo)),a=Math.max(a,n.distanceToSquared(Io))}this.boundingSphere.radius=Math.sqrt(a),isNaN(this.boundingSphere.radius)&&console.error('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,t=this.attributes;if(t.position){var n=t.position.array;if(void 0===t.normal)this.setAttribute("normal",new bo(new Float32Array(n.length),3));else for(var r=t.normal.array,i=0,o=r.length;i<o;i++)r[i]=0;var a,s,c,u=t.normal.array,l=new jr,h=new jr,f=new jr,d=new jr,p=new jr;if(e){var m=e.array;for(i=0,o=e.count;i<o;i+=3)a=3*m[i+0],s=3*m[i+1],c=3*m[i+2],l.fromArray(n,a),h.fromArray(n,s),f.fromArray(n,c),d.subVectors(f,h),p.subVectors(l,h),d.cross(p),u[a]+=d.x,u[a+1]+=d.y,u[a+2]+=d.z,u[s]+=d.x,u[s+1]+=d.y,u[s+2]+=d.z,u[c]+=d.x,u[c+1]+=d.y,u[c+2]+=d.z}else for(i=0,o=n.length;i<o;i+=9)l.fromArray(n,i),h.fromArray(n,i+3),f.fromArray(n,i+6),d.subVectors(f,h),p.subVectors(l,h),d.cross(p),u[i]=d.x,u[i+1]=d.y,u[i+2]=d.z,u[i+3]=d.x,u[i+4]=d.y,u[i+5]=d.z,u[i+6]=d.x,u[i+7]=d.y,u[i+8]=d.z;this.normalizeNormals(),t.normal.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==e.attributes[r])for(var i=n[r].array,o=e.attributes[r],a=o.array,s=o.itemSize*t,c=Math.min(a.length,i.length-s),u=0,l=s;u<c;u++,l++)i[l]=a[u];return this}console.error("BufferGeometry.merge(): geometry not an instance of BufferGeometry.",e)},normalizeNormals:function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)Io.x=e.getX(t),Io.y=e.getY(t),Io.z=e.getZ(t),Io.normalize(),e.setXYZ(t,Io.x,Io.y,Io.z)},toNonIndexed:function(){function e(e,t){for(var n=e.array,r=e.itemSize,i=new n.constructor(t.length*r),o=0,a=0,s=0,c=t.length;s<c;s++){o=t[s]*r;for(var u=0;u<r;u++)i[a++]=n[o++]}return new bo(i,r)}if(null===this.index)return console.warn("BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new Uo,n=this.index.array,r=this.attributes;for(var i in r){var o=e(r[i],n);t.setAttribute(i,o)}var a=this.morphAttributes;for(i in a){for(var s=[],c=a[i],u=0,l=c.length;u<l;u++)o=e(c[u],n),s.push(o);t.morphAttributes[i]=s}t.morphTargetsRelative=this.morphTargetsRelative;for(var h=this.groups,f=(u=0,h.length);u<f;u++){var d=h[u];t.addGroup(d.start,d.count,d.materialIndex)}return t},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var r=this.index;null!==r&&(e.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(var n in i){var o=(f=i[n]).toJSON();""!==f.name&&(o.name=f.name),e.data.attributes[n]=o}var a={},s=!1;for(var n in this.morphAttributes){for(var c=this.morphAttributes[n],u=[],l=0,h=c.length;l<h;l++){var f;o=(f=c[l]).toJSON(),""!==f.name&&(o.name=f.name),u.push(o)}u.length>0&&(a[n]=u,s=!0)}s&&(e.data.morphAttributes=a,e.data.morphTargetsRelative=this.morphTargetsRelative);var d=this.groups;d.length>0&&(e.data.groups=JSON.parse(JSON.stringify(d)));var p=this.boundingSphere;return null!==p&&(e.data.boundingSphere={center:p.center.toArray(),radius:p.radius}),e},clone:function(){return(new Uo).copy(this)},copy:function(e){var t,n,r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=e.name;var i=e.index;null!==i&&this.setIndex(i.clone());var o=e.attributes;for(t in o){var a=o[t];this.setAttribute(t,a.clone())}var s=e.morphAttributes;for(t in s){var c=[],u=s[t];for(n=0,r=u.length;n<r;n++)c.push(u[n].clone());this.morphAttributes[t]=c}this.morphTargetsRelative=e.morphTargetsRelative;var l=e.groups;for(n=0,r=l.length;n<r;n++){var h=l[n];this.addGroup(h.start,h.count,h.materialIndex)}var f=e.boundingBox;null!==f&&(this.boundingBox=f.clone());var d=e.boundingSphere;return null!==d&&(this.boundingSphere=d.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Go=function(e){jo(n,Uo);var t=function(e){return function(){var t,n=Vo(e);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()){var r=Vo(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return function(e,t){return!t||"object"!==Bo(t)&&"function"!=typeof t?zo(e):t}(this,t)}}(n);function n(e,r,i,o,a,s){var c;(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")})(this,n),(c=t.call(this)).type="BoxBufferGeometry",c.parameters={width:e,height:r,depth:i,widthSegments:o,heightSegments:a,depthSegments:s};var u=zo(c);e=e||1,r=r||1,i=i||1,o=Math.floor(o)||1,a=Math.floor(a)||1;var l=[],h=[],f=[],d=[],p=0,m=0;function v(e,t,n,r,i,o,a,s,c,v,g){var y,b,_=o/c,w=a/v,x=o/2,S=a/2,E=s/2,M=c+1,C=v+1,T=0,A=0,P=new jr;for(b=0;b<C;b++){var L=b*w-S;for(y=0;y<M;y++){var R=y*_-x;P[e]=R*r,P[t]=L*i,P[n]=E,h.push(P.x,P.y,P.z),P[e]=0,P[t]=0,P[n]=s>0?1:-1,f.push(P.x,P.y,P.z),d.push(y/c),d.push(1-b/v),T+=1}}for(b=0;b<v;b++)for(y=0;y<c;y++){var k=p+y+M*b,N=p+y+M*(b+1),O=p+(y+1)+M*(b+1),D=p+(y+1)+M*b;l.push(k,N,D),l.push(N,O,D),A+=6}u.addGroup(m,A,g),m+=A,p+=T}return v("z","y","x",-1,-1,i,r,e,s=Math.floor(s)||1,a,0),v("z","y","x",1,-1,i,r,-e,s,a,1),v("x","z","y",1,1,e,i,r,o,s,2),v("x","z","y",1,-1,e,i,-r,o,s,3),v("x","y","z",1,-1,e,r,i,o,a,4),v("x","y","z",-1,-1,e,r,-i,o,a,5),c.setIndex(l),c.setAttribute("position",new To(h,3)),c.setAttribute("normal",new To(f,3)),c.setAttribute("uv",new To(d,2)),c}return n}();function Wo(e,t,n,r){go.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new Ho(e,t,n,r)),this.mergeVertices()}function Ho(e,t,n,r){Uo.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:r};var i,o,a=(e=e||1)/2,s=(t=t||1)/2,c=Math.floor(n)||1,u=Math.floor(r)||1,l=c+1,h=u+1,f=e/c,d=t/u,p=[],m=[],v=[],g=[];for(o=0;o<h;o++){var y=o*d-s;for(i=0;i<l;i++){var b=i*f-a;m.push(b,-y,0),v.push(0,0,1),g.push(i/c),g.push(1-o/u)}}for(o=0;o<u;o++)for(i=0;i<c;i++){var _=i+l*o,w=i+l*(o+1),x=i+1+l*(o+1),S=i+1+l*o;p.push(_,w,S),p.push(w,x,S)}this.setIndex(p),this.setAttribute("position",new To(m,3)),this.setAttribute("normal",new To(v,3)),this.setAttribute("uv",new To(g,2))}Wo.prototype=Object.create(go.prototype),Wo.prototype.constructor=Wo,Ho.prototype=Object.create(Uo.prototype),Ho.prototype.constructor=Ho;var qo=0;function Xo(){Object.defineProperty(this,"id",{value:qo++}),this.uuid=Fr.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.flatShading=!1,this.vertexTangents=!1,this.vertexColors=0,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}function Yo(e){var t={};for(var n in e)for(var r in t[n]={},e[n]){var i=e[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?t[n][r]=i.clone():Array.isArray(i)?t[n][r]=i.slice():t[n][r]=i}return t}function Zo(e){for(var t={},n=0;n<e.length;n++){var r=Yo(e[n]);for(var i in r)t[i]=r[i]}return t}Xo.prototype=Object.assign(Object.create(Zr.prototype),{constructor:Xo,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n)if("shading"!==t){var r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn(this.type+": '"+t+"' is not a property of this material.")}else console.warn(this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;else console.warn("Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),!0===this.flatShading&&(n.flatShading=this.flatShading),0!==this.side&&(n.side=this.side),0!==this.vertexColors&&(n.vertexColors=this.vertexColors),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){var i=r(e.textures),o=r(e.images);i.length>0&&(n.textures=i),o.length>0&&(n.images=o)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexTangents=e.vertexTangents,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var t=e.clippingPlanes,n=null;if(null!==t){var r=t.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=t[i].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Xo.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}});var Jo={clone:Yo,merge:Zo};function Ko(e){Xo.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="\nvoid main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",this.fragmentShader="\nvoid main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}\n",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==e&&(void 0!==e.attributes&&console.error("ShaderMaterial: attributes should now be defined in BufferGeometry instead."),this.setValues(e))}Ko.prototype=Object.create(Xo.prototype),Ko.prototype.constructor=Ko,Ko.prototype.isShaderMaterial=!0,Ko.prototype.copy=function(e){return Xo.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Yo(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=e.extensions,this},Ko.prototype.toJSON=function(e){var t=Xo.prototype.toJSON.call(this,e);for(var n in t.uniforms={},this.uniforms){var r=this.uniforms[n].value;r&&r.isTexture?t.uniforms[n]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?t.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?t.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?t.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?t.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?t.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?t.uniforms[n]={type:"m4",value:r.toArray()}:t.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var i={};for(var o in this.extensions)!0===this.extensions[o]&&(i[o]=!0);return Object.keys(i).length>0&&(t.extensions=i),t};var $o=new jr,Qo=new jr,ea=new jr,ta=new jr,na=new jr,ra=new jr,ia=new jr;function oa(e,t){this.origin=void 0!==e?e:new jr,this.direction=void 0!==t?t:new jr(0,0,-1)}Object.assign(oa.prototype,{set:function(e,t){return this.origin.copy(e),this.direction.copy(t),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,t){return void 0===t&&(console.warn("Ray: .at() target is now required"),t=new jr),t.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(e){return this.origin.copy(this.at(e,$o)),this},closestPointToPoint:function(e,t){void 0===t&&(console.warn("Ray: .closestPointToPoint() target is now required"),t=new jr),t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(e){var t=$o.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):($o.copy(this.direction).multiplyScalar(t).add(this.origin),$o.distanceToSquared(e))},distanceSqToSegment:function(e,t,n,r){Qo.copy(e).add(t).multiplyScalar(.5),ea.copy(t).sub(e).normalize(),ta.copy(this.origin).sub(Qo);var i,o,a,s,c=.5*e.distanceTo(t),u=-this.direction.dot(ea),l=ta.dot(this.direction),h=-ta.dot(ea),f=ta.lengthSq(),d=Math.abs(1-u*u);if(d>0)if(o=u*l-h,s=c*d,(i=u*h-l)>=0)if(o>=-s)if(o<=s){var p=1/d;a=(i*=p)*(i+u*(o*=p)+2*l)+o*(u*i+o+2*h)+f}else o=c,a=-(i=Math.max(0,-(u*o+l)))*i+o*(o+2*h)+f;else o=-c,a=-(i=Math.max(0,-(u*o+l)))*i+o*(o+2*h)+f;else o<=-s?a=-(i=Math.max(0,-(-u*c+l)))*i+(o=i>0?-c:Math.min(Math.max(-c,-h),c))*(o+2*h)+f:o<=s?(i=0,a=(o=Math.min(Math.max(-c,-h),c))*(o+2*h)+f):a=-(i=Math.max(0,-(u*c+l)))*i+(o=i>0?c:Math.min(Math.max(-c,-h),c))*(o+2*h)+f;else o=u>0?-c:c,a=-(i=Math.max(0,-(u*o+l)))*i+o*(o+2*h)+f;return n&&n.copy(this.direction).multiplyScalar(i).add(this.origin),r&&r.copy(ea).multiplyScalar(o).add(Qo),a},intersectSphere:function(e,t){$o.subVectors(e.center,this.origin);var n=$o.dot(this.direction),r=$o.dot($o)-n*n,i=e.radius*e.radius;if(r>i)return null;var o=Math.sqrt(i-r),a=n-o,s=n+o;return a<0&&s<0?null:a<0?this.at(s,t):this.at(a,t)},intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null},intersectPlane:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)},intersectsPlane:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0},intersectBox:function(e,t){var n,r,i,o,a,s,c=1/this.direction.x,u=1/this.direction.y,l=1/this.direction.z,h=this.origin;return c>=0?(n=(e.min.x-h.x)*c,r=(e.max.x-h.x)*c):(n=(e.max.x-h.x)*c,r=(e.min.x-h.x)*c),u>=0?(i=(e.min.y-h.y)*u,o=(e.max.y-h.y)*u):(i=(e.max.y-h.y)*u,o=(e.min.y-h.y)*u),n>o||i>r?null:((i>n||n!=n)&&(n=i),(o<r||r!=r)&&(r=o),l>=0?(a=(e.min.z-h.z)*l,s=(e.max.z-h.z)*l):(a=(e.max.z-h.z)*l,s=(e.min.z-h.z)*l),n>s||a>r?null:((a>n||n!=n)&&(n=a),(s<r||r!=r)&&(r=s),r<0?null:this.at(n>=0?n:r,t)))},intersectsBox:function(e){return null!==this.intersectBox(e,$o)},intersectTriangle:function(e,t,n,r,i){na.subVectors(t,e),ra.subVectors(n,e),ia.crossVectors(na,ra);var o,a=this.direction.dot(ia);if(a>0){if(r)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}ta.subVectors(this.origin,e);var s=o*this.direction.dot(ra.crossVectors(ta,ra));if(s<0)return null;var c=o*this.direction.dot(na.cross(ta));if(c<0)return null;if(s+c>a)return null;var u=-o*ta.dot(ia);return u<0?null:this.at(u/a,i)},applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}});var aa=new jr,sa=new jr,ca=new jr,ua=new jr,la=new jr,ha=new jr,fa=new jr,da=new jr,pa=new jr,ma=new jr;function va(e,t,n){this.a=void 0!==e?e:new jr,this.b=void 0!==t?t:new jr,this.c=void 0!==n?n:new jr}function ga(e){Xo.call(this),this.type="MeshBasicMaterial",this.color=new ro(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.setValues(e)}Object.assign(va,{getNormal:function(e,t,n,r){void 0===r&&(console.warn("Triangle: .getNormal() target is now required"),r=new jr),r.subVectors(n,t),aa.subVectors(e,t),r.cross(aa);var i=r.lengthSq();return i>0?r.multiplyScalar(1/Math.sqrt(i)):r.set(0,0,0)},getBarycoord:function(e,t,n,r,i){aa.subVectors(r,t),sa.subVectors(n,t),ca.subVectors(e,t);var o=aa.dot(aa),a=aa.dot(sa),s=aa.dot(ca),c=sa.dot(sa),u=sa.dot(ca),l=o*c-a*a;if(void 0===i&&(console.warn("Triangle: .getBarycoord() target is now required"),i=new jr),0===l)return i.set(-2,-1,-1);var h=1/l,f=(c*s-a*u)*h,d=(o*u-a*s)*h;return i.set(1-f-d,d,f)},containsPoint:function(e,t,n,r){return va.getBarycoord(e,t,n,r,ua),ua.x>=0&&ua.y>=0&&ua.x+ua.y<=1},getUV:function(e,t,n,r,i,o,a,s){return this.getBarycoord(e,t,n,r,ua),s.set(0,0),s.addScaledVector(i,ua.x),s.addScaledVector(o,ua.y),s.addScaledVector(a,ua.z),s},isFrontFacing:function(e,t,n,r){return aa.subVectors(n,t),sa.subVectors(e,t),aa.cross(sa).dot(r)<0}}),Object.assign(va.prototype,{set:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this},setFromPointsAndIndices:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){return aa.subVectors(this.c,this.b),sa.subVectors(this.a,this.b),.5*aa.cross(sa).length()},getMidpoint:function(e){return void 0===e&&(console.warn("Triangle: .getMidpoint() target is now required"),e=new jr),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return va.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return void 0===e&&(console.warn("Triangle: .getPlane() target is now required"),e=new Ji),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,t){return va.getBarycoord(e,this.a,this.b,this.c,t)},getUV:function(e,t,n,r,i){return va.getUV(e,this.a,this.b,this.c,t,n,r,i)},containsPoint:function(e){return va.containsPoint(e,this.a,this.b,this.c)},isFrontFacing:function(e){return va.isFrontFacing(this.a,this.b,this.c,e)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(e,t){void 0===t&&(console.warn("Triangle: .closestPointToPoint() target is now required"),t=new jr);var n,r,i=this.a,o=this.b,a=this.c;la.subVectors(o,i),ha.subVectors(a,i),da.subVectors(e,i);var s=la.dot(da),c=ha.dot(da);if(s<=0&&c<=0)return t.copy(i);pa.subVectors(e,o);var u=la.dot(pa),l=ha.dot(pa);if(u>=0&&l<=u)return t.copy(o);var h=s*l-u*c;if(h<=0&&s>=0&&u<=0)return n=s/(s-u),t.copy(i).addScaledVector(la,n);ma.subVectors(e,a);var f=la.dot(ma),d=ha.dot(ma);if(d>=0&&f<=d)return t.copy(a);var p=f*c-s*d;if(p<=0&&c>=0&&d<=0)return r=c/(c-d),t.copy(i).addScaledVector(ha,r);var m=u*d-f*l;if(m<=0&&l-u>=0&&f-d>=0)return fa.subVectors(a,o),r=(l-u)/(l-u+(f-d)),t.copy(o).addScaledVector(fa,r);var v=1/(m+p+h);return n=p*v,r=h*v,t.copy(i).addScaledVector(la,n).addScaledVector(ha,r)},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}),ga.prototype=Object.create(Xo.prototype),ga.prototype.constructor=ga,ga.prototype.isMeshBasicMaterial=!0,ga.prototype.copy=function(e){return Xo.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this};var ya=new Yr,ba=new oa,_a=new qi,wa=new jr,xa=new jr,Sa=new jr,Ea=new jr,Ma=new jr,Ca=new jr,Ta=new jr,Aa=new jr,Pa=new jr,La=new Mi,Ra=new Mi,ka=new Mi,Na=new jr,Oa=new jr;function Da(e,t){pi.call(this),this.type="Mesh",this.geometry=void 0!==e?e:new Uo,this.material=void 0!==t?t:new ga,this.updateMorphTargets()}function Fa(e,t,n,r,i,o,a,s){if(null===(1===t.side?r.intersectTriangle(a,o,i,!0,s):r.intersectTriangle(i,o,a,2!==t.side,s)))return null;Oa.copy(s),Oa.applyMatrix4(e.matrixWorld);var c=n.ray.origin.distanceTo(Oa);return c<n.near||c>n.far?null:{distance:c,point:Oa.clone(),object:e}}function Ia(e,t,n,r,i,o,a,s,c,u,l,h){wa.fromBufferAttribute(i,u),xa.fromBufferAttribute(i,l),Sa.fromBufferAttribute(i,h);var f=e.morphTargetInfluences;if(t.morphTargets&&o&&f){Ta.set(0,0,0),Aa.set(0,0,0),Pa.set(0,0,0);for(var d=0,p=o.length;d<p;d++){var m=f[d],v=o[d];0!==m&&(Ea.fromBufferAttribute(v,u),Ma.fromBufferAttribute(v,l),Ca.fromBufferAttribute(v,h),a?(Ta.addScaledVector(Ea,m),Aa.addScaledVector(Ma,m),Pa.addScaledVector(Ca,m)):(Ta.addScaledVector(Ea.sub(wa),m),Aa.addScaledVector(Ma.sub(xa),m),Pa.addScaledVector(Ca.sub(Sa),m)))}wa.add(Ta),xa.add(Aa),Sa.add(Pa)}var g=Fa(e,t,n,r,wa,xa,Sa,Na);if(g){s&&(La.fromBufferAttribute(s,u),Ra.fromBufferAttribute(s,l),ka.fromBufferAttribute(s,h),g.uv=va.getUV(Na,wa,xa,Sa,La,Ra,ka,new Mi)),c&&(La.fromBufferAttribute(c,u),Ra.fromBufferAttribute(c,l),ka.fromBufferAttribute(c,h),g.uv2=va.getUV(Na,wa,xa,Sa,La,Ra,ka,new Mi));var y=new ho(u,l,h);va.getNormal(wa,xa,Sa,y.normal),g.face=y}return g}Da.prototype=Object.assign(Object.create(pi.prototype),{constructor:Da,isMesh:!0,copy:function(e){return pi.prototype.copy.call(this,e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e,t,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,o=Object.keys(i);if(o.length>0){var a=i[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,t=a.length;e<t;e++)n=a[e].name||String(e),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=e}}else{var s=r.morphTargets;void 0!==s&&s.length>0&&console.error("Mesh.updateMorphTargets() no longer supports Geometry. Use BufferGeometry instead.")}},raycast:function(e,t){var n,r=this.geometry,i=this.material,o=this.matrixWorld;if(void 0!==i&&(null===r.boundingSphere&&r.computeBoundingSphere(),_a.copy(r.boundingSphere),_a.applyMatrix4(o),!1!==e.ray.intersectsSphere(_a)&&(ya.getInverse(o),ba.copy(e.ray).applyMatrix4(ya),null===r.boundingBox||!1!==ba.intersectsBox(r.boundingBox))))if(r.isBufferGeometry){var a,s,c,u,l,h,f,d,p,m=r.index,v=r.attributes.position,g=r.morphAttributes.position,y=r.morphTargetsRelative,b=r.attributes.uv,_=r.attributes.uv2,w=r.groups,x=r.drawRange;if(null!==m)if(Array.isArray(i))for(u=0,h=w.length;u<h;u++)for(p=i[(d=w[u]).materialIndex],l=Math.max(d.start,x.start),f=Math.min(d.start+d.count,x.start+x.count);l<f;l+=3)a=m.getX(l),s=m.getX(l+1),c=m.getX(l+2),(n=Ia(this,p,e,ba,v,g,y,b,_,a,s,c))&&(n.faceIndex=Math.floor(l/3),n.face.materialIndex=d.materialIndex,t.push(n));else for(u=Math.max(0,x.start),h=Math.min(m.count,x.start+x.count);u<h;u+=3)a=m.getX(u),s=m.getX(u+1),c=m.getX(u+2),(n=Ia(this,i,e,ba,v,g,y,b,_,a,s,c))&&(n.faceIndex=Math.floor(u/3),t.push(n));else if(void 0!==v)if(Array.isArray(i))for(u=0,h=w.length;u<h;u++)for(p=i[(d=w[u]).materialIndex],l=Math.max(d.start,x.start),f=Math.min(d.start+d.count,x.start+x.count);l<f;l+=3)(n=Ia(this,p,e,ba,v,g,y,b,_,a=l,s=l+1,c=l+2))&&(n.faceIndex=Math.floor(l/3),n.face.materialIndex=d.materialIndex,t.push(n));else for(u=Math.max(0,x.start),h=Math.min(v.count,x.start+x.count);u<h;u+=3)(n=Ia(this,i,e,ba,v,g,y,b,_,a=u,s=u+1,c=u+2))&&(n.faceIndex=Math.floor(u/3),t.push(n))}else if(r.isGeometry){var S,E,M,C,T=Array.isArray(i),A=r.vertices,P=r.faces,L=r.faceVertexUvs[0];L.length>0&&(C=L);for(var R=0,k=P.length;R<k;R++){var N=P[R],O=T?i[N.materialIndex]:i;if(void 0!==O&&(S=A[N.a],E=A[N.b],M=A[N.c],n=Fa(this,O,e,ba,S,E,M,Na))){if(C&&C[R]){var D=C[R];La.copy(D[0]),Ra.copy(D[1]),ka.copy(D[2]),n.uv=va.getUV(Na,S,E,M,La,Ra,ka,new Mi)}n.face=N,n.faceIndex=R,t.push(n)}}}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Ua={alphamap_fragment:"\n#ifdef USE_ALPHAMAP\n\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n\n#endif\n",alphamap_pars_fragment:"\n#ifdef USE_ALPHAMAP\n\n\tuniform sampler2D alphaMap;\n\n#endif\n",alphatest_fragment:"\n#ifdef ALPHATEST\n\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n\n#endif\n",aomap_fragment:"\n#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\n\t#endif\n\n#endif\n",aomap_pars_fragment:"\n#ifdef USE_AOMAP\n\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n\n#endif\n",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n\n#ifdef USE_TANGENT\n\n\tvec3 objectTangent = vec3( tangent.xyz );\n\n#endif\n",bsdfs:"\nvec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\n\tvec4 r = roughness * c0 + c1;\n\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n\n}\n\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\n\tif( cutoffDistance > 0.0 ) {\n\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\n\t}\n\n\treturn distanceFalloff;\n\n#else\n\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\n\t}\n\n\treturn 1.0;\n\n#endif\n\n}\n\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\n\treturn RECIPROCAL_PI * diffuseColor;\n\n} \n\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n\n} \n\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\n\treturn Fr * fresnel + F0;\n\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\n\treturn 1.0 / ( gl * gv );\n\n} \nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\n\treturn 0.5 / max( gv + gl, EPSILON );\n\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\n\tfloat a2 = pow2( alpha );\n\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0; \n\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\n\tfloat alpha = pow2( roughness ); \n\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\n\tfloat D = D_GGX( alpha, dotNH );\n\n\treturn F * ( G * D );\n\n} \nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\n\treturn uv;\n\n}\n\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n\n}\n\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\n\tfloat x = dot( v1, v2 );\n\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\n\treturn cross( v1, v2 ) * theta_sintheta;\n\n}\n\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 ); \n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\n\treturn specularColor * brdf.x + brdf.y;\n\n} \nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619; \n\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n\n}\n\nfloat G_BlinnPhong_Implicit(  ) {\n\treturn 0.25;\n\n}\n\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n\n}\n\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\n\tfloat G = G_BlinnPhong_Implicit(  );\n\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\n\treturn F * ( G * D );\n\n} \nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\n\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\t\n\tfloat invAlpha  = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125); \n\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\t\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\n\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n\n}\n\n#endif\n",bumpmap_pars_fragment:"\n#ifdef USE_BUMPMAP\n\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\n\t\treturn vec2( dBx, dBy );\n\n\t}\n\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\t\t\n\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\n\t\tfDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\n\t}\n\n#endif\n",clipping_planes_fragment:"\n#if NUM_CLIPPING_PLANES > 0\n\n\tvec4 plane;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\n\t}\n\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\n\t\tbool clipped = true;\n\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\n\t\t}\n\n\t\tif ( clipped ) discard;\n\n\t#endif\n\n#endif\n",clipping_planes_pars_fragment:"\n#if NUM_CLIPPING_PLANES > 0\n\n\t#if ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n\n#endif\n",clipping_planes_pars_vertex:"\n#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"\n#if NUM_CLIPPING_PLANES > 0 && ! defined( STANDARD ) && ! defined( PHONG ) && ! defined( MATCAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"\n#ifdef USE_COLOR\n\n\tdiffuseColor.rgb *= vColor;\n\n#endif\n",color_pars_fragment:"\n#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif\n",color_pars_vertex:"\n#ifdef USE_COLOR\n\n\tvarying vec3 vColor;\n\n#endif\n",color_vertex:"\n#ifdef USE_COLOR\n\n\tvColor.xyz = color.xyz;\n\n#endif\n",common:"\n#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n\n#ifndef saturate\n\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\n\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\n\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\n\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\n\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\n\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n}\n\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n\n}\n\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\n\treturn - distance * planeNormal + point;\n\n}\n\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n\n}\n\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n\n}\n\nmat3 transposeMat3( const in mat3 m ) {\n\n\tmat3 tmp;\n\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\n\treturn tmp;\n\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\n\treturn dot( weights, color.rgb );\n\n}\n\nbool isPerspectiveMatrix( mat4 m ) {\n\n  return m[ 2 ][ 3 ] == - 1.0;\n\n}\n",cube_uv_reflection_fragment:"\n#ifdef ENVMAP_TYPE_CUBE_UV\n\n#define cubeUV_maxMipLevel 8.0\n#define cubeUV_minMipLevel 4.0\n#define cubeUV_maxTileSize 256.0\n#define cubeUV_minTileSize 16.0\nfloat getFace(vec3 direction) {\n    vec3 absDirection = abs(direction);\n    float face = -1.0;\n    if (absDirection.x > absDirection.z) {\n      if (absDirection.x > absDirection.y)\n        face = direction.x > 0.0 ? 0.0 : 3.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    } else {\n      if (absDirection.z > absDirection.y)\n        face = direction.z > 0.0 ? 2.0 : 5.0;\n      else\n        face = direction.y > 0.0 ? 1.0 : 4.0;\n    }\n    return face;\n}\n\nvec2 getUV(vec3 direction, float face) {\n    vec2 uv;\n    if (face == 0.0) {\n      uv = vec2(-direction.z, direction.y) / abs(direction.x);\n    } else if (face == 1.0) {\n      uv = vec2(direction.x, -direction.z) / abs(direction.y);\n    } else if (face == 2.0) {\n      uv = direction.xy / abs(direction.z);\n    } else if (face == 3.0) {\n      uv = vec2(direction.z, direction.y) / abs(direction.x);\n    } else if (face == 4.0) {\n      uv = direction.xz / abs(direction.y);\n    } else {\n      uv = vec2(-direction.x, direction.y) / abs(direction.z);\n    }\n    return 0.5 * (uv + 1.0);\n}\n\nvec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {\n  float face = getFace(direction);\n  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);\n  mipInt = max(mipInt, cubeUV_minMipLevel);\n  float faceSize = exp2(mipInt);\n\n  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);\n\n  vec2 uv = getUV(direction, face) * (faceSize - 1.0);\n  vec2 f = fract(uv);\n  uv += 0.5 - f;\n  if (face > 2.0) {\n    uv.y += faceSize;\n    face -= 3.0;\n  }\n  uv.x += face * faceSize;\n  if(mipInt < cubeUV_maxMipLevel){\n    uv.y += 2.0 * cubeUV_maxTileSize;\n  }\n  uv.y += filterInt * 2.0 * cubeUV_minTileSize;\n  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);\n  uv *= texelSize;\n\n  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x += texelSize;\n  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.y += texelSize;\n  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  uv.x -= texelSize;\n  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;\n  vec3 tm = mix(tl, tr, f.x);\n  vec3 bm = mix(bl, br, f.x);\n  return mix(tm, bm, f.y);\n}\n#define r0 1.0\n#define v0 0.339\n#define m0 -2.0\n#define r1 0.8\n#define v1 0.276\n#define m1 -1.0\n#define r4 0.4\n#define v4 0.046\n#define m4 2.0\n#define r5 0.305\n#define v5 0.016\n#define m5 3.0\n#define r6 0.21\n#define v6 0.0038\n#define m6 4.0\n\nfloat roughnessToMip(float roughness) {\n  float mip = 0.0;\n  if (roughness >= r1) {\n    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;\n  } else if (roughness >= r4) {\n    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;\n  } else if (roughness >= r5) {\n    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;\n  } else if (roughness >= r6) {\n    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;\n  } else {\n    mip = -2.0 * log2(1.16 * roughness);\n  }\n  return mip;\n}\n\nvec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {\n  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);\n  float mipF = fract(mip);\n  float mipInt = floor(mip);\n\n  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);\n  if (mipF == 0.0) {\n    return vec4(color0, 1.0);\n  } else {\n    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);\n    return vec4(mix(color0, color1, mipF), 1.0);\n  }\n}\n#endif\n",defaultnormal_vertex:"\nvec3 transformedNormal = objectNormal;\n\n#ifdef USE_INSTANCING\n\n\ttransformedNormal = mat3( instanceMatrix ) * transformedNormal;\n\n#endif\n\ntransformedNormal = normalMatrix * transformedNormal;\n\n#ifdef FLIP_SIDED\n\n\ttransformedNormal = - transformedNormal;\n\n#endif\n\n#ifdef USE_TANGENT\n\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\n\t#ifdef FLIP_SIDED\n\n\t\ttransformedTangent = - transformedTangent;\n\n\t#endif\n\n#endif\n",displacementmap_pars_vertex:"\n#ifdef USE_DISPLACEMENTMAP\n\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n\n#endif\n",displacementmap_vertex:"\n#ifdef USE_DISPLACEMENTMAP\n\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n\n#endif\n",emissivemap_fragment:"\n#ifdef USE_EMISSIVEMAP\n\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n\n#endif\n",emissivemap_pars_fragment:"\n#ifdef USE_EMISSIVEMAP\n\n\tuniform sampler2D emissiveMap;\n\n#endif\n",encodings_fragment:"\ngl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\n\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\n\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\n\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\n\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\n\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\n\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\n\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\n\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}\n",envmap_fragment:"\n#ifdef USE_ENVMAP\n\n\t#ifdef ENV_WORLDPOS\n\n\t\tvec3 cameraToFrag;\n\t\t\n\t\tif ( isOrthographic ) {\n\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\n\t\t}  else {\n\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\n\t\t#else\n\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\n\t\t#endif\n\n\t#else\n\n\t\tvec3 reflectVec = vReflect;\n\n\t#endif\n\n\t#ifdef ENVMAP_TYPE_CUBE\n\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\n\t\tvec2 sampleUV;\n\n\t\treflectVec = normalize( reflectVec );\n\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\n\t\treflectVec = normalize( reflectVec );\n\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\n\t#else\n\n\t\tvec4 envColor = vec4( 0.0 );\n\n\t#endif\n\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\n\t\tenvColor = envMapTexelToLinear( envColor );\n\n\t#endif\n\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\n\t#endif\n\n#endif\n",envmap_common_pars_fragment:"\n#ifdef USE_ENVMAP\n\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif\n",envmap_pars_fragment:"\n#ifdef USE_ENVMAP\n\n\tuniform float reflectivity;\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\n\t\t#define ENV_WORLDPOS\n\n\t#endif\n\n\t#ifdef ENV_WORLDPOS\n\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n\n#endif\n",envmap_pars_vertex:"\n#ifdef USE_ENVMAP\n\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\n\t\t#define ENV_WORLDPOS\n\n\t#endif\n\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\n\t#else\n\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\n\t#endif\n\n#endif\n",envmap_physical_pars_fragment:"\n#if defined( USE_ENVMAP )\n\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\n\tvec3 getLightProbeIndirectIrradiance(  const in GeometricContext geometry, const in int maxMIPLevel ) {\n\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\n\t\t#else\n\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\n\t\t#endif\n\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\n\t}\n\n\tvec3 getLightProbeIndirectRadiance(  const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t  vec3 reflectVec = reflect( -viewDir, normal );\n\t\t  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\n\t\t#else\n\n\t\t  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\n\t\t#endif\n\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\n\t\t\t#else\n\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\n\t\t\t#else\n\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\n\t\t\t#else\n\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\n\t\t\t#endif\n\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\n\t\t#endif\n\n\t\treturn envMapColor.rgb * envMapIntensity;\n\n\t}\n\n#endif\n",envmap_vertex:"\n#ifdef USE_ENVMAP\n\n\t#ifdef ENV_WORLDPOS\n\n\t\tvWorldPosition = worldPosition.xyz;\n\n\t#else\n\n\t\tvec3 cameraToVertex;\n\n\t\tif ( isOrthographic ) { \n\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\n\t\t} else {\n\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\n\t\t}\n\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\n\t\t#else\n\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\n\t\t#endif\n\n\t#endif\n\n#endif\n",fog_vertex:"\n#ifdef USE_FOG\n\n\tfogDepth = -mvPosition.z;\n\n#endif\n",fog_pars_vertex:"\n#ifdef USE_FOG\n\n\tvarying float fogDepth;\n\n#endif\n",fog_fragment:"\n#ifdef USE_FOG\n\n\t#ifdef FOG_EXP2\n\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\n\t#else\n\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\n\t#endif\n\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n\n#endif\n",fog_pars_fragment:"\n#ifdef USE_FOG\n\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\n\t#ifdef FOG_EXP2\n\n\t\tuniform float fogDensity;\n\n\t#else\n\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\n\t#endif\n\n#endif\n",gradientmap_pars_fragment:"\n\n#ifdef USE_GRADIENTMAP\n\n\tuniform sampler2D gradientMap;\n\n#endif\n\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\n\t#ifdef USE_GRADIENTMAP\n\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\n\t#else\n\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\n\t#endif\n\n}\n\n",lightmap_fragment:"\n#ifdef USE_LIGHTMAP\n\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity; \n\n#endif\n",lightmap_pars_fragment:"\n#ifdef USE_LIGHTMAP\n\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n\n#endif\n",lights_lambert_vertex:"\nvec3 diffuse = vec3( 1.0 );\n\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\n\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\n\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\n\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n\n#if NUM_POINT_LIGHTS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\n\t}\n\n#endif\n\n#if NUM_SPOT_LIGHTS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\t}\n\n#endif\n#if NUM_DIR_LIGHTS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\n\t\t#endif\n\n\t}\n\n#endif\n\n#if NUM_HEMI_LIGHTS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\n\t\t#endif\n\n\t}\n\n#endif\n",lights_pars_begin:"\nuniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\n\treturn result;\n\n}\n\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\n\treturn irradiance;\n\n}\n\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\n\tvec3 irradiance = ambientLightColor;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *= PI;\n\n\t#endif\n\n\treturn irradiance;\n\n}\n\n#if NUM_DIR_LIGHTS > 0\n\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\n\t}\n\n#endif\n#if NUM_POINT_LIGHTS > 0\n\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\n\t\tfloat lightDistance = length( lVector );\n\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\n\t}\n\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\n\t\tif ( angleCos > spotLight.coneCos ) {\n\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\n\t\t} else {\n\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\n\t\t}\n\t}\n\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1; \n\tuniform sampler2D ltc_2; \n\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\t\tirradiance *= PI;\n\n\t\t#endif\n\n\t\treturn irradiance;\n\n\t}\n\n#endif\n",lights_toon_fragment:"\nToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_toon_pars_fragment:"\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\nstruct ToonMaterial {\n\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n\n};\n\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *= PI; \n\n\t#endif\n\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n\n}\n\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n\n#define Material_LightProbeLOD( material )\t(0)\n",lights_phong_fragment:"\nBlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\nstruct BlinnPhongMaterial {\n\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n\n};\n\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *= PI; \n\n\t#endif\n\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n\n}\n\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"\nPhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\n\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\n\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );\nmaterial.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n\n#ifdef REFLECTIVITY\n\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\n#else\n\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n\n#endif\n\n#ifdef CLEARCOAT\n\n\tmaterial.clearcoat = saturate( clearcoat ); \n\tmaterial.clearcoatRoughness = max( clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n\n#endif\n#ifdef USE_SHEEN\n\n\tmaterial.sheenColor = sheen;\n\n#endif\n",lights_physical_pars_fragment:"\nstruct PhysicalMaterial {\n\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n\n};\n\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n\n}\n\n#if NUM_RECT_AREA_LIGHTS > 0\n\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight; \n\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\n\t}\n\n#endif\n\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\n\tvec3 irradiance = dotNL * directLight.color;\n\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\tirradiance *= PI; \n\n\t#endif\n\n\t#ifdef CLEARCOAT\n\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\t\tccIrradiance *= PI; \n\n\t\t#endif\n\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\n\t#else\n\n\t\tfloat clearcoatDHR = 0.0;\n\n\t#endif\n\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\n}\n\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\n\t#ifdef CLEARCOAT\n\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\n\t#else\n\n\t\tfloat clearcoatDHR = 0.0;\n\n\t#endif\n\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n\n}\n\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n\n}\n",lights_fragment_begin:"\nGeometricContext geometry;\n\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n\n#ifdef CLEARCOAT\n\n\tgeometry.clearcoatNormal = clearcoatNormal;\n\n#endif\n\nIncidentLight directLight;\n\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tPointLight pointLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\n\t\tpointLight = pointLights[ i ];\n\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tdirectLight.color *= all( bvec3( pointLight.shadow, directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\n#endif\n\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tSpotLight spotLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\n\t\tspotLight = spotLights[ i ];\n\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tdirectLight.color *= all( bvec3( spotLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\n#endif\n\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\n\tDirectionalLight directionalLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\n\t\tdirectionalLight = directionalLights[ i ];\n\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectLight.color *= all( bvec3( directionalLight.shadow, directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\n\t}\n\n#endif\n\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\n\tRectAreaLight rectAreaLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\n\t}\n\n#endif\n\n#if defined( RE_IndirectDiffuse )\n\n\tvec3 iblIrradiance = vec3( 0.0 );\n\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\n\t\t}\n\n\t#endif\n\n#endif\n\n#if defined( RE_IndirectSpecular )\n\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n\n#endif\n",lights_fragment_maps:"\n#if defined( RE_IndirectDiffuse )\n\n\t#ifdef USE_LIGHTMAP\n\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\n\t\t\tlightMapIrradiance *= PI; \n\n\t\t#endif\n\n\t\tirradiance += lightMapIrradiance;\n\n\t#endif\n\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\n\t\tiblIrradiance += getLightProbeIndirectIrradiance(  geometry, maxMipLevel );\n\n\t#endif\n\n#endif\n\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\n\tradiance += getLightProbeIndirectRadiance(  geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\n\t#ifdef CLEARCOAT\n\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance(  geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\n\t#endif\n\n#endif\n",lights_fragment_end:"\n#if defined( RE_IndirectDiffuse )\n\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n\n#endif\n\n#if defined( RE_IndirectSpecular )\n\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n\n#endif\n",logdepthbuf_fragment:"\n#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n\n#endif\n",logdepthbuf_pars_fragment:"\n#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n\n#endif\n",logdepthbuf_pars_vertex:"\n#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\n\t#else\n\n\t\tuniform float logDepthBufFC;\n\n\t#endif\n\n#endif\n",logdepthbuf_vertex:"\n#ifdef USE_LOGDEPTHBUF\n\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\n\t#else\n\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\n\t\t\tgl_Position.z *= gl_Position.w;\n\n\t\t}\n\n\t#endif\n\n#endif\n",map_fragment:"\n#ifdef USE_MAP\n\n\tvec4 texelColor = texture2D( map, vUv );\n\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n\n#endif\n",map_pars_fragment:"\n#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif\n",map_particle_fragment:"\n#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\n#endif\n\n#ifdef USE_MAP\n\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n\n#endif\n\n#ifdef USE_ALPHAMAP\n\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n\n#endif\n",map_particle_pars_fragment:"\n#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\n\tuniform mat3 uvTransform;\n\n#endif\n\n#ifdef USE_MAP\n\n\tuniform sampler2D map;\n\n#endif\n\n#ifdef USE_ALPHAMAP\n\n\tuniform sampler2D alphaMap;\n\n#endif\n",metalnessmap_fragment:"\nfloat metalnessFactor = metalness;\n\n#ifdef USE_METALNESSMAP\n\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n\n#endif\n",metalnessmap_pars_fragment:"\n#ifdef USE_METALNESSMAP\n\n\tuniform sampler2D metalnessMap;\n\n#endif\n",morphnormal_vertex:"\n#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\n#endif\n",morphtarget_pars_vertex:"\n#ifdef USE_MORPHTARGETS\n\n\tuniform float morphTargetBaseInfluence;\n\n\t#ifndef USE_MORPHNORMALS\n\n\tuniform float morphTargetInfluences[ 8 ];\n\n\t#else\n\n\tuniform float morphTargetInfluences[ 4 ];\n\n\t#endif\n\n#endif\n",morphtarget_vertex:"\n#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\n\t#ifndef USE_MORPHNORMALS\n\n\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\n\t#endif\n\n#endif\n",normal_fragment_begin:"\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n\n#else\n\n\tvec3 normal = normalize( vNormal );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t#endif\n\n\t#ifdef USE_TANGENT\n\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\n\t\t#ifdef DOUBLE_SIDED\n\n\t\t\ttangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t\t\tbitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t\t#endif\n\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\n\t\t#endif\n\n\t#endif\n\n#endif\nvec3 geometryNormal = normal;\n\n",normal_fragment_maps:"\n\n#ifdef OBJECTSPACE_NORMALMAP\n\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0; \n\n\t#ifdef FLIP_SIDED\n\n\t\tnormal = - normal;\n\n\t#endif\n\n\t#ifdef DOUBLE_SIDED\n\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t#endif\n\n\tnormal = normalize( normalMatrix * normal );\n\n#elif defined( TANGENTSPACE_NORMALMAP )\n\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\n\t#ifdef USE_TANGENT\n\n\t\tnormal = normalize( vTBN * mapN );\n\n\t#else\n\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN );\n\n\t#endif\n\n#elif defined( USE_BUMPMAP )\n\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n\n#endif\n",normalmap_pars_fragment:"\n#ifdef USE_NORMALMAP\n\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\n#endif\n\n#ifdef OBJECTSPACE_NORMALMAP\n\n\tuniform mat3 normalMatrix;\n\n#endif\n\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s ); \n\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\n\t\tmat3 tsn = mat3( S, T, N );\n\n\t\tmapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\n\t\treturn normalize( tsn * mapN );\n\n\t}\n\n#endif\n",clearcoat_normal_fragment_begin:"\n#ifdef CLEARCOAT\n\n\tvec3 clearcoatNormal = geometryNormal;\n\n#endif\n",clearcoat_normal_fragment_maps:"\n#ifdef USE_CLEARCOAT_NORMALMAP\n\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\n\t#ifdef USE_TANGENT\n\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\n\t#else\n\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );\n\n\t#endif\n\n#endif\n",clearcoat_normalmap_pars_fragment:"\n#ifdef USE_CLEARCOAT_NORMALMAP\n\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n\n#endif\n",packing:"\nvec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\n\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\n\nconst float PackUpscale = 256. / 255.; \nconst float UnpackDownscale = 255. / 256.; \n\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\n\nconst float ShiftRight8 = 1. / 256.;\n\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8; \n\treturn r * PackUpscale;\n}\n\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\n\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\n\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"\n#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n\n#endif\n",project_vertex:"\nvec4 mvPosition = vec4( transformed, 1.0 );\n\n#ifdef USE_INSTANCING\n\n\tmvPosition = instanceMatrix * mvPosition;\n\n#endif\n\nmvPosition = modelViewMatrix * mvPosition;\n\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"\n#ifdef DITHERING\n\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n\n#endif\n",dithering_pars_fragment:"\n#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\t\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n\n#endif\n",roughnessmap_fragment:"\nfloat roughnessFactor = roughness;\n\n#ifdef USE_ROUGHNESSMAP\n\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n\n#endif\n",roughnessmap_pars_fragment:"\n#ifdef USE_ROUGHNESSMAP\n\n\tuniform sampler2D roughnessMap;\n\n#endif\n",shadowmap_pars_fragment:"\n#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\n\t}\n\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\n\t}\n\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\n\t\tfloat occlusion = 1.0;\n\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\n\t\tfloat hard_shadow = step( compare , distribution.x ); \n\n\t\tif (hard_shadow != 1.0 ) {\n\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance ); \n\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 ); \n\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\n\t\t}\n\t\treturn occlusion;\n\n\t}\n\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\n\t\tfloat shadow = 1.0;\n\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\n\t\tbool frustumTest = all( frustumTestVec );\n\n\t\tif ( frustumTest ) {\n\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\n\t\t#else \n\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\n\t\t#endif\n\n\t\t}\n\n\t\treturn shadow;\n\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\n\t\tif ( absV.z >= almostOne ) {\n\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\n\t\t} else if ( absV.x >= almostOne ) {\n\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\n\t\t} else if ( absV.y >= almostOne ) {\n\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\n\t}\n\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear ); \n\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\n\t\t#else \n\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\n\t\t#endif\n\n\t}\n\n#endif\n",shadowmap_pars_vertex:"\n#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\n\t#endif\n#endif\n",shadowmap_vertex:"\n#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\n\t}\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\n\t}\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\n\t}\n\n\t#endif\n#endif\n",shadowmask_pars_fragment:"\nfloat getShadowMask() {\n\n\tfloat shadow = 1.0;\n\n\t#ifdef USE_SHADOWMAP\n\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\n\tDirectionalLight directionalLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= all( bvec2( directionalLight.shadow, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\n\t}\n\n\t#endif\n\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\n\tSpotLight spotLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= all( bvec2( spotLight.shadow, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\n\t}\n\n\t#endif\n\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\n\tPointLight pointLight;\n\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= all( bvec2( pointLight.shadow, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\n\t}\n\n\t#endif\n\t#endif\n\n\treturn shadow;\n\n}\n",skinbase_vertex:"\n#ifdef USE_SKINNING\n\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n\n#endif\n",skinning_pars_vertex:"\n#ifdef USE_SKINNING\n\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\n\t#ifdef BONE_TEXTURE\n\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\n\t\t\ty = dy * ( y + 0.5 );\n\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\n\t\t\treturn bone;\n\n\t\t}\n\n\t#else\n\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\n\t\tmat4 getBoneMatrix( const in float i ) {\n\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\n\t\t}\n\n\t#endif\n\n#endif\n",skinning_vertex:"\n#ifdef USE_SKINNING\n\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n\n#endif\n",skinnormal_vertex:"\n#ifdef USE_SKINNING\n\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\n\t#ifdef USE_TANGENT\n\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\n\t#endif\n\n#endif\n",specularmap_fragment:"\nfloat specularStrength;\n\n#ifdef USE_SPECULARMAP\n\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n\n#else\n\n\tspecularStrength = 1.0;\n\n#endif\n",specularmap_pars_fragment:"\n#ifdef USE_SPECULARMAP\n\n\tuniform sampler2D specularMap;\n\n#endif\n",tonemapping_fragment:"\n#if defined( TONE_MAPPING )\n\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n\n#endif\n",tonemapping_pars_fragment:"\n#ifndef saturate\n\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\n\treturn toneMappingExposure * color;\n\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\n\tcolor *= toneMappingExposure;\n\treturn saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );\n\n}\n",uv_pars_fragment:"\n#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\n\tvarying vec2 vUv;\n\n#endif\n",uv_pars_vertex:"\n#ifdef USE_UV\n\n\t#ifdef UVS_VERTEX_ONLY\n\n\t\tvec2 vUv;\n\n\t#else\n\n\t\tvarying vec2 vUv;\n\n\t#endif\n\n\tuniform mat3 uvTransform;\n\n#endif\n",uv_vertex:"\n#ifdef USE_UV\n\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\n#endif\n",uv2_pars_fragment:"\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tvarying vec2 vUv2;\n\n#endif\n",uv2_pars_vertex:"\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\n\tuniform mat3 uv2Transform;\n\n#endif\n",uv2_vertex:"\n#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n\n#endif\n",worldpos_vertex:"\n#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\n\t#ifdef USE_INSTANCING\n\n\t\tworldPosition = instanceMatrix * worldPosition;\n\n\t#endif\n\n\tworldPosition = modelMatrix * worldPosition;\n\n#endif\n",background_frag:"\nuniform sampler2D t2D;\n\nvarying vec2 vUv;\n\nvoid main() {\n\n\tvec4 texColor = texture2D( t2D, vUv );\n\n\tgl_FragColor = mapTexelToLinear( texColor );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\n}\n",background_vert:"\nvarying vec2 vUv;\nuniform mat3 uvTransform;\n\nvoid main() {\n\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n\n}\n",cube_frag:"\n\n#include <envmap_common_pars_fragment>\nuniform float opacity;\n\nvarying vec3 vWorldDirection;\n\n#include <cube_uv_reflection_fragment>\n\nvoid main() {\n\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\n}\n",cube_vert:"\nvarying vec3 vWorldDirection;\n\n#include <common>\n\nvoid main() {\n\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\n\tgl_Position.z = gl_Position.w; \n\n}\n",depth_frag:"\n#if DEPTH_PACKING == 3200\n\n\tuniform float opacity;\n\n#endif\n\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( 1.0 );\n\n\t#if DEPTH_PACKING == 3200\n\n\t\tdiffuseColor.a = opacity;\n\n\t#endif\n\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\t#include <logdepthbuf_fragment>\n\n\t#if DEPTH_PACKING == 3200\n\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\n\t#elif DEPTH_PACKING == 3201\n\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\n\t#endif\n\n}\n",depth_vert:"\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_DISPLACEMENTMAP\n\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n}\n",distanceRGBA_frag:"\n#define DISTANCE\n\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main () {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( 1.0 );\n\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist ); \n\n\tgl_FragColor = packDepthToRGBA( dist );\n\n}\n",distanceRGBA_vert:"\n#define DISTANCE\n\nvarying vec3 vWorldPosition;\n\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_DISPLACEMENTMAP\n\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvWorldPosition = worldPosition.xyz;\n\n}\n",equirect_frag:"\nuniform sampler2D tEquirect;\n\nvarying vec3 vWorldDirection;\n\n#include <common>\n\nvoid main() {\n\n\tvec3 direction = normalize( vWorldDirection );\n\n\tvec2 sampleUV;\n\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\n\tgl_FragColor = mapTexelToLinear( texColor );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\n}\n",equirect_vert:"\nvarying vec3 vWorldDirection;\n\n#include <common>\n\nvoid main() {\n\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\n}\n",linedashed_frag:"\nuniform vec3 diffuse;\nuniform float opacity;\n\nuniform float dashSize;\nuniform float totalSize;\n\nvarying float vLineDistance;\n\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\n\t\tdiscard;\n\n\t}\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\n\toutgoingLight = diffuseColor.rgb; \n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\n}\n",linedashed_vert:"\nuniform float scale;\nattribute float lineDistance;\n\nvarying float vLineDistance;\n\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <color_vertex>\n\n\tvLineDistance = scale * lineDistance;\n\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n}\n",meshbasic_frag:"\nuniform vec3 diffuse;\nuniform float opacity;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\n\t#else\n\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\n\t#endif\n\t#include <aomap_fragment>\n\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\n}\n",meshbasic_vert:"\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\n\t#ifdef USE_ENVMAP\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n\n}\n",meshlambert_frag:"\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\n\t#else\n\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\n\t#endif\n\n\t#include <lightmap_fragment>\n\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\n\t#ifdef DOUBLE_SIDED\n\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\n\t#else\n\n\t\treflectedLight.directDiffuse = vLightFront;\n\n\t#endif\n\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"\n#define LAMBERT\n\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshmatcap_frag:"\n#define MATCAP\n\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5; \n\n\t#ifdef USE_MATCAP\n\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\n\t#else\n\n\t\tvec4 matcapColor = vec4( 1.0 );\n\n\t#endif\n\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\n}\n",meshmatcap_vert:"\n#define MATCAP\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#ifndef FLAT_SHADED \n\n\t\tvNormal = normalize( transformedNormal );\n\n\t#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n}\n",meshtoon_frag:"\n#define TOON\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n",meshtoon_vert:"\n#define TOON\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED \n\n\tvNormal = normalize( transformedNormal );\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n",meshphong_frag:"\n#define PHONG\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\n\t#include <envmap_fragment>\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n",meshphong_vert:"\n#define PHONG\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED \n\n\tvNormal = normalize( transformedNormal );\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n",meshphysical_frag:"\n#define STANDARD\n\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSPARENCY\n#endif\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\n#ifdef TRANSPARENCY\n\tuniform float transparency;\n#endif\n\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSPARENCY\n\t\tdiffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t#endif\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n",meshphysical_vert:"\n#define STANDARD\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED \n\n\tvNormal = normalize( transformedNormal );\n\n\t#ifdef USE_TANGENT\n\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\n\t#endif\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\tvViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n",normal_frag:"\n#define NORMAL\n\nuniform float opacity;\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\n\tvarying vec3 vViewPosition;\n\n#endif\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\n}\n",normal_vert:"\n#define NORMAL\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\n\tvarying vec3 vViewPosition;\n\n#endif\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED \n\n\tvNormal = normalize( transformedNormal );\n\n\t#ifdef USE_TANGENT\n\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\n\t#endif\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\n\tvViewPosition = - mvPosition.xyz;\n\n#endif\n\n}\n",points_frag:"\nuniform vec3 diffuse;\nuniform float opacity;\n\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\n\toutgoingLight = diffuseColor.rgb;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\n}\n",points_vert:"\nuniform float size;\nuniform float scale;\n\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\n\tgl_PointSize = size;\n\n\t#ifdef USE_SIZEATTENUATION\n\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\n\t#endif\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n\n}\n",shadow_frag:"\nuniform vec3 color;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n\nvoid main() {\n\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\n}\n",shadow_vert:"\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n\nvoid main() {\n\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n",sprite_frag:"\nuniform vec3 diffuse;\nuniform float opacity;\n\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\n\toutgoingLight = diffuseColor.rgb;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\n}\n",sprite_vert:"\nuniform float rotation;\nuniform vec2 center;\n\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\n\t#ifndef USE_SIZEATTENUATION\n\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\n\t#endif\n\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\n\tmvPosition.xy += rotatedPosition;\n\n\tgl_Position = projectionMatrix * mvPosition;\n\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\n}\n"},Ba={basic:{uniforms:Zo([so.common,so.specularmap,so.envmap,so.aomap,so.lightmap,so.fog]),vertexShader:Ua.meshbasic_vert,fragmentShader:Ua.meshbasic_frag},lambert:{uniforms:Zo([so.common,so.specularmap,so.envmap,so.aomap,so.lightmap,so.emissivemap,so.fog,so.lights,{emissive:{value:new ro(0)}}]),vertexShader:Ua.meshlambert_vert,fragmentShader:Ua.meshlambert_frag},phong:{uniforms:Zo([so.common,so.specularmap,so.envmap,so.aomap,so.lightmap,so.emissivemap,so.bumpmap,so.normalmap,so.displacementmap,so.fog,so.lights,{emissive:{value:new ro(0)},specular:{value:new ro(1118481)},shininess:{value:30}}]),vertexShader:Ua.meshphong_vert,fragmentShader:Ua.meshphong_frag},standard:{uniforms:Zo([so.common,so.envmap,so.aomap,so.lightmap,so.emissivemap,so.bumpmap,so.normalmap,so.displacementmap,so.roughnessmap,so.metalnessmap,so.fog,so.lights,{emissive:{value:new ro(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Ua.meshphysical_vert,fragmentShader:Ua.meshphysical_frag},toon:{uniforms:Zo([so.common,so.specularmap,so.aomap,so.lightmap,so.emissivemap,so.bumpmap,so.normalmap,so.displacementmap,so.gradientmap,so.fog,so.lights,{emissive:{value:new ro(0)},specular:{value:new ro(1118481)},shininess:{value:30}}]),vertexShader:Ua.meshtoon_vert,fragmentShader:Ua.meshtoon_frag},matcap:{uniforms:Zo([so.common,so.bumpmap,so.normalmap,so.displacementmap,so.fog,{matcap:{value:null}}]),vertexShader:Ua.meshmatcap_vert,fragmentShader:Ua.meshmatcap_frag},points:{uniforms:Zo([so.points,so.fog]),vertexShader:Ua.points_vert,fragmentShader:Ua.points_frag},dashed:{uniforms:Zo([so.common,so.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ua.linedashed_vert,fragmentShader:Ua.linedashed_frag},depth:{uniforms:Zo([so.common,so.displacementmap]),vertexShader:Ua.depth_vert,fragmentShader:Ua.depth_frag},normal:{uniforms:Zo([so.common,so.bumpmap,so.normalmap,so.displacementmap,{opacity:{value:1}}]),vertexShader:Ua.normal_vert,fragmentShader:Ua.normal_frag},sprite:{uniforms:Zo([so.sprite,so.fog]),vertexShader:Ua.sprite_vert,fragmentShader:Ua.sprite_frag},background:{uniforms:{uvTransform:{value:new ei},t2D:{value:null}},vertexShader:Ua.background_vert,fragmentShader:Ua.background_frag},cube:{uniforms:Zo([so.envmap,{opacity:{value:1}}]),vertexShader:Ua.cube_vert,fragmentShader:Ua.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ua.equirect_vert,fragmentShader:Ua.equirect_frag},distanceRGBA:{uniforms:Zo([so.common,so.displacementmap,{referencePosition:{value:new jr},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ua.distanceRGBA_vert,fragmentShader:Ua.distanceRGBA_frag},shadow:{uniforms:Zo([so.lights,so.fog,{color:{value:new ro(0)},opacity:{value:1}}]),vertexShader:Ua.shadow_vert,fragmentShader:Ua.shadow_frag}};function ja(e,t){return Math.abs(t[1])-Math.abs(e[1])}function za(e,t,n,r,i,o,a,s,c,u){e=void 0!==e?e:[],t=void 0!==t?t:301,a=void 0!==a?a:Si,Ai.call(this,e,t,n,r,i,o,a,s,c,u),this.flipY=!1}function Va(e,t,n,r){Ai.call(this,null),this.image={data:e||null,width:t||1,height:n||1,depth:r||1},this.magFilter=_i,this.minFilter=_i,this.wrapR=bi,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}function Ga(e,t,n,r){Ai.call(this,null),this.image={data:e||null,width:t||1,height:n||1,depth:r||1},this.magFilter=_i,this.minFilter=_i,this.wrapR=bi,this.generateMipmaps=!1,this.flipY=!1,this.needsUpdate=!0}Ba.physical={uniforms:Zo([Ba.standard.uniforms,{transparency:{value:0},clearcoat:{value:0},clearcoatRoughness:{value:0},sheen:{value:new ro(0)},clearcoatNormalScale:{value:new Mi(1,1)},clearcoatNormalMap:{value:null}}]),vertexShader:Ua.meshphysical_vert,fragmentShader:Ua.meshphysical_frag},za.prototype=Object.create(Ai.prototype),za.prototype.constructor=za,za.prototype.isCubeTexture=!0,Object.defineProperty(za.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),Va.prototype=Object.create(Ai.prototype),Va.prototype.constructor=Va,Va.prototype.isDataTexture2DArray=!0,Ga.prototype=Object.create(Ai.prototype),Ga.prototype.constructor=Ga,Ga.prototype.isDataTexture3D=!0;var Wa=new Ai,Ha=new Va,qa=new Ga,Xa=new za,Ya=[],Za=[],Ja=new Float32Array(16),Ka=new Float32Array(9),$a=new Float32Array(4);function Qa(e,t,n){var r=e[0];if(r<=0||r>0)return e;var i=t*n,o=Ya[i];if(void 0===o&&(o=new Float32Array(i),Ya[i]=o),0!==t){r.toArray(o,0);for(var a=1,s=0;a!==t;++a)s+=n,e[a].toArray(o,s)}return o}function es(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function ts(e,t){for(var n=0,r=t.length;n<r;n++)e[n]=t[n]}function ns(e,t){var n=Za[t];void 0===n&&(n=new Int32Array(t),Za[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function rs(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function is(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(es(n,t))return;e.uniform2fv(this.addr,t),ts(n,t)}}function os(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(es(n,t))return;e.uniform3fv(this.addr,t),ts(n,t)}}function as(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(es(n,t))return;e.uniform4fv(this.addr,t),ts(n,t)}}function ss(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(es(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),ts(n,t)}else{if(es(n,r))return;$a.set(r),e.uniformMatrix2fv(this.addr,!1,$a),ts(n,r)}}function cs(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(es(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),ts(n,t)}else{if(es(n,r))return;Ka.set(r),e.uniformMatrix3fv(this.addr,!1,Ka),ts(n,r)}}function us(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(es(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),ts(n,t)}else{if(es(n,r))return;Ja.set(r),e.uniformMatrix4fv(this.addr,!1,Ja),ts(n,r)}}function ls(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTexture2D(t||Wa,i)}function hs(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture2DArray(t||Ha,i)}function fs(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.setTexture3D(t||qa,i)}function ds(e,t,n){var r=this.cache,i=n.allocateTextureUnit();r[0]!==i&&(e.uniform1i(this.addr,i),r[0]=i),n.safeSetTextureCube(t||Xa,i)}function ps(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function ms(e,t){var n=this.cache;es(n,t)||(e.uniform2iv(this.addr,t),ts(n,t))}function vs(e,t){var n=this.cache;es(n,t)||(e.uniform3iv(this.addr,t),ts(n,t))}function gs(e,t){var n=this.cache;es(n,t)||(e.uniform4iv(this.addr,t),ts(n,t))}function ys(e,t){var n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function bs(e,t){e.uniform1fv(this.addr,t)}function _s(e,t){e.uniform1iv(this.addr,t)}function ws(e,t){e.uniform2iv(this.addr,t)}function xs(e,t){e.uniform3iv(this.addr,t)}function Ss(e,t){e.uniform4iv(this.addr,t)}function Es(e,t){var n=Qa(t,this.size,2);e.uniform2fv(this.addr,n)}function Ms(e,t){var n=Qa(t,this.size,3);e.uniform3fv(this.addr,n)}function Cs(e,t){var n=Qa(t,this.size,4);e.uniform4fv(this.addr,n)}function Ts(e,t){var n=Qa(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function As(e,t){var n=Qa(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function Ps(e,t){var n=Qa(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function Ls(e,t,n){var r=t.length,i=ns(n,r);e.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.safeSetTexture2D(t[o]||Wa,i[o])}function ol(e,t,n){var r=t.length,i=ns(n,r);e.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.safeSetTextureCube(t[o]||Xa,i[o])}function Rs(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return rs;case 35664:return is;case 35665:return os;case 35666:return as;case 35674:return ss;case 35675:return cs;case 35676:return us;case 5124:case 35670:return ps;case 35667:case 35671:return ms;case 35668:case 35672:return vs;case 35669:case 35673:return gs;case 5125:return ys;case 35678:case 36198:case 36298:case 36306:case 35682:return ls;case 35679:case 36299:case 36307:return fs;case 35680:case 36300:case 36308:case 36293:return ds;case 36289:case 36303:case 36311:case 36292:return hs}}(t.type)}function ks(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return bs;case 35664:return Es;case 35665:return Ms;case 35666:return Cs;case 35674:return Ts;case 35675:return As;case 35676:return Ps;case 5124:case 35670:return _s;case 35667:case 35671:return ws;case 35668:case 35672:return xs;case 35669:case 35673:return Ss;case 35678:case 36198:case 36298:case 36306:case 35682:return Ls;case 35680:case 36300:case 36308:case 36293:return ol}}(t.type)}function Ns(e){this.id=e,this.seq=[],this.map={}}ks.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),ts(t,e)},Ns.prototype.setValue=function(e,t,n){for(var r=this.seq,i=0,o=r.length;i!==o;++i){var a=r[i];a.setValue(e,t[a.id],n)}};var ul=/([\w\d_]+)(\])?(\[|\.)?/g;function Os(e,t){e.seq.push(t),e.map[t.id]=t}function Ds(e,t,n){var r=e.name,i=r.length;for(ul.lastIndex=0;;){var o=ul.exec(r),a=ul.lastIndex,s=o[1],c="]"===o[2],u=o[3];if(c&&(s|=0),void 0===u||"["===u&&a+2===i){Os(n,void 0===u?new Rs(s,e,t):new ks(s,e,t));break}var l=n.map[s];void 0===l&&Os(n,l=new Ns(s)),n=l}}function Fs(e,t){this.seq=[],this.map={};for(var n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS),r=0;r<n;++r){var i=e.getActiveUniform(t,r);Ds(i,e.getUniformLocation(t,i.name),this)}}function dl(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}Fs.prototype.setValue=function(e,t,n,r){var i=this.map[t];void 0!==i&&i.setValue(e,n,r)},Fs.prototype.setOptional=function(e,t,n){var r=t[n];void 0!==r&&this.setValue(e,n,r)},Fs.upload=function(e,t,n,r){for(var i=0,o=t.length;i!==o;++i){var a=t[i],s=n[a.id];!1!==s.needsUpdate&&a.setValue(e,s.value,r)}},Fs.seqWithValue=function(e,t){for(var n=[],r=0,i=e.length;r!==i;++r){var o=e[r];o.id in t&&n.push(o)}return n};var Is=0;function Us(e){switch(e){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:throw new Error("unsupported encoding: "+e)}}function Bs(e,t,n){var r=e.getShaderParameter(t,e.COMPILE_STATUS),i=e.getShaderInfoLog(t).trim();return r&&""===i?"":"WebGLShader: gl.getShaderInfoLog() "+n+"\n"+i+function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(e.getShaderSource(t))}function js(e,t){var n=Us(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function zs(e){return""!==e}function Vs(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Gs(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var Ws=/^[ \t]*#include +<([\w\d./]+)>/gm;function Hs(e){return e.replace(Ws,qs)}function qs(e,t){var n=Ua[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return Hs(n)}var Xs=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;function Ys(e){return e.replace(Xs,Zs)}function Zs(e,t,n,r){for(var i="",o=parseInt(t);o<parseInt(n);o++)i+=r.replace(/\[ i \]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return i}function Js(e){var t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Ks(e,t,n){var r,i,o=e.getContext(),a=n.defines,s=n.vertexShader,c=n.fragmentShader,u=function(e){var t="SHADOWMAP_TYPE_BASIC";return 1===e.shadowMapType?t="SHADOWMAP_TYPE_PCF":2===e.shadowMapType?t="SHADOWMAP_TYPE_PCF_SOFT":3===e.shadowMapType&&(t="SHADOWMAP_TYPE_VSM"),t}(n),l=function(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case 301:case 302:t="ENVMAP_TYPE_CUBE";break;case 306:case 307:t="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:t="ENVMAP_TYPE_EQUIREC";break;case 305:t="ENVMAP_TYPE_SPHERE"}return t}(n),h=function(e){var t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case 302:case 304:t="ENVMAP_MODE_REFRACTION"}return t}(n),f=function(e){var t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(n),d=e.gammaFactor>0?e.gammaFactor:1,p=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(zs).join("\n")}(n),m=function(e){var t=[];for(var n in e){var r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(a),v=o.createProgram(),g=n.numMultiviewViews;if(n.isRawShaderMaterial?((r=[m].filter(zs).join("\n")).length>0&&(r+="\n"),(i=[p,m].filter(zs).join("\n")).length>0&&(i+="\n")):(r=[Js(n),"#define SHADER_NAME "+n.shaderName,m,n.instancing?"#define USE_INSTANCING":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+d,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+h:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+u:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(zs).join("\n"),i=[p,Js(n),"#define SHADER_NAME "+n.shaderName,m,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+d,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+l:"",n.envMap?"#define "+h:"",n.envMap?"#define "+f:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+u:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?Ua.tonemapping_pars_fragment:"",0!==n.toneMapping?function(e,t){var n;switch(t){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="Uncharted2";break;case 4:n="OptimizedCineon";break;case 5:n="ACESFilmic";break;default:throw new Error("unsupported toneMapping: "+t)}return"vec3 toneMapping( vec3 color ) { return "+n+"ToneMapping( color ); }"}(0,n.toneMapping):"",n.dithering?"#define DITHERING":"",n.outputEncoding||n.mapEncoding||n.matcapEncoding||n.envMapEncoding||n.emissiveMapEncoding||n.lightMapEncoding?Ua.encodings_pars_fragment:"",n.mapEncoding?js("mapTexelToLinear",n.mapEncoding):"",n.matcapEncoding?js("matcapTexelToLinear",n.matcapEncoding):"",n.envMapEncoding?js("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMapEncoding?js("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMapEncoding?js("lightMapTexelToLinear",n.lightMapEncoding):"",n.outputEncoding?function(e,t){var n=Us(t);return"vec4 linearToOutputTexel( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}(0,n.outputEncoding):"",n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(zs).join("\n")),s=Gs(s=Vs(s=Hs(s),n),n),c=Gs(c=Vs(c=Hs(c),n),n),s=Ys(s),c=Ys(c),n.isWebGL2&&!n.isRawShaderMaterial){var y=!1,b=/^\s*#version\s+300\s+es\s*\n/;n.isShaderMaterial&&null!==s.match(b)&&null!==c.match(b)&&(y=!0,s=s.replace(b,""),c=c.replace(b,"")),r=["#version 300 es\n","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+r,i=["#version 300 es\n","#define varying in",y?"":"out highp vec4 pc_fragColor;",y?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+i,g>0&&(r=(r=r.replace("#version 300 es\n",["#version 300 es\n","#extension GL_OVR_multiview2 : require","layout(num_views = "+g+") in;","#define VIEW_ID gl_ViewID_OVR"].join("\n"))).replace(["uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;"].join("\n"),["uniform mat4 modelViewMatrices["+g+"];","uniform mat4 projectionMatrices["+g+"];","uniform mat4 viewMatrices["+g+"];","uniform mat3 normalMatrices["+g+"];","#define modelViewMatrix modelViewMatrices[VIEW_ID]","#define projectionMatrix projectionMatrices[VIEW_ID]","#define viewMatrix viewMatrices[VIEW_ID]","#define normalMatrix normalMatrices[VIEW_ID]"].join("\n")),i=(i=i.replace("#version 300 es\n",["#version 300 es\n","#extension GL_OVR_multiview2 : require","#define VIEW_ID gl_ViewID_OVR"].join("\n"))).replace("uniform mat4 viewMatrix;",["uniform mat4 viewMatrices["+g+"];","#define viewMatrix viewMatrices[VIEW_ID]"].join("\n")))}var _,w,x=r+s,S=i+c,E=dl(o,o.VERTEX_SHADER,x),M=dl(o,o.FRAGMENT_SHADER,S);if(o.attachShader(v,E),o.attachShader(v,M),void 0!==n.index0AttributeName?o.bindAttribLocation(v,0,n.index0AttributeName):!0===n.morphTargets&&o.bindAttribLocation(v,0,"position"),o.linkProgram(v),e.debug.checkShaderErrors){var C=o.getProgramInfoLog(v).trim(),T=o.getShaderInfoLog(E).trim(),A=o.getShaderInfoLog(M).trim(),P=!0,L=!0;if(!1===o.getProgramParameter(v,o.LINK_STATUS)){P=!1;var R=Bs(o,E,"vertex"),k=Bs(o,M,"fragment");console.error("WebGLProgram: shader error: ",o.getError(),"gl.VALIDATE_STATUS",o.getProgramParameter(v,o.VALIDATE_STATUS),"gl.getProgramInfoLog",C,R,k)}else""!==C?console.warn("WebGLProgram: gl.getProgramInfoLog()",C):""!==T&&""!==A||(L=!1);L&&(this.diagnostics={runnable:P,programLog:C,vertexShader:{log:T,prefix:r},fragmentShader:{log:A,prefix:i}})}return o.deleteShader(E),o.deleteShader(M),this.getUniforms=function(){return void 0===_&&(_=new Fs(o,v)),_},this.getAttributes=function(){return void 0===w&&(w=function(e,t){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),i=0;i<r;i++){var o=e.getActiveAttrib(t,i).name;n[o]=e.getAttribLocation(t,o)}return n}(o,v)),w},this.destroy=function(){o.deleteProgram(v),this.program=void 0},this.name=n.shaderName,this.id=Is++,this.cacheKey=t,this.usedTimes=1,this.program=v,this.vertexShader=E,this.fragmentShader=M,this.numMultiviewViews=g,this}function $s(e,t,n){var r=[],i=n.isWebGL2,o=n.logarithmicDepthBuffer,a=n.floatVertexTextures,s=n.precision,c=n.maxVertexUniforms,u=n.vertexTextures,l={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},h=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","numMultiviewViews","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen"];function f(e){var t;return e?e.isTexture?t=e.encoding:e.isWebGLRenderTarget&&(console.warn("WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),t=e.texture.encoding):t=3e3,t}this.getParameters=function(r,h,d,p,m,v,g){var y=p.fog,b=r.isMeshStandardMaterial?p.environment:null,_=r.envMap||b,w=l[r.type],x=g.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(a)return 1024;var n=c,r=Math.floor((n-20)/4),i=Math.min(r,t.length);return i<t.length?(console.warn("WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+i+"."),0):i}(g):0;null!==r.precision&&(s=n.getMaxPrecision(r.precision))!==r.precision&&console.warn("WebGLProgram.getParameters:",r.precision,"not supported, using",s,"instead.");var S=function(e,t){var n;if(t){var r=Ba[t];n={name:e.type,uniforms:Jo.clone(r.uniforms),vertexShader:r.vertexShader,fragmentShader:r.fragmentShader}}else n={name:e.type,uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader};return n}(r,w);r.onBeforeCompile(S,e);var E=e.getRenderTarget(),M=E&&E.isWebGLMultiviewRenderTarget?E.numViews:0;return{isWebGL2:i,shaderID:w,shaderName:S.name,uniforms:S.uniforms,vertexShader:S.vertexShader,fragmentShader:S.fragmentShader,defines:r.defines,isRawShaderMaterial:r.isRawShaderMaterial,isShaderMaterial:r.isShaderMaterial,precision:s,instancing:!0===g.isInstancedMesh,supportsVertexTextures:u,numMultiviewViews:M,outputEncoding:null!==E?f(E.texture):e.outputEncoding,map:!!r.map,mapEncoding:f(r.map),matcap:!!r.matcap,matcapEncoding:f(r.matcap),envMap:!!_,envMapMode:_&&_.mapping,envMapEncoding:f(_),envMapCubeUV:!!_&&(306===_.mapping||307===_.mapping),lightMap:!!r.lightMap,lightMapEncoding:f(r.lightMap),aoMap:!!r.aoMap,emissiveMap:!!r.emissiveMap,emissiveMapEncoding:f(r.emissiveMap),bumpMap:!!r.bumpMap,normalMap:!!r.normalMap,objectSpaceNormalMap:1===r.normalMapType,tangentSpaceNormalMap:0===r.normalMapType,clearcoatNormalMap:!!r.clearcoatNormalMap,displacementMap:!!r.displacementMap,roughnessMap:!!r.roughnessMap,metalnessMap:!!r.metalnessMap,specularMap:!!r.specularMap,alphaMap:!!r.alphaMap,gradientMap:!!r.gradientMap,sheen:!!r.sheen,combine:r.combine,vertexTangents:r.normalMap&&r.vertexTangents,vertexColors:r.vertexColors,vertexUvs:!!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatNormalMap||r.displacementMap),uvsVertexOnly:!(r.map||r.bumpMap||r.normalMap||r.specularMap||r.alphaMap||r.emissiveMap||r.roughnessMap||r.metalnessMap||r.clearcoatNormalMap||!r.displacementMap),fog:!!y,useFog:r.fog,fogExp2:y&&y.isFogExp2,flatShading:r.flatShading,sizeAttenuation:r.sizeAttenuation,logarithmicDepthBuffer:o,skinning:r.skinning&&x>0,maxBones:x,useVertexTexture:a,morphTargets:r.morphTargets,morphNormals:r.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:h.directional.length,numPointLights:h.point.length,numSpotLights:h.spot.length,numRectAreaLights:h.rectArea.length,numHemiLights:h.hemi.length,numDirLightShadows:h.directionalShadowMap.length,numPointLightShadows:h.pointShadowMap.length,numSpotLightShadows:h.spotShadowMap.length,numClippingPlanes:m,numClipIntersection:v,dithering:r.dithering,shadowMapEnabled:e.shadowMap.enabled&&d.length>0,shadowMapType:e.shadowMap.type,toneMapping:r.toneMapped?e.toneMapping:0,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:r.premultipliedAlpha,alphaTest:r.alphaTest,doubleSided:2===r.side,flipSided:1===r.side,depthPacking:void 0!==r.depthPacking&&r.depthPacking,index0AttributeName:r.index0AttributeName,extensionDerivatives:r.extensions&&r.extensions.derivatives,extensionFragDepth:r.extensions&&r.extensions.frawbuffers,extensionDrawbuffers:r.extensions&&r.extensions.drawbuffers,extensionShaderTextureLOD:r.extensions&&r.extensions.shaderTextureLOD,rendererExtensionFragDepth:i||null!==t.get("EXT_frag_depth"),rendererExtensionDrawBuffers:i||null!==t.get("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:i||null!==t.get("EXT_shader_texture_lod"),onBeforeCompile:r.onBeforeCompile}},this.getProgramCacheKey=function(t){var n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var r in t.defines)n.push(r),n.push(t.defines[r]);if(void 0===t.isRawShaderMaterial){for(var i=0;i<h.length;i++)n.push(t[h[i]]);n.push(e.outputEncoding),n.push(e.gammaFactor)}return n.push(t.onBeforeCompile.toString()),n.join()},this.acquireProgram=function(t,n){for(var i,o=0,a=r.length;o<a;o++){var s=r[o];if(s.cacheKey===n){++(i=s).usedTimes;break}}return void 0===i&&(i=new Ks(e,n,t),r.push(i)),i},this.releaseProgram=function(e){if(0==--e.usedTimes){var t=r.indexOf(e);r[t]=r[r.length-1],r.pop(),e.destroy()}},this.programs=r}function Qs(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function ec(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function tc(){var e=[],t=0,n=[],r=[],i={id:-1};function o(n,r,o,a,s,c){var u=e[t];return void 0===u?(u={id:n.id,object:n,geometry:r,material:o,program:o.program||i,groupOrder:a,renderOrder:n.renderOrder,z:s,group:c},e[t]=u):(u.id=n.id,u.object=n,u.geometry=r,u.material=o,u.program=o.program||i,u.groupOrder=a,u.renderOrder=n.renderOrder,u.z=s,u.group=c),t++,u}return{opaque:n,transparent:r,init:function(){t=0,n.length=0,r.length=0},push:function(e,t,i,a,s,c){var u=o(e,t,i,a,s,c);(!0===i.transparent?r:n).push(u)},unshift:function(e,t,i,a,s,c){var u=o(e,t,i,a,s,c);(!0===i.transparent?r:n).unshift(u)},sort:function(e,t){n.length>1&&n.sort(e||Qs),r.length>1&&r.sort(t||ec)}}}var nc=0;function rc(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function ic(){for(var e=new function(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new jr,color:new ro,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Mi};break;case"SpotLight":n={position:new jr,direction:new jr,color:new ro,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Mi};break;case"PointLight":n={position:new jr,color:new ro,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Mi,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":n={direction:new jr,skyColor:new ro,groundColor:new ro};break;case"RectAreaLight":n={color:new ro,position:new jr,halfWidth:new jr,halfHeight:new jr}}return e[t.id]=n,n}}},t={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},n=0;n<9;n++)t.probe.push(new jr);var r=new jr,i=new Yr,o=new Yr;return{setup:function(n,a,s){for(var c=0,u=0,l=0,h=0;h<9;h++)t.probe[h].set(0,0,0);var f=0,d=0,p=0,m=0,v=0,g=0,y=0,b=0,_=s.matrixWorldInverse;n.sort(rc),h=0;for(var w=n.length;h<w;h++){var x=n[h],S=x.color,E=x.intensity,M=x.distance,C=x.shadow&&x.shadow.map?x.shadow.map.texture:null;if(x.isAmbientLight)c+=S.r*E,u+=S.g*E,l+=S.b*E;else if(x.isLightProbe)for(var T=0;T<9;T++)t.probe[T].addScaledVector(x.sh.coefficients[T],E);else if(x.isDirectionalLight){if((P=e.get(x)).color.copy(x.color).multiplyScalar(x.intensity),P.direction.setFromMatrixPosition(x.matrixWorld),r.setFromMatrixPosition(x.target.matrixWorld),P.direction.sub(r),P.direction.transformDirection(_),P.shadow=x.castShadow,x.castShadow){var A=x.shadow;P.shadowBias=A.bias,P.shadowRadius=A.radius,P.shadowMapSize=A.mapSize,t.directionalShadowMap[f]=C,t.directionalShadowMatrix[f]=x.shadow.matrix,g++}t.directional[f]=P,f++}else if(x.isSpotLight)(P=e.get(x)).position.setFromMatrixPosition(x.matrixWorld),P.position.applyMatrix4(_),P.color.copy(S).multiplyScalar(E),P.distance=M,P.direction.setFromMatrixPosition(x.matrixWorld),r.setFromMatrixPosition(x.target.matrixWorld),P.direction.sub(r),P.direction.transformDirection(_),P.coneCos=Math.cos(x.angle),P.penumbraCos=Math.cos(x.angle*(1-x.penumbra)),P.decay=x.decay,P.shadow=x.castShadow,x.castShadow&&(A=x.shadow,P.shadowBias=A.bias,P.shadowRadius=A.radius,P.shadowMapSize=A.mapSize,t.spotShadowMap[p]=C,t.spotShadowMatrix[p]=x.shadow.matrix,b++),t.spot[p]=P,p++;else if(x.isRectAreaLight)(P=e.get(x)).color.copy(S).multiplyScalar(E),P.position.setFromMatrixPosition(x.matrixWorld),P.position.applyMatrix4(_),o.identity(),i.copy(x.matrixWorld),i.premultiply(_),o.extractRotation(i),P.halfWidth.set(.5*x.width,0,0),P.halfHeight.set(0,.5*x.height,0),P.halfWidth.applyMatrix4(o),P.halfHeight.applyMatrix4(o),t.rectArea[m]=P,m++;else if(x.isPointLight)(P=e.get(x)).position.setFromMatrixPosition(x.matrixWorld),P.position.applyMatrix4(_),P.color.copy(x.color).multiplyScalar(x.intensity),P.distance=x.distance,P.decay=x.decay,P.shadow=x.castShadow,x.castShadow&&(A=x.shadow,P.shadowBias=A.bias,P.shadowRadius=A.radius,P.shadowMapSize=A.mapSize,P.shadowCameraNear=A.camera.near,P.shadowCameraFar=A.camera.far,t.pointShadowMap[d]=C,t.pointShadowMatrix[d]=x.shadow.matrix,y++),t.point[d]=P,d++;else if(x.isHemisphereLight){var P;(P=e.get(x)).direction.setFromMatrixPosition(x.matrixWorld),P.direction.transformDirection(_),P.direction.normalize(),P.skyColor.copy(x.color).multiplyScalar(E),P.groundColor.copy(x.groundColor).multiplyScalar(E),t.hemi[v]=P,v++}}t.ambient[0]=c,t.ambient[1]=u,t.ambient[2]=l;var L=t.hash;L.directionalLength===f&&L.pointLength===d&&L.spotLength===p&&L.rectAreaLength===m&&L.hemiLength===v&&L.numDirectionalShadows===g&&L.numPointShadows===y&&L.numSpotShadows===b||(t.directional.length=f,t.spot.length=p,t.rectArea.length=m,t.point.length=d,t.hemi.length=v,t.directionalShadowMap.length=g,t.pointShadowMap.length=y,t.spotShadowMap.length=b,t.directionalShadowMatrix.length=g,t.pointShadowMatrix.length=y,t.spotShadowMatrix.length=b,L.directionalLength=f,L.pointLength=d,L.spotLength=p,L.rectAreaLength=m,L.hemiLength=v,L.numDirectionalShadows=g,L.numPointShadows=y,L.numSpotShadows=b,t.version=nc++)},state:t}}function oc(){var e=new ic,t=[],n=[];return{init:function(){t.length=0,n.length=0},state:{lightsArray:t,shadowsArray:n,lights:e},setupLights:function(r){e.setup(t,n,r)},pushLight:function(e){t.push(e)},pushShadow:function(e){n.push(e)}}}function ac(e,t,n){this.width=e,this.height=t,this.scissor=new co(0,0,e,t),this.scissorTest=!1,this.viewport=new co(0,0,e,t),n=n||{},this.texture=new Ai(void 0,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=t,this.texture.generateMipmaps=void 0!==n.generateMipmaps&&n.generateMipmaps,this.texture.minFilter=void 0!==n.minFilter?n.minFilter:wi,this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function sc(e){Xo.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}function cc(e){Xo.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new jr,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}function uc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function lc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hc(e,t,n,r,i,o,a){var s,c,u,l=i.isWebGL2,h=i.maxTextures,f=i.maxCubemapSize,d=i.maxTextureSize,p=i.maxSamples,m=new WeakMap,v=!1;try{v="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function g(e,t){return v?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function y(e,t,n,r){var i=1;if((e.width>r||e.height>r)&&(i=r/Math.max(e.width,e.height)),i<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){var o=t?Fr.floorPowerOfTwo:Math.floor,a=o(i*e.width),s=o(i*e.height);void 0===u&&(u=g(a,s));var c=n?g(a,s):u;return c.width=a,c.height=s,c.getContext("2d").drawImage(e,0,0,a,s),console.warn("WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+a+"x"+s+")."),c}return"data"in e&&console.warn("WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function b(e){return Fr.isPowerOfTwo(e.width)&&Fr.isPowerOfTwo(e.height)}function _(e,t){return e.generateMipmaps&&t&&e.minFilter!==_i&&e.minFilter!==wi}function w(t,n,i,o){e.generateMipmap(t),r.get(n).__maxMipLevel=Math.log(Math.max(i,o))*Math.LOG2E}function x(n,r,i){if(!1===l)return r;if(null!==n){if(void 0!==e[n])return e[n];console.warn("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var o=r;return r===e.RED&&(i===e.FLOAT&&(o=e.R32F),i===e.HALF_FLOAT&&(o=e.R16F),i===e.UNSIGNED_BYTE&&(o=e.R8)),r===e.RGB&&(i===e.FLOAT&&(o=e.RGB32F),i===e.HALF_FLOAT&&(o=e.RGB16F),i===e.UNSIGNED_BYTE&&(o=e.RGB8)),r===e.RGBA&&(i===e.FLOAT&&(o=e.RGBA32F),i===e.HALF_FLOAT&&(o=e.RGBA16F),i===e.UNSIGNED_BYTE&&(o=e.RGBA8)),o===e.R16F||o===e.R32F||o===e.RGBA16F||o===e.RGBA32F?t.get("EXT_color_buffer_float"):o!==e.RGB16F&&o!==e.RGB32F||console.warn("WebGLRenderer: Floating point textures with RGB format not supported. Please use RGBA instead."),o}function S(t){return t===_i||1004===t||1005===t?e.NEAREST:e.LINEAR}function E(t){var n=t.target;n.removeEventListener("dispose",E),function(t){var n=r.get(t);void 0!==n.__webglInit&&(e.deleteTexture(n.__webglTexture),r.remove(t))}(n),n.isVideoTexture&&m.delete(n),a.memory.textures--}function M(t){var n=t.target;n.removeEventListener("dispose",M),function(t){var n=r.get(t),i=r.get(t.texture);if(t){if(void 0!==i.__webglTexture&&e.deleteTexture(i.__webglTexture),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLCubeRenderTarget)for(var o=0;o<6;o++)e.deleteFramebuffer(n.__webglFramebuffer[o]),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[o]);else e.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer);if(t.isWebGLMultiviewRenderTarget){e.deleteTexture(n.__webglColorTexture),e.deleteTexture(n.__webglDepthStencilTexture),a.memory.textures-=2,o=0;for(var s=n.__webglViewFramebuffers.length;o<s;o++)e.deleteFramebuffer(n.__webglViewFramebuffers[o])}r.remove(t.texture),r.remove(t)}}(n),a.memory.textures--}var C=0;function T(t,i){var o=r.get(t);if(t.isVideoTexture&&function(e){var t=a.render.frame;m.get(e)!==t&&(m.set(e,t),e.update())}(t),t.version>0&&o.__version!==t.version){var s=t.image;if(void 0===s)console.warn("WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==s.complete)return void O(o,t,i);console.warn("WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(e.TEXTURE0+i),n.bindTexture(e.TEXTURE_2D,o.__webglTexture)}function A(t,i){if(6===t.image.length){var a=r.get(t);if(t.version>0&&a.__version!==t.version){N(a,t),n.activeTexture(e.TEXTURE0+i),n.bindTexture(e.TEXTURE_CUBE_MAP,a.__webglTexture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,t.flipY);for(var s=t&&(t.isCompressedTexture||t.image[0].isCompressedTexture),c=t.image[0]&&t.image[0].isDataTexture,u=[],h=0;h<6;h++)u[h]=s||c?c?t.image[h].image:t.image[h]:y(t.image[h],!1,!0,f);var d,p=u[0],m=b(p)||l,v=o.convert(t.format),g=o.convert(t.type),S=x(t.internalFormat,v,g);if(k(e.TEXTURE_CUBE_MAP,t,m),s){for(h=0;h<6;h++){d=u[h].mipmaps;for(var E=0;E<d.length;E++){var M=d[E];t.format!==Ei&&t.format!==Si?null!==v?n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+h,E,S,M.width,M.height,0,M.data):console.warn("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+h,E,S,M.width,M.height,0,v,g,M.data)}}a.__maxMipLevel=d.length-1}else{for(d=t.mipmaps,h=0;h<6;h++)if(c)for(n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+h,0,S,u[h].width,u[h].height,0,v,g,u[h].data),E=0;E<d.length;E++){var C=(M=d[E]).image[h].image;n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+h,E+1,S,C.width,C.height,0,v,g,C.data)}else for(n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+h,0,S,v,g,u[h]),E=0;E<d.length;E++)M=d[E],n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+h,E+1,S,v,g,M.image[h]);a.__maxMipLevel=d.length}_(t,m)&&w(e.TEXTURE_CUBE_MAP,t,p.width,p.height),a.__version=t.version,t.onUpdate&&t.onUpdate(t)}else n.activeTexture(e.TEXTURE0+i),n.bindTexture(e.TEXTURE_CUBE_MAP,a.__webglTexture)}}function P(t,i){n.activeTexture(e.TEXTURE0+i),n.bindTexture(e.TEXTURE_CUBE_MAP,r.get(t).__webglTexture)}var L=(lc(s={},1e3,e.REPEAT),lc(s,bi,e.CLAMP_TO_EDGE),lc(s,1002,e.MIRRORED_REPEAT),s),R=(lc(c={},_i,e.NEAREST),lc(c,1004,e.NEAREST_MIPMAP_NEAREST),lc(c,1005,e.NEAREST_MIPMAP_LINEAR),lc(c,wi,e.LINEAR),lc(c,1007,e.LINEAR_MIPMAP_NEAREST),lc(c,1008,e.LINEAR_MIPMAP_LINEAR),c);function k(n,o,a){a?(e.texParameteri(n,e.TEXTURE_WRAP_S,L[o.wrapS]),e.texParameteri(n,e.TEXTURE_WRAP_T,L[o.wrapT]),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,L[o.wrapR]),e.texParameteri(n,e.TEXTURE_MAG_FILTER,R[o.magFilter]),e.texParameteri(n,e.TEXTURE_MIN_FILTER,R[o.minFilter])):(e.texParameteri(n,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(n,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,e.CLAMP_TO_EDGE),o.wrapS===bi&&o.wrapT===bi||console.warn("WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to ClampToEdgeWrapping."),e.texParameteri(n,e.TEXTURE_MAG_FILTER,S(o.magFilter)),e.texParameteri(n,e.TEXTURE_MIN_FILTER,S(o.minFilter)),o.minFilter!==_i&&o.minFilter!==wi&&console.warn("WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to NearestFilter or LinearFilter."));var s=t.get("EXT_texture_filter_anisotropic");if(s){if(o.type===xi&&null===t.get("OES_texture_float_linear"))return;if(1016===o.type&&null===(l||t.get("OES_texture_half_float_linear")))return;(o.anisotropy>1||r.get(o).__currentAnisotropy)&&(e.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,i.getMaxAnisotropy())),r.get(o).__currentAnisotropy=o.anisotropy)}}function N(t,n){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",E),t.__webglTexture=e.createTexture(),a.memory.textures++)}function O(t,r,i){var a=e.TEXTURE_2D;r.isDataTexture2DArray&&(a=e.TEXTURE_2D_ARRAY),r.isDataTexture3D&&(a=e.TEXTURE_3D),N(t,r),n.activeTexture(e.TEXTURE0+i),n.bindTexture(a,t.__webglTexture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,r.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,r.unpackAlignment);var s=function(e){return!l&&(e.wrapS!==bi||e.wrapT!==bi||e.minFilter!==_i&&e.minFilter!==wi)}(r)&&!1===b(r.image),c=y(r.image,s,!1,d),u=b(c)||l,h=o.convert(r.format),f=o.convert(r.type),p=x(r.internalFormat,h,f);k(a,r,u);var m,v=r.mipmaps;if(r.isDepthTexture){if(p=e.DEPTH_COMPONENT,r.type===xi){if(!1===l)throw new Error("Float Depth Texture only supported in WebGL2.0");p=e.DEPTH_COMPONENT32F}else l&&(p=e.DEPTH_COMPONENT16);1026===r.format&&p===e.DEPTH_COMPONENT&&1012!==r.type&&1014!==r.type&&(console.warn("WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=1012,f=o.convert(r.type)),1027===r.format&&(p=e.DEPTH_STENCIL,1020!==r.type&&(console.warn("WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=1020,f=o.convert(r.type))),n.texImage2D(e.TEXTURE_2D,0,p,c.width,c.height,0,h,f,null)}else if(r.isDataTexture)if(v.length>0&&u){for(var g=0,S=v.length;g<S;g++)m=v[g],n.texImage2D(e.TEXTURE_2D,g,p,m.width,m.height,0,h,f,m.data);r.generateMipmaps=!1,t.__maxMipLevel=v.length-1}else n.texImage2D(e.TEXTURE_2D,0,p,c.width,c.height,0,h,f,c.data),t.__maxMipLevel=0;else if(r.isCompressedTexture){for(g=0,S=v.length;g<S;g++)m=v[g],r.format!==Ei&&r.format!==Si?null!==h?n.compressedTexImage2D(e.TEXTURE_2D,g,p,m.width,m.height,0,m.data):console.warn("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(e.TEXTURE_2D,g,p,m.width,m.height,0,h,f,m.data);t.__maxMipLevel=v.length-1}else if(r.isDataTexture2DArray)n.texImage3D(e.TEXTURE_2D_ARRAY,0,p,c.width,c.height,c.depth,0,h,f,c.data),t.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(e.TEXTURE_3D,0,p,c.width,c.height,c.depth,0,h,f,c.data),t.__maxMipLevel=0;else if(v.length>0&&u){for(g=0,S=v.length;g<S;g++)m=v[g],n.texImage2D(e.TEXTURE_2D,g,p,h,f,m);r.generateMipmaps=!1,t.__maxMipLevel=v.length-1}else n.texImage2D(e.TEXTURE_2D,0,p,h,f,c),t.__maxMipLevel=0;_(r,u)&&w(a,r,c.width,c.height),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}function D(t,i,a,s){var c=o.convert(i.texture.format),u=o.convert(i.texture.type),l=x(i.texture.internalFormat,c,u);n.texImage2D(s,0,l,i.width,i.height,0,c,u,null),e.bindFramebuffer(e.FRAMEBUFFER,t),e.framebufferTexture2D(e.FRAMEBUFFER,a,s,r.get(i.texture).__webglTexture,0),e.bindFramebuffer(e.FRAMEBUFFER,null)}function F(t,n,r){if(e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer&&!n.stencilBuffer){if(r){var i=U(n);e.renderbufferStorageMultisample(e.RENDERBUFFER,i,e.DEPTH_COMPONENT16,n.width,n.height)}else e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,n.width,n.height);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)}else if(n.depthBuffer&&n.stencilBuffer)r?(i=U(n),e.renderbufferStorageMultisample(e.RENDERBUFFER,i,e.DEPTH24_STENCIL8,n.width,n.height)):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t);else{var a=o.convert(n.texture.format),s=o.convert(n.texture.type),c=x(n.texture.internalFormat,a,s);r?(i=U(n),e.renderbufferStorageMultisample(e.RENDERBUFFER,i,c,n.width,n.height)):e.renderbufferStorage(e.RENDERBUFFER,c,n.width,n.height)}e.bindRenderbuffer(e.RENDERBUFFER,null)}function I(t){var n=r.get(t),i=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,n){if(n&&n.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(e.FRAMEBUFFER,t),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),T(n.depthTexture,0);var i=r.get(n.depthTexture).__webglTexture;if(1026===n.depthTexture.format)e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,i,0);else{if(1027!==n.depthTexture.format)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,i,0)}}(n.__webglFramebuffer,t)}else if(i){n.__webglDepthbuffer=[];for(var o=0;o<6;o++)e.bindFramebuffer(e.FRAMEBUFFER,n.__webglFramebuffer[o]),n.__webglDepthbuffer[o]=e.createRenderbuffer(),F(n.__webglDepthbuffer[o],t)}else e.bindFramebuffer(e.FRAMEBUFFER,n.__webglFramebuffer),n.__webglDepthbuffer=e.createRenderbuffer(),F(n.__webglDepthbuffer,t);e.bindFramebuffer(e.FRAMEBUFFER,null)}function U(e){return l&&e.isWebGLMultisampleRenderTarget?Math.min(p,e.samples):0}var B=!1,j=!1;this.allocateTextureUnit=function(){var e=C;return e>=h&&console.warn("WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+h),C+=1,e},this.resetTextureUnits=function(){C=0},this.setTexture2D=T,this.setTexture2DArray=function(t,i){var o=r.get(t);t.version>0&&o.__version!==t.version?O(o,t,i):(n.activeTexture(e.TEXTURE0+i),n.bindTexture(e.TEXTURE_2D_ARRAY,o.__webglTexture))},this.setTexture3D=function(t,i){var o=r.get(t);t.version>0&&o.__version!==t.version?O(o,t,i):(n.activeTexture(e.TEXTURE0+i),n.bindTexture(e.TEXTURE_3D,o.__webglTexture))},this.setTextureCube=A,this.setTextureCubeDynamic=P,this.setupRenderTarget=function(i){var s=r.get(i),c=r.get(i.texture);i.addEventListener("dispose",M),c.__webglTexture=e.createTexture(),a.memory.textures++;var u=!0===i.isWebGLCubeRenderTarget,h=!0===i.isWebGLMultisampleRenderTarget,f=!0===i.isWebGLMultiviewRenderTarget,d=b(i)||l;if(u){s.__webglFramebuffer=[];for(var p=0;p<6;p++)s.__webglFramebuffer[p]=e.createFramebuffer()}else if(s.__webglFramebuffer=e.createFramebuffer(),h)if(l){s.__webglMultisampledFramebuffer=e.createFramebuffer(),s.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,s.__webglColorRenderbuffer);var m=o.convert(i.texture.format),v=o.convert(i.texture.type),g=x(i.texture.internalFormat,m,v),y=U(i);e.renderbufferStorageMultisample(e.RENDERBUFFER,y,g,i.width,i.height),e.bindFramebuffer(e.FRAMEBUFFER,s.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,s.__webglColorRenderbuffer),e.bindRenderbuffer(e.RENDERBUFFER,null),i.depthBuffer&&(s.__webglDepthRenderbuffer=e.createRenderbuffer(),F(s.__webglDepthRenderbuffer,i,!0)),e.bindFramebuffer(e.FRAMEBUFFER,null)}else console.warn("WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");else if(f){var S=i.width,E=i.height,C=i.numViews;e.bindFramebuffer(e.FRAMEBUFFER,s.__webglFramebuffer);var T=t.get("OVR_multiview2");a.memory.textures+=2;var A=e.createTexture();e.bindTexture(e.TEXTURE_2D_ARRAY,A),e.texParameteri(e.TEXTURE_2D_ARRAY,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D_ARRAY,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texImage3D(e.TEXTURE_2D_ARRAY,0,e.RGBA8,S,E,C,0,e.RGBA,e.UNSIGNED_BYTE,null),T.framebufferTextureMultiviewOVR(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,A,0,0,C);var P=e.createTexture();e.bindTexture(e.TEXTURE_2D_ARRAY,P),e.texParameteri(e.TEXTURE_2D_ARRAY,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D_ARRAY,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texImage3D(e.TEXTURE_2D_ARRAY,0,e.DEPTH24_STENCIL8,S,E,C,0,e.DEPTH_STENCIL,e.UNSIGNED_INT_24_8,null),T.framebufferTextureMultiviewOVR(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,P,0,0,C);var L=new Array(C);for(p=0;p<C;++p)L[p]=e.createFramebuffer(),e.bindFramebuffer(e.FRAMEBUFFER,L[p]),e.framebufferTextureLayer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,A,0,p);s.__webglColorTexture=A,s.__webglDepthStencilTexture=P,s.__webglViewFramebuffers=L,e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindTexture(e.TEXTURE_2D_ARRAY,null)}if(u){for(n.bindTexture(e.TEXTURE_CUBE_MAP,c.__webglTexture),k(e.TEXTURE_CUBE_MAP,i.texture,d),p=0;p<6;p++)D(s.__webglFramebuffer[p],i,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+p);_(i.texture,d)&&w(e.TEXTURE_CUBE_MAP,i.texture,i.width,i.height),n.bindTexture(e.TEXTURE_CUBE_MAP,null)}else f||(n.bindTexture(e.TEXTURE_2D,c.__webglTexture),k(e.TEXTURE_2D,i.texture,d),D(s.__webglFramebuffer,i,e.COLOR_ATTACHMENT0,e.TEXTURE_2D),_(i.texture,d)&&w(e.TEXTURE_2D,i.texture,i.width,i.height),n.bindTexture(e.TEXTURE_2D,null));i.depthBuffer&&I(i)},this.updateRenderTargetMipmap=function(t){var i=t.texture;if(_(i,b(t)||l)){var o=t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,a=r.get(i).__webglTexture;n.bindTexture(o,a),w(o,i,t.width,t.height),n.bindTexture(o,null)}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(l){var n=r.get(t);e.bindFramebuffer(e.READ_FRAMEBUFFER,n.__webglMultisampledFramebuffer),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,n.__webglFramebuffer);var i=t.width,o=t.height,a=e.COLOR_BUFFER_BIT;t.depthBuffer&&(a|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&(a|=e.STENCIL_BUFFER_BIT),e.blitFramebuffer(0,0,i,o,0,0,i,o,a,e.NEAREST)}else console.warn("WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===B&&(console.warn("WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),B=!0),e=e.texture),T(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLCubeRenderTarget&&(!1===j&&(console.warn("WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),j=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?A(e,t):P(e,t)}}function fc(e,t,n,r){ac.call(this,e,t,r),this.depthBuffer=!1,this.stencilBuffer=!1,this.numViews=n}function dc(e,t){var n,r,i,o,a,s,c,l=e.extensions,h=e.properties,f=0;function d(e){return e.isArrayCamera?e.cameras:(a[0]=e,a)}this.isAvailable=function(){if(void 0===c){var e=l.get("OVR_multiview2");if(c=null!==e&&!1===t.getContextAttributes().antialias){f=t.getParameter(e.MAX_VIEWS_OVR),n=new fc(0,0,2),s=new Mi,o=[],i=[],a=[];for(var r=0;r<f;r++)o[r]=new Yr,i[r]=new ei}}return c},this.attachCamera=function(t){!1!==function(e){if(void 0===e.isArrayCamera)return!0;var t=e.cameras;if(t.length>f)return!1;for(var n=1,r=t.length;n<r;n++)if(t[0].viewport.z!==t[n].viewport.z||t[0].viewport.w!==t[n].viewport.w)return!1;return!0}(t)&&(r=e.getRenderTarget(),function(t){if(r?s.set(r.width,r.height):e.getDrawingBufferSize(s),t.isArrayCamera){var i=t.cameras[0].viewport;n.setSize(i.z,i.w),n.setNumViews(t.cameras.length)}else n.setSize(s.x,s.y),n.setNumViews(2)}(t),e.setRenderTarget(n))},this.detachCamera=function(i){n===e.getRenderTarget()&&(e.setRenderTarget(r),function(e){var r=n,i=r.numViews,o=h.get(r).__webglViewFramebuffers,a=r.width,c=r.height;if(e.isArrayCamera)for(var u=0;u<i;u++){var l=e.cameras[u].viewport,f=l.x,d=l.y,p=f+l.z,m=d+l.w;t.bindFramebuffer(t.READ_FRAMEBUFFER,o[u]),t.blitFramebuffer(0,0,a,c,f,d,p,m,t.COLOR_BUFFER_BIT,t.NEAREST)}else t.bindFramebuffer(t.READ_FRAMEBUFFER,o[0]),t.blitFramebuffer(0,0,a,c,0,0,s.x,s.y,t.COLOR_BUFFER_BIT,t.NEAREST)}(i))},this.updateCameraProjectionMatricesUniform=function(e,n){for(var r=d(e),i=0;i<r.length;i++)o[i].copy(r[i].projectionMatrix);n.setValue(t,"projectionMatrices",o)},this.updateCameraViewMatricesUniform=function(e,n){for(var r=d(e),i=0;i<r.length;i++)o[i].copy(r[i].matrixWorldInverse);n.setValue(t,"viewMatrices",o)},this.updateObjectMatricesUniforms=function(e,n,r){for(var a=d(n),s=0;s<a.length;s++)o[s].multiplyMatrices(a[s].matrixWorldInverse,e.matrixWorld),i[s].getNormalMatrix(o[s]);r.setValue(t,"modelViewMatrices",o),r.setValue(t,"normalMatrices",i)}}function pc(e,t,n,r){vi.call(this),this.type="PerspectiveCamera",this.fov=void 0!==e?e:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==t?t:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function mc(e){pc.call(this),this.cameras=e||[]}function vc(){pi.call(this),this.type="Group"}function gc(e,t){var n=this,r=null,i=null,o="local-floor",a=null,s=[],c=new Map,u=new pc;u.layers.enable(1),u.viewport=new co;var l=new pc;l.layers.enable(2),l.viewport=new co;var h=new mc([u,l]);h.layers.enable(1),h.layers.enable(2);var f=null,d=null;function p(e){var t=c.get(e.inputSource);t&&(t.targetRay&&t.targetRay.dispatchEvent({type:e.type}),t.grip&&t.grip.dispatchEvent({type:e.type}))}function m(){c.forEach((function(e,t){e.targetRay&&(e.targetRay.dispatchEvent({type:"disconnected",data:t}),e.targetRay.visible=!1),e.grip&&(e.grip.dispatchEvent({type:"disconnected",data:t}),e.grip.visible=!1)})),c.clear(),e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),x.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function v(e){i=e,x.setContext(r),x.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}function g(e){for(var t=r.inputSources,n=0;n<s.length;n++)c.set(t[n],s[n]);for(n=0;n<e.removed.length;n++){var i=e.removed[n];(o=c.get(i))&&(o.targetRay&&o.targetRay.dispatchEvent({type:"disconnected",data:i}),o.grip&&o.grip.dispatchEvent({type:"disconnected",data:i}),c.delete(i))}for(n=0;n<e.added.length;n++){var o;i=e.added[n],(o=c.get(i))&&(o.targetRay&&o.targetRay.dispatchEvent({type:"connected",data:i}),o.grip&&o.grip.dispatchEvent({type:"connected",data:i}))}}this.enabled=!1,this.isPresenting=!1,this.getController=function(e){var t=s[e];return void 0===t&&(t={},s[e]=t),void 0===t.targetRay&&(t.targetRay=new vc,t.targetRay.matrixAutoUpdate=!1,t.targetRay.visible=!1),t.targetRay},this.getControllerGrip=function(e){var t=s[e];return void 0===t&&(t={},s[e]=t),void 0===t.grip&&(t.grip=new vc,t.grip.matrixAutoUpdate=!1,t.grip.visible=!1),t.grip},this.setFramebufferScaleFactor=function(){},this.setReferenceSpaceType=function(e){o=e},this.getReferenceSpace=function(){return i},this.getSession=function(){return r},this.setSession=function(e){if(null!==(r=e)){r.addEventListener("select",p),r.addEventListener("selectstart",p),r.addEventListener("selectend",p),r.addEventListener("squeeze",p),r.addEventListener("squeezestart",p),r.addEventListener("squeezeend",p),r.addEventListener("end",m);var n=t.getContextAttributes(),i={antialias:n.antialias,alpha:n.alpha,depth:n.depth,stencil:n.stencil},a=new XRWebGLLayer(r,t,i);r.updateRenderState({baseLayer:a}),r.requestReferenceSpace(o).then(v),r.addEventListener("inputsourceschange",g)}};var y=new jr,b=new jr;function _(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.getInverse(e.matrixWorld)}this.getCamera=function(e){h.near=l.near=u.near=e.near,h.far=l.far=u.far=e.far,f===h.near&&d===h.far||(r.updateRenderState({depthNear:h.near,depthFar:h.far}),f=h.near,d=h.far);var t=e.parent,n=h.cameras;_(h,t);for(var i=0;i<n.length;i++)_(n[i],t);e.matrixWorld.copy(h.matrixWorld);for(var o=e.children,a=(i=0,o.length);i<a;i++)o[i].updateMatrixWorld(!0);return function(e,t,n){y.setFromMatrixPosition(t.matrixWorld),b.setFromMatrixPosition(n.matrixWorld);var r=y.distanceTo(b),i=t.projectionMatrix.elements,o=n.projectionMatrix.elements,a=i[14]/(i[10]-1),s=i[14]/(i[10]+1),c=(i[9]+1)/i[5],u=(i[9]-1)/i[5],l=(i[8]-1)/i[0],h=(o[8]+1)/o[0],f=a*l,d=a*h,p=r/(-l+h),m=p*-l;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(p),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.getInverse(e.matrixWorld);var v=a+p,g=s+p,_=f-m,w=d+(r-m),x=c*s/g*v,S=u*s/g*v;e.projectionMatrix.makePerspective(_,w,x,S,v,g)}(h,u,l),h};var w=null,x=new uo;x.setAnimationLoop((function(t,n){if(null!==(a=n.getViewerPose(i))){var o=a.views,c=r.renderState.baseLayer;e.setFramebuffer(c.framebuffer);for(var u=0;u<o.length;u++){var l=o[u],f=c.getViewport(l),d=h.cameras[u];d.matrix.fromArray(l.transform.matrix),d.projectionMatrix.fromArray(l.projectionMatrix),d.viewport.set(f.x,f.y,f.width,f.height),0===u&&h.matrix.copy(d.matrix)}}var p=r.inputSources;for(u=0;u<s.length;u++){var m=s[u],v=p[u],g=null,y=null;v&&(m.targetRay&&null!==(g=n.getPose(v.targetRaySpace,i))&&(m.targetRay.matrix.fromArray(g.transform.matrix),m.targetRay.matrix.decompose(m.targetRay.position,m.targetRay.rotation,m.targetRay.scale)),m.grip&&v.gripSpace&&null!==(y=n.getPose(v.gripSpace,i))&&(m.grip.matrix.fromArray(y.transform.matrix),m.grip.matrix.decompose(m.grip.position,m.grip.rotation,m.grip.scale))),m.targetRay&&(m.targetRay.visible=null!==g),m.grip&&(m.grip.visible=null!==y)}w&&w(t,n)})),this.setAnimationLoop=function(e){w=e},this.dispose=function(){}}function yc(e){var t=void 0!==(e=e||{}).canvas?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),n=void 0!==e.context?e.context:null,r=void 0!==e.alpha&&e.alpha,i=void 0===e.depth||e.depth,o=void 0===e.stencil||e.stencil,a=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,c=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,u=void 0!==e.powerPreference?e.powerPreference:"default",l=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat,h=null,f=null;this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=3e3,this.physicallyCorrectLights=!1,this.toneMapping=1,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var d,p,m,v,g,y,b,_,w,x,S,E,M,C,T,A,P,L,R=this,k=!1,N=null,O=0,D=0,F=null,I=null,U=-1,B={geometry:null,program:null,wireframe:!1},j=null,z=null,V=new co,G=new co,W=null,H=t.width,q=t.height,X=1,Y=null,Z=null,J=new co(0,0,H,q),K=new co(0,0,H,q),$=!1,Q=new Qi,ee=new function(){var e=this,t=null,n=0,r=!1,i=!1,o=new Ji,a=new ei,s={value:null,needsUpdate:!1};function c(){s.value!==t&&(s.value=t,s.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function u(t,n,r,i){var c=null!==t?t.length:0,u=null;if(0!==c){if(u=s.value,!0!==i||null===u){var l=r+4*c,h=n.matrixWorldInverse;a.getNormalMatrix(h),(null===u||u.length<l)&&(u=new Float32Array(l));for(var f=0,d=r;f!==c;++f,d+=4)o.copy(t[f]).applyMatrix4(h,a),o.normal.toArray(u,d),u[d+3]=o.constant}s.value=u,s.needsUpdate=!0}return e.numPlanes=c,u}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(e,i,o){var a=0!==e.length||i||0!==n||r;return r=i,t=u(e,o,0),n=e.length,a},this.beginShadows=function(){i=!0,u(null)},this.endShadows=function(){i=!1,c()},this.setState=function(e,o,a,l,h,f){if(!r||null===e||0===e.length||i&&!a)i?u(null):c();else{var d=i?0:n,p=4*d,m=h.clippingState||null;s.value=m,m=u(e,l,p,f);for(var v=0;v!==p;++v)m[v]=t[v];h.clippingState=m,this.numIntersection=o?this.numPlanes:0,this.numPlanes+=d}}},te=!1,ne=!1,re=new Yr,ie=new jr;function oe(){return null===F?X:1}try{var ae={alpha:r,depth:i,stencil:o,antialias:a,premultipliedAlpha:s,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:l,xrCompatible:!0};if(t.addEventListener("webglcontextlost",he,!1),t.addEventListener("webglcontextrestored",fe,!1),null===(d=n||t.getContext("webgl",ae)||t.getContext("experimental-webgl",ae)))throw null!==t.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===d.getShaderPrecisionFormat&&(d.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("WebGLRenderer: "+e.message),e}function se(){p=new function(e){var t={};return{get:function(n){if(void 0!==t[n])return t[n];var r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return null===r&&console.warn("WebGLRenderer: "+n+" extension not supported."),t[n]=r,r}}}(d),!1===(m=new function(e,t,n){var r;function i(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var o="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext,a=void 0!==n.precision?n.precision:"highp",s=i(a);s!==a&&(console.warn("WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);var c=!0===n.logarithmicDepthBuffer,u=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),l=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),h=e.getParameter(e.MAX_TEXTURE_SIZE),f=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),d=e.getParameter(e.MAX_VERTEX_ATTRIBS),p=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),m=e.getParameter(e.MAX_VARYING_VECTORS),v=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),g=l>0,y=o||!!t.get("OES_texture_float");return{isWebGL2:o,getMaxAnisotropy:function(){if(void 0!==r)return r;var n=t.get("EXT_texture_filter_anisotropic");return r=null!==n?e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:i,precision:a,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:l,maxTextureSize:h,maxCubemapSize:f,maxAttributes:d,maxVertexUniforms:p,maxVaryings:m,maxFragmentUniforms:v,vertexTextures:g,floatFragmentTextures:y,floatVertexTextures:g&&y,maxSamples:o?e.getParameter(e.MAX_SAMPLES):0}}(d,p,e)).isWebGL2&&(p.get("WEBGL_depth_texture"),p.get("OES_texture_float"),p.get("OES_texture_half_float"),p.get("OES_texture_half_float_linear"),p.get("OES_standard_derivatives"),p.get("OES_element_index_uint"),p.get("ANGLE_instanced_arrays")),p.get("OES_texture_float_linear"),L=new function(e,t,n){var r=n.isWebGL2;return{convert:function(n){var i;if(1009===n)return e.UNSIGNED_BYTE;if(1017===n)return e.UNSIGNED_SHORT_4_4_4_4;if(1018===n)return e.UNSIGNED_SHORT_5_5_5_1;if(1019===n)return e.UNSIGNED_SHORT_5_6_5;if(1010===n)return e.BYTE;if(1011===n)return e.SHORT;if(1012===n)return e.UNSIGNED_SHORT;if(1013===n)return e.INT;if(1014===n)return e.UNSIGNED_INT;if(n===xi)return e.FLOAT;if(1016===n)return r?e.HALF_FLOAT:null!==(i=t.get("OES_texture_half_float"))?i.HALF_FLOAT_OES:null;if(1021===n)return e.ALPHA;if(n===Si)return e.RGB;if(n===Ei)return e.RGBA;if(1024===n)return e.LUMINANCE;if(1025===n)return e.LUMINANCE_ALPHA;if(1026===n)return e.DEPTH_COMPONENT;if(1027===n)return e.DEPTH_STENCIL;if(1028===n)return e.RED;if(1029===n)return e.RED_INTEGER;if(1030===n)return e.RG;if(1031===n)return e.RG_INTEGER;if(1032===n)return e.RGB_INTEGER;if(1033===n)return e.RGBA_INTEGER;if(33776===n||33777===n||33778===n||33779===n){if(null===(i=t.get("WEBGL_compressed_texture_s3tc")))return null;if(33776===n)return i.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===n)return i.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===n)return i.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===n)return i.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===n||35841===n||35842===n||35843===n){if(null===(i=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(35840===n)return i.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===n)return i.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===n)return i.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===n)return i.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}return 36196===n?null!==(i=t.get("WEBGL_compressed_texture_etc1"))?i.COMPRESSED_RGB_ETC1_WEBGL:null:37808===n||37809===n||37810===n||37811===n||37812===n||37813===n||37814===n||37815===n||37816===n||37817===n||37818===n||37819===n||37820===n||37821===n?null!==(i=t.get("WEBGL_compressed_texture_astc"))?n:null:1020===n?r?e.UNSIGNED_INT_24_8:null!==(i=t.get("WEBGL_depth_texture"))?i.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}(d,p,m),(v=new function(e,t,n){var r,i,o=n.isWebGL2,a=new function(){var t=!1,n=new co,r=null,i=new co(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,o,a,s){!0===s&&(t*=a,r*=a,o*=a),n.set(t,r,o,a),!1===i.equals(n)&&(e.clearColor(t,r,o,a),i.copy(n))},reset:function(){t=!1,r=null,i.set(-1,0,0,0)}}},s=new function(){var t=!1,n=null,r=null,i=null;return{setTest:function(t){t?j(e.DEPTH_TEST):z(e.DEPTH_TEST)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case 0:e.depthFunc(e.NEVER);break;case 1:e.depthFunc(e.ALWAYS);break;case 2:e.depthFunc(e.LESS);break;case 3:e.depthFunc(e.LEQUAL);break;case 4:e.depthFunc(e.EQUAL);break;case 5:e.depthFunc(e.GEQUAL);break;case 6:e.depthFunc(e.GREATER);break;case 7:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}else e.depthFunc(e.LEQUAL);r=t}},setLocked:function(e){t=e},setClear:function(t){i!==t&&(e.clearDepth(t),i=t)},reset:function(){t=!1,n=null,r=null,i=null}}},c=new function(){var t=!1,n=null,r=null,i=null,o=null,a=null,s=null,c=null,u=null;return{setTest:function(n){t||(n?j(e.STENCIL_TEST):z(e.STENCIL_TEST))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,a){r===t&&i===n&&o===a||(e.stencilFunc(t,n,a),r=t,i=n,o=a)},setOp:function(t,n,r){a===t&&s===n&&c===r||(e.stencilOp(t,n,r),a=t,s=n,c=r)},setLocked:function(e){t=e},setClear:function(t){u!==t&&(e.clearStencil(t),u=t)},reset:function(){t=!1,n=null,r=null,i=null,o=null,a=null,s=null,c=null,u=null}}},u=e.getParameter(e.MAX_VERTEX_ATTRIBS),l=new Uint8Array(u),h=new Uint8Array(u),f=new Uint8Array(u),d={},p=null,m=null,v=null,g=null,y=null,b=null,_=null,w=null,x=null,S=!1,E=null,M=null,C=null,T=null,A=null,P=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),L=!1,R=0,k=e.getParameter(e.VERSION);-1!==k.indexOf("WebGL")?(R=parseFloat(/^WebGL\ ([0-9])/.exec(k)[1]),L=R>=1):-1!==k.indexOf("OpenGL ES")&&(R=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(k)[1]),L=R>=2);var N=null,O={},D=new co,F=new co;function I(t,n,r){var i=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(var a=0;a<r;a++)e.texImage2D(n+a,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,i);return o}var U={};function B(n,r){l[n]=1,0===h[n]&&(e.enableVertexAttribArray(n),h[n]=1),f[n]!==r&&((o?e:t.get("ANGLE_instanced_arrays"))[o?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,r),f[n]=r)}function j(t){!0!==d[t]&&(e.enable(t),d[t]=!0)}function z(t){!1!==d[t]&&(e.disable(t),d[t]=!1)}U[e.TEXTURE_2D]=I(e.TEXTURE_2D,e.TEXTURE_2D,1),U[e.TEXTURE_CUBE_MAP]=I(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),a.setClear(0,0,0,1),s.setClear(1),c.setClear(0),j(e.DEPTH_TEST),s.setFunc(3),q(!1),X(1),j(e.CULL_FACE),H(0);var V=(uc(r={},100,e.FUNC_ADD),uc(r,101,e.FUNC_SUBTRACT),uc(r,102,e.FUNC_REVERSE_SUBTRACT),r);if(o)V[103]=e.MIN,V[104]=e.MAX;else{var G=t.get("EXT_blend_minmax");null!==G&&(V[103]=G.MIN_EXT,V[104]=G.MAX_EXT)}var W=(uc(i={},200,e.ZERO),uc(i,201,e.ONE),uc(i,202,e.SRC_COLOR),uc(i,204,e.SRC_ALPHA),uc(i,210,e.SRC_ALPHA_SATURATE),uc(i,208,e.DST_COLOR),uc(i,206,e.DST_ALPHA),uc(i,203,e.ONE_MINUS_SRC_COLOR),uc(i,205,e.ONE_MINUS_SRC_ALPHA),uc(i,209,e.ONE_MINUS_DST_COLOR),uc(i,207,e.ONE_MINUS_DST_ALPHA),i);function H(t,n,r,i,o,a,s,c){if(0!==t){if(m||(j(e.BLEND),m=!0),5===t)o=o||n,a=a||r,s=s||i,n===g&&o===_||(e.blendEquationSeparate(V[n],V[o]),g=n,_=o),r===y&&i===b&&a===w&&s===x||(e.blendFuncSeparate(W[r],W[i],W[a],W[s]),y=r,b=i,w=a,x=s),v=t,S=null;else if(t!==v||c!==S){if(100===g&&100===_||(e.blendEquation(e.FUNC_ADD),g=100,_=100),c)switch(t){case 1:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFunc(e.ONE,e.ONE);break;case 3:e.blendFuncSeparate(e.ZERO,e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ONE_MINUS_SRC_ALPHA);break;case 4:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case 3:e.blendFunc(e.ZERO,e.ONE_MINUS_SRC_COLOR);break;case 4:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("WebGLState: Invalid blending: ",t)}y=null,b=null,w=null,x=null,v=t,S=c}}else m&&(z(e.BLEND),m=!1)}function q(t){E!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),E=t)}function X(t){0!==t?(j(e.CULL_FACE),t!==M&&(1===t?e.cullFace(e.BACK):2===t?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):z(e.CULL_FACE),M=t}function Y(t,n,r){t?(j(e.POLYGON_OFFSET_FILL),T===n&&A===r||(e.polygonOffset(n,r),T=n,A=r)):z(e.POLYGON_OFFSET_FILL)}function Z(t){void 0===t&&(t=e.TEXTURE0+P-1),N!==t&&(e.activeTexture(t),N=t)}return{buffers:{color:a,depth:s,stencil:c},initAttributes:function(){for(var e=0,t=l.length;e<t;e++)l[e]=0},enableAttribute:function(e){B(e,0)},enableAttributeAndDivisor:B,disableUnusedAttributes:function(){for(var t=0,n=h.length;t!==n;++t)h[t]!==l[t]&&(e.disableVertexAttribArray(t),h[t]=0)},enable:j,disable:z,useProgram:function(t){return p!==t&&(e.useProgram(t),p=t,!0)},setBlending:H,setMaterial:function(t,n){2===t.side?z(e.CULL_FACE):j(e.CULL_FACE);var r=1===t.side;n&&(r=!r),q(r),1===t.blending&&!1===t.transparent?H(0):H(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),s.setFunc(t.depthFunc),s.setTest(t.depthTest),s.setMask(t.depthWrite),a.setMask(t.colorWrite);var i=t.stencilWrite;c.setTest(i),i&&(c.setMask(t.stencilWriteMask),c.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),c.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),Y(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits)},setFlipSided:q,setCullFace:X,setLineWidth:function(t){t!==C&&(L&&e.lineWidth(t),C=t)},setPolygonOffset:Y,setScissorTest:function(t){t?j(e.SCISSOR_TEST):z(e.SCISSOR_TEST)},activeTexture:Z,bindTexture:function(t,n){null===N&&Z();var r=O[N];void 0===r&&(r={type:void 0,texture:void 0},O[N]=r),r.type===t&&r.texture===n||(e.bindTexture(t,n||U[t]),r.type=t,r.texture=n)},unbindTexture:function(){var t=O[N];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("WebGLState:",e)}},scissor:function(t){!1===D.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),D.copy(t))},viewport:function(t){!1===F.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),F.copy(t))},reset:function(){for(var t=0;t<h.length;t++)1===h[t]&&(e.disableVertexAttribArray(t),h[t]=0);d={},N=null,O={},p=null,v=null,E=null,M=null,a.reset(),s.reset(),c.reset()}}}(d,p,m)).scissor(G.copy(K).multiplyScalar(X).floor()),v.viewport(V.copy(J).multiplyScalar(X).floor()),g=new function(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,r,i){switch(i=i||1,t.calls++,r){case e.TRIANGLES:t.triangles+=i*(n/3);break;case e.LINES:t.lines+=i*(n/2);break;case e.LINE_STRIP:t.lines+=i*(n-1);break;case e.LINE_LOOP:t.lines+=i*n;break;case e.POINTS:t.points+=i*n;break;default:console.error("WebGLInfo: Unknown draw mode:",r)}}}}(d),y=new function(){var e=new WeakMap;return{get:function(t){var n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}},b=new hc(d,p,v,y,m,L,g),_=new lo(d,m),w=new function(e,t,n){var r=new WeakMap,i=new WeakMap;function o(e){var a=e.target,s=r.get(a);for(var c in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[c]);a.removeEventListener("dispose",o),r.delete(a);var u=i.get(s);u&&(t.remove(u),i.delete(s)),n.memory.geometries--}function a(n){var r=[],o=n.index,a=n.attributes.position,s=0;if(null!==o){var c=o.array;s=o.version;for(var u=0,l=c.length;u<l;u+=3){var h=c[u+0],f=c[u+1],d=c[u+2];r.push(h,f,f,d,d,h)}}else for(c=a.array,s=a.version,u=0,l=c.length/3-1;u<l;u+=3)h=u+0,f=u+1,d=u+2,r.push(h,f,f,d,d,h);var p=new(Lo(r)>65535?Co:Eo)(r,1);p.version=s,t.update(p,e.ELEMENT_ARRAY_BUFFER);var m=i.get(n);m&&t.remove(m),i.set(n,p)}return{get:function(e,t){var i=r.get(t);return i||(t.addEventListener("dispose",o),t.isBufferGeometry?i=t:t.isGeometry&&(void 0===t._bufferGeometry&&(t._bufferGeometry=(new Uo).setFromObject(e)),i=t._bufferGeometry),r.set(t,i),n.memory.geometries++,i)},update:function(n){var r=n.index,i=n.attributes;for(var o in null!==r&&t.update(r,e.ELEMENT_ARRAY_BUFFER),i)t.update(i[o],e.ARRAY_BUFFER);var a=n.morphAttributes;for(var o in a)for(var s=a[o],c=0,u=s.length;c<u;c++)t.update(s[c],e.ARRAY_BUFFER)},getWireframeAttribute:function(e){var t=i.get(e);if(t){var n=e.index;null!==n&&t.version<n.version&&a(e)}else a(e);return i.get(e)}}}(d,_,g),x=new function(e,t,n,r){var i={};return{update:function(o){var a=r.render.frame,s=o.geometry,c=t.get(o,s);return i[c.id]!==a&&(s.isGeometry&&c.updateFromObject(o),t.update(c),i[c.id]=a),o.isInstancedMesh&&n.update(o.instanceMatrix,e.ARRAY_BUFFER),c},dispose:function(){i={}}}}(d,w,_,g),T=new function(e){var t={},n=new Float32Array(8);return{update:function(r,i,o,a){var s=r.morphTargetInfluences,c=void 0===s?0:s.length,u=t[i.id];if(void 0===u){u=[];for(var l=0;l<c;l++)u[l]=[l,0];t[i.id]=u}var h=o.morphTargets&&i.morphAttributes.position,f=o.morphNormals&&i.morphAttributes.normal;for(l=0;l<c;l++)0!==(p=u[l])[1]&&(h&&i.deleteAttribute("morphTarget"+l),f&&i.deleteAttribute("morphNormal"+l));for(l=0;l<c;l++)(p=u[l])[0]=l,p[1]=s[l];u.sort(ja);var d=0;for(l=0;l<8;l++){var p;if(p=u[l]){var m=p[0],v=p[1];if(v){h&&i.setAttribute("morphTarget"+l,h[m]),f&&i.setAttribute("morphNormal"+l,f[m]),n[l]=v,d+=v;continue}}n[l]=0}var g=i.morphTargetsRelative?1:1-d;a.getUniforms().setValue(e,"morphTargetBaseInfluence",g),a.getUniforms().setValue(e,"morphTargetInfluences",n)}}}(d),S=new $s(R,p,m),E=new function(){var e=new WeakMap;function t(n){var r=n.target;r.removeEventListener("dispose",t),e.delete(r)}return{get:function(n,r){var i,o=e.get(n);return void 0===o?(i=new tc,e.set(n,new WeakMap),e.get(n).set(r,i),n.addEventListener("dispose",t)):void 0===(i=o.get(r))&&(i=new tc,o.set(r,i)),i},dispose:function(){e=new WeakMap}}},M=new function(){var e=new WeakMap;function t(n){var r=n.target;r.removeEventListener("dispose",t),e.delete(r)}return{get:function(n,r){var i;return!1===e.has(n)?(i=new oc,e.set(n,new WeakMap),e.get(n).set(r,i),n.addEventListener("dispose",t)):!1===e.get(n).has(r)?(i=new oc,e.get(n).set(r,i)):i=e.get(n).get(r),i},dispose:function(){e=new WeakMap}}},C=new function(e,t,n,r){var i,o,a=new ro(0),s=0,c=null,u=0,l=null;function h(e,n){t.buffers.color.setClear(e.r,e.g,e.b,n,r)}return{getClearColor:function(){return a},setClearColor:function(e,t){a.set(e),h(a,s=void 0!==t?t:1)},getClearAlpha:function(){return s},setClearAlpha:function(e){h(a,s=e)},render:function(t,r,f,d){var p=r.background,m=e.xr,v=m.getSession&&m.getSession();if(v&&"additive"===v.environmentBlendMode&&(p=null),null===p?h(a,s):p&&p.isColor&&(h(p,1),d=!0),(e.autoClear||d)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),p&&(p.isCubeTexture||p.isWebGLCubeRenderTarget||306===p.mapping)){void 0===o&&((o=new Da(new Go(1,1,1),new Ko({type:"BackgroundCubeMaterial",uniforms:Yo(Ba.cube.uniforms),vertexShader:Ba.cube.vertexShader,fragmentShader:Ba.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),o.geometry.deleteAttribute("uv"),o.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(o.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(o));var g=p.isWebGLCubeRenderTarget?p.texture:p;o.material.uniforms.envMap.value=g,o.material.uniforms.flipEnvMap.value=g.isCubeTexture?-1:1,c===p&&u===g.version&&l===e.toneMapping||(o.material.needsUpdate=!0,c=p,u=g.version,l=e.toneMapping),t.unshift(o,o.geometry,o.material,0,0,null)}else p&&p.isTexture&&(void 0===i&&((i=new Da(new Ho(2,2),new Ko({type:"BackgroundMaterial",uniforms:Yo(Ba.background.uniforms),vertexShader:Ba.background.vertexShader,fragmentShader:Ba.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(i.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(i)),i.material.uniforms.t2D.value=p,!0===p.matrixAutoUpdate&&p.updateMatrix(),i.material.uniforms.uvTransform.value.copy(p.matrix),c===p&&u===p.version&&l===e.toneMapping||(i.material.needsUpdate=!0,c=p,u=p.version,l=e.toneMapping),t.unshift(i,i.geometry,i.material,0,0,null))}}}(R,v,x,s),A=new function(e,t,n,r){var i,o=r.isWebGL2;this.setMode=function(e){i=e},this.render=function(t,r){e.drawArrays(i,t,r),n.update(r,i)},this.renderInstances=function(r,a,s,c){if(0!==c){var u,l;if(o)u=e,l="drawArraysInstanced";else if(l="drawArraysInstancedANGLE",null===(u=t.get("ANGLE_instanced_arrays")))return void console.error("WebGLBufferRenderer: using InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[l](i,a,s,c),n.update(s,i,c)}}}(d,p,g,m),P=new function(e,t,n,r){var i,o,a,s=r.isWebGL2;this.setMode=function(e){i=e},this.setIndex=function(e){o=e.type,a=e.bytesPerElement},this.render=function(t,r){e.drawElements(i,r,o,t*a),n.update(r,i)},this.renderInstances=function(r,c,u,l){if(0!==l){var h,f;if(s)h=e,f="drawElementsInstanced";else if(f="drawElementsInstancedANGLE",null===(h=t.get("ANGLE_instanced_arrays")))return void console.error("WebGLIndexedBufferRenderer: using InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");h[f](i,u,o,c*a,l),n.update(u,i,l)}}}(d,p,g,m),g.programs=S.programs,R.capabilities=m,R.extensions=p,R.properties=y,R.renderLists=E,R.state=v,R.info=g}se();var ce=new gc(R,d);this.xr=ce;var ue=new dc(R,d),le=new function(e,t,n){var r=new Qi,i=new Mi,o=new Mi,a=new co,s=[],c=[],u={},l={0:1,1:0,2:2},h=new Ko({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new Mi},radius:{value:4}},vertexShader:"\n\nvoid main() {\n\n\tgl_Position = vec4( position, 1.0 );\n\n}\n\n",fragmentShader:"\nuniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n\n#include <packing>\n\nvoid main() {\n\n  float mean = 0.0;\n  float squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );\n\n  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n\n    #ifdef HORIZONAL_PASS\n\n      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n      mean += distribution.x;\n      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\n    #else\n\n      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );\n      mean += depth;\n      squared_mean += depth * depth;\n\n    #endif\n\n  }\n\n  mean = mean * HALF_SAMPLE_RATE;\n  squared_mean = squared_mean * HALF_SAMPLE_RATE;\n\n  float std_dev = sqrt( squared_mean - mean * mean );\n\n  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n\n}\n"}),f=h.clone();f.defines.HORIZONAL_PASS=1;var d=new Uo;d.setAttribute("position",new bo(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var p=new Da(d,h),m=this;function v(n,r){var i=t.update(p);h.uniforms.shadow_pass.value=n.map.texture,h.uniforms.resolution.value=n.mapSize,h.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,i,h,p,null),f.uniforms.shadow_pass.value=n.mapPass.texture,f.uniforms.resolution.value=n.mapSize,f.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,i,f,p,null)}function g(e,t,n){var r=e<<0|t<<1|n<<2,i=s[r];return void 0===i&&(i=new sc({depthPacking:3201,morphTargets:e,skinning:t}),s[r]=i),i}function y(e,t,n){var r=e<<0|t<<1|n<<2,i=c[r];return void 0===i&&(i=new cc({morphTargets:e,skinning:t}),c[r]=i),i}function b(t,n,r,i,o,a){var s=t.geometry,c=null,h=g,f=t.customDepthMaterial;if(!0===r.isPointLight&&(h=y,f=t.customDistanceMaterial),void 0===f){var d=!1;!0===n.morphTargets&&(!0===s.isBufferGeometry?d=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:!0===s.isGeometry&&(d=s.morphTargets&&s.morphTargets.length>0));var p=!1;!0===t.isSkinnedMesh&&(!0===n.skinning?p=!0:console.warn("WebGLShadowMap: SkinnedMesh with material.skinning set to false:",t)),c=h(d,p,!0===t.isInstancedMesh)}else c=f;if(e.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){var m=c.uuid,v=n.uuid,b=u[m];void 0===b&&(b={},u[m]=b);var _=b[v];void 0===_&&(_=c.clone(),b[v]=_),c=_}return c.visible=n.visible,c.wireframe=n.wireframe,c.side=3===a?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:l[n.side],c.clipShadows=n.clipShadows,c.clippingPlanes=n.clippingPlanes,c.clipIntersection=n.clipIntersection,c.wireframeLinewidth=n.wireframeLinewidth,c.linewidth=n.linewidth,!0===r.isPointLight&&!0===c.isMeshDistanceMaterial&&(c.referencePosition.setFromMatrixPosition(r.matrixWorld),c.nearDistance=i,c.farDistance=o),c}function _(n,i,o,a,s){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===s)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);var c=t.update(n),u=n.material;if(Array.isArray(u))for(var l=c.groups,h=0,f=l.length;h<f;h++){var d=l[h],p=u[d.materialIndex];if(p&&p.visible){var m=b(n,p,a,o.near,o.far,s);e.renderBufferDirect(o,null,c,m,n,d)}}else u.visible&&(m=b(n,u,a,o.near,o.far,s),e.renderBufferDirect(o,null,c,m,n,null))}for(var v=n.children,g=0,y=v.length;g<y;g++)_(v[g],i,o,a,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(t,s,c){if(!1!==m.enabled&&(!1!==m.autoUpdate||!1!==m.needsUpdate)&&0!==t.length){var u=e.getRenderTarget(),l=e.getActiveCubeFace(),h=e.getActiveMipmapLevel(),f=e.state;f.setBlending(0),f.buffers.color.setClear(1,1,1,1),f.buffers.depth.setTest(!0),f.setScissorTest(!1);for(var d=0,p=t.length;d<p;d++){var g=t[d],y=g.shadow;if(void 0!==y){i.copy(y.mapSize);var b=y.getFrameExtents();if(i.multiply(b),o.copy(y.mapSize),(i.x>n||i.y>n)&&(console.warn("WebGLShadowMap:",g,"has shadow exceeding max texture size, reducing"),i.x>n&&(o.x=Math.floor(n/b.x),i.x=o.x*b.x,y.mapSize.x=o.x),i.y>n&&(o.y=Math.floor(n/b.y),i.y=o.y*b.y,y.mapSize.y=o.y)),null===y.map&&!y.isPointLightShadow&&3===this.type){var w={minFilter:wi,magFilter:wi,format:Ei};y.map=new ac(i.x,i.y,w),y.map.texture.name=g.name+".shadowMap",y.mapPass=new ac(i.x,i.y,w),y.camera.updateProjectionMatrix()}null===y.map&&(w={minFilter:_i,magFilter:_i,format:Ei},y.map=new ac(i.x,i.y,w),y.map.texture.name=g.name+".shadowMap",y.camera.updateProjectionMatrix()),e.setRenderTarget(y.map),e.clear();for(var x=y.getViewportCount(),S=0;S<x;S++){var E=y.getViewport(S);a.set(o.x*E.x,o.y*E.y,o.x*E.z,o.y*E.w),f.viewport(a),y.updateMatrices(g,S),r=y.getFrustum(),_(s,c,y.camera,g,this.type)}y.isPointLightShadow||3!==this.type||v(y,c)}else console.warn("WebGLShadowMap:",g,"has no shadow.")}m.needsUpdate=!1,e.setRenderTarget(u,l,h)}}}(R,x,m.maxTextureSize);function he(e){e.preventDefault(),console.log("WebGLRenderer: Context Lost."),k=!0}function fe(){console.log("WebGLRenderer: Context Restored."),k=!1,se()}function de(e){var t=e.target;t.removeEventListener("dispose",de),function(e){pe(e),y.remove(e)}(t)}function pe(e){var t=y.get(e).program;e.program=void 0,void 0!==t&&S.releaseProgram(t)}this.shadowMap=le,this.getContext=function(){return d},this.getContextAttributes=function(){return d.getContextAttributes()},this.forceContextLoss=function(){var e=p.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=p.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return X},this.setPixelRatio=function(e){void 0!==e&&(X=e,this.setSize(H,q,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new Mi),e.set(H,q)},this.setSize=function(e,n,r){ce.isPresenting?console.warn("WebGLRenderer: Can't change size while VR device is presenting."):(H=e,q=n,t.width=Math.floor(e*X),t.height=Math.floor(n*X),!1!==r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new Mi),e.set(H*X,q*X).floor()},this.setDrawingBufferSize=function(e,n,r){H=e,q=n,X=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new co),e.copy(V)},this.getViewport=function(e){return e.copy(J)},this.setViewport=function(e,t,n,r){e.isVector4?J.set(e.x,e.y,e.z,e.w):J.set(e,t,n,r),v.viewport(V.copy(J).multiplyScalar(X).floor())},this.getScissor=function(e){return e.copy(K)},this.setScissor=function(e,t,n,r){e.isVector4?K.set(e.x,e.y,e.z,e.w):K.set(e,t,n,r),v.scissor(G.copy(K).multiplyScalar(X).floor())},this.getScissorTest=function(){return $},this.setScissorTest=function(e){v.setScissorTest($=e)},this.setOpaqueSort=function(e){Y=e},this.setTransparentSort=function(e){Z=e},this.getClearColor=function(){return C.getClearColor()},this.setClearColor=function(){C.setClearColor.apply(C,arguments)},this.getClearAlpha=function(){return C.getClearAlpha()},this.setClearAlpha=function(){C.setClearAlpha.apply(C,arguments)},this.clear=function(e,t,n){var r=0;(void 0===e||e)&&(r|=d.COLOR_BUFFER_BIT),(void 0===t||t)&&(r|=d.DEPTH_BUFFER_BIT),(void 0===n||n)&&(r|=d.STENCIL_BUFFER_BIT),d.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",he,!1),t.removeEventListener("webglcontextrestored",fe,!1),E.dispose(),M.dispose(),y.dispose(),x.dispose(),ce.dispose(),ge.stop()},this.renderBufferImmediate=function(e,t){v.initAttributes();var n=y.get(e);e.hasPositions&&!n.position&&(n.position=d.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=d.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=d.createBuffer()),e.hasColors&&!n.color&&(n.color=d.createBuffer());var r=t.getAttributes();e.hasPositions&&(d.bindBuffer(d.ARRAY_BUFFER,n.position),d.bufferData(d.ARRAY_BUFFER,e.positionArray,d.DYNAMIC_DRAW),v.enableAttribute(r.position),d.vertexAttribPointer(r.position,3,d.FLOAT,!1,0,0)),e.hasNormals&&(d.bindBuffer(d.ARRAY_BUFFER,n.normal),d.bufferData(d.ARRAY_BUFFER,e.normalArray,d.DYNAMIC_DRAW),v.enableAttribute(r.normal),d.vertexAttribPointer(r.normal,3,d.FLOAT,!1,0,0)),e.hasUvs&&(d.bindBuffer(d.ARRAY_BUFFER,n.uv),d.bufferData(d.ARRAY_BUFFER,e.uvArray,d.DYNAMIC_DRAW),v.enableAttribute(r.uv),d.vertexAttribPointer(r.uv,2,d.FLOAT,!1,0,0)),e.hasColors&&(d.bindBuffer(d.ARRAY_BUFFER,n.color),d.bufferData(d.ARRAY_BUFFER,e.colorArray,d.DYNAMIC_DRAW),v.enableAttribute(r.color),d.vertexAttribPointer(r.color,3,d.FLOAT,!1,0,0)),v.disableUnusedAttributes(),d.drawArrays(d.TRIANGLES,0,e.count),e.count=0};var me=new mi;this.renderBufferDirect=function(e,t,n,r,i,o){null===t&&(t=me);var a=i.isMesh&&i.matrixWorld.determinant()<0,s=we(e,t,r,i);v.setMaterial(r,a);var c=!1;B.geometry===n.id&&B.program===s.id&&B.wireframe===(!0===r.wireframe)||(B.geometry=n.id,B.program=s.id,B.wireframe=!0===r.wireframe,c=!0),(r.morphTargets||r.morphNormals)&&(T.update(i,n,r,s),c=!0);var u=n.index,l=n.attributes.position;if(null===u){if(void 0===l||0===l.count)return}else if(0===u.count)return;var h,f=1;!0===r.wireframe&&(u=w.getWireframeAttribute(n),f=2);var g=A;null!==u&&(h=_.get(u),(g=P).setIndex(h)),c&&(function(e,t,n,r){if(!1!==m.isWebGL2||!e.isInstancedMesh&&!t.isInstancedBufferGeometry||null!==p.get("ANGLE_instanced_arrays")){v.initAttributes();var i=t.attributes,o=r.getAttributes(),a=n.defaultAttributeValues;for(var s in o){var c=o[s];if(c>=0){var u=i[s];if(void 0!==u){var l=u.normalized,h=u.itemSize;if(void 0===(S=_.get(u)))continue;var g=S.buffer,f=S.type,b=S.bytesPerElement;if(u.isInterleavedBufferAttribute){var y=u.data,w=y.stride,x=u.offset;y&&y.isInstancedInterleavedBuffer?(v.enableAttributeAndDivisor(c,y.meshPerAttribute),void 0===t.maxInstancedCount&&(t.maxInstancedCount=y.meshPerAttribute*y.count)):v.enableAttribute(c),d.bindBuffer(d.ARRAY_BUFFER,g),d.vertexAttribPointer(c,h,f,l,w*b,x*b)}else u.isInstancedBufferAttribute?(v.enableAttributeAndDivisor(c,u.meshPerAttribute),void 0===t.maxInstancedCount&&(t.maxInstancedCount=u.meshPerAttribute*u.count)):v.enableAttribute(c),d.bindBuffer(d.ARRAY_BUFFER,g),d.vertexAttribPointer(c,h,f,l,0,0)}else if("instanceMatrix"===s){var S;if(void 0===(S=_.get(e.instanceMatrix)))continue;g=S.buffer,f=S.type,v.enableAttributeAndDivisor(c+0,1),v.enableAttributeAndDivisor(c+1,1),v.enableAttributeAndDivisor(c+2,1),v.enableAttributeAndDivisor(c+3,1),d.bindBuffer(d.ARRAY_BUFFER,g),d.vertexAttribPointer(c+0,4,f,!1,64,0),d.vertexAttribPointer(c+1,4,f,!1,64,16),d.vertexAttribPointer(c+2,4,f,!1,64,32),d.vertexAttribPointer(c+3,4,f,!1,64,48)}else if(void 0!==a){var E=a[s];if(void 0!==E)switch(E.length){case 2:d.vertexAttrib2fv(c,E);break;case 3:d.vertexAttrib3fv(c,E);break;case 4:d.vertexAttrib4fv(c,E);break;default:d.vertexAttrib1fv(c,E)}}}}v.disableUnusedAttributes()}}(i,n,r,s),null!==u&&d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,h.buffer));var y=null!==u?u.count:l.count,b=n.drawRange.start*f,x=n.drawRange.count*f,S=null!==o?o.start*f:0,E=null!==o?o.count*f:1/0,M=Math.max(b,S),C=Math.min(y,b+x,S+E)-1,L=Math.max(0,C-M+1);if(0!==L){if(i.isMesh)!0===r.wireframe?(v.setLineWidth(r.wireframeLinewidth*oe()),g.setMode(d.LINES)):g.setMode(d.TRIANGLES);else if(i.isLine){var R=r.linewidth;void 0===R&&(R=1),v.setLineWidth(R*oe()),i.isLineSegments?g.setMode(d.LINES):i.isLineLoop?g.setMode(d.LINE_LOOP):g.setMode(d.LINE_STRIP)}else i.isPoints?g.setMode(d.POINTS):i.isSprite&&g.setMode(d.TRIANGLES);i.isInstancedMesh?g.renderInstances(n,M,L,i.count):n.isInstancedBufferGeometry?g.renderInstances(n,M,L,n.maxInstancedCount):g.render(M,L)}},this.compile=function(e,t){(f=M.get(e,t)).init(),e.traverse((function(e){e.isLight&&(f.pushLight(e),e.castShadow&&f.pushShadow(e))})),f.setupLights(t);var n={};e.traverse((function(t){if(t.material)if(Array.isArray(t.material))for(var r=0;r<t.material.length;r++)t.material[r].uuid in n==0&&(_e(t.material[r],e,t),n[t.material[r].uuid]=!0);else t.material.uuid in n==0&&(_e(t.material,e,t),n[t.material.uuid]=!0)}))};var ve=null,ge=new uo;function ye(e,t,n,r){for(var i=0,o=e.length;i<o;i++){var a=e[i],s=a.object,c=a.geometry,u=void 0===r?a.material:r,l=a.group;if(n.isArrayCamera)if(z=n,ce.enabled&&ue.isAvailable())be(s,t,n,c,u,l);else for(var h=n.cameras,d=0,p=h.length;d<p;d++){var m=h[d];s.layers.test(m.layers)&&(v.viewport(V.copy(m.viewport)),f.setupLights(m),be(s,t,m,c,u,l))}else z=null,be(s,t,n,c,u,l)}}function be(e,t,n,r,i,o){if(e.onBeforeRender(R,t,n,r,i,o),f=M.get(t,z||n),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){var a=we(n,t,i,e);v.setMaterial(i),B.geometry=null,B.program=null,B.wireframe=!1,function(e,t){e.render((function(e){R.renderBufferImmediate(e,t)}))}(e,a)}else R.renderBufferDirect(n,t,r,i,e,o);e.onAfterRender(R,t,n,r,i,o),f=M.get(t,z||n)}function _e(e,t,n){var r=y.get(e),i=f.state.lights,o=f.state.shadowsArray,a=i.state.version,s=S.getParameters(e,i.state,o,t,ee.numPlanes,ee.numIntersection,n),c=S.getProgramCacheKey(s),u=r.program,l=!0;if(void 0===u)e.addEventListener("dispose",de);else if(u.cacheKey!==c)pe(e);else if(r.lightsStateVersion!==a)r.lightsStateVersion=a,l=!1;else{if(void 0!==s.shaderID)return;l=!1}l&&(u=S.acquireProgram(s,c),r.program=u,r.uniforms=s.uniforms,r.environment=e.isMeshStandardMaterial?t.environment:null,r.outputEncoding=R.outputEncoding,e.program=u);var h=u.getAttributes();if(e.morphTargets){e.numSupportedMorphTargets=0;for(var d=0;d<R.maxMorphTargets;d++)h["morphTarget"+d]>=0&&e.numSupportedMorphTargets++}if(e.morphNormals)for(e.numSupportedMorphNormals=0,d=0;d<R.maxMorphNormals;d++)h["morphNormal"+d]>=0&&e.numSupportedMorphNormals++;var p=r.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(r.numClippingPlanes=ee.numPlanes,r.numIntersection=ee.numIntersection,p.clippingPlanes=ee.uniform),r.fog=t.fog,r.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),r.lightsStateVersion=a,r.needsLights&&(p.ambientLightColor.value=i.state.ambient,p.lightProbe.value=i.state.probe,p.directionalLights.value=i.state.directional,p.spotLights.value=i.state.spot,p.rectAreaLights.value=i.state.rectArea,p.pointLights.value=i.state.point,p.hemisphereLights.value=i.state.hemi,p.directionalShadowMap.value=i.state.directionalShadowMap,p.directionalShadowMatrix.value=i.state.directionalShadowMatrix,p.spotShadowMap.value=i.state.spotShadowMap,p.spotShadowMatrix.value=i.state.spotShadowMatrix,p.pointShadowMap.value=i.state.pointShadowMap,p.pointShadowMatrix.value=i.state.pointShadowMatrix);var m=r.program.getUniforms(),v=Fs.seqWithValue(m.seq,p);r.uniformsList=v}function we(e,t,n,r){b.resetTextureUnits();var i=t.fog,o=n.isMeshStandardMaterial?t.environment:null,a=y.get(n),s=f.state.lights;if(te&&(ne||e!==j)){var c=e===j&&n.id===U;ee.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,e,a,c)}n.version===a.__version?void 0===a.program||n.fog&&a.fog!==i||a.environment!==o||a.needsLights&&a.lightsStateVersion!==s.state.version?_e(n,t,r):void 0===a.numClippingPlanes||a.numClippingPlanes===ee.numPlanes&&a.numIntersection===ee.numIntersection?a.outputEncoding!==R.outputEncoding&&_e(n,t,r):_e(n,t,r):(_e(n,t,r),a.__version=n.version);var u=!1,l=!1,h=!1,p=a.program,g=p.getUniforms(),_=a.uniforms;if(v.useProgram(p.program)&&(u=!0,l=!0,h=!0),n.id!==U&&(U=n.id,l=!0),u||j!==e){if(p.numMultiviewViews>0?ue.updateCameraProjectionMatricesUniform(e,g):g.setValue(d,"projectionMatrix",e.projectionMatrix),m.logarithmicDepthBuffer&&g.setValue(d,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),j!==e&&(j=e,l=!0,h=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){var w=g.map.cameraPosition;void 0!==w&&w.setValue(d,ie.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&g.setValue(d,"isOrthographic",!0===e.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&(p.numMultiviewViews>0?ue.updateCameraViewMatricesUniform(e,g):g.setValue(d,"viewMatrix",e.matrixWorldInverse))}if(n.skinning){g.setOptional(d,r,"bindMatrix"),g.setOptional(d,r,"bindMatrixInverse");var x=r.skeleton;if(x){var S=x.bones;if(m.floatVertexTextures){if(void 0===x.boneTexture){var E=Math.sqrt(4*S.length);E=Fr.ceilPowerOfTwo(E),E=Math.max(E,4);var M=new Float32Array(E*E*4);M.set(x.boneMatrices);var C=new Pi(M,E,E,Ei,xi);x.boneMatrices=M,x.boneTexture=C,x.boneTextureSize=E}g.setValue(d,"boneTexture",x.boneTexture,b),g.setValue(d,"boneTextureSize",x.boneTextureSize)}else g.setOptional(d,x,"boneMatrices")}}return(l||a.receiveShadow!==r.receiveShadow)&&(a.receiveShadow=r.receiveShadow,g.setValue(d,"receiveShadow",r.receiveShadow)),l&&(g.setValue(d,"toneMappingExposure",R.toneMappingExposure),g.setValue(d,"toneMappingWhitePoint",R.toneMappingWhitePoint),a.needsLights&&function(e,t){e.ambientLightColor.needsUpdate=t,e.lightProbe.needsUpdate=t,e.directionalLights.needsUpdate=t,e.pointLights.needsUpdate=t,e.spotLights.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}(_,h),i&&n.fog&&function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)}(_,i),n.isMeshBasicMaterial?xe(_,n):n.isMeshLambertMaterial?(xe(_,n),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(_,n)):n.isMeshToonMaterial?(xe(_,n),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.gradientMap&&(e.gradientMap.value=t.gradientMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(_,n)):n.isMeshPhongMaterial?(xe(_,n),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(_,n)):n.isMeshStandardMaterial?(xe(_,n,o),n.isMeshPhysicalMaterial?function(e,t,n){Se(e,t,n),e.reflectivity.value=t.reflectivity,e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.sheen&&e.sheen.value.copy(t.sheen),t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,1===t.side&&e.clearcoatNormalScale.value.negate()),e.transparency.value=t.transparency}(_,n,o):Se(_,n,o)):n.isMeshMatcapMaterial?(xe(_,n),function(e,t){t.matcap&&(e.matcap.value=t.matcap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(_,n)):n.isMeshDepthMaterial?(xe(_,n),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(_,n)):n.isMeshDistanceMaterial?(xe(_,n),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(_,n)):n.isMeshNormalMaterial?(xe(_,n),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(_,n)):n.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(_,n),n.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(_,n)):n.isPointsMaterial?function(e,t){var n;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*X,e.scale.value=.5*q,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.map?n=t.map:t.alphaMap&&(n=t.alphaMap),void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(_,n):n.isSpriteMaterial?function(e,t){var n;e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.map?n=t.map:t.alphaMap&&(n=t.alphaMap),void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(_,n):n.isShadowMaterial&&(_.color.value.copy(n.color),_.opacity.value=n.opacity),void 0!==_.ltc_1&&(_.ltc_1.value=so.LTC_1),void 0!==_.ltc_2&&(_.ltc_2.value=so.LTC_2),Fs.upload(d,a.uniformsList,_,b),n.isShaderMaterial&&(n.uniformsNeedUpdate=!1)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(Fs.upload(d,a.uniformsList,_,b),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&g.setValue(d,"center",r.center),p.numMultiviewViews>0?ue.updateObjectMatricesUniforms(r,e,g):(g.setValue(d,"modelViewMatrix",r.modelViewMatrix),g.setValue(d,"normalMatrix",r.normalMatrix)),g.setValue(d,"modelMatrix",r.matrixWorld),p}function xe(e,t,n){e.opacity.value=t.opacity,t.color&&e.diffuse.value.copy(t.color),t.emissive&&e.emissive.value.copy(t.emissive).multiplyScalar(t.emissiveIntensity),t.map&&(e.map.value=t.map),t.alphaMap&&(e.alphaMap.value=t.alphaMap),t.specularMap&&(e.specularMap.value=t.specularMap);var r,i,o=t.envMap||n;o&&(e.envMap.value=o,e.flipEnvMap.value=o.isCubeTexture?-1:1,e.reflectivity.value=t.reflectivity,e.refractionRatio.value=t.refractionRatio,e.maxMipLevel.value=y.get(o).__maxMipLevel),t.lightMap&&(e.lightMap.value=t.lightMap,e.lightMapIntensity.value=t.lightMapIntensity),t.aoMap&&(e.aoMap.value=t.aoMap,e.aoMapIntensity.value=t.aoMapIntensity),t.map?r=t.map:t.specularMap?r=t.specularMap:t.displacementMap?r=t.displacementMap:t.normalMap?r=t.normalMap:t.bumpMap?r=t.bumpMap:t.roughnessMap?r=t.roughnessMap:t.metalnessMap?r=t.metalnessMap:t.alphaMap?r=t.alphaMap:t.emissiveMap&&(r=t.emissiveMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),e.uvTransform.value.copy(r.matrix)),t.aoMap?i=t.aoMap:t.lightMap&&(i=t.lightMap),void 0!==i&&(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate&&i.updateMatrix(),e.uv2Transform.value.copy(i.matrix))}function Se(e,t,n){e.roughness.value=t.roughness,e.metalness.value=t.metalness,t.roughnessMap&&(e.roughnessMap.value=t.roughnessMap),t.metalnessMap&&(e.metalnessMap.value=t.metalnessMap),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap),t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1)),t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate()),t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias),(t.envMap||n)&&(e.envMapIntensity.value=t.envMapIntensity)}ge.setAnimationLoop((function(e){ce.isPresenting||ve&&ve(e)})),"undefined"!=typeof window&&ge.setContext(window),this.setAnimationLoop=function(e){ve=e,ce.setAnimationLoop(e),ge.start()},this.render=function(e,t){var n,r;if(void 0!==arguments[2]&&(console.warn("WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),r=arguments[3]),t&&t.isCamera){if(!k){B.geometry=null,B.program=null,B.wireframe=!1,U=-1,j=null,!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),ce.enabled&&ce.isPresenting&&(t=ce.getCamera(t)),(f=M.get(e,t)).init(),e.onBeforeRender(R,e,t,n||F),re.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),Q.setFromProjectionMatrix(re),ne=this.localClippingEnabled,te=ee.init(this.clippingPlanes,ne,t),(h=E.get(e,t)).init(),function e(t,n,r,i){if(!1!==t.visible){if(t.layers.test(n.layers))if(t.isGroup)r=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(n);else if(t.isLight)f.pushLight(t),t.castShadow&&f.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||Q.intersectsSprite(t)){i&&ie.setFromMatrixPosition(t.matrixWorld).applyMatrix4(re);var a=x.update(t);(s=t.material).visible&&h.push(t,a,s,r,ie.z,null)}}else if(t.isImmediateRenderObject)i&&ie.setFromMatrixPosition(t.matrixWorld).applyMatrix4(re),h.push(t,null,t.material,r,ie.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.frame!==g.render.frame&&(t.skeleton.update(),t.skeleton.frame=g.render.frame),!t.frustumCulled||Q.intersectsObject(t))){i&&ie.setFromMatrixPosition(t.matrixWorld).applyMatrix4(re),a=x.update(t);var s=t.material;if(Array.isArray(s))for(var o=a.groups,u=0,c=o.length;u<c;u++){var l=o[u],p=s[l.materialIndex];p&&p.visible&&h.push(t,a,p,r,ie.z,l)}else s.visible&&h.push(t,a,s,r,ie.z,null)}var d=t.children;for(u=0,c=d.length;u<c;u++)e(d[u],n,r,i)}}(e,t,0,R.sortObjects),!0===R.sortObjects&&h.sort(Y,Z),te&&ee.beginShadows();var i=f.state.shadowsArray;le.render(i,e,t),f.setupLights(t),te&&ee.endShadows(),this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),ce.enabled&&ue.isAvailable()&&ue.attachCamera(t),C.render(h,e,t,r);var o=h.opaque,a=h.transparent;if(e.overrideMaterial){var s=e.overrideMaterial;o.length&&ye(o,e,t,s),a.length&&ye(a,e,t,s)}else o.length&&ye(o,e,t),a.length&&ye(a,e,t);e.onAfterRender(R,e,t),null!==F&&(b.updateRenderTargetMipmap(F),b.updateMultisampleRenderTarget(F)),v.buffers.depth.setTest(!0),v.buffers.depth.setMask(!0),v.buffers.color.setMask(!0),v.setPolygonOffset(!1),ce.enabled&&ue.isAvailable()&&ue.detachCamera(t),h=null,f=null}}else console.error("WebGLRenderer.render: camera is not an instance of Camera.")},this.setFramebuffer=function(e){N!==e&&null===F&&d.bindFramebuffer(d.FRAMEBUFFER,e),N=e},this.getActiveCubeFace=function(){return O},this.getActiveMipmapLevel=function(){return D},this.getRenderTarget=function(){return F},this.setRenderTarget=function(e,t,n){F=e,O=t,D=n,e&&void 0===y.get(e).__webglFramebuffer&&b.setupRenderTarget(e);var r=N,i=!1;if(e){var o=y.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(r=o[t||0],i=!0):r=e.isWebGLMultisampleRenderTarget?y.get(e).__webglMultisampledFramebuffer:o,V.copy(e.viewport),G.copy(e.scissor),W=e.scissorTest}else V.copy(J).multiplyScalar(X).floor(),G.copy(K).multiplyScalar(X).floor(),W=$;if(I!==r&&(d.bindFramebuffer(d.FRAMEBUFFER,r),I=r),v.viewport(V),v.scissor(G),v.setScissorTest(W),i){var a=y.get(e.texture);d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_CUBE_MAP_POSITIVE_X+(t||0),a.__webglTexture,n||0)}},this.readRenderTargetPixels=function(e,t,n,r,i,o,a){if(e&&e.isWebGLRenderTarget){var s=y.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==a&&(s=s[a]),s){var c=!1;s!==I&&(d.bindFramebuffer(d.FRAMEBUFFER,s),c=!0);try{var u=e.texture,l=u.format,h=u.type;if(l!==Ei&&L.convert(l)!==d.getParameter(d.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(1009===h||L.convert(h)===d.getParameter(d.IMPLEMENTATION_COLOR_READ_TYPE)||h===xi&&(m.isWebGL2||p.get("OES_texture_float")||p.get("WEBGL_color_buffer_float"))||1016===h&&(m.isWebGL2?p.get("EXT_color_buffer_float"):p.get("EXT_color_buffer_half_float"))))return void console.error("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");d.checkFramebufferStatus(d.FRAMEBUFFER)===d.FRAMEBUFFER_COMPLETE?t>=0&&t<=e.width-r&&n>=0&&n<=e.height-i&&d.readPixels(t,n,r,i,L.convert(l),L.convert(h),o):console.error("WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{c&&d.bindFramebuffer(d.FRAMEBUFFER,I)}}}else console.error("WebGLRenderer.readRenderTargetPixels: renderTarget is not WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t,n){void 0===n&&(n=0);var r=Math.pow(2,-n),i=Math.floor(t.image.width*r),o=Math.floor(t.image.height*r),a=L.convert(t.format);b.setTexture2D(t,0),d.copyTexImage2D(d.TEXTURE_2D,n,a,e.x,e.y,i,o,0),v.unbindTexture()},this.copyTextureToTexture=function(e,t,n,r){var i=t.image.width,o=t.image.height,a=L.convert(n.format),s=L.convert(n.type);b.setTexture2D(n,0),t.isDataTexture?d.texSubImage2D(d.TEXTURE_2D,r||0,e.x,e.y,i,o,a,s,t.image.data):d.texSubImage2D(d.TEXTURE_2D,r||0,e.x,e.y,a,s,t.image),v.unbindTexture()},this.initTexture=function(e){b.setTexture2D(e,0),v.unbindTexture()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function bc(e){this.autoStart=void 0===e||e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function _c(e,t,n,r){go.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new wc(e,t,n,r)),this.mergeVertices()}function wc(e,t,n,r){Uo.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:r},e=e||1,t=void 0!==t?Math.max(3,t):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var i,o,a=[],s=[],c=[],u=[],l=new jr,h=new Mi;for(s.push(0,0,0),c.push(0,0,1),u.push(.5,.5),o=0,i=3;o<=t;o++,i+=3){var f=n+o/t*r;l.x=e*Math.cos(f),l.y=e*Math.sin(f),s.push(l.x,l.y,l.z),c.push(0,0,1),h.x=(s[i]/e+1)/2,h.y=(s[i+1]/e+1)/2,u.push(h.x,h.y)}for(i=1;i<=t;i++)a.push(i,i+1,0);this.setIndex(a),this.setAttribute("position",new To(s,3)),this.setAttribute("normal",new To(c,3)),this.setAttribute("uv",new To(u,2))}ac.prototype=Object.assign(Object.create(Zr.prototype),{constructor:ac,isWebGLRenderTarget:!0,setSize:function(e,t){this.width===e&&this.height===t||(this.width=e,this.height=t,this.texture.image.width=e,this.texture.image.height=t,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),sc.prototype=Object.create(Xo.prototype),sc.prototype.constructor=sc,sc.prototype.isMeshDepthMaterial=!0,sc.prototype.copy=function(e){return Xo.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},cc.prototype=Object.create(Xo.prototype),cc.prototype.constructor=cc,cc.prototype.isMeshDistanceMaterial=!0,cc.prototype.copy=function(e){return Xo.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},fc.prototype=Object.assign(Object.create(ac.prototype),{constructor:fc,isWebGLMultiviewRenderTarget:!0,copy:function(e){return ac.prototype.copy.call(this,e),this.numViews=e.numViews,this},setNumViews:function(e){return this.numViews!==e&&(this.numViews=e,this.dispose()),this}}),pc.prototype=Object.assign(Object.create(vi.prototype),{constructor:pc,isPerspectiveCamera:!0,copy:function(e,t){return vi.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*Fr.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*Fr.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*Fr.RAD2DEG*Math.atan(Math.tan(.5*Fr.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,r,i,o){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*Fr.DEG2RAD*this.fov)/this.zoom,n=2*t,r=this.aspect*n,i=-.5*r,o=this.view;if(null!==this.view&&this.view.enabled){var a=o.fullWidth,s=o.fullHeight;i+=o.offsetX*r/a,t-=o.offsetY*n/s,r*=o.width/a,n*=o.height/s}var c=this.filmOffset;0!==c&&(i+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,t,t-n,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){var t=pi.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),mc.prototype=Object.assign(Object.create(pc.prototype),{constructor:mc,isArrayCamera:!0}),vc.prototype=Object.assign(Object.create(pi.prototype),{constructor:vc,isGroup:!0}),Object.assign(gc.prototype,Zr.prototype),Object.assign(bc.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=("undefined"==typeof performance?Date:performance).now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}),_c.prototype=Object.create(go.prototype),_c.prototype.constructor=_c,wc.prototype=Object.create(Uo.prototype),wc.prototype.constructor=wc;var th={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","\tvec4 texel = texture2D( tDiffuse, vUv );","\tgl_FragColor = opacity * texel;","}"].join("\n")};function xc(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}Object.assign(xc.prototype,{setSize:function(){},render:function(){console.error("Pass: .render() must be implemented in derived pass.")}}),xc.FullScreenQuad=function(){var e=new gi(-1,1,1,-1,0,1),t=new Ho(2,2),n=function(e){this._mesh=new Da(t,e)};return Object.defineProperty(n.prototype,"material",{get:function(){return this._mesh.material},set:function(e){this._mesh.material=e}}),Object.assign(n.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(t){t.render(this._mesh,e)}}),n}();var Sc=function(e,t){xc.call(this),this.textureID=void 0!==t?t:"tDiffuse",e instanceof Ko?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=Jo.clone(e.uniforms),this.material=new Ko({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new xc.FullScreenQuad(this.material)};Sc.prototype=Object.assign(Object.create(xc.prototype),{constructor:Sc,render:function(e,t,n){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}});var Ec=function(e,t){xc.call(this),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1};Ec.prototype=Object.assign(Object.create(xc.prototype),{constructor:Ec,render:function(e,t,n){var r,i,o=e.getContext(),a=e.state;a.buffers.color.setMask(!1),a.buffers.depth.setMask(!1),a.buffers.color.setLocked(!0),a.buffers.depth.setLocked(!0),this.inverse?(r=0,i=1):(r=1,i=0),a.buffers.stencil.setTest(!0),a.buffers.stencil.setOp(o.REPLACE,o.REPLACE,o.REPLACE),a.buffers.stencil.setFunc(o.ALWAYS,r,4294967295),a.buffers.stencil.setClear(i),a.buffers.stencil.setLocked(!0),e.setRenderTarget(n),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),a.buffers.color.setLocked(!1),a.buffers.depth.setLocked(!1),a.buffers.stencil.setLocked(!1),a.buffers.stencil.setFunc(o.EQUAL,1,4294967295),a.buffers.stencil.setOp(o.KEEP,o.KEEP,o.KEEP),a.buffers.stencil.setLocked(!0)}});var Mc=function(){xc.call(this),this.needsSwap=!1};Mc.prototype=Object.create(xc.prototype),Object.assign(Mc.prototype,{render:function(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}});var Cc=function(e,t){if(this.renderer=e,void 0===t){var n={minFilter:wi,magFilter:wi,format:Ei,stencilBuffer:!1},r=e.getSize(new Mi);this._pixelRatio=e.getPixelRatio(),this._width=r.width,this._height=r.height,(t=new ac(this._width*this._pixelRatio,this._height*this._pixelRatio,n)).texture.name="EffectComposer.rt1"}else this._pixelRatio=1,this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===th&&console.error("EffectComposer relies on CopyShader"),void 0===Sc&&console.error("EffectComposer relies on ShaderPass"),this.copyPass=new Sc(th),this.clock=new bc};function Tc(e,t,n,r,i,o,a,s,c){Ai.call(this,e,t,n,r,i,o,a,s,c),this.format=void 0!==a?a:Si,this.minFilter=void 0!==o?o:wi,this.magFilter=void 0!==i?i:wi,this.generateMipmaps=!1}Object.assign(Cc.prototype,{swapBuffers:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},addPass:function(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},insertPass:function(e,t){this.passes.splice(t,0,e)},isLastEnabledPass:function(e){for(var t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0},render:function(e){void 0===e&&(e=this.clock.getDelta());var t,n,r=this.renderer.getRenderTarget(),i=!1,o=this.passes.length;for(n=0;n<o;n++)if(!1!==(t=this.passes[n]).enabled){if(t.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(n),t.render(this.renderer,this.writeBuffer,this.readBuffer,e,i),t.needsSwap){if(i){var a=this.renderer.getContext(),s=this.renderer.state.buffers.stencil;s.setFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),s.setFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==Ec&&(t instanceof Ec?i=!0:t instanceof Mc&&(i=!1))}this.renderer.setRenderTarget(r)},reset:function(e){if(void 0===e){var t=this.renderer.getSize(new Mi);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(e,t){this._width=e,this._height=t;var n=this._width*this._pixelRatio,r=this._height*this._pixelRatio;this.renderTarget1.setSize(n,r),this.renderTarget2.setSize(n,r);for(var i=0;i<this.passes.length;i++)this.passes[i].setSize(n,r)},setPixelRatio:function(e){this._pixelRatio=e,this.setSize(this._width,this._height)}}),Tc.prototype=Object.assign(Object.create(Ai.prototype),{constructor:Tc,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}});var Ac=n(56);function Pc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Lc=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.webgl=t,this.speed=75,this.time=200,this.style="solid",this.colour={r:0,g:0,b:0},this.listen()}return function(e,t,n){t&&Pc(e.prototype,t)}(e,[{key:"listen",value:function(){var e=this;this.webgl.base.listenEvent(qn.flash,(function(t){e.change(t.flash)})),this.webgl.base.listenEvent(kr.exitFullScreen,(function(){e.webgl.pass.flash.solid.uniforms.nextR.value=e.colour.r,e.webgl.pass.flash.solid.uniforms.nextG.value=e.colour.g,e.webgl.pass.flash.solid.uniforms.nextB.value=e.colour.b}))}},{key:"change",value:function(e){e>0&&e<=Iu.code.length?(this.webgl.pass.flash[this.style].uniforms.seedsX.value=this.webgl.uniform.seeds(),this.webgl.pass.flash[this.style].uniforms.seedsY.value=this.webgl.uniform.seeds(),this.webgl.pass.flash[this.style].uniforms.thisR.value=this.colour.r,this.webgl.pass.flash[this.style].uniforms.thisG.value=this.colour.g,this.webgl.pass.flash[this.style].uniforms.thisB.value=this.colour.b,this.webgl.pass.flash[this.style].uniforms.start.value=this.webgl.pass.flash[this.style].uniforms.time.value,this.colour.r=mr.r[e],this.colour.g=mr.g[e],this.colour.b=mr.b[e],this.webgl.pass.flash[this.style].uniforms.nextR.value=this.colour.r,this.webgl.pass.flash[this.style].uniforms.nextG.value=this.colour.g,this.webgl.pass.flash[this.style].uniforms.nextB.value=this.colour.b,this.webgl.pass.colourBlend.uniforms.edgeR.value=.5,this.webgl.pass.colourBlend.uniforms.edgeG.value=.5,this.webgl.pass.colourBlend.uniforms.edgeB.value=.5):(this.webgl.pass.flash[this.style].uniforms.nextR.value=0,this.webgl.pass.flash[this.style].uniforms.nextG.value=0,this.webgl.pass.flash[this.style].uniforms.nextB.value=0,this.webgl.pass.colourBlend.uniforms.edgeR.value=192/255,this.webgl.pass.colourBlend.uniforms.edgeG.value=192/255,this.webgl.pass.colourBlend.uniforms.edgeB.value=192/255)}}]),e}();function Rc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var kc=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.options=t,this.luminance={tDiffuse:{type:"t",value:null}},this.flash={solid:{time:{type:"f",value:1},seedsX:{type:"fv1",value:this.seeds()},seedsY:{type:"fv1",value:this.seeds()},thisR:{type:"f",value:250/255},thisG:{type:"f",value:250/255},thisB:{type:"f",value:250/255},nextR:{type:"f",value:250/255},nextG:{type:"f",value:250/255},nextB:{type:"f",value:250/255},start:{type:"f",value:250/255}},circles:{time:{type:"f",value:1},timeDiff:{type:"f",value:20},delta:{type:"f",value:.15},seedsX:{type:"fv1",value:this.seeds()},seedsY:{type:"fv1",value:this.seeds()},thisR:{type:"f",value:0},thisG:{type:"f",value:0},thisB:{type:"f",value:0},nextR:{type:"f",value:0},nextG:{type:"f",value:0},nextB:{type:"f",value:0},start:{type:"f",value:0}},scan:{tScan:{type:"t",value:null},uWindow:{type:"v2",value:new Mi(parseFloat(xu),parseFloat(Su))},cross:{type:"v4",value:new co(-.55,.55,0,10)},color:{type:"v4",value:new co(1,1,1,1)}}},this.copy={tDiffuse:{type:"t",value:null},opacity:{type:"float",value:1}},this.sobel={tDiffuse:{type:"t",value:null},uWindow:{type:"v2",value:new Mi(parseFloat(xu),parseFloat(Su))},threshold:{type:"float",value:1}},this.suppression={tDiffuse:{type:"t",value:null},texelWidth:{type:"float",value:.001},texelHeight:{type:"float",value:.001},upperThreshold:{type:"float",value:.15},lowerThreshold:{type:"float",value:.05}},this.inclusion={tDiffuse:{type:"t",value:null},uWindow:{type:"v2",value:new Mi(parseFloat(xu),parseFloat(Su))},threshold:{type:"float",value:1}},this.shade={tDiffuse:{type:"t",value:null},tShade:{type:"t",value:null},blend:{type:"v4",value:new co(1,1,1,this.options.isKioskMode?.25:.75)},fade:{type:"v4",value:new co(2.8,2.3,2.8,2.3)}},this.blend={tDiffuse:{type:"t",value:null},tFlash:{type:"t",value:null},edgeR:{type:"float",value:64/255},edgeG:{type:"float",value:64/255},edgeB:{type:"float",value:64/255},show:{type:"f",value:0}},this.alphaBlend={tDiffuse:{type:"t",value:null},tBlend:{type:"t",value:null}},this.blur={tDiffuse:{type:"t",value:null},h:{type:"float",value:1/xu},v:{type:"float",value:1/Su}}}return function(e,t,n){t&&Rc(e.prototype,t)}(e,[{key:"seeds",value:function(){return Array.from(Array(5),(function(){return 1.6*Math.random()-.8}))}}]),e}(),Nc={uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float h;","varying vec2 vUv;","void main() {","\tvec4 sum = vec4( 0.0 );","\tsum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;","\tsum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;","\tsum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;","\tsum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","\tsum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;","\tsum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;","\tsum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;","\tsum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;","\tgl_FragColor = sum;","}"].join("\n")},Oc={uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:["varying vec2 vUv;","void main() {","\tvUv = uv;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform sampler2D tDiffuse;","uniform float v;","varying vec2 vUv;","void main() {","\tvec4 sum = vec4( 0.0 );","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;","\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;","\tgl_FragColor = sum;","}"].join("\n")},Dc=n(162),Fc=n.n(Dc),Ic=n(163),Uc=n.n(Ic),Bc=n(164),jc=n.n(Bc),zc=n(165),Vc=n.n(zc),Gc=n(166),Wc=n.n(Gc),Hc=n(161),qc=n.n(Hc),Xc=n(170),Yc=n.n(Xc),Zc=n(169),Jc=n.n(Zc),Kc=n(11),$c=n.n(Kc),Qc=n(168),eu=n.n(Qc),tu=n(167),nu=n.n(tu),ru=n(171),iu=n.n(ru),ou=n(172),au=n.n(ou),su=n(173),cu=n.n(su);function uu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var lu=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.uniform=t,this.options=n,this.load()}return function(e,t,n){t&&uu(e.prototype,t)}(e,[{key:"load",value:function(){this.copyShader={uniforms:this.uniform.copy,vertexShader:$c.a,fragmentShader:qc.a},this.luminanceFilterPass={uniforms:this.uniform.luminance,vertexShader:$c.a,fragmentShader:Fc.a},this.sobelEdgeFilterPass={uniforms:this.uniform.sobel,vertexShader:$c.a,fragmentShader:Uc.a},this.suppressionFilterPass={uniforms:this.uniform.suppression,vertexShader:$c.a,fragmentShader:jc.a},this.inclusionFilterPass={uniforms:this.uniform.inclusion,vertexShader:$c.a,fragmentShader:Vc.a},this.shadeFilterPass={uniforms:this.uniform.shade,vertexShader:$c.a,fragmentShader:Wc.a},this.additiveBlendShader={uniforms:this.uniform.blend,vertexShader:$c.a,fragmentShader:this.options.isKioskMode?nu.a:eu.a},this.horizontalBlurShader={uniforms:this.uniform.blur,vertexShader:$c.a,fragmentShader:Nc.fragmentShader},this.verticalBlurShader={uniforms:this.uniform.blur,vertexShader:$c.a,fragmentShader:Oc.fragmentShader},this.solidFlashShader={uniforms:this.uniform.flash.solid,vertexShader:$c.a,fragmentShader:Jc.a},this.circlesFlashShader={uniforms:this.uniform.flash.circles,vertexShader:$c.a,fragmentShader:Yc.a},this.alphaBlend={uniforms:this.uniform.alphaBlend,vertexShader:$c.a,fragmentShader:iu.a},this.mirrorColourShader={uniforms:this.uniform.flash.solid,vertexShader:$c.a,fragmentShader:au.a},this.scanFlashShader={uniforms:this.uniform.flash.scan,vertexShader:$c.a,fragmentShader:cu.a}}}]),e}();function hu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var fu=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.webgl=t,this.colour={0:{r:.6,g:.6,b:.6},1:{r:.4,g:.4,b:.4},r:{r:1,g:.6,b:.6},g:{r:.6,g:1,b:.6},b:{r:.6,g:.6,b:1},y:{r:1,g:1,b:.6},c:{r:.6,g:1,b:1},m:{r:1,g:.6,b:1}}}return function(e,t,n){t&&hu(e.prototype,t)}(e,[{key:"init",value:function(){this.webgl.pass.sobel.uniforms.threshold.value=1,this.webgl.pass.suppression.uniforms.texelWidth.value=.001,this.webgl.pass.suppression.uniforms.texelHeight.value=.001,this.webgl.pass.suppression.uniforms.upperThreshold.value=.15,this.webgl.pass.suppression.uniforms.lowerThreshold.value=.05,this.webgl.pass.inclusion.uniforms.threshold.value=1}}]),e}(),du=function(e,t){xc.call(this),void 0===th&&console.error("TexturePass relies on CopyShader");var n=th;this.map=e,this.opacity=void 0!==t?t:1,this.uniforms=Jo.clone(n.uniforms),this.material=new Ko({uniforms:this.uniforms,vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,depthTest:!1,depthWrite:!1}),this.needsSwap=!1,this.fsQuad=new xc.FullScreenQuad(null)};du.prototype=Object.assign(Object.create(xc.prototype),{constructor:du,render:function(e,t,n){var r=e.autoClear;e.autoClear=!1,this.fsQuad.material=this.material,this.uniforms.opacity.value=this.opacity,this.uniforms.tDiffuse.value=this.map,this.material.transparent=this.opacity<1,e.setRenderTarget(this.renderToScreen?null:n),this.clear&&e.clear(),this.fsQuad.render(e),e.autoClear=r}});var pu=function(e,t,n,r,i){xc.call(this),this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=r,this.clearAlpha=void 0!==i?i:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1};function mu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}pu.prototype=Object.assign(Object.create(xc.prototype),{constructor:pu,render:function(e,t,n){var r,i,o=e.autoClear;e.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(r=e.getClearColor().getHex(),i=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:n),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(r,i),this.scene.overrideMaterial=null,e.autoClear=o}});var vu=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.webgl=t,this.flash={},this.blur={}}return function(e,t,n){t&&mu(e.prototype,t)}(e,[{key:"init",value:function(){this.webcam=new du(this.webgl.videoTexture,1),this.luminance=new Sc(this.webgl.shader.luminanceFilterPass),this.blur.horizontal=new Sc(this.webgl.shader.horizontalBlurShader),this.blur.vertical=new Sc(this.webgl.shader.verticalBlurShader),this.sobel=new Sc(this.webgl.shader.sobelEdgeFilterPass),this.suppression=new Sc(this.webgl.shader.suppressionFilterPass),this.inclusion=new Sc(this.webgl.shader.inclusionFilterPass),this.shade=new Sc(this.webgl.shader.shadeFilterPass),this.copy=new Sc(this.webgl.shader.copyShader),this.copy.renderToScreen=!1,this.renderCannyPlane=new pu(this.webgl.scene,this.webgl.camera),this.renderCannyPlane.renderToScreen=!1,this.flash.solid=new Sc(this.webgl.shader.solidFlashShader),this.flash.circles=new Sc(this.webgl.shader.circlesFlashShader),this.flash.circles.enabled=!1,this.flash.mirror=new Sc(this.webgl.shader.mirrorColourShader),this.flash.mirror.enabled=!1,this.flash.scan=new Sc(this.webgl.shader.scanFlashShader),this.colourBlend=new Sc(this.webgl.shader.additiveBlendShader),this.colourBlend.renderToScreen=!0}}]),e}();function gu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var yu=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.count=0,this.frames=0,this.prevTime=null}return function(e,t,n){t&&gu(e.prototype,t)}(e,[{key:"begin",value:function(){this.start=performance.now(),this.prevTime||(this.prevTime=this.start)}},{key:"end",value:function(){this.frames++,this.finish=performance.now(),this.finish>=this.prevTime+1e3&&(this.count=this.frames,this.prevTime=null,this.frames=0)}}]),e}();function bu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function wu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var xu,Su,Eu={background_color:"#000000",line_color:"#ffffff"},Mu="CanvasWebGL.lowFPS",Cu=function(){function e(t,n,r,i,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.video=n,this.faceModule=r,this.framesPerFlash=null,this.kioskMode=o,this.colours=this.setColours(Eu,i),this.fps=new yu,this.init(),this.listen()}return function(e,t,n){t&&wu(e.prototype,t)}(e,[{key:"init",value:function(){this.isStarted=!1,this.isEnteringCanny=!1,this.isLeavingCanny=!1,this.isScanning=!1,this.isLoadedWebGL=!1,this.isTriggeredLowFPS=!1,this.fpsReady=!1,this.isAnimating=!1,this.mustStop=null,this.prevFPS=0,this.trigger=0,this.scene=new mi,this.composer={},this.time=performance.now(),this.oval=4/3,this.offset={ios:this.base.device.isLandscape()?40:0,android:640},this.previousFace={x:0,y:0},this.hasFoundFace=!1,this.lastFoundFace=null,this.canSnapToFace=this.setSnapToFace(this.kioskMode),this.setSizes(this.isTriggeredLowFPS)}},{key:"listen",value:function(){var e=this;this.base.listenEvent(bl.clientStarted,(function(t){t.flags&&void 0!==t.flags.snap_to_face&&(e.base.console.log("Backend setting snap_to_face: ".concat(t.flags.snap_to_face)),e.setSnapToFace(t.flags.snap_to_face))})),this.base.listenEvent(qn.framesPerFlash,(function(t){e.framesPerFlash=t})),this.base.listenEvent(Cn.started,(function(){e.fpsReady=!0})),this.base.listenEvent(kr.start,(function(){e.isLeavingCanny=!1,e.isScanning=!1})),this.base.listenEvent(kr.exitFullScreen,(function(){e.isLoadedWebGL&&(e.base.dom.deleteElement(e.renderer.domElement),e.base.listenEvent(kr.enterFullScreen,(function(){return e.init()})))})),this.base.listenEvent(bl.edgeResult,(function(){return e.cleanUp()})),this.base.listenEvent(Zn.loaded,(function(){e.start(),e.base.listenEvent(kr.landscape,(function(){e.mustStop=!0})),e.base.listenEvent(kr.portrait,(function(){e.init(),e.start(),e.animate()})),e.animate()})),this.base.listenEvent(lr.stopped,(function(){e.mustStop=!0,cancelAnimationFrame(e.animation)})),this.base.listenEvent(kr.dimensionsUpdated,(function(){e.isScanning||e.updatePositions(e.isTriggeredLowFPS)})),this.base.listenEvent(l,(function(){e.isEnteringCanny=!0})),this.base.listenEvent(u,(function(){e.isEnteringCanny=!1})),this.base.listenEvent(h,(function(){e.isScanning=!0})),this.base.listenEvent(qn.maxFlashes,(function(){e.isLeavingCanny=!0})),this.base.listenEvent($t,(function(t){e.drawFace(t)}),!1)}},{key:"setSizes",value:function(e){this.width=e?innerWidth/2:innerWidth,this.height=e?innerHeight/2:innerHeight}},{key:"setSnapToFace",value:function(e){return this.canSnapToFace=e&&(this.base.device.tablet||this.base.device.desktop),this.canSnapToFace}},{key:"setColours",value:function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bu(Object(n),!0).forEach((function(t){_u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{},t)}},{key:"start",value:function(){if(this.isStarted)this.base.console.warn("WebGL already started, will not re-start");else{this.isStarted=!0;var e=this.base.dom.getElement("#".concat("iproov-webgl"));e&&this.base.dom.deleteElement(e);var t=this.cameraPosition,n=t.left,r=t.right,i=t.top,o=t.bottom;try{this.camera=new gi(n,r,i,o,1,1e3),this.cannyTarget=new ac(this.width,this.height),this.flashTarget=new ac(this.width,this.height),this.renderer=new yc({antialias:!this.base.device.safari,alpha:!0}),this.renderer.setPixelRatio(Pu),this.renderer.setSize(this.width,this.height),this.uniform=new kc({isKioskMode:this.kioskMode}),this.flash=new Lc(this),this.shader=new lu(this.uniform,{isKioskMode:this.kioskMode}),this.pass=new vu(this),this.line=new fu(this),this.clock=new bc,this.renderer.domElement.id="iproov-webgl",this.base.device.safari&&!this.base.device.ios&&this.base.device.firefox&&this.renderer.domElement.classList.add("low-fps"),this.renderer.autoClear=!0,this.base.app.appendChild(this.renderer.domElement),this.composer.edge=new Cc(this.renderer,this.cannyTarget),this.composer.flash=new Cc(this.renderer,this.flashTarget),this.composer.blend=new Cc(this.renderer),this.camera.position.set(0,0,Hn),this.videoTexture=new Tc(this.video.video),this.videoTexture.minFilter=wi,this.videoTexture.magFilter=wi,this.base.device.ios?this.cannyPlane=new Da(new Wo(Hn,Wn),new ga({map:this.cannyTarget,side:2})):this.cannyPlane=new Da(new Wo(Wn,Hn),new ga({map:this.cannyTarget,side:2})),this.cannyPlane.rotateY(Math.PI),this.scene.add(this.cannyPlane),this.face=new Da(new _c(1,64),new ga({transparent:!0,opacity:.25,color:16777215})),this.face.visible=!1,this.scene.add(this.face),this.pass.init(),this.line.init(),this.isLoadedWebGL=!0,this.renderSetup(),this.updatePositions()}catch(e){this.base.console.error("CanvasWebGL ".concat(e)),this.base.sendEvent(lf.error,{feedback:"client_stream",reason:this.base.language.term("client_stream")})}}}},{key:"renderSetup",value:function(){this.composer.edge.addPass(this.pass.webcam),this.composer.edge.addPass(this.pass.luminance),this.composer.edge.addPass(this.pass.blur.horizontal),this.composer.edge.addPass(this.pass.blur.vertical),this.composer.edge.addPass(this.pass.sobel),this.composer.edge.addPass(this.pass.suppression),this.composer.edge.addPass(this.pass.inclusion),this.composer.edge.addPass(this.pass.shade),this.pass.shade.uniforms.tShade.value=this.videoTexture,this.base.device.isLandscape()?this.pass.shade.uniforms.fade.value=new co(2.8,2.3,2.8,2.3):this.pass.shade.uniforms.fade.value=new co(2.3,2.8,2.3,2.8),this.composer.edge.addPass(this.pass.copy),this.composer.flash.addPass(this.pass.flash.solid),this.composer.flash.addPass(this.pass.flash.circles),this.composer.flash.addPass(this.pass.flash.mirror),this.composer.flash.addPass(this.pass.flash.scan),this.composer.flash.addPass(this.pass.copy),this.pass.flash.scan.uniforms.tScan.value=this.flashTarget.texture,this.composer.flash.addPass(this.pass.copy),this.composer.blend.addPass(this.pass.renderCannyPlane),this.composer.blend.addPass(this.pass.colourBlend),this.pass.colourBlend.uniforms.tFlash.value=this.flashTarget.texture}},{key:"animate",value:function(){var e=this;if(!this.mustStop){this.fps.begin();var t=this.clock.getDelta();if(this.pass.flash[this.flash.style].uniforms.time.value+=t*this.flash.speed,this.hasFoundFace){var n=this.lastFoundFace;this.base.device.ios?(this.face.position.x=-n.x+Hn/2,this.face.position.y=-n.y+this.offset.ios+Wn/2):(this.face.position.y=xu/Su<Wn/Hn?-n.y+Hn/2+(Hn-this.offset.android)/2:-n.y+Hn/2,this.face.position.x=-n.x+Wn/2),this.canSnapToFace&&this.snapToFace(n)}this.isScanning&&(this.pass.flash.scan.uniforms.cross.value.x+=t/(Mn/(this.framesPerFlash*this.base.device.edgeLegacy?2:4)),this.pass.shade.uniforms.blend.value.w=.85);var r=!this.base.device.isLandscape(),i=r?.2:.8,o=r?.5:.3,a=r?.8:.3,s=2.5*t;this.video.video.readyState===this.video.video.HAVE_ENOUGH_DATA&&this.isAnimating&&(this.pass.shade.uniforms.fade.value.x=Math.max(i,this.pass.shade.uniforms.fade.value.x-s),this.pass.shade.uniforms.fade.value.y=Math.max(o,this.pass.shade.uniforms.fade.value.y-s),this.pass.shade.uniforms.fade.value.z=Math.max(i,this.pass.shade.uniforms.fade.value.z-s),this.pass.shade.uniforms.fade.value.w=Math.max(a,this.pass.shade.uniforms.fade.value.w-s)),this.isEnteringCanny?this.pass.flash.solid.uniforms.nextB.value>0&&!this.isScanning&&(this.pass.flash.solid.uniforms.nextR.value-=t,this.pass.flash.solid.uniforms.nextG.value-=t,this.pass.flash.solid.uniforms.nextB.value-=t):this.pass.flash.solid.uniforms.nextB.value<.98&&!this.isScanning&&(this.pass.flash.solid.uniforms.nextR.value+=t,this.pass.flash.solid.uniforms.nextG.value+=t,this.pass.flash.solid.uniforms.nextB.value+=t),this.isLeavingCanny&&(this.pass.shade.uniforms.fade.value.x+=2.5*s,this.pass.shade.uniforms.fade.value.y+=2.5*s,this.pass.shade.uniforms.fade.value.z+=2.5*s,this.pass.shade.uniforms.fade.value.w+=2.5*s),this.composer.edge.render(),this.composer.flash.render(),this.composer.blend.render(),(t>0&&t<.2||performance.now()>this.time+5e3)&&(this.isAnimating=!0),this.fps.end(),this.fpsReady&&!this.isTriggeredLowFPS&&this.lowRes(12,this.fps.count),setTimeout((function(){e.animation=requestAnimationFrame(e.animate.bind(e))}),1e3/30)}}},{key:"smooth",value:function(e,t){var n=this;this.tween||(this.tween=new Ac.a.Tween(e.position).to(t,2*this.faceModule.timeSinceLastFace).easing(Ac.a.Easing.Quadratic.InOut).onComplete((function(){n.tween=null})).start(),this.tween.interpolation(Ac.a.Interpolation.Bezier)),Ac.a.update()}},{key:"snapToFace",value:function(e){var t=e.x,n=e.y,r=e.height,i=t-Wn/2,o=n-.15*r-Hn/2;if(this.base.device.ios&&(i=t-Hn/2,o=n-Wn/2),this.previousFace.x!==t||this.previousFace.y!==n){var a={x:i,y:o};this.smooth(this.cannyPlane,a),this.previousFace=a}}},{key:"lowRes",value:function(e,t){e>=t&&this.prevFPS!==t&&(this.trigger++,this.prevFPS=t,3===this.trigger&&(this.isTriggeredLowFPS=!0,this.base.sendEvent(Mu),this.renderer.domElement.classList.add("low-fps"),this.setSizes(this.isTriggeredLowFPS),this.base.sendEvent(Bu.telemetry,{event:"html5.low_fps",data:{fps:t,threshold:e}})))}},{key:"updatePositions",value:function(e){if(this.isStarted){this.setSizes(e);var t=this.cameraPosition,n=t.left,r=t.right,i=t.top,o=t.bottom,a=t.aspect;if(this.camera.left=n,this.camera.right=r,this.camera.top=i,this.camera.bottom=o,this.camera.aspect=a,this.renderer.setViewport(0,0,this.width,this.height),this.renderer.setPixelRatio(Pu),this.renderer.setSize(this.width,this.height),this.camera.updateProjectionMatrix(),xu/Su<Wn/Hn){var s=this.base.device.ios?Wn/2-this.offset.ios:this.offset.android;this.cannyPlane.position.set(0,(Hn-s)/2,0)}}}},{key:"drawFace",value:function(e){this.hasFoundFace=null!=e,this.hasFoundFace&&(this.lastFoundFace=e)}},{key:"cleanUp",value:function(){this.renderer.renderLists.dispose(),this.cannyTarget.dispose(),this.flashTarget.dispose(),this.scene.dispose(),this.videoTexture.dispose(),this.camera=null,this.uniform=null,this.flash=null,this.shader=null,this.pass=null,this.line=null,this.clock=null,this.face=null,this.cannyPlane=null}},{key:"videoZoom",get:function(){return this.base.device.ios?2*Math.min(this.width/Hn,this.height/Wn):2*Math.min(this.width/Wn,this.height/Hn)}},{key:"cameraPosition",get:function(){var e=this.videoZoom;return{left:innerWidth/-e,right:innerWidth/e,top:innerHeight/e,bottom:innerHeight/-e,aspect:innerWidth/innerHeight}}}]),e}();function Tu(e){return(Tu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Au(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Pu,Lu,Ru={},ku=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.shouldDownScale=!1,this.deepCopyScreen(),this.setScreenMetrics(this.shouldDownScale),this.processDOMEvents(),this.listen()}return function(e,t,n){t&&Au(e.prototype,t)}(e,[{key:"listen",value:function(){var e=this;this.base.listenEvent(Mu,(function(){e.base.console.log("Low FPS detected, lowering resolution by 50%"),e.shouldDownScale=!0,e.setScreenMetrics(e.shouldDownScale)}))}},{key:"processDOMEvents",value:function(){var e=this;window.onresize=function(){e.deepCopyScreen(),e.setScreenMetrics(e.shouldDownScale)}}},{key:"getDPI",value:function(){for(var e=56;e<2e3;++e)if(!0===matchMedia("(max-resolution: ".concat(e,"dpi)")).matches)return e;return 0}},{key:"deepCopyScreen",value:function(){for(var e in this.screen={},screen){var t=screen[e];if("object"===Tu(t))for(var n in this.screen[e]={},t){var r=t[n];"string"!=typeof r&&"number"!=typeof r||(this.screen[e][n]=r)}else"string"!=typeof t&&"number"!=typeof t||(this.screen[e]=t)}}},{key:"setScreenMetrics",value:function(e){if(Pu=window.hasOwnProperty("devicePixelRatio")?window.devicePixelRatio:1,this.base.console.log("Screen pixel ratio: ".concat(Pu)),this.base.device.safari&&!this.base.device.ios||this.base.device.firefox||e)xu=this.screen.width/2,Su=this.screen.height/2;else if(this.base.device.handheld)if(this.base.device.ios)Su=window.innerHeight,xu=window.innerWidth;else{var t=this.screen.height-window.innerHeight;xu=this.screen.width,Su=t>=80&&t<=132&&this.base.device.android?this.screen.height:window.innerHeight}else xu=this.screen.width,Su=this.screen.height;if(Lu=this.getDPI(),void 0===(Ru=this.screen.orientation)&&(Ru={}),void 0!==this.screen.msOrientation)switch(Ru={type:this.screen.msOrientation},this.screen.msOrientation){case"landscape-primary":Ru.angle=0;break;case"landscape-secondary":Ru.angle=180;break;case"portrait-primary":Ru.angle=270;break;case"portrait-secondary":Ru.angle=90;break;default:Ru.angle=-1}else this.base.device.safari&&(Ru={},Su>xu?(Ru.type="portrait",Ru.angle=90):(Ru.type="landscape",Ru.angle=0));this.base.sendEvent(kr.dimensionsUpdated)}}]),e}();function Nu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ou(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nu(Object(n),!0).forEach((function(t){Du(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nu(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Du(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Fu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Iu,Uu,Bu={abort:"Claim.abort",streaming:"Claim.streaming",flashCodeSet:"Claim.flashCodeSet",error:"Claim.error",telemetry:"Claim.telemetry"},ju=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.init(),this.listen()}return function(e,t,n){t&&Fu(e.prototype,t)}(e,[{key:"init",value:function(){this.token=null,this.user_id=void 0,this.display_name=void 0,this.completed=!1,Iu={started:!1,streaming:!1,flashing:!1,invalidated:!1,finished:!1,streamed:!1,code:null}}},{key:"listen",value:function(){var e=this;this.base.listenEvent(kr.enterFullScreen,(function(){Iu.finished=!1,e.completed=!1})),this.base.listenEvent([lf.error,bl.edgeResult],(function(){e.init(),e.completed=!0})),this.base.listenEvent(kr.exitFullScreen,(function(){e.completed||(Iu.streaming&&!Iu.finished?e.error("fullscreen_change",e.base.language.term("error_fullscreen_change")):Iu.finished||e.abort("fullscreen_change",e.base.language.term("error_fullscreen_change")))})),this.base.listenEvent(Zn.noData,(function(t){var n=t.feedback,r=t.reason;e.error(n,r)})),this.base.listenEvent([bl.error,bl.claimAborted,lr.noCamera],(function(t){e.base.console.log("Claim aborted:"+JSON.stringify(t)),e.init()})),this.base.listenEvent(qn.finished,(function(t){Iu.finished=!0,e.stop(t)})),this.base.listenEvent(qn.maxFlashes,(function(){Iu.flashing=!1})),this.base.listenEvent(bl.lastFrame,(function(){Iu.streamed=!0})),this.base.listenEvent(bl.clientStarted,(function(t){e.base.console.log("Client Started called with flash code: ".concat(t.flash_code)),Iu.started=!0,e.setFlashCode(t.flash_code),e.user_id=t.ex_username,e.display_name=t.display_name,e.token=t.token,t.deprecation_warning&&e.base.console.warn("Deprecation notice for ".concat(e.base.version,": ").concat(t.deprecation_warning))})),this.base.listenEvent(h,(function(){return e.stream()})),this.base.listenEvent(kr.start,(function(){Uu=Ou({},e.base.device.setDeviceProperties()),e.base.console.log("Claim Ready, set claim details: ".concat(JSON.stringify(Uu)))}))}},{key:"setFlashCode",value:function(e){if(!e)return this.base.console.warn("Invalid flash code"),void this.error("client_config",this.base.language.term("error_server"));Iu.code=e,this.base.sendEvent(Bu.flashCodeSet,{code:e})}},{key:"stream",value:function(){this.base.console.log("Start streaming claim with token: ".concat(this.token)),Iu.streaming=!0,Iu.flashing=!0,this.base.sendEvent(Bu.streaming,{token:this.token,agent:this.base.device.version,device_key:this.base.device.properties.device_key,rotation:Ru.angle})}},{key:"stop",value:function(e){this.base.console.log("Stopped claim on frame: ".concat(e))}},{key:"abort",value:function(e,t){this.base.console.log("Abort claim called: Feedback: ".concat(e,", Reason: ").concat(t));var n={feedback:e,reason:t};this.base.sendEvent(Bu.abort,Ou({},this.base.details,{},n))}},{key:"error",value:function(e,t){this.base.console.warn("Error claim called: Feedback: ".concat(e,", Reason: ").concat(t));var n={feedback:e,reason:t};this.base.sendEvent(Bu.error,Ou({},this.base.details,{},n))}}]),e}(),zu=n(72),Vu=n.n(zu);function Gu(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.reduce((function(e,t){return e&&e[t]}),e)}function Wu(e){return Gu(e||window,"iProovNativeBridge")}function Hu(e){return Gu(e||window,"webkit","messageHandlers","iProovNativeBridge")}function qu(e){return(qu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xu(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&function(e,t){(Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}(e,t)}function Yu(e){return function(){var t,n=Zu(e);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()){var r=Zu(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return function(e,t){return!t||"object"!==qu(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,t)}}function Zu(e){return(Zu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Ju(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ku(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $u(e,t,n){return t&&Ku(e.prototype,t),n&&Ku(e,n),e}var Qu=function(){function e(t){Ju(this,e);var n=Wu(t),r=Hu(t);if(n)this.facade=new tl(n);else{if(!r)throw new Error("Not in native bridge mode");this.facade=new nl(r)}}return $u(e,[{key:"toProxy",value:function(){var e=this.facade;return new Proxy(this,{get:function(t,n){return e[n]}})}}]),e}(),el=function e(t){Ju(this,e),this.nativeInterface=t},tl=function(e){Xu(n,el);var t=Yu(n);function n(){return Ju(this,n),t.apply(this,arguments)}return $u(n,[{key:"launch",value:function(e,t,n){this.nativeInterface.launch(JSON.stringify({token:e,streaming_url:t,options:n}))}}]),n}(),nl=function(e){Xu(n,el);var t=Yu(n);function n(){return Ju(this,n),t.apply(this,arguments)}return $u(n,[{key:"launch",value:function(e,t,n){this.nativeInterface.postMessage({name:"launch",token:e,streaming_url:t,options:n})}}]),n}();function rl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function il(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function al(e,t,n){return t&&il(e.prototype,t),n&&il(e,n),e}var sl=["connect","disconnect","reconnect","error","connect_error"],cl=["client_start","client_error","edge_status","edge_result_callback"],ll=["client_log","client_telemetry"],hl=function(){function e(t,n){var r=this;rl(this,e),this.base=t,this.io=n,this.isLegacyMode=t.legacy_native_bridge,this.hasStartedProcessing=!1,this.nativeEmitter=new Vu.a,this.isInstalled=t.device.isNativeBridgeInstalled,this.isInstalled?(this.nativeSDKInterface=function(e){return e||(e=window),new Qu(e).toProxy()}(window),this.base.console.log("nativeBridge: listening to events"),["processing","success","failure","cancelled","error"].forEach((function(e){var t="iproov-"+e;r.base.console.log("nativeBridge: binding "+t),window.addEventListener(t,(function(t){var n=t.detail;r.base.console.log("nativeBridge: intercepted "+e),r[e](n)}))}))):this.isLegacyMode&&(this.base.console.log("nativeBridge: created legacy interface"),this.legacyBridge=new fl(this))}return al(e,[{key:"disconnect",value:function(){return this.io.disconnect()}},{key:"on",value:function(e,t){sl.includes(e)?(this.base.console.debug("SocketIO listening: "+e),this.io.on(e,t)):cl.includes(e)?(this.base.console.debug("NativeBridgeIO listening: "+e),this.nativeEmitter.on(e,t)):this.base.console.debug("NativeBridgeIO skipping: "+e)}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=n[0],o=n[1];if(ll.includes(e))return this.io.emit(e,i,o);this.base.console.warn("Emitting unwanted event: "+e),"function"==typeof o&&o()}},{key:"launch",value:function(e,t,n){this.base.console.debug("Launching SDK..."),this.nativeSDKInterface.launch(e,t,n)}},{key:"processing",value:function(e){var t=e.progress,n=e.message;this.hasStartedProcessing||(this.base.console.debug("nativeBridge: emitting claimed as processing has started"),this.hasStartedProcessing=!0,this.base.sendEvent(bl.claimed)),this.nativeEmitter.emit("edge_status",{progress:100*t,message:n})}},{key:"success",value:function(e){var t=e.token;this.nativeEmitter.emit("edge_result_callback",{result:"Passed",token:t})}},{key:"failure",value:function(e){e.reason;var t=e.feedbackCode;this.nativeEmitter.emit("edge_result_callback",{result:"Failed",feedback_code:t})}},{key:"cancelled",value:function(){var e="error_exited_native_bridge";this.base.sendEvent(bl.invalidated,{feedback:e,reason:this.base.language.term(e)})}},{key:"error",value:function(e){var t=e.error;this.nativeEmitter.emit("error",{error:t})}}]),e}(),fl=function(){function e(t){rl(this,e),this.nbio=t}return al(e,[{key:"start",value:function(){}},{key:"processing",value:function(e,t){this.nbio.processing({progress:e,message:t})}},{key:"success",value:function(e){this.nbio.success({token:e})}},{key:"failure",value:function(e,t){this.nbio.failure({reason:e,feedbackCode:t})}},{key:"error",value:function(e){this.nbio.error({error:e})}},{key:"cancelled",value:function(){this.nbio.cancelled()}}]),e}();function pl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ml(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pl(Object(n),!0).forEach((function(t){vl(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function gl(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function yl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var bl={edgeResult:"Socket.edgeResult",invalid:"Socket.invalid",claimed:"Socket.claimed",invalidated:"Socket.invalidated",error:"Socket.error",lastFrame:"Socket.lastFrame",claimAborted:"Socket.claimAborted",clientStarted:"Socket.clientStarted",edgeStatus:"Socket.edgeStatus",sendLog:"Socket.sendLog"},_l=function(){function e(t,n,r){var i=r.isKioskMode,o=r.isNativeBridge;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.camera=n,this.isKioskMode=i,this.isNativeBridge=o,this.hasSetup=!1,this.hasStarted=!1,this.mediaStreaming=!1,this.aborted=!1,this.queue=[],this.encoded=20;var a={};a.promise=new Promise((function(e,t){a.resolve=e,a.reject=t})),this.sioDeferred=a,this.listen()}return function(e,t,n){t&&yl(e.prototype,t)}(e,[{key:"listen",value:function(){var e=this;this.base.listenEvent(lr.mediaStreaming,(function(){return e.mediaStreaming=!0})),this.base.listenEvent(kr.start,(function(){e.setup(),e.mediaStreaming?e.clientStart():e.base.listenEvent(lr.mediaStreaming,(function(){return e.clientStart()}))})),this.base.listenEvent(bl.sendLog,(function(t){try{if(e.io&&e.io.connected){if(e.queue.length>0)for(var n=0;n<e.queue.length;n++)e.io.emit("client_log",e.queue.shift());e.io.emit("client_log",t)}else e.queue.push(t)}catch(n){e.queue.push(t)}})),this.base.listenEvent(Bu.telemetry,(function(t){var n=t.event,r=t.data;e.base.console.log("client_telemetry "+n+" "+JSON.stringify(r)),e.io.emit("client_telemetry",{event:n,data:r})})),this.base.listenEvent(Bu.error,(function(t){e.hasStarted&&(e.aborted=!0,e.details=t,e.io.emit("client_abort",t,(function(t){t.hasOwnProperty("error")?e.base.console.log("Claim aborted with error",t):e.base.console.log("Claim aborted",t)})))})),this.base.listenEvent(In,(function(t){e.io.emit("client_video",t,(function(t){e.base.console.log("Sent WASM frame: ".concat(t));var n=e.encoded;e.base.sendEvent(Un,{progress:n,message:e.statusMessage({progress:n})}),e.encoded++}))}))}},{key:"setup",value:function(){this.base.token?this.hasSetup||(this.createIO(),this.hasSetup=!0):this.base.sendEvent(bl.claimAborted,{type:"user_timeout",details:this.base.language.term("error_user_timeout")})}},{key:"createIO",value:function(){var e=this.base,t=e.token,n=e.path,r=new o.a("wss://".concat(this.base.domain,"/").concat(t),{path:n,query:"token=".concat(t),transports:["websocket"],upgrade:!1,forceNew:!0});this.isNativeBridge?this.io=new hl(this.base,r):this.io=r,this.processIOEvents()}},{key:"clientStart",value:function(){var e=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){gl(o,r,i,a,s,"next",e)}function s(e){gl(o,r,i,a,s,"throw",e)}a(void 0)}))}}(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hasStarted){e.next=2;break}return e.abrupt("return");case 2:return this.hasStarted=!0,e.next=5,this.sioDeferred.promise;case 5:t=ml({},Uu,{},{id:this.io.id,dpi:Lu,details:Ru.type,rotation:Ru.angle,name:this.camera.name,kiosk_mode:this.isKioskMode}),this.io.emit("client_start",t,(function(e){var t=e.type,r=e.error;if(n.type=t,r){n.base.console.log("Client start error: ".concat(r)),n.aborted=!0,"Token already claimed"===e.error_description&&(e.error_description=n.base.language.term("error_user_timeout"));var i={reason:e.error_description,feedback:"client_api"};"sdk_unsupported"===e.error&&(i.feedback=e.error),n.base.sendEvent(bl.error,i)}else n.base.console.log("Client start callback",e),n.base.sendEvent(bl.clientStarted,e)}));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"processIOEvents",value:function(){var e=this;this.io.on("connect",(function(){e.base.console.log("Connected to SocketIO: ".concat(e.base.token)),e.sioDeferred.resolve(),e.connected=!0})),this.io.on("disconnect",(function(){e.base.console.log("Disconnected from SocketIO"),e.connected=!1})),this.io.on("reconnect",(function(){e.base.console.log("Reconnected to SocketIO: ".concat(e.base.token)),e.connected=!0})),this.io.on("error",(function(t){e.base.console.log("Socket error: ".concat(t)),e.connected=!1,e.base.sendEvent(bl.error,{feedback:"Invalid namespace"===t?"invalid_token":"client_error",reason:e.base.language.term("Invalid namespace"===t?"failure_user_timeout":"error_server")})})),this.io.on("connect_error",(function(t){e.base.console.log("Socket connect error: ".concat(t)),e.sioDeferred.reject(),e.base.sendEvent(bl.error,{feedback:"error_server",reason:e.base.language.term("error_server")}),e.connected=!1})),this.io.on("edge_result_callback",(function(t,n){if(e.base.console.log("Edge result:",t),!e.aborted){var r="Passed"===t.result,i={heading:e.base.language.term(r?"passed":"failed"),feedback:r?"passed":t.feedback_code,reason:e.base.language.term(r?"iproov_success":"failure_".concat(t.feedback_code)),type:e.base.isNativeBridge?null:e.type,passed:r};e.base.sendEvent(bl.edgeResult,i),n&&(i.received=(new Date).getTime(),n(i)),e.base.console.log("Edge result, disconnecting from Socket.io"),e.io.disconnect()}})),this.io.on("edge_token_claimed",(function(t){e.base.console.log("edge_token_claimed: ".concat(t)),e.base.sendEvent(bl.claimed,t)})),this.io.on("edge_status",(function(t){e.base.console.log("Edge status",t,e.aborted),e.camera&&!e.camera.frame.final&&e.base.sendEvent(bl.lastFrame,e.base.language.term("progress_loading")),e.aborted||(t.message=e.statusMessage(t),e.base.console.log("Sending edgeStatus",t),e.base.sendEvent(bl.edgeStatus,t))})),this.io.on("edge_invalidate",(function(t){var n=t.reason;e.base.console.log("Claim invalidated: ".concat(n)),"Token already claimed"===n&&(n="Session expired, please try again"),e.base.sendEvent(bl.error,{feedback:"error_server",reason:n})}))}},{key:"statusMessage",value:function(e){var t=e.progress,n=e.message;if(this.isNativeBridge)return n;var r="enrol"===this.type;switch(!0){case t<50:return this.base.language.term("progress_streaming");case t<=60:return this.base.language.term(r?"progress_finding_face":"progress_identifying_face");case t<=75:return this.base.language.term(r?"progress_creating_identity":"progress_confirming_identity");case t<=90:return this.base.language.term("progress_assessing_genuine_presence");case t<=100:return this.base.language.term("progress_loading");default:this.base.console.warn("unknown progress value")}}}]),e}();function wl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var td=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.emitter=new Vu.a,this.emitter.setMaxListeners(12),this.listening=[],this.listen(bl.edgeResult,this.wipeEvents.bind(this))}return function(e,t,n){t&&wl(e.prototype,t)}(e,[{key:"wipeEvents",value:function(){var e=this;this.listening.map((function(t){return e.emitter.removeAllListeners(t)})),this.listening=null}},{key:"emit",value:function(e,t){this.emitter.emit(e,t)}},{key:"listen",value:function(e,t){var n=this,r=function(e,t){n.isListening(e,t)||(n.emitter.on(e,t),n.listening.push(e))};Array.isArray(e)?e.forEach((function(e){return r(e,t)})):r(e,t)}},{key:"isListening",value:function(e,t){return this.emitter.rawListeners(e).filter((function(e){return t.toString()==e.toString()})).length>0}}]),e}();function xl(e){return(xl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var El=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.container=t,this.elements=[]}return function(e,t,n){t&&Sl(e.prototype,t)}(e,[{key:"getElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container;if(!this.elements.includes(e)){var n=t.querySelector(e);return n&&this.elements.push(n),n}return this.elements[e]}},{key:"setAttributes",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if("object"!==xl(e))throw new Error("Invalid element passed to set attributtes!");for(var n in t)e.setAttribute(n,t[n])}},{key:"getAdaptiveElement",value:function(e){var t;if("string"==typeof e)t=this.getElement(e);else{if("object"!==xl(e))throw new Error("Invalid element passed!");t=e}return t}},{key:"showElement",value:function(e){this.getAdaptiveElement(e).style.display="block"}},{key:"hideElement",value:function(e){this.getAdaptiveElement(e).style.display="none"}},{key:"createElement",value:function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return document.getElementById(t)||(r=document.createElement(e),i.id=t,this.setAttributes(r,i),(n?this.getAdaptiveElement(n):this.container).appendChild(r),this.elements.push(r)),r}},{key:"deleteElement",value:function(e){this.elements=this.elements.filter((function(t){return t!==e})),e.remove()}}]),e}(),Ml=n(174),Cl=n.n(Ml);function Tl(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Al(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pl(e,t){return(Pl=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ll(e){return(Ll=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Rl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function kl(e,t,n){return t&&dd(e.prototype,t),n&&dd(e,n),e}function Nl(e){return(Nl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ol(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function Dl(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Ol(o,r,i,a,s,"next",e)}function s(e){Ol(o,r,i,a,s,"throw",e)}a(void 0)}))}}function Fl(){return(Fl=Dl(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Wu()||Hu(),e.abrupt("return",!!t);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Il(){return navigator.vendor&&navigator.vendor.indexOf("Apple")>-1&&navigator.userAgent&&-1==navigator.userAgent.indexOf("CriOS")&&-1==navigator.userAgent.indexOf("FxiOS")}function Ul(e){try{if("object"===("undefined"==typeof WebAssembly?"undefined":Nl(WebAssembly))&&"function"==typeof WebAssembly.instantiate){var t=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(t instanceof WebAssembly.Module)return new WebAssembly.Instance(t)instanceof WebAssembly.Instance}}catch(e){}return!1}function Bl(e){return window.isSecureContext&&navigator.mediaDevices&&"getUserMedia"in navigator.mediaDevices}function jl(e){return window.isSecureContext&&"MediaStreamTrack"in window}function zl(e){return!!window.isSecureContext&&(Il()&&zl.checks>1?(e.logger.warn("Safari detected. Using last check to avoid subsequent checks returning no devices."),zl.checks[0]):new Promise(function(){var t=Dl(regeneratorRuntime.mark((function t(n,r){var i,o,a,s,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=function(e){return zl.checks.push(e),n(e)},t.prev=1,t.next=4,navigator.mediaDevices.enumerateDevices();case 4:o=t.sent,t.next=10;break;case 7:return t.prev=7,t.t0=t.catch(1),t.abrupt("return",i(!1));case 10:if(a=o.filter((function(e){return"videoinput"===e.kind})),!(s=Array.from(new Set(a.filter((function(e){return""!==e.label}))))).length){t.next=16;break}return e.logger.debug("Devices with labels exist, user tests granted full permission:",s),e.tests.frontCamera=!0,t.abrupt("return",i(!0));case 16:if(0!==(c=Array.from(new Set(a.map((function(e){return e.groupId}))))).length){t.next=20;break}return e.logger.warn("No video inputs identified"),t.abrupt("return",i(!1));case 20:return""===c[0]?e.logger.debug("Video inputs found with groups omitted for privacy"):e.logger.debug("Video groups found: "+c.join(", "),o),t.abrupt("return",i(!0));case 22:case"end":return t.stop()}}),t,null,[[1,7]])})));return function(e,n){return t.apply(this,arguments)}}()))}function Vl(e,t){return Gl.apply(this,arguments)}function Gl(){return(Gl=Dl(regeneratorRuntime.mark((function e(t,n){var r,i=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=i.length>2&&void 0!==i[2]?i[2]:5e3,e.abrupt("return",new Promise((function(e,i){t.logger.debug("Waiting for prompt: "+r);var o=setTimeout((function(){t.logger.warn("Prompt timeout, could be user, could be browser block"),e(null)}),r);n.onchange=function(t){clearTimeout(o),e("granted"===t.target.state)}})));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Wl(e){return Hl.apply(this,arguments)}function Hl(){return(Hl=Dl(regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("permissions"in navigator)){e.next=22;break}return n=null,e.prev=2,e.next=5,navigator.permissions.query({name:"camera"});case 5:if("granted"!==(n=e.sent).state){e.next=10;break}return e.abrupt("return",!0);case 10:if("denied"!==n.state){e.next=12;break}return e.abrupt("return",!1);case 12:return e.next=14,Vl(t,n,5e3);case 14:if(null===(r=e.sent)){e.next=17;break}return e.abrupt("return",r);case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(2),t.logger.debug("Permission descriptor probably not supported: "+e.t0.message);case 22:return e.abrupt("return",new Promise(function(){var e=Dl(regeneratorRuntime.mark((function e(n,r){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"user"}});case 3:i=e.sent,t.logger.debug("Got a track with: "+i.getVideoTracks()[0].label),i.getVideoTracks()[0].stop(),n(!0),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),t.logger.error("Problem testing front camera",e.t0),n(!1);case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}()));case 23:case"end":return e.stop()}}),e,null,[[2,19]])})))).apply(this,arguments)}function ql(e){return document.fullscreenEnabled}zl.checks=[];var Xl=["wasm","userMedia","mediaStreamTrack"];Il()||Xl.unshift("videoInput");var Yl=["frontCamera"],Zl="granted",Jl=function(){function e(){Rl(this,e),this.listeners=[]}return kl(e,[{key:"hasEventListener",value:function(e,t){return this.listeners.some((function(n){return n.type===e&&n.listener===t}))}},{key:"addEventListener",value:function(e,t){return this.hasEventListener(e,t)||this.listeners.push({type:e,listener:t,options:{once:!1}}),this}},{key:"removeEventListener",value:function(e,t){var n=this.listeners.findIndex((function(n){return n.type===e&&n.listener===t}));return n>=0&&this.listeners.splice(n,1),this}},{key:"removeEventListeners",value:function(){return this.listeners=[],this}},{key:"dispatchEvent",value:function(e){var t=this;return this.listeners.filter((function(t){return t.type===e.type})).forEach((function(n){var r=n.type,i=n.listener,o=n.options.once;i.call(t,e),!0===o&&t.removeEventListener(r,i)})),this}}]),e}(),Kl={legacyNativeBridge:!1},$l=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pl(e,t)}(n,Jl);var t=function(e){return function(){var t,n=Ll(e);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()){var r=Ll(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return function(e,t){return!t||"object"!==Nl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,t)}}(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Rl(this,n),(r=t.call(this)).logger=e||console,r.options=Object.assign({},Kl,i),r.isNativeBridge=void 0,r.isNativeBridgeInstalled=void 0,r.tests={videoInput:null,wasm:null,userMedia:null,mediaStreamTrack:null,frontCamera:null,fullScreen:null,webgl:null},r.testSupport={videoInput:zl,wasm:Ul,userMedia:Bl,mediaStreamTrack:jl,frontCamera:Wl,fullScreen:ql},r.detectNativeBridge(),r}return kl(n,[{key:"detectNativeBridge",value:function(){var e=this;return this._detectNativeBridge||(this._detectNativeBridge=function(){return Fl.apply(this,arguments)}({logger:this.logger}).then((function(t){e.logger.debug("Native bridge is installed:",t),e.isNativeBridgeInstalled=t,e.isNativeBridge=!(!t&&!e.options.legacyNativeBridge),e.options.legacyNativeBridge&&e.isNativeBridge&&e.logger.warn("Native bridge: enabled because deprecated legacyNativeBridge was set")})).catch((function(t){e.isNativeBridgeInstalled=!1,e.isNativeBridge=!1,e.logger.error("There was an error: "+t.message,t)}))),this._detectNativeBridge}},{key:"wrapTest",value:function(){var e=Dl(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===this.tests[t]){e.next=4;break}return n=this.tests[t],this.logger.debug("Precomputed test "+t+": "+n),e.abrupt("return",n);case 4:return e.next=6,this.testSupport[t](this);case 6:return n=e.sent,this.tests[t]=n,this.logger.debug("Test result for "+t+": "+n),e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"checkWithPermission",value:function(){var e=Dl(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.detectNativeBridge();case 2:return e.next=4,this.check({emit:!1});case 4:return this.logger.log("Checking permission:",Yl),e.next=7,Promise.all(Yl.map(this.wrapTest.bind(this)));case 7:return this.isPermissionGranted?this.emitPayload(Zl):this.emitPayload("denied"),this.emitCheckResult(),e.abrupt("return",{supported:this.isDeviceSupported,granted:this.isPermissionGranted,is_native_bridge:this.isNativeBridge});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"check",value:function(){var e=Dl(regeneratorRuntime.mark((function e(){var t,n=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{emit:!0},e.next=3,this.detectNativeBridge();case 3:return this.logger.debug("Checking support: ".concat(Xl.join(", "))),e.next=6,Promise.all(Xl.map(this.wrapTest.bind(this)));case 6:return t.emit&&this.emitCheckResult(),e.abrupt("return",{supported:this.isDeviceSupported,granted:this.isPermissionGranted,is_native_bridge:this.isNativeBridge,is_native_bridge_installed:this.isNativeBridgeInstalled});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"emitPayload",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.dispatchEvent(new CustomEvent(e,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Tl(Object(n),!0).forEach((function(t){Al(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Tl(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t,{tests:this.tests,is_native_bridge:this.isNativeBridge,is_native_bridge_installed:this.isNativeBridgeInstalled})))}},{key:"emitCheckResult",value:function(){this.emitPayload("check",{supported:this.isDeviceSupported,granted:this.hasCheckedPermissions?this.isPermissionGranted:null}),this.isDeviceSupported||this.emitPayload("unsupported",{supported:this.isDeviceSupported}),this.isPermissionGranted&&this.emitPayload(Zl)}},{key:"isDeviceSupported",get:function(){var e=this;return this.isNativeBridge||Xl.every((function(t){return!0===e.tests[t]}))}},{key:"isPermissionGranted",get:function(){var e=this;return this.isNativeBridge||Yl.every((function(t){return!0===e.tests[t]}))}},{key:"hasCheckedPermissions",get:function(){var e=this;return Yl.every((function(t){return null!==e.tests[t]}))}}]),n}();function Ql(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function eh(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ql(Object(n),!0).forEach((function(t){nh(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ql(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function nh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rh(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function ih(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var oh,ah=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.properties={},this.support=new $l(t.console,{legacyNativeBridge:t.legacy_native_bridge}),this.setDeviceDetails(),this.setLanguage(),this.supportCheck=xh(),this.checkDeviceSupport().then((function(e){var t=e.supported;n.supportCheck.resolve({isNativeBridge:n.isNativeBridge,supported:t}),t&&(n.token=n.base.token,n.setStorage(),n.setDeviceId(),n.setCodec())}))}return function(e,t,n){t&&ih(e.prototype,t)}(e,[{key:"isLandscape",value:function(){return window.innerWidth>window.innerHeight}},{key:"setDeviceDetails",value:function(){this.detector=Cl()(window.navigator.userAgent);var e=this.detector.browser,t=e.name,n=e.version;if(this.version=parseFloat(n),this.chrome=t.match(/Chrome/),this.firefox=t.match(/Firefox/),this.safari=t.match(/Safari/),this.samsung=t.match(/Samsung/),this.edge=t.match(/Edge/),this.edgeLegacy=this.edge&&this.version<19,this.opera=t.match(/Opera/),this.tablet="tablet"===this.detector.device.type,this.mobile="mobile"===this.detector.device.type,this.handheld=this.mobile||this.tablet,this.desktop=!this.handheld,this.android="Android"===this.detector.os.name,this.ios="iOS"===this.detector.os.name,this.webview="Chrome WebView"===t||"WebKit"===t,this.iphone=!!this.detector.device.model&&this.detector.device.model.match(/iPhone/),this.ipod=!!this.detector.device.model&&this.detector.device.model.match(/iPod/),this.ipad=!!this.detector.device.model&&this.detector.device.model.match(/iPad/),this.model=this.getModel(),!this.handheld){var r=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.appVersion)[1],10)&&0===navigator.vendor.indexOf("Google");!this.android&&r&&0===navigator.platform.indexOf("Linux a")&&"ontouchstart"in document.documentElement&&(this.base.console.log("Desktop mode on Chrome detected, forcing mobile and android to true"),this.android=!0,this.mobile=!0,this.handheld=!0)}}},{key:"setLanguage",value:function(){var e=window.navigator.userLanguage||window.navigator.language;switch(e){case"en-GB":case"en-US":this.language="en";break;default:this.language=e}}},{key:"checkDeviceSupport",value:function(){var e=function(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){rh(o,r,i,a,s,"next",e)}function s(e){rh(o,r,i,a,s,"throw",e)}a(void 0)}))}}(regeneratorRuntime.mark((function e(){var t,n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.support.check({emit:!1});case 2:return t=e.sent,n=t.supported,r=t.is_native_bridge,i=t.is_native_bridge_installed,this.supported=n,this.isNativeBridge=r,this.isNativeBridgeInstalled=i,e.abrupt("return",{supported:n,is_native_bridge:r,is_native_bridge_installed:i});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setStorage",value:function(){this.storage={};try{Object.assign(this.storage,JSON.parse(localStorage.getItem("iProov")))}catch(e){this.base.console.log("Corrupt local storage entry, resetting");try{localStorage.removeItem("iProov")}catch(e){this.base.console.warn("Error setting local storage",e)}}}},{key:"setDeviceId",value:function(){if(this.storage.hasOwnProperty("device_id"))this.base.console.debug("Using existing device_id: ".concat(this.storage.device_id)),this.properties.device_id=this.storage.device_id;else{var e=this.base.generateUUID();this.properties.device_id=e,this.base.console.debug("Generated new device ID: ".concat(e)),this.setStorageData({device_id:e})}}},{key:"setCodec",value:function(){this.edgeLegacy||this.safari||this.ios?(oh="h264",this.properties.sdp_encoding="H264/90000",this.properties.sdp_packet_type=this.ios&&this.version<12.1?"98":"96",this.properties.sdp_packetization_mode="1"):(oh="vp9",this.properties.sdp_encoding="VP9/90000",this.properties.sdp_packet_type="98",this.properties.sdp_packetization_mode="0"),this.properties.codec=oh}},{key:"setDeviceProperties",value:function(){return this.properties=eh({},{app_version:this.base.version,sdk_version:this.base.version,version:this.detector.browser.version,supported_codecs:["vp9","h264"],platform:"HTML5",transport:"WASM",width:xu,height:Su,model:this.model,manufacturer:this.detector.device.vendor?this.detector.device.vendor:"Unknown",type:this.detector.device.type?this.detector.device.type:"Unknown",os:this.detector.os.name?this.detector.os.name:"Unknown",identifier:this.detector.engine.name?this.detector.engine.name:"Unknown",details:Ru.type,rotation:Ru.angle,dpi:Lu,language:navigator.languages&&navigator.languages[0]||navigator.language||navigator.userLanguage,camera_width:this.ios?Hn:Wn,camera_height:this.ios?Wn:Hn,name:fr,variant:this.handheld?"mobile":"desktop"},{},this.properties),this.properties}},{key:"setStorageData",value:function(e){try{var t=JSON.stringify(eh({},this.storage,{},e));this.base.console.debug("Device set storage data ".concat(t)),localStorage.setItem("iProov",t)}catch(e){this.base.console.error("Device localStorage: ".concat(e.message))}}},{key:"getModel",value:function(){return"Mac OS"===this.detector.os.name&&navigator.maxTouchPoints>1?(this.mobile=!0,this.ios=!0,this.tablet=!0,this.ipad=!0,this.handheld=!0,"iPad"):this.iphone?window.screen.height<=736?"iPhone 8 (or older)":"iPhone X (or newer)":this.detector.device.model||"Unknown"}}]),e}();function sh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ch(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var lh=["en"],hh=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.logger=n,this.languages=this.build(lh),this.terms=this.setTerms(t)}return function(e,t,n){t&&uh(e.prototype,t)}(e,[{key:"build",value:function(e){var t=[];return e.forEach((function(e){t[e]=n(411)("./iproov-".concat(e,".json"))})),t}},{key:"setTerms",value:function(e){var t=e;if("string"==typeof e&&!(t=JSON.parse(e)))throw new Error("iProov: Language terms not valid JSON!");return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sh(Object(n),!0).forEach((function(t){ch(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.languages.en,{},t)}},{key:"term",value:function(e){return e in this.terms==0?(this.logger.warn('Unable to load "'.concat(e,'" from language file!')),e):this.terms[e]}}]),e}();function fh(e){return null!==e&&e}function dh(e){return"true"===e||"True"===e||"1"===e||!0===e}function ph(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mh(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var gh={config:{show_countdown:!1,allow_landscape:!0,kiosk_mode:!1}},yh=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config={},this.device=t,Object.assign(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ph(Object(n),!0).forEach((function(t){mh(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ph(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},gh,{},n)),this.validate(),this.stripNull(this.config.colours),this.booleanValues(),this.overrides()}return function(e,t,n){t&&vh(e.prototype,t)}(e,[{key:"validate",value:function(){var e=this;["start_button","grant_button","token","dom"].forEach((function(t){if(!e.config.hasOwnProperty(t))throw new Error("".concat(t," is missing from config!"))})),["token","logo","title"].forEach((function(e){if(e&&"string"!=typeof e)throw new Error("".concat(e," must of type string!"))}))}},{key:"overrides",value:function(){this.config.kiosk_mode=!this.device.mobile&&this.config.kiosk_mode,this.config.allow_landscape=this.allowLandscape(this.config.allow_landscape)}},{key:"allowLandscape",value:function(e){return!!(!this.device.handheld||this.device.tablet&&this.device.android)&&(null===e?gh.config.allow_landscape:e)}},{key:"booleanValues",value:function(){var e=this;["show_countdown","kiosk_mode"].forEach((function(t){e.config[t]=dh(e.config[t])}))}},{key:"stripNull",value:function(e){return Object.keys(e).forEach((function(t){return null==e[t]&&delete e[t]}))}}]),e}();function rp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var bh=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canVibrate=void 0!==navigator.vibrate&&!t.device.firefox}return function(e,t,n){t&&rp(e.prototype,t)}(e,[{key:"run",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;this.canVibrate&&navigator.vibrate([e])}}]),e}();function _h(e){return(_h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xh(){var e={},t=new Promise((function(t,n){e.resolve=t,e.reject=n}));return e.promise=t,e}var Sh=function(){function e(t){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.version="2.2.1",this.console=new Ar(this),this.emitter=new td,this.legacy_native_bridge=t.config.legacy_native_bridge,this.legacy_native_bridge&&this.console.warn("legacy_native_bridge mode is deprecated and will be removed in an upcoming version."),this.device=new ah(this),this.settings=new yh(this.device,t),this.dom=new El(this.settings.config.dom),this.vibrate=new bh(this),this.shadow=this.dom.container.shadowRoot,this.token=this.settings.config.token,this.container=this.dom.container,this.appWrapper=this.container.shadowRoot.getElementById("iproov-wrapper"),this.app=this.dom.createElement("div","iproov-app",this.appWrapper),this.language=new hh(this.settings.config.language,this.console),this.details={token:this.token},this.native_sdk_options=null,this.settings.config.native_sdk_options)try{this.native_sdk_options=JSON.parse(window.atob(this.settings.config.native_sdk_options))}catch(e){throw this.console.error("native_sdk_options contains invalid JSON. Please pass these as base64-encoded JSON."),e}this.setAssetsURL(this.settings.config.assets_url),this.baseUrl(this.settings.config.base_url)}return function(e,t,n){t&&wh(e.prototype,t)}(e,[{key:"setAssetsURL",value:function(e){e||(this.settings.config.assets_url="https://cdn.iproov.app/assets"),this.console.debug("Set assets_url to: "+this.settings.config.assets_url)}},{key:"baseUrl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";if(this.path="/socket.io/v2/",e){var t=new URL(e);this.domain=t.host,"/"!==t.pathname&&(this.path=t.pathname.endsWith("/")?t.pathname:t.pathname+"/"),this.base_url=new URL(this.path,e)}else this.domain="".concat("eu.rp",".secure.iproov.me"),this.base_url=new URL(this.path,"https://"+this.domain)}},{key:"createAssetURL",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.settings.config.assets_url+e}},{key:"sendEvent",value:function(e,t){this.emitter.emit(e,t)}},{key:"listenEvent",value:function(e,t){this.emitter.listen(e,t)}},{key:"titleCase",value:function(e){return e.replace(/(^|\s)\S/g,(function(e){return e.toUpperCase()}))}},{key:"generateUUID",value:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}},{key:"extractFromFactors",value:function(e){var t=this;if("object"!==_h(e))return e;for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(r.length?r:Object.keys(e)).reduce((function(n,r){return Object.assign(n,function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},function(e){return e.replace(/([-_][a-z])/gi,(function(e){return e.toUpperCase().replace("-","").replace("_","")}))}(r),t.extractFromFactors(e[r])))}),{})}}]),e}(),Eh=function e(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4?arguments[4]:void 0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.video=n,this.canvas=new Cu(this.base,this.video,r,i,o)},Mh=n(175),Ch=n.n(Mh);function Th(e){return(Th="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ah(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ph(e,t){return(Ph=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lh(e){return(Lh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Rh=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ph(e,t)}(n,Sr);var t=function(e){return function(){var t,n=Lh(e);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()){var r=Lh(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return function(e,t){return!t||"object"!==Th(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,t)}}(n);function n(e,r,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e,288,480,r,i,o)).landscape=.6>xu/Su,a.listen(),a.inject(Ch.a),a}return function(e,t,n){t&&Ah(e.prototype,t)}(n,[{key:"listen",value:function(){var e=this;this.base.listenEvent(wr,(function(){e.svgContainer=e.base.app.querySelector("svg"),e.bar=e.svgContainer.getElementById("svg-bar"),e.exit=e.svgContainer.getElementById("svg-exit"),e.info=e.svgContainer.getElementById("svg-info-text"),e.statusContainer=e.svgContainer.getElementById("svg-status"),e.status=e.svgContainer.getElementById("svg-status-text"),e.panel=e.svgContainer.getElementById("svg-panel"),e.topBar=e.svgContainer.getElementById("svg-top"),e.oval=e.svgContainer.getElementById("svg-oval"),e.frame=e.svgContainer.getElementById("svg-frame"),e.progress=e.svgContainer.getElementById("svg-progress"),e.mask=e.svgContainer.getElementById("svg-mask"),e.shouldShowCountdown&&(e.progress.style.display="none",e.numberOne=e.svgContainer.getElementById("svg-start-1"),e.numberTwo=e.svgContainer.getElementById("svg-start-2"),e.numberThree=e.svgContainer.getElementById("svg-start-3")),e.logo=e.svgContainer.getElementById("svg-logo"),e.setCustomLogo(e.customLogo),e.setTextArea(e.info,e.base.language.term("prompt_connecting")),e.setTextArea(e.status,e.base.language.term("prompt_loading")),e.initialColours(),e.base.sendEvent(xr,{exit:e.exit}),e.resize()})),this.base.listenEvent(Qt,(function(){e.animate("shake")})),this.base.listenEvent(Bu.flashCodeSet,(function(t){var n=Math.abs(e.panel.getAttribute("width")/t.code.length);e.chunk=1.2*n})),this.base.listenEvent(Kt,(function(t){e.faceFeedback(t)})),this.base.listenEvent([kr.dimensionsUpdated,lr.granted],(function(){e.resize()})),this.base.listenEvent(kr.exitFullScreen,(function(){e.reset(),e.toggleUI("visible"),e.changeColour(e.colours.loading_tint_color)})),this.base.listenEvent(kr.start,(function(){e.start()})),this.base.listenEvent(bl.lastFrame,(function(){e.setTextArea(e.status,e.base.language.term("progress_loading"))})),this.base.listenEvent(bl.clientStarted,(function(t){e.socketConnected=!0,e.setCustomTitle(e.title,t),e.updateInfo()})),this.base.listenEvent(Bu.abort,(function(){e.removeClickToStart(),e.removeSpaceHandler()})),this.shouldShowCountdown||this.base.listenEvent(qn.flash,(function(t){var n=t.flash;e.flashed=n,n%3==2&&e.loading(e.getProgress())}))}},{key:"resize",value:function(){var e=this;this.delay&&clearTimeout(this.delay),this.delay=setTimeout((function(){e.repositionSVG(),e.delay=null}),100)}},{key:"start",value:function(){this.base.sendEvent(lf.feedback,{key:"prompt_hold_still",message:this.base.language.term("prompt_hold_still")}),this.fadeIn()}},{key:"repositionSVG",value:function(){this.setBasePositions(),this.setTopBar(),this.setBottomBar(),this.setTextAreasSize(),this.setMaskSize()}},{key:"faceFeedback",value:function(e){e!==this.feedback&&"function"==typeof this[e]&&(this.shouldShowCountdown||"foundFace"!==e&&(this.removeClickToStart(),this.removeSpaceHandler(),this.timer&&(this.loading(1),clearTimeout(this.timer),this.base.sendEvent(u))),this.reset(),this.setTextArea(this.status,tn[e]),this[e](),this.feedback=e)}},{key:"animate",value:function(e){var t=this;this.base.console.log("animating status message with animation: ".concat(e)),this.statusContainer.setAttribute("class","animated ".concat(e," fast")),this.statusContainer.addEventListener("animationend",(function(){t.statusContainer.setAttribute("class","")}))}},{key:"setBasePositions",value:function(){this.top=this.positionTop(0),this.left=this.positionLeft(0),this.right=this.positionRight(0),this.bottom=this.positionBottom(0)}},{key:"setMaskSize",value:function(){var e,t=this.mask.getAttribute("d");e=this.landscape?"M0,".concat(this.top," L").concat(this.width,",").concat(this.top," L").concat(this.width,",").concat(this.bottom," L0,").concat(this.bottom," L0,").concat(this.top," ").concat(t.substring(t.indexOf("Z"))):"M".concat(this.left,",0 L").concat(this.right,",0 L").concat(this.right,",").concat(this.height," L").concat(this.left,",").concat(this.height," L").concat(this.left,",0 ").concat(t.substring(t.indexOf("Z"))),this.mask.setAttribute("d",e)}},{key:"setTopBar",value:function(){this.landscape?(this.base.dom.setAttributes(this.bar,{x:0,y:this.top,width:this.right+this.left,height:40}),this.exit.setAttribute("transform","translate(".concat(this.width-50,", ").concat(this.top,")")),this.logo.setAttribute("transform","translate(4, ".concat(this.positionTop(2),")")),this.info.setAttribute("y",25)):(this.base.dom.setAttributes(this.bar,{x:this.left,y:0,width:this.right-this.left,height:40}),this.exit.setAttribute("transform","translate(".concat(this.positionRight(50),", 0)")),this.logo.setAttribute("transform","translate(".concat(this.positionLeft(10),", ").concat(6,")")),this.info.setAttribute("y",25))}},{key:"setBottomBar",value:function(){this.landscape?(this.status.setAttribute("y",this.positionBottom(this.height)+25),this.base.dom.setAttributes(this.panel,{x:0,y:this.positionBottom(this.height),width:this.width,height:40}),this.shouldShowCountdown||this.base.dom.setAttributes(this.progress,{x:0,y:this.positionBottom(this.height),height:40})):(this.status.setAttribute("y",25),this.base.dom.setAttributes(this.panel,{x:this.left,y:0,width:this.right-this.left,height:40}),this.shouldShowCountdown||this.base.dom.setAttributes(this.progress,{x:this.left,y:0,height:40}))}},{key:"toggleUI",value:function(e){this.base.console.log("Toggle UI: ".concat(e)),this.frame.style.visibility=e,this.topBar.style.visibility=e,this.panel.style.visibility=e,this.mask.setAttribute("opacity","hidden"===e?0:1)}},{key:"reset",value:function(){this.feedback=null,this.shouldShowCountdown&&this.hideCountdown(),this.timer&&clearTimeout(this.timer)}},{key:"hideCountdown",value:function(){this.numberOne.style.visibility="hidden",this.numberTwo.style.visibility="hidden",this.numberThree.style.visibility="hidden"}},{key:"foundFace",value:function(){var e=this;if(this.canStart()){if(this.shouldShowCountdown)this.autoSelect();else{var t=this.base.language.term("prompt_get_ready");this.base.sendEvent(lf.feedback,{key:"prompt_get_ready",message:t}),this.setTextArea(this.status,t),this.forceStart(),this.loading(this.getProgress()),this.base.sendEvent(l),this.timer=setTimeout((function(){e.scan()}),2500)}this.changeColour(this.colours.ready_tint_color)}}},{key:"removeClickToStart",value:function(){this.svgContainer.removeEventListener("click",this.clickHandler)}},{key:"removeSpaceHandler",value:function(){document.removeEventListener("keypress",this.spaceHandler)}},{key:"autoSelect",value:function(){var e=this;this.count=3,this.forceStart(),this.autoTimer(),this.timer=setInterval((function(){e.autoTimer()}),1e3)}},{key:"autoTimer",value:function(){0!==this.count?(this.hideCountdown(),this.svgContainer.getElementById("svg-start-".concat(this.count)).style.visibility="visible",this.count--):this.scan()}},{key:"scan",value:function(){this.removeClickToStart(),this.removeSpaceHandler(),this.toggleUI("hidden"),this.reset();var e=this.base.language.term("prompt_scanning");this.setTextArea(this.status,e),this.changeColour(this.colours.loading_tint_color),this.oval.setAttribute("fill-opacity","0.2"),this.base.sendEvent(lf.feedback,{key:"prompt_scanning",message:e}),this.base.sendEvent(h)}},{key:"initialColours",value:function(){this.colourSetter(this.mask,this.colours.loading_tint_color)}},{key:"changeColour",value:function(e){this.colourSetter(this.oval,e),this.colourSetter(this.frame,e),this.colourSetter(this.mask,e)}},{key:"noFace",value:function(){this.changeColour(this.colours.loading_tint_color)}},{key:"moveCloser",value:function(){this.changeColour(this.colours.not_ready_tint_color)}},{key:"moveLeft",value:function(){this.changeColour(this.colours.not_ready_tint_color)}},{key:"moveRight",value:function(){this.changeColour(this.colours.not_ready_tint_color)}},{key:"moveUp",value:function(){this.changeColour(this.colours.not_ready_tint_color)}},{key:"moveDown",value:function(){this.changeColour(this.colours.not_ready_tint_color)}},{key:"moveBack",value:function(){this.changeColour(this.colours.not_ready_tint_color)}},{key:"getProgress",value:function(){return this.flashed*this.chunk}},{key:"loading",value:function(e){this.progress.setAttribute("width",e)}}]),n}();function kh(e){return(kh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nh(e,t){return(Nh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Oh(e){return(Oh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Dh={not_ready_tint_color:"#f5a623",ready_tint_color:"#01bf46",loading_tint_color:"#5c5c5c",no_face_found:"#e02020"},Fh=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nh(e,t)}(n,f);var t=function(e){return function(){var t,n=Oh(e);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()){var r=Oh(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return function(e,t){return!t||"object"!==kh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,t)}}(n);function n(e,r,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).setColours(Dh,r),a.init(Rh,i,o),a}return n}();function Ih(e){return(Ih="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Uh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Bh(e,t){return(Bh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jh(e){return(jh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var zh=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Bh(e,t)}(n,f);var t=function(e){return function(){var t,n=jh(e);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()){var r=jh(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return function(e,t){return!t||"object"!==Ih(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,t)}}(n);function n(e){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(r=t.call(this,e)).init(),r}return function(e,t,n){t&&Uh(e.prototype,t)}(n,[{key:"init",value:function(){this.base.console.log("palm interface has been called")}}]),n}(),Vh=n(176),Gh=n.n(Vh);function Wh(e){return(Wh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Hh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qh(e,t){return(qh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Xh(e){return(Xh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Yh=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&qh(e,t)}(n,Sr);var t=function(e){return function(){var t,n=Xh(e);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()){var r=Xh(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return function(e,t){return!t||"object"!==Wh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,t)}}(n);function n(e,r,i,o,a,s){var c;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(c=t.call(this,e,r,i,o,a,s)).landscape=xu/Su>1,c.listen(),c.inject(Gh.a),c}return function(e,t,n){t&&Hh(e.prototype,t)}(n,[{key:"listen",value:function(){var e=this;this.base.listenEvent(wr,(function(){e.svgContainer=e.base.app.querySelector("svg"),e.bar=e.svgContainer.getElementById("svg-bar"),e.exit=e.svgContainer.getElementById("svg-exit"),e.info=e.svgContainer.getElementById("svg-info-text"),e.mask=e.svgContainer.getElementById("svg-mask"),e.logo=e.svgContainer.getElementById("svg-logo"),e.topBar=e.svgContainer.getElementById("svg-top"),e.setCustomLogo(e.customLogo),e.repositionSVG(),e.initialColours(e.mask,e.colours.loading_tint_color),e.base.sendEvent(xr,{exit:e.exit}),e.showFeedback()})),this.base.listenEvent(xr,(function(){e.countdown=e.svgContainer.getElementById("svg-countdown"),e.numberOne=e.svgContainer.getElementById("svg-number-1"),e.numberTwo=e.svgContainer.getElementById("svg-number-2"),e.numberThree=e.svgContainer.getElementById("svg-number-3"),e.hideCountdown(),e.feedbackBar=e.svgContainer.getElementById("svg-feedback"),e.topText=e.svgContainer.querySelector("#svg-top-text tspan"),e.bottomText=e.svgContainer.querySelector("#svg-bottom-text tspan"),e.hideFeedback(),e.repositionSVG()})),this.base.listenEvent(Kt,(function(t){return e.faceFeedback(t)})),this.base.listenEvent([kr.dimensionsUpdated,lr.granted],(function(){return e.resize()})),this.base.listenEvent(kr.exitFullScreen,(function(){e.reset(),e.toggleUI("visible"),e.changeColour(e.colours.loading_tint_color)})),this.base.listenEvent(kr.start,(function(){return e.start()})),this.base.listenEvent(bl.clientStarted,(function(t){e.socketConnected=!0,e.setCustomTitle(e.title,t),e.updateInfo()})),this.base.listenEvent(Bu.abort,(function(){e.removeClickToStart(),e.removeSpaceHandler()}))}},{key:"setBasePositions",value:function(){this.top=this.positionTop(0),this.left=this.positionLeft(0),this.right=this.positionRight(0),this.bottom=this.positionBottom(0)}},{key:"setMaskSize",value:function(){var e,t=this.mask.getAttribute("d");e=this.landscape?"M".concat(this.left,",0 L").concat(this.right,",0 L").concat(this.right,",").concat(this.height," L").concat(this.left,",").concat(this.height," L").concat(this.left,",0 ").concat(t.substring(t.indexOf("Z"))):"M0,".concat(this.top," L").concat(this.width,",").concat(this.top," L").concat(this.width,",").concat(this.bottom," L0,").concat(this.bottom," L0,").concat(this.top," ").concat(t.substring(t.indexOf("Z"))),this.mask.setAttribute("d",e)}},{key:"setBar",value:function(){this.landscape?this.base.dom.setAttributes(this.bar,{x:this.left,y:0,width:this.right-this.left,height:80}):this.base.dom.setAttributes(this.bar,{x:0,y:this.top,width:this.right+this.left,height:80}),this.exit.setAttribute("transform","translate(".concat(this.positionRight(0)+-66,", ").concat(14,")")),this.logo.setAttribute("transform","translate(".concat(this.positionLeft(10),", ").concat(6,")"))}},{key:"repositionSVG",value:function(){this.setBasePositions(),this.setBar(),this.setMaskSize()}},{key:"hideCountdown",value:function(){this.hide(this.countdown),this.hide(this.numberOne),this.hide(this.numberTwo),this.hide(this.numberThree)}},{key:"showCountdown",value:function(){this.show(this.countdown)}},{key:"hideFeedback",value:function(){this.hide(this.feedbackBar)}},{key:"showFeedback",value:function(){this.show(this.feedbackBar)}},{key:"changeColour",value:function(e){this.colourSetter(this.mask,e)}},{key:"removeClickToStart",value:function(){this.svgContainer.removeEventListener("click",this.clickHandler)}},{key:"removeSpaceHandler",value:function(){document.removeEventListener("keypress",this.spaceHandler)}},{key:"toggleUI",value:function(e){this.base.console.log("Toggle UI: ".concat(e)),this.mask.setAttribute("opacity","hidden"===e?0:1)}},{key:"reset",value:function(){this.feedback=null,this.shouldShowCountdown&&this.hideCountdown(),this.timer&&clearTimeout(this.timer)}},{key:"scan",value:function(){this.removeClickToStart(),this.removeSpaceHandler(),this.toggleUI("hidden"),this.hide(this.topBar),this.hideCountdown(),this.reset();var e=this.base.language.term("prompt_scanning");this.changeColour(this.colours.loading_tint_color),this.base.sendEvent(lf.feedback,{key:"prompt_scanning",message:e}),this.base.sendEvent(h)}},{key:"autoTimer",value:function(){if(0===this.count)return this.setTextArea(this.topText,""),this.setTextArea(this.bottomText,""),void this.scan();3===this.count?(this.show(this.numberThree),this.hide(this.numberTwo),this.hide(this.numberOne)):2===this.count?(this.hide(this.numberThree),this.show(this.numberTwo),this.hide(this.numberOne)):1===this.count&&(this.hide(this.numberThree),this.hide(this.numberTwo),this.show(this.numberOne)),this.count--}},{key:"autoSelect",value:function(){var e=this;this.showCountdown(),this.show(this.numberThree),this.forceStart(),this.setTextArea(this.topText,"Keep still"),this.setTextArea(this.bottomText,"Keep still"),this.count=3,this.autoTimer(),this.timer=setInterval((function(){e.autoTimer()}),1e3)}},{key:"foundFace",value:function(){var e=this;if(this.setTextArea(this.topText,"Keep still"),this.setTextArea(this.bottomText,"Keep still"),this.changeColour(this.colours.ready_tint_color),this.canStart()){if(this.shouldShowCountdown)return void this.autoSelect();this.forceStart(),this.base.sendEvent(l),this.timer=setTimeout((function(){e.scan()}),2500),this.changeColour(this.colours.ready_tint_color)}}},{key:"start",value:function(){this.base.sendEvent(lf.feedback,{key:"prompt_hold_still",message:this.base.language.term("prompt_hold_still")}),this.fadeIn(),this.show(this.topBar)}},{key:"faceFeedback",value:function(e){e!==this.feedback&&"function"==typeof this[e]&&(this.shouldShowCountdown||"foundFace"!==e&&(this.removeClickToStart(),this.removeSpaceHandler(),this.timer&&(clearTimeout(this.timer),this.base.sendEvent(u))),this.reset(),this[e](e),this.feedback=e)}},{key:"animate",value:function(e,t){e.setAttribute("class","animated ".concat(t)),e.addEventListener("animationend",(function(){e.setAttribute("class","")}))}},{key:"noFace",value:function(){this.setTextArea(this.topText,"Put your face in the oval"),this.setTextArea(this.bottomText,"Put your face in the oval"),this.hideCountdown(),this.changeColour(this.colours.no_face_found)}},{key:"moveCloser",value:function(){this.setTextArea(this.topText,"Move Closer"),this.setTextArea(this.bottomText,"Move Closer"),this.changeColour(this.colours.not_ready_tint_color),this.hideCountdown()}},{key:"moveLeft",value:function(){this.hideCountdown(),this.setTextArea(this.topText,"Move Left"),this.setTextArea(this.bottomText,"Move Left"),this.changeColour(this.colours.not_ready_tint_color)}},{key:"moveRight",value:function(){this.setTextArea(this.topText,"Move Right"),this.setTextArea(this.bottomText,"Move Right"),this.changeColour(this.colours.not_ready_tint_color),this.hideCountdown()}},{key:"moveUp",value:function(){this.setTextArea(this.topText,"Move Up"),this.setTextArea(this.bottomText,"Move Up"),this.changeColour(this.colours.not_ready_tint_color),this.hideCountdown()}},{key:"moveDown",value:function(){this.setTextArea(this.topText,"Move Down"),this.setTextArea(this.bottomText,"Move Down"),this.changeColour(this.colours.not_ready_tint_color),this.hideCountdown()}},{key:"moveBack",value:function(){this.setTextArea(this.topText,"Move Back"),this.setTextArea(this.bottomText,"Move Back"),this.changeColour(this.colours.not_ready_tint_color),this.hideCountdown()}}]),n}();function Zh(e){return(Zh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Jh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Kh(e,t){return(Kh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $h(e){return($h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Qh={not_ready_tint_color:"#f5a623",ready_tint_color:"#01bf46",loading_tint_color:"#5c5c5c",no_face_found:"#e02020"},ef=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Kh(e,t)}(n,f);var t=function(e){return function(){var t,n=$h(e);if(function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}()){var r=$h(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return function(e,t){return!t||"object"!==Zh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,t)}}(n);function n(e,r,i,o){var a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(a=t.call(this,e)).setColours(Qh,r),a.init(Yh,i,o),a}return function(e,t,n){t&&Jh(e.prototype,t)}(n,[{key:"init",value:function(e,t,n){this.interface=new e(this.base,1653,1220,this.colours,t,n)}}]),n}();function tf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var nf=["default","palm","kiosk"],rf=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=t,this.setInterface(o,n,r,i)}return function(e,t,n){t&&tf(e.prototype,t)}(e,[{key:"setInterface",value:function(e,t,n,r){switch(e){case nf[0]:this.interface=new Fh(this.base,t,n,r);break;case nf[1]:this.interface=new zh(this.base,t,n,r);break;case nf[2]:this.interface=new ef(this.base,t,n,r)}}}]),e}();function of(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function af(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sf(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,i)}function cf(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){sf(o,r,i,a,s,"next",e)}function s(e){sf(o,r,i,a,s,"throw",e)}a(void 0)}))}}function em(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n(366);var uf,lf={error:"iProov.error",finished:"iProov.finished",feedback:"iProov.feedback"},hf=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.base=new Sh(t),this.callback={},["ready","permission_denied","permission","started","aborted","streamed","progress","passed","failed","error","unsupported"].forEach((function(e){n.base.settings.config.hasOwnProperty(e)&&(n.callback[e]=n.base.settings.config[e])})),this.details=this.base.details,this.app=this.base.app,this.checkSupport().then((function(e){e.isNativeBridge?n.initNativeBridge():n.init()}))}return function(e,t,n){t&&em(e.prototype,t)}(e,[{key:"checkSupport",value:function(){var e=cf(regeneratorRuntime.mark((function e(){var t,n,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.base.device.supportCheck.promise;case 2:return t=e.sent,n=t.supported,r=t.isNativeBridge,i=t.isNativeBridgeInstalled,n||this.runCallback("unsupported",this.getDetails({feedback:"client_browser",heading:this.base.language.term("error_not_supported"),reason:this.base.language.term("error_not_supported_message")})),this.isNativeBridge=r,this.isNativeBridgeInstalled=i,e.abrupt("return",{supported:n,isNativeBridge:r,isNativeBridgeInstalled:i});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"init",value:function(){var e=cf(regeneratorRuntime.mark((function e(){var t,n,i,r,a,s,o,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkSupport();case 2:if(e.sent.supported){e.next=6;break}return e.abrupt("return");case 6:t=this.base.settings.config,n=t.start_button,i=t.grant_button,r=t.colours,a=t.allow_landscape,s=t.logo,o=t.title,u=t.kiosk_mode,this.accessibility=this.base.shadow.getElementById("accessibility"),this.app=this.base.app,this.video=new hr(this.base),this.screen=new Nr(this.base,n,a),this.ui=new rf(this.base,r,s,o,u?nf[2]:nf[0]),this.camera=new dr(this.base,i),this.socket=new _l(this.base,this.camera,{isKioskMode:u}),this.claim=new ju(this.base),this.faceDetect=new An(this.base,this.video,{isKioskMode:u}),this.canvas=new Eh(this.base,this.video,this.faceDetect.face,r,u),this.encoder=new zn(this.base,this.video,this.faceDetect),this.aborted=!1,this.error=!1,this.listen(),this.base.sendEvent(lf.finished);case 22:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"initNativeBridge",value:function(){var e=cf(regeneratorRuntime.mark((function e(){var t,n,i,r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.checkSupport();case 2:if(e.sent.supported){e.next=6;break}return e.abrupt("return");case 6:this.aborted=!1,this.socket=new _l(this.base,null,{isNativeBridge:!0}),this.socket.setup(),this.claim=new ju(this.base),t=this.base.device.isNativeBridgeInstalled,n=this.base.container.querySelector('[slot="button"]')?this.base.container.querySelector('[slot="button"]'):this.base.settings.config.start_button.querySelector("button"),this.base.legacy_native_bridge&&!t?(this.base.console.warn("Deprecated legacy_native_bridge mode: replacing app link"),(i=ff(n,this.base.token,{streaming_url:this.base.base_url,options:this.base.prefer_app_options})).addEventListener("click",(function(){r.base.console.log("Launch iProov App...")})),n.parentNode.replaceChild(i,n)):n.addEventListener("click",(function(){r.socket.io.launch(r.base.token,r.base.base_url.toString(),r.base.native_sdk_options)})),this.listen(),this.base.sendEvent(lf.finished),this.runCallback("ready",this.getDetails());case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"listen",value:function(){var e=this;this.base.listenEvent([lf.error,bl.error,lr.error,Bu.error],(function(t){e.error||(e.error=!0,e.toggleDisplay(),e.toggleVisibility(),t.heading=e.base.language.term("error"),e.runCallback("error",e.getDetails(t)))})),this.base.listenEvent(bl.invalidated,(function(t){e.base.console.log("App exited before iProoving",t),e.runCallback("error",e.getDetails(t))})),this.base.listenEvent(bl.edgeResult,(function(t){e.aborted||(e.feedback(t.reason),e.toggleVisibility(),e.runCallback("passed"===t.feedback?"passed":"failed",e.getDetails(t)))})),this.base.listenEvent(kr.exitFullScreen,(function(){e.toggleDisplay(),e.toggleVisibility()})),this.base.listenEvent(lr.granted,(function(t){e.aborted||(t.hasPermission?e.runCallback("ready",e.getDetails(t)):e.runCallback("permission",e.getDetails({heading:e.base.language.term("prompt_grant_permission"),reason:e.base.language.term("prompt_grant_permission_message")})))})),this.base.listenEvent(lf.feedback,(function(t){e.feedback(t.message)})),this.base.listenEvent(kr.enterFullScreen,(function(){e.toggleDisplay("block")})),this.base.listenEvent(kr.start,(function(){e.toggleVisibility("visible"),e.aborted=!1,e.runCallback("started",e.getDetails())})),this.base.listenEvent(lr.noCamera,(function(){e.toggleVisibility(),e.runCallback("no_camera",e.getDetails({heading:e.base.language.term("error_no_camera"),reason:e.base.language.term("error_no_camera_message")}))})),this.base.listenEvent(lr.denied,(function(){e.toggleVisibility(),e.runCallback("permission_denied",e.getDetails({heading:e.base.language.term("error_camera_permission_denied"),reason:e.base.language.term("error_camera_permission_denied_message")}))})),this.base.listenEvent(bl.claimed,(function(t){e.isNativeBridge&&e.runCallback("started",e.getDetails())})),this.base.listenEvent(qn.finished,(function(){requestAnimationFrame((function(){e.toggleVisibility()}))})),this.base.listenEvent([bl.edgeStatus,Un],(function(t){e.aborted||(e.feedback(t.reason),e.runCallback("progress",e.getDetails(t)))})),this.base.listenEvent(h,(function(){e.runCallback("streamed",e.getDetails())})),this.base.listenEvent(Bu.abort,(function(t){e.aborted||e.error||(e.aborted=!0,e.runCallback("aborted",e.getDetails(t)))}))}},{key:"feedback",value:function(e){if(e){var t=this.accessibility;t&&(t.textContent=e,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"change",n=document.createEvent("Event");n.initEvent(t,!0,!0),e.dispatchEvent(n)}(t))}}},{key:"toggleVisibility",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"hidden";this.app.style.visibility=e}},{key:"toggleDisplay",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"none";this.app.style.display=e}},{key:"hasCallback",value:function(e){return this.callback[e]&&"function"==typeof this.callback[e]}},{key:"runCallback",value:function(e,t){this.isNativeBridge&&(t.is_native_bridge=!0),this.base.settings.config.integration[e]&&this.base.settings.config.integration[e](this.base.shadow,t),this.hasCallback(e)&&this.callback[e](this.base.shadow,t)}},{key:"getDetails",value:function(){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?of(Object(n),!0).forEach((function(t){af(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):of(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{},this.details)}}]),e}();function ff(e,t,n){var r=document.createElement("a"),i=e.attributes,o=i.length,a=null;if(n.streaming_url){var s=new URL(n.streaming_url);a=s.protocol+"//"+s.host}var c={streaming_url:a||null,options:n.options?n.options:null},u=new URL(t,"https://iproov.app"),l=Object.keys(c).map((function(e){return null!==c[e]?e+"="+encodeURIComponent(c[e]):null})).filter((function(e){return null!==e})).join("&");for(u.search=l,r.href=u.href,e=e.cloneNode(!0);e.firstChild;)r.appendChild(e.firstChild);for(var h=0;h<o;h++)r.setAttribute(i[h].nodeName,i[h].nodeValue);return e.style.cssText&&(r.style.cssText=e.style.cssText),r}function df(e){return(df="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mf(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function vf(e){var t="function"==typeof Map?new Map:void 0;return(vf=function(e){if(null===e||!function(e){return-1!==Function.toString.call(e).indexOf("[native code]")}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return gf(e,arguments,_f(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),bf(n,e)})(e)}function gf(e,t,n){return(gf=yf()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&bf(i,n.prototype),i}).apply(null,arguments)}function yf(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function bf(e,t){return(bf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _f(e){return(_f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wf="iproov-is-visible",xf=["allow_landscape","assets_url","background_color","base_url","custom_title","interface","kiosk_mode","language","line_color","loading_tint_color","logo","not_ready_tint_color","legacy_native_bridge","native_sdk_options","ready_tint_color","show_countdown","token"];function Sf(e){Ef(e,"ready").classList.remove(wf),Ef(e,"button").classList.remove(wf),Ef(e,"aborted").classList.remove(wf),Ef(e,"progress").classList.remove(wf),Ef(e,"passed").classList.remove(wf),Ef(e,"failed").classList.remove(wf),Ef(e,"error").classList.remove(wf),Ef(e,"unsupported").classList.remove(wf),Ef(e,"permission_denied").classList.remove(wf),Ef(e,"grant_permission").classList.remove(wf),Ef(e,"grant_button").classList.remove(wf)}function Ef(e,t){return e.querySelector("#iproov-"+t)}function Mf(e,t){var n=t.heading,r=t.reason,i=t.message;if(n){var o=e.querySelector(".iproov-lang-heading");o&&(o.innerText=n)}var a=r||i;if(a){var s=e.querySelector(".iproov-lang-term");s&&(s.innerText=a)}}var Cf=Object(r.WebComponent)("iproov-me",{template:n(364),styles:n(365),shadowDOM:!0})(uf=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&bf(e,t)}(n,vf(HTMLElement));var t=function(e){return function(){var t,n=_f(e);if(yf()){var r=_f(this).constructor;t=Reflect.construct(n,arguments,r)}else t=n.apply(this,arguments);return function(e,t){return!t||"object"!==df(t)&&"function"!=typeof t?mf(e):t}(this,t)}}(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,n),(e=t.call(this)).props={},xf.forEach((function(t){t in r&&(e.props[t]=r[t])}),mf(e)),e.shadowDomIntegration={ready:function(e,t){Sf(e),Ef(e,"ready").classList.add(wf),Ef(e,"button").classList.add(wf)},started:function(e){Sf(e),Ef(e,"progress").classList.add(wf)},aborted:function(e){Sf(e),Ef(e,"aborted").classList.add(wf),Ef(e,"button").classList.add(wf)},streamed:function(e){Sf(e),Ef(e,"progress").classList.add(wf)},progress:function(e,t){var n=Ef(e,"progress");n.querySelector("progress").value=t.progress,Mf(n,t)},passed:function(e,t){Sf(e);var n=Ef(e,"passed");n.classList.add(wf),Mf(n,t)},failed:function(e,t){Sf(e);var n=Ef(e,"failed");n.classList.add(wf),Mf(n,t)},error:function(e,t){Sf(e);var n=Ef(e,"error");n.classList.add(wf),Mf(n,t)},unsupported:function(e,t){Sf(e);var n=Ef(e,"unsupported");n.classList.add(wf),Mf(n,t)},permission:function(e,t){Sf(e);var n=Ef(e,"grant_permission");n.classList.add(wf),Mf(n,t),Ef(e,"grant_button").classList.add(wf)},permission_denied:function(e,t){Sf(e);var n=Ef(e,"permission_denied");n.classList.add(wf),Mf(n,t)},no_camera:function(e,t){Sf(e);var n=Ef(e,"no_camera");n.classList.add(wf),Mf(n,t)}},e}return function(e,t,n){t&&pf(e.prototype,t)}(n,[{key:"settings",value:function(){var e=this;return xf.reduce((function(t,n){return Object.assign(t,function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({},n,e.props[n]||e.getAttribute(n)))}),{})}},{key:"getSlotElement",value:function(e,t){var n=e.querySelector("slot[name="+t+"]"),r=n.assignedNodes({flatten:!1});return r.length?r.find((function(e){return"Text"!==e.constructor.name})):n.children[0]}},{key:"connectedCallback",value:function(){var e=this,t=this.settings();function n(t){return function(){var n=Array.prototype.slice.call(arguments);e.dispatchEvent(new CustomEvent(t,{detail:function(e){return void 0!==e.heading&&delete e.heading,e}(n[1])}))}}this.iproov=new hf({config:{dom:this,token:t.token,start_button:Ef(this.shadowRoot,"button"),grant_button:Ef(this.shadowRoot,"grant_button"),integration:this.shadowDomIntegration,ready:n("ready"),permission_denied:n("permission_denied"),permission:n("permission"),aborted:n("aborted"),started:n("started"),progress:n("progress"),streamed:n("streamed"),passed:n("passed"),failed:n("failed"),error:n("error"),no_camera:n("no_camera"),unsupported:n("unsupported"),interface:t.interface||void 0,allow_landscape:t.allow_landscape,assets_url:fh(t.assets_url),base_url:fh(t.base_url),language:t.language||{},legacy_native_bridge:dh(t.legacy_native_bridge),native_sdk_options:fh(t.native_sdk_options),show_countdown:fh(t.show_countdown),title:t.custom_title,kiosk_mode:t.kiosk_mode,colours:function(e){return{background_color:e.background_color,line_color:e.line_color,loading_tint_color:e.loading_tint_color,not_ready_tint_color:e.not_ready_tint_color,ready_tint_color:e.ready_tint_color,no_face_found:e.no_face_found}}(t),logo:t.logo}})}},{key:"nativeBridge",get:function(){if(this.iproov.base.legacy_native_bridge)return this.iproov.socket.io.legacyBridge;throw new Error("Please enable legacy_native_bridge on the <iproov-me> component")}}]),n}())||uf;t.default=Cf}])},187:function(e,t,n){"use strict";var r=n(183);n.n(r).a},188:function(e,t,n){(t=n(47)(!1)).push([e.i,".m-1[data-v-1086fa2e]{margin:1rem 0!important}.card[data-v-1086fa2e]{height:100%}",""]),e.exports=t},189:function(e,t,n){"use strict";n.r(t);n(13);var r={head:function(){return{title:"Identiface | Face Verify"}},created:function(){},mounted:function(){var e=this;this.token="",this.notice="You need to verify before proceeding with the transfer.",this.alerts("You're about to transfer more than your daily limit. Verification is needed.","is-danger",5e3),window.some_lib=n(186),window.iProovEvent=function(t){var n=document.getElementsByTagName("PROGRESS");switch(t.type){case"aborted":e.alerts("You've aborted the process.","is-danger",5e3);break;case"passed":case"failed":n[0].setAttribute("value",100),e.validateResult();break;case"error":e.alerts("Error: "+t.detail.reason,"is-danger",5e3);break;case"ready":n[0].setAttribute("value",10),e.alerts("Ready to begin face verification","is-success",3e3);break;case"unsupported":e.alerts("Not supported!","is-danger",5e3);break;case"permission":e.alerts("Please enable permissions to continue","is-info",3e3);break;case"permission_denied":e.alerts("You need to enable camera permissions to continue","is-warning",3e3);break;case"progress":n[0].style.visibility="visible";for(var r=n[0].getAttribute("value"),o=t.detail.progress-r,c=r;c<o;c++)n[0].setAttribute("value",t.detail.progress);t.detail.progress>40&&t.detail.progress<60?(n[0].classList.remove("is-primary"),n[0].classList.add("is-info")):t.detail.progress>60&&(n[0].classList.remove("is-info"),n[0].classList.add("is-success"));break;case"feedback":e.alerts(t.detail.reason,"is-info",5e3);default:console.log("sp-face"+t.detail.type+" "+t.type)}}},data:function(){return{notice:"Thank you for signing up.",columnA:"column is-6 is-offset-3",label:"Validate NRIC",token:"",activeStep:0,title:"Verification",account:"177-77777-777",amount:"S$ 9,999,999.99",service_id:"SingPass",user_id:"G2957839M",transaction_type:"SingPass onboarding",image:"",validated:!1,verified:!1,backendPass:"ndi-api",isLoading:!1,isCardModalActive:!0,isPrivacyAssuranceActive:!1}},methods:{startVerify:function(){var e=this;this.validateNRIC().then((function(t){""!=t&&(e.validated=!0,e.activeStep=1,e.openLoading())})).catch((function(t){if(null!=t.response){var n=t.response.data;e.alerts(n.message,"is-danger",2e3)}else console.log(t),e.alerts("ERROR: Service is offline","is-danger",5e3)}))},alerts:function(e,t,n){this.$buefy.toast.open({duration:n,message:e,type:t,queue:!1,canvasWidth:800,canvasHeight:800})},validateNRIC:function(){var e=this;return new Promise((function(t,n){e.token="";e.$axios.$post("/face/verify/token",{user_id:e.user_id,service_id:e.service_id,transaction_type:e.transaction_type,pw:e.backendPass}).then((function(n){if("error"==n.type)e.alerts(n.status+" "+n.message.error_description,"is-danger",5e3),e.notice="Your NRIC is invalid or does not exist in the SingPass database.";else{var r=n.token;e.token=n.token,e.alerts("NRIC validated!","is-success",2e3),e.notice="We'll need to verify your identity now.",t(r)}})).catch((function(t){if(e.token="",null!=t.response){var n=t.response.data;e.notice="Your NRIC is invalid or does not exist in the SingPass database.",e.alerts("User doesn't exist in the SingPass database","is-danger",2e3),console.log(n)}else e.notice="Verification service is offline.",e.alerts("ERROR: Service is offline","is-danger",5e3)}))}))},validateResult:function(){var e=this;this.$axios.$post("/face/verify/validate",{user_id:this.user_id,service_id:this.service_id,token:this.token,pw:this.backendPass}).then((function(t){if("success"==t.type){var n=t.is_passed,r=(t.reason,Math.ceil(100*t.score));n&&r>70?(e.verified=!0,e.notice="Transaction successful!",e.title="Success!",e.alerts("You have successfully transferred S$ 9,999,999.99 to account number 177-77777-777.","is-success",1e4)):e.alerts("Failed verification","is-danger",5e3)}else{var o=t.message;console.log(t),e.alerts(o.error_description,"is-danger",5e3)}})).catch((function(t){if(null!=t.response){var n=t.response.data.message.error_description;e.alerts(n,"is-danger",2e3)}else e.alerts("ERROR: Service is offline","is-danger",5e3)}))},openLoading:function(){var e=this;this.isLoading=!0,setTimeout((function(){e.isLoading=!1;var t=e.$el.querySelector("iproov-me");t.addEventListener("ready",iProovEvent),t.addEventListener("started",iProovEvent),t.addEventListener("aborted",iProovEvent),t.addEventListener("streamed",iProovEvent),t.addEventListener("progress",iProovEvent),t.addEventListener("passed",iProovEvent),t.addEventListener("failed",iProovEvent),t.addEventListener("error",iProovEvent),t.addEventListener("unsupported",iProovEvent),t.addEventListener("permission",iProovEvent),t.addEventListener("permission_denied",iProovEvent)}),500)}}},o=(n(187),n(18)),component=Object(o.a)(r,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"section"},[r("div",{staticClass:"columns"},[r("div",{staticClass:"column is-half is-offset-one-quarter has-text-centered"},[r("p",[e._v(e._s(this.notice))])])]),e._v(" "),r("div",{staticClass:"columns"},[r("div",{class:e.columnA},[r("b-steps",{attrs:{animated:!0,rounded:!1,"has-navigation":!1},model:{value:e.activeStep,callback:function(t){e.activeStep=t},expression:"activeStep"}},[r("b-step-item",{attrs:{step:"1",label:"Transfer details",clickable:!1}},[r("h1",{staticClass:"title has-text-centered"},[e._v("Transfer details")]),e._v(" "),r("div",{staticClass:"card"},[r("div",{staticClass:"card-content"},[r("div",{staticClass:"content"},[r("form",{on:{submit:function(t){return t.preventDefault(),e.startVerify(t)}}},[r("b-field",{attrs:{label:"Transfer to account"}},[r("b-input",{attrs:{placeholder:"",required:"",disabled:!0},model:{value:e.account,callback:function(t){e.account=t},expression:"account"}})],1),e._v(" "),r("b-field",{attrs:{label:"Amount"}},[r("b-input",{attrs:{placeholder:"",required:"",disabled:!0},model:{value:e.amount,callback:function(t){e.amount=t},expression:"amount"}})],1),e._v(" "),r("b-field",{attrs:{label:"Key in your NRIC/FIN number to confirm"}},[r("b-input",{attrs:{placeholder:"S7012345A",required:"",disabled:e.validated},model:{value:e.user_id,callback:function(t){e.user_id=t},expression:"user_id"}})],1),e._v(" "),"G2957839M"==this.user_id?r("a",{staticClass:"is-primary is-size-7",on:{click:function(t){e.user_id="G2834561K"}}},[r("u",[e._v("Set to a dummy NRIC persona that will fail verification")])]):r("a",{staticClass:"is-primary is-size-7",on:{click:function(t){e.user_id="G2957839M"}}},[r("u",[e._v("Set to a dummy NRIC persona that will pass verification")])]),e._v(" "),r("br"),r("br"),e._v(" "),r("b-button",{staticClass:"is-dark",attrs:{type:"submit",disabled:!(!e.validated&&9==this.user_id.length)},on:{click:e.startVerify}},[e._v("Next")])],1)])])])]),e._v(" "),r("b-step-item",{attrs:{step:"2",label:"Verification",clickable:!1}},[r("h1",{staticClass:"title has-text-centered"},[e._v(e._s(e.title))]),e._v(" "),r("div",{staticClass:"card"},[r("div",{staticClass:"card-content"},[e.verified?r("div",{ref:"verifyCard",staticClass:"content",staticStyle:{"justify-content":"center"}},[r("img",{staticStyle:{"max-height":"30vh"},attrs:{src:n(185)}}),e._v(" "),r("h1",[e._v("Success!")]),e._v(" "),r("h3",[e._v(e._s(e.amount)+" was transferred to account number "+e._s(e.account)+".")])]):e._e(),e._v(" "),e.verified?e._e():r("div",{ref:"verifyCard",staticClass:"content"},[r("h4",[e._v("Verify your identity with SingPass Face")]),e._v(" "),r("img",{attrs:{src:n(184)}}),e._v(" "),r("br"),e._v(" "),r("a",{staticClass:"is-primary is-size-7",on:{click:function(t){e.isPrivacyAssuranceActive=!0}}},[e._v("\n                                    Read SingPass Face Privacy Assurance\n                                ")]),e._v(" "),r("br"),e._v(" "),r("br"),e._v(" "),r("p",[e._v("Verification progress:")]),e._v(" "),r("progress",{staticClass:"progress is-large is-primary",attrs:{id:"progress-bar",value:"0",max:"100",hidden:""}},[e._v("0")]),e._v(" "),r("hr"),e._v(" "),r("b-loading",{attrs:{"is-full-page":!1,active:e.isLoading,"can-cancel":!0},on:{"update:active":function(t){e.isLoading=t}}}),e._v(" "),e.validated?r("iproov-me",{ref:"iproov",attrs:{token:e.token,base_url:"https://stg-bio-stream.singpass.gov.sg",logo:"https://www.ndi-api.gov.sg/assets/img/ndi-api-logo.png",assets_url:"http://localhost:8080"}},[r("div",{staticClass:"m-1",attrs:{slot:"no_camera"},slot:"no_camera"},[r("p",{staticClass:"has-text-danger"},[e._v("You don't have a camera on your device."),r("br")])]),e._v(" "),r("div",{staticClass:"m-1",attrs:{slot:"grant_permission"},slot:"grant_permission"},[r("p",{staticClass:"has-text-grey-dark"},[e._v("Before we proceed, please allow us to access your camera."),r("br")])]),e._v(" "),r("div",{staticClass:"m-1",attrs:{slot:"grant_button"},slot:"grant_button"},[r("b-button",{staticClass:"is-warning"},[e._v("Allow camera access")]),r("br"),r("br"),e._v(" "),r("a",{staticClass:"has-text-grey",attrs:{href:"/"}},[r("u",[e._v("Use another way to verify my identity")])])],1),e._v(" "),r("div",{staticClass:"m-1",attrs:{slot:"permission_denied"},slot:"permission_denied"},[r("p",{staticClass:"has-text-danger"},[e._v("You've denied permissions. If you would like to continue with the verification, please refresh the page."),r("br")])]),e._v(" "),r("div",{staticClass:"m-1",attrs:{slot:"ready"},slot:"ready"},[r("p",{staticClass:"has-text-grey-dark"},[e._v("Thank you. Please proceed to verify your identity."),r("br")])]),e._v(" "),r("div",{staticClass:"m-1",attrs:{slot:"button"},slot:"button"},[r("b-button",{staticClass:"is-primary"},[e._v("Scan my face")])],1),e._v(" "),r("div",{staticClass:"m-1",attrs:{slot:"aborted"},slot:"aborted"},[r("p",{staticClass:"has-text-grey-dark"},[e._v("If you'd like to try again, please click the button below."),r("br")])]),e._v(" "),r("div",{staticClass:"m-1",attrs:{slot:"progress"},slot:"progress"},[r("p",{staticClass:"has-text-grey-dark"},[e._v("Verifying, please wait..."),r("br")]),e._v(" "),r("progress",{staticClass:"progress is-small is-primary",attrs:{max:"100"}},[e._v("15%")])]),e._v(" "),r("div",{staticClass:"m-1",attrs:{slot:"passed"},slot:"passed"},[r("p",[e._v("You have successfully transferred.")])]),e._v(" "),r("div",{staticClass:"m-1",attrs:{slot:"failed"},slot:"failed"},[r("p",[e._v("You have failed verification. Retry?")])]),e._v(" "),r("div",{staticClass:"m-1",attrs:{slot:"error"},slot:"error"},[r("p",{staticClass:"has-text-grey-dark"},[e._v("Oh no, something went wrong. Please try again."),r("br")]),e._v(" "),r("a",{staticClass:"button is-warning",attrs:{href:"/"}},[e._v("Retry")])])]):e._e()],1)])])])],1)],1)]),e._v(" "),r("b-modal",{attrs:{active:e.isCardModalActive,width:640,scroll:"keep"},on:{"update:active":function(t){e.isCardModalActive=t}}},[r("div",{staticClass:"card"},[r("div",{staticClass:"card-content"},[r("div",{staticClass:"content"},[r("p",[r("b",[e._v("Welcome to the Face Verify API demo.")])]),e._v(" "),r("p",{staticClass:"is-italic"},[e._v("The Face Verify Service contains a face-scanning module with Presentation-Attack-Detection (PAD) and liveness detection technologies that you can use to embed into your frontend, with API endpoints to validate the user's identity and results.")]),e._v(" "),r("p",[e._v("In this sample transaction authorisation demo, we will be using a dummy NRIC persona "),r("code",[e._v("G2957839M")]),e._v(", which will return an always "),r("code",[e._v("true")]),e._v(" result when verifying the identity, regardless of the face.")]),e._v(" "),r("p",[e._v("If you'd like to test a flow that will "),r("b",[e._v("fail")]),e._v(" authentication, please replace the dummy NRIC persona to "),r("code",[e._v("G2834561K")]),e._v(". This will return a "),r("code",[e._v("false")]),e._v(" match result.")]),e._v(" "),r("br"),e._v(" "),r("a",{staticClass:"button is-primary",on:{click:function(t){e.isCardModalActive=!1}}},[e._v("Close")])])])])]),e._v(" "),r("client-only",[r("b-modal",{attrs:{active:e.isPrivacyAssuranceActive,width:640,scroll:"keep"},on:{"update:active":function(t){e.isPrivacyAssuranceActive=t}}},[r("div",{staticClass:"card"},[r("div",{staticClass:"card-content"},[r("div",{staticClass:"content",staticStyle:{"overflow-y":"scroll","max-height":"90vh !important"}},[r("img",{attrs:{src:n(184)}}),e._v(" "),r("h5",[r("b",[e._v("Verifying your identity with SingPass Face")])]),e._v(" "),r("hr"),e._v(" "),r("br"),e._v(" "),r("p",[e._v("The new SingPass face verification feature makes it easy for you to verify your identity by scanning your face. We are committed to protecting your data when you use the SingPass face verification feature:")]),e._v(" "),r("br"),e._v(" "),r("b",[e._v("1. Your consent is key")]),e._v(" "),r("hr"),e._v(" "),r("p",[e._v("You will be asked to give consent for the system to capture your facial images electronically and use that data to verify your identity for access to government digital services.")]),e._v(" "),r("br"),e._v(" "),r("b",[e._v("2. You are protected against fraud")]),e._v(" "),r("hr"),e._v(" "),r("p",[e._v("You will be asked to give consent for the system to capture your facial images electronically and use that data to verify your identity for access to government digital services.")]),e._v(" "),r("br"),e._v(" "),r("b",[e._v("3. Your data is encrypted")]),e._v(" "),r("hr"),e._v(" "),r("p",[e._v("All captured facial images are encrypted and protected with advanced technologies to prevent unauthorised access. Additional measures, such as security incident monitoring, are also put in place to ensure that your personal data is securely protected.")]),e._v(" "),r("br"),e._v(" "),r("b",[e._v("4. Storage of your image is time-limited")]),e._v(" "),r("hr"),e._v(" "),r("p",[e._v("The system will only keep the captured facial images for 30 days for audit purposes. Thereafter, the images will be deleted. There is no collection or storing of any other personal data from you on the system. Your data will not be used for any surveillance or commercial purposes.")]),e._v(" "),r("p",[e._v("If you do not wish to use the SingPass face verification feature, you may use other available way of authentication, such as SMS OTP.")]),e._v(" "),r("br"),e._v(" "),r("small",{staticClass:"is-italic"},[e._v("Privacy Assurance as of 08 July 2020")]),e._v(" "),r("br"),e._v(" "),r("br"),e._v(" "),r("br"),e._v(" "),r("br"),e._v(" "),r("br")])])])])],1)],1)}),[],!1,null,"1086fa2e",null);t.default=component.exports}}]);